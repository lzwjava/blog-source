---
audio: false
generated: true
image: false
lang: ar
layout: post
model: moonshotai/kimi-k2-thinking
title: نظرة عامة على بروتوكول متعدد المسارات لـ TCP
translated: true
---

MPTCP هو امتداد لبروتوكول طبقة النقل يغير بشكل جذري طريقة عمل اتصالات الشبكة من خلال تمكين اتصال منطقي واحد من استخدام مسارات فيزيائية متعددة في وقت واحد. إليك تفصيلاً دقيقاً:

## **1. المشكلة الأساسية: قيود المسار الواحد**

يُقيِّد بروتوكول TCP التقليدي كل اتصال بمسار شبكة واحد محدد بواسطة 5-توبل (عنوان IP المصدر، منفذ المصدر، عنوان IP الوجهة، منفذ الوجهة، البروتوكول). وهذا يخلق عدة قيود حرجة:

- **لا يوجد تجميع للواجهات**: يمكن للجهاز الذي يحتوي على كل من Wi-Fi والخلوية استخدام واجهة واحدة فقط في كل مرة
- **نقطة فشل واحدة**: إذا أصبح المسار المختير مزدحمًا أو فشل، فإن الاتصال بأكمله ينقطع
- **استخدام غير أمثل للموارد**: تبقى المسارات البديلة غير المزدحمة خاملة بينما يعاني مسار واحد
- **تعطيل التنقل**: تتطلب التنقل بين الشبكات (مثال: من Wi-Fi إلى 4G) إعادة إنشاء جميع الاتصالات

الأجهزة الحديثة متعددة العوائل بطبيعتها—الهواتف الذكية، أجهزة الكمبيوتر المحمولة، والخوادم لديها واجهات شبكة متعددة—لكن TCP لا يمكنه الاستفادة من هذا التنوع.

## **2. كيف يعمل MPTCP: هندسة Subflow**

MPTCP (RFC 8684) **ليس** بروتوكولاً جديداً بل هو امتداد متوافق مع الإصدارات السابقة لـ TCP. يعمل من خلال إنشاء **subflows**—اتصالات TCP مستقلة عبر مسارات مختلفة—تشكل معًا اتصال MPTCP منطقيًا واحدًا.

### عملية إنشاء الاتصال:

1. **المصافحة الأولية**: يتفاوض العميل والخادم حول قدرة MPTCP أثناء مصافحة TCP الثلاثية المعيارية
2. **اكتشاف المسار**: يتبادل الأطراف عناوين IP إضافية يمكنهم استخدامها
3. **إنشاء Subflow**: يتم إنشاء اتصالات TCP إضافية عبر الواجهات/المسارات المتاحة
4. **توزيع البيانات**: **مجدول** يقوم بتقسيم دفق البايتات الخاص بالتطبيق عبر subflows متعددة
5. **إعادة التجميع**: يستخدم المستقبل أرقام تسلسل على مستوى الاتصال لإعادة ترتيب البيانات من عدة subflows إلى التسلسل الأصلي

```
TCP التقليدي: بيانات التطبيق → دفق TCP مفرد → مسار واحد
MPTCP: بيانات التطبيق → مجدول → عدة subflows لـ TCP → مسارات متعددة → إعادة تجميع
```

يمكنك تصور هذا على Linux باستخدام `ss -M`، والذي يُظهر subflows مجمعة تحت اتصال MPTCP واحد.

## **3. الآليات الرئيسية للأداء**

### **تجميع النطاق الترددي**
يمكن لـ MPTCP دمج النطاق الترددي من جميع المسارات المتاحة. يمكن تقسيم دفق 9 Mbps إلى ثلاثة subflows بقدرة 3 Mbps عبر واجهات مختلفة، مستخدمة بشكل فعال كل سعة الشبكة. هذا قوي بشكل خاص في مراكز البيانات حيث توجد روابط فيزيائية متعددة بين الخوادم.

### **جدولة ذكية**
يراقب المجدول باستمرار:
- زمن الوصول وازدحام المسار
- معدلات فقدان الحزم
- النطاق الترددي المتاح
- تكلفة/أولوية الرابط

يقوم بتعديل مقدار البيانات المرسلة عبر كل subflow ديناميكيًا، مما يمنع إثقال المسارات البطيئة بينما يستخدم بالكامل المسارات السريعة.

### **تحكم مشترك في الازدحام**
يستخدم MPTCP خوارزميات متخصصة (مثل LIA, OLIA, BALIA) التي:
- توازن الازدحام عبر المسارات
- تضمان الإنصاف مع تدفقات TCP العادية
- تمنع اتصال MPTCP مفرد من تجويت حركة المرور الأخرى
- تتفاعل بشكل مناسب عندما يصبح مسار ما مزدحمًا

## **4. الفوائد: المرونة والإنتاجية**

### **مرونة محسنة**
- **التبديل التلقائي عند الفشل**: إذا انقطع Wi-Fi، تحافظ subflows الخلوية على الاتصال دون انقطاع التطبيق
- **تكرار المسار**: فقدان الحزم على مسار واحد لا يكسر الاتصال—يتم إعادة توجيه حركة المرور إلى subflows السليمة
- **تدهور سلس**: تقلل أعطال المسار الجزئية من النطاق الترددي ولكن لا تسبب انقطاعات
- **وقت الاسترداد**: تظهر المحاكاة أن MPTCP يقلل التعطيلات من خلال تحويل حركة المرور بسرعة إلى مسارات بديلة

### **إنتاجية محسنة**
- **تجمع الموارد**: يستخدم جميع موارد الشبكة المتاحة في وقت واحد
- **تجنب الازدحام**: يتجاوز الاختناقات باستخدام مسارات بديلة أقل ازدحامًا
- **موازنة الحمل**: يوزع حركة المرور لمنع أي مسار مفرد من أن يصبح نقطة اختناق

### **تنقل سلس**
استخدمت Apple MPTCP منذ iOS 7 لـ Siri، مما يسمح لطلبات الصوت بالاستمرار دون انقطاع عند التنقل بين شبكات Wi-Fi والخلوية. يستمر الاتصال لأنه تتم إضافة وإزالة subflows ديناميكيًا مع تصبح الواجهات متاحة أو غير متاحة.

## **5. حالات الاستخدام في العالم الحقيقي**

- **الأجهزة المحمولة**: الهواتف الذكية تتبدل بسلاسة بين الشبكات
- **مراكز البيانات**: استغلال تنوع المسار للحصول على إنتاجية أعلى وتحمل أعطال
- **أنظمة IoT/M2M**: تعظيم استخدام الموارد في الأجهزة متعددة الواجهات
- **الشبكات الهجينة**: الجمع بين النطاق العريض الثابت والشبكات المحمولة لنقل الملفات بشكل أسرع
- **خدمات السحابة**: شبكات توصيل المحتوى والبيئات المؤسسية التي تتطلب توفرًا عاليًا

## **6. التنفيذ والاعتماد**

### **دعم نظام التشغيل**
- **Linux**: دعم كامل للنواة مع daemon `mptcpd` (RHEL 9+، التوزيعات الحديثة)
- **iOS**: مستخدم في Siri وتطبيقات مختارة منذ 2013
- **Android**: دعم جزئي في الإصدارات الحديثة
- **Windows**: دعم أصلي محدود

### **شفافية التطبيق**
عادة لا تتطلب التطبيقات **أي تغييرات**—حيث تتعامل مكدس شبكة نظام التشغيل مع MPTCP بشفافية. قد تكون هناك حاجة فقط لتعديلات طفيفة على خيارات المقبس للميزات المتقدمة.

### **حالة النشر**
لا يزال MPTCP في طور النضج. بينما تستخدمه Apple داخليًا، فإن معظم خدمات الإنترنت لا تدعمه بعد. يتطلب الاعتماد دعمًا من كل من العميل والخادم، على الرغم من أن التراجع إلى TCP العادي يكون تلقائيًا.

## **7. المقايضات والتحديات**

### **التعقيد**
- آلة حالات بروتوكول أكثر تعقيدًا
- دعم محدود للـ Middleboxes—قد تمنع بعض الجدران النارية/أجهزة NAT خيارات MPTCP
- يصبح استكشاف أخطاء الشبكة وإصلاحها أكثر صعوبة

### **الآثار الأمنية**
- **بقع عمى التفتيش**: تتعثر الجدران النارية وأنظمة IPS في إعادة تجميع التدفقات المنقسمة، مما يخلق فجوات أمنية
- **إخفاء نمط حركة المرور**: بينما يمكن لهذا تحسين الخصوصية، فإنه يعقد المراقبة الأمنية
- **منتجات Cisco**: العديد من ميزات التفتيش لا تدعم MPTCP، مما يتطلب تكوينًا دقيقًا

### **اعتبارات الأداء**
- **إعادة ترتيب الحزم**: اختلاف زمن الوصول للمسارات يمكن أن يسبب وصولاً خارج الترتيب، مما قد يضر بالأداء إذا لم تتم إدارته بشكل صحيح
- **انسداد رأس الخط**: يمكن لـ subflows البطيئة تأخير التسليم الكلي إذا لم يكن المجدول ذكيًا
- **متطلبات المخزن المؤقت**: الحاجة إلى المزيد من التخزين المؤقت عند المستقبل لإعادة ترتيب الحزم

### **الإنصاف**
يجب أن يوازن تحكم MPTCP المشترك في الازدحام بعناية بين عدوانية المسار المتعدد والإنصاف لتدفقات TCP أحادية المسار على الروابط المشتركة.

## **8. المقارنة مع التقنيات المماثلة**

- **ربط/تجميع الوصلات**: يعمل في الطبقة 2، يتطلب عادة نفس الوسط، ولا يساعد في اتصالات TCP المفردة
- **ECMP**: توجيه على مستوى طبقة الشبكة يقسم التدفقات، لكنه لا يمكنه تقسيم اتصال *مفرد*
- **SCTP**: بروتوكول نقل بديل مع تعدد العوائل لكنه ضعيف الاعتماد ومشاكل في اجتياز NAT

الميزة الرئيسية لـ MPTCP هي العمل ضمن نظام TCP الحالي مع توفير تعدد مسارات حقيقي على **مستوى الاتصال**.

---

**خلاصة القول**: يحول MPTCP نموذج TCP أحادي المسار الصارم إلى بنية مرنة وقوية وموجهة للأداء من خلال تجميع موارد الشبكة المتعددة بذكاء. بينما لا تزال هناك تحديات حول النضج والأمان، فإنه يمثل الحل الأكثر عملية للاستفادة من نقاط النهاية متعددة العوائل في الشبكات الحديثة.