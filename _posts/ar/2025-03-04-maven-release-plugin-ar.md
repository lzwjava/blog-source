---
audio: false
generated: true
lang: ar
layout: post
title: إصدار مافن
translated: true
---

هنا دليل شامل حول كيفية استخدام **إضافة إصدار Maven** لإدارة وتوثيق عملية إصدار مشروعك Maven.

---

### ما هو إضافة إصدار Maven؟

**إضافة إصدار Maven** هي أداة تتيح لك التلقائي لإصدار مشروع Maven. وهي تتعامل مع المهام التالية:

- تحديث أرقام الإصدارات في ملفات POM للمشروع.
- تقديم التغييرات إلى نظام التحكم في الإصدار (VCS) مثل Git.
- إنشاء علامة للإصدار في VCS.
- بناء وإصدار الأجزاء.
- إعداد المشروع للدورة التطويرية القادمة من خلال تحديث أرقام الإصدارات مرة أخرى.

أهداف الإضافة الرئيسية هي:

- **`release:prepare`**: يهيئ المشروع للإصدار من خلال تحديث الإصدارات، تقديم التغييرات، وإضافة العلامة في VCS.
- **`release:perform`**: يبني ويصدر الإصدار باستخدام الكود المعلَّم في VCS.

---

### دليل خطوة بخطوة لاستخدام إضافة إصدار Maven

#### 1. إضافة إضافة إصدار Maven إلى ملف POM

لاستخدام الإضافة، يجب أن تضيفها إلى ملف `pom.xml` للمشروع. أضفها تحت القسم `<build><plugins>` كما يلي:

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-release-plugin</artifactId>
            <version>2.5.3</version> <!-- استخدم أحدث الإصدار المستقر -->
        </plugin>
    </plugins>
</build>
```

**ملاحظة**: تحقق من [صفحة إضافة إصدار Maven الرسمية](https://maven.apache.org/maven-release/maven-release-plugin/) للحصول على أحدث الإصدار واستبدل `2.5.3` حسب الحاجة.

#### 2. تهيئة القسم SCM (إدارة التحكم في المصدر)

تتعامل الإضافة مع VCS (مثل Git) لتقديم التغييرات وإضافة العلامات. يجب عليك تحديد تفاصيل VCS في القسم `<scm>` من ملف `pom.xml`. قد يبدو ذلك كالتالي لمستودع Git مستضيف على GitHub:

```xml
<scm>
    <connection>scm:git:git://github.com/username/project.git</connection>
    <developerConnection>scm:git:git@github.com:username/project.git</developerConnection>
    <url>https://github.com/username/project</url>
</scm>
```

- استبدل `username` و `project` باسم مستخدم GitHub واسم مستودعك.
- قم بتعديل URLs إذا كنت تستخدم خدمة استضافة Git أخرى (مثل GitLab، Bitbucket).
- تأكد من أن لديك الإذنات اللازمة (مثل مفاتيح SSH أو رمز وصول شخصي) مهيئة لإرسال التغييرات إلى المستودع.

#### 3. إعداد مشروعك للإصدار

قبل تشغيل أوامر الإصدار، تأكد من أن مشروعك جاهز:

- جميع الاختبارات ناجحة (`mvn test`).
- لا يوجد تغييرات غير مرسلة في مجلد العمل (استخدم `git status` للتحقق).
- أنت على الفرع الصحيح (مثل `master` أو `main`) للإصدار.

#### 4. تشغيل `release:prepare`

يهيئ `release:prepare` مشروعك للإصدار. قم بتشغيل الأمر التالي في محرر الأوامر:

```bash
mvn release:prepare
```

**ما يحدث أثناء `release:prepare`**:

- **تحقق من التغييرات غير المرسلة**: يضمن أن مجلد العمل نظيف.
- **يطلب الإصدارات**: يسأل عن إصدار الإصدار و الإصدار التطويري التالي.
  - مثال: إذا كان الإصدار الحالي `1.0-SNAPSHOT`، قد يقترح `1.0` للإصدار و `1.1-SNAPSHOT` للإصدار التطويري التالي. يمكنك قبول القيم الافتراضية أو إدخال إصدارات مخصصة (مثل `1.0.1` لإصدار إصلاح).
- **تحديث ملفات POM**: يغير الإصدار إلى الإصدار (مثل `1.0`), يقدم التغيير، ويضيف علامة في VCS (مثل `project-1.0`).
- **تهيئة للدورة القادمة**: يغير POM إلى الإصدار التطويري التالي (مثل `1.1-SNAPSHOT`) ويقدم التغيير.

**جرب تجريبي اختياري**: لتجربة العملية دون إجراء تغييرات، استخدم:

```bash
mvn release:prepare -DdryRun=true
```

يستنبط هذا الخطوات التهيئة دون تقديم أو إضافة علامات.

#### 5. تشغيل `release:perform`

بعد إعداد الإصدار، قم ببناء وإصداره باستخدام:

```bash
mvn release:perform
```

**ما يحدث أثناء `release:perform`**:

- يحدد الإصدار المعلَّم من VCS.
- يبني المشروع.
- يصدر الأجزاء إلى المستودع المحدد في قسم `<distributionManagement>` من POM.

**تهيئة `<distributionManagement>`** (إذا كنت تصدر إلى مستودع عن بُعد):

```xml
<distributionManagement>
    <repository>
        <id>releases</id>
        <url>http://my-repository-manager/releases</url>
    </repository>
    <snapshotRepository>
        <id>snapshots</id>
        <url>http://my-repository-manager/snapshots</url>
    </snapshotRepository>
</distributionManagement>
```

- استبدل URLs بعنوان مستودع مدير المستودعات الخاص بك (مثل Nexus، Artifactory).
- تأكد من أن الإذنات مهيئة في ملف `~/.m2/settings.xml` تحت `<servers>` مع `id`s متطابقة.

#### 6. التحقق من الإصدار

بعد `release:perform`، تحقق من الإصدار:

- تحقق من مدير المستودع لضمان أن الأجزاء (مثل JARs، المصادر) مصدرة.
- اختبر الإصدار المصدور في مشروع آخر من خلال إضافته كاعتماد في ملف POM.

---

### تهيئة إضافية ونصائح

#### معالجة الفشل

- **تنظيف**: إذا فشل عملية الإصدار، استخدم:
  ```bash
  mvn release:clean
  ```
  لإزالة الملفات المؤقتة التي أنشأتها الإضافة.
- **التراجع**: لإلغاء التغييرات التي قام بها `release:prepare`:
  ```bash
  mvn release:rollback
  ```
  كن حذرًا وتأكد من التغييرات التي يتم إرجاعها.

#### مشاريع متعددة الأجزاء

للمشاريع متعددة الأجزاء، تحديث الإضافة إصدارات عبر جميع الأجزاء بشكل متزامن بشكل افتراضي. تأكد من أن POM الأب يحتوي على الإضافة وتهيئة SCM.

#### وضع التسلسلية للتصنيع

لإجراء الإصدار بشكل غير تفاعلي (مثل في خط تصنيع CI/CD)، استخدم علم `-B` وحدد الإصدارات:

```bash
mvn release:prepare -B -DreleaseVersion=1.0 -DdevelopmentVersion=1.1-SNAPSHOT
mvn release:perform -B
```

#### المشكلات الشائعة وحلولها

- **أخطاء VCS**: تأكد من أن أوامر Git (مثل `git commit`، `git push`) تعمل يدويًا. تحقق من المصادقة (مفاتيح SSH، رموز الوصول).
- **فشل البناء**: تأكد من أن البناء ينجح محليًا (`mvn clean install`) و أن الاعتماديات تتحلل بشكل صحيح.
- **استراتيجية الإصدار**: قم بتخصيص الإصدارات أثناء التقديمات أو عبر الخصائص إذا لم تكن القيم الافتراضية تناسب احتياجاتك.

---

### ملخص الأوامر

1. **تهيئة الإصدار**:
   ```bash
   mvn release:prepare
   ```
2. **إجراء الإصدار**:
   ```bash
   mvn release:perform
   ```
3. **جرب تجريبي اختياري**:
   ```bash
   mvn release:prepare -DdryRun=true
   ```
4. **تنظيف أو التراجع إذا لزم الأمر**:
   ```bash
   mvn release:clean
   mvn release:rollback
   ```

---

### الخاتمة

تسهل إضافة إصدار Maven عملية الإصدار من خلال التلقائي لإدارة الإصدارات، تعاملات VCS، والإصدار. من خلال إضافة الإضافة إلى POM، تهيئة SCM، وتتبع الخطوات `release:prepare` و `release:perform`، يمكنك إصدار مشاريع Maven بشكل فعال. دائمًا اختبر تهيئةك مع جرب تجريبي وتحقق من النتائج لضمان عملية إصدار ناعمة.