---
audio: false
generated: true
lang: ar
layout: post
title: مكتبة جافا سكريبت لتشغيل إتش إل إس
translated: true
type: note
---

يبدو أنك تسأل عن كيفية استخدام مكتبة `hls.js`، الإصدار `^0.7.6` على وجه التحديد، وهي مكتبة جافا سكريبت لتشغيل تدفقات الفيديو HLS (HTTP Live Streaming) في المتصفحات. سأقدم دليلاً موجزًا حول كيفية إعدادها واستخدامها بناءً على المعرفة العامة بالمكتبة. لاحظ أن الإصدار `0.7.6` قديم جدًا (تم إصداره حوالي عام 2017)، لذا قد تختلف بعض الميزات أو واجهات البرمجة عن الإصدارات الأحدث. إذا كنت بحاجة إلى تفاصيل مرتبطة بهذا الإصدار المحدد، فأعلمني وسأقوم بتعديل الإجابة بشكل أكبر!

### خطوات استخدام `hls.js` (الإصدار 0.7.6)

#### 1. **تثبيت أو تضمين المكتبة**
يمكنك تضمين `hls.js` في مشروعك بإحدى الطريقتين التاليتين:

- **عن طريق npm** (إذا كنت تستخدم أداة بناء مثل Webpack):
  ```bash
  npm install hls.js@^0.7.6
  ```
  ثم قم باستيرادها في ملف الجافا سكريبت الخاص بك:
  ```javascript
  var Hls = require('hls.js');
  ```

- **عن طريق CDN** (إذا كنت تضيفها مباشرة إلى ملف HTML):
  ```html
  <script src="https://cdn.jsdelivr.net/npm/hls.js@0.7.6"></script>
  ```
  هذا يجعل `Hls` متاحًا كمتغير عام.

#### 2. **إعداد HTML الخاص بك**
أنت بحاجة إلى عنصر `<video>` في الـ HTML الخاص بك لربط دفق HLS به:
```html
<video id="video" controls></video>
```

#### 3. **تهيئة `hls.js`**
إليك مثالاً أساسيًا لكيفية استخدام `hls.js` لتحميل وتشغيل دفق HLS (مثل ملف `.m3u8`):

```javascript
// تحقق مما إذا كان المتصفح يدعم HLS أصليًا (مثل Safari)
// إذا لم يكن كذلك، استخدم hls.js
var video = document.getElementById('video');
var videoSrc = 'https://example.com/playlist.m3u8'; // استبدل هذا بعنوان URL لـ HLS الخاص بك

if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource(videoSrc);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, function () {
        video.play();
    });
} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    // للمتصفحات التي تدعم HLS أصليًا (مثل Safari)
    video.src = videoSrc;
    video.addEventListener('loadedmetadata', function () {
        video.play();
    });
}
```

#### 4. **المفاهيم الأساسية**
- **`Hls.isSupported()`**: يتحقق مما إذا كان المتصفح بحاجة إلى `hls.js` (يُرجع `true` إذا كانت Media Source Extensions مدعومة).
- **`loadSource(url)`**: يحمل ملف البيان (manifest) لـ HLS (ملف `.m3u8`).
- **`attachMedia(video)`**: يربط عنصر الفيديو بنسخة `hls.js`.
- **`Hls.Events.MANIFEST_PARSED`**: حدث يتم تشغيله عند تحميل البيان، مما يشير إلى أن الدفق جاهز للتشغيل.

#### 5. **مثال مع معالجة الأخطاء**
لجعله أكثر متانة:
```javascript
var video = document.getElementById('video');
var videoSrc = 'https://example.com/playlist.m3u8';

if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource(videoSrc);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, function () {
        video.play();
    });
    hls.on(Hls.Events.ERROR, function (event, data) {
        console.error('خطأ HLS:', data);
        if (data.fatal) {
            switch (data.type) {
                case Hls.ErrorTypes.NETWORK_ERROR:
                    console.log('خطأ في الشبكة، جاري إعادة المحاولة...');
                    hls.startLoad();
                    break;
                case Hls.ErrorTypes.MEDIA_ERROR:
                    console.log('خطأ في الوسائط، جاري الاستعادة...');
                    hls.recoverMediaError();
                    break;
                default:
                    hls.destroy();
                    break;
            }
        }
    });
} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = videoSrc;
}
```

#### ملاحظات للإصدار `^0.7.6`
- هذا الإصدار من عام 2017، لذا يفتقر إلى الميزات الأحدث مثل تحسينات تبديل معدل البت التكيفي أو دعم HLS منخفض الكمون المضافة في الإصدارات اللاحقة.
- واجهة برمجة التطبيقات الأساسية (`loadSource`, `attachMedia`, الأحداث مثل `MANIFEST_PARSED`) يجب أن تعمل كما هو موضح أعلاه.
- راجع [الإصدارات الرسمية لمستودع `hls.js` على GitHub](https://github.com/video-dev/hls.js/releases/tag/v0.7.6) للحصول على سجل التغييرات الدقيق إذا كنت بحاجة إلى تفاصيل دقيقة.

#### 6. **الاختبار**
- استخدم دفق HLS متاحًا للعامة للاختبار، مثل:
  ```
  https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8
  ```
- افتح أدوات المطور في متصفحك (F12) لتصحيح أي مشكلات.

إذا كان لديك حالة استخدام محددة أو مشكلة (مثل الدمج مع إطار عمل، أو التعامل مع الترجمات، إلخ)، فأعلمني وسأقوم بتخصيص الرد بشكل أكبر!