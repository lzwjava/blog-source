---
audio: false
generated: true
lang: ar
layout: post
title: كتابية JavaScript لتشغيل HLS
translated: true
---

يبدو أنك تسأل عن كيفية استخدام مكتبة `hls.js`، بشكل خاص الإصدار `^0.7.6`، وهي مكتبة JavaScript لتشغيل تيارات الفيديو HLS (HTTP Live Streaming) في المتصفحات. سأقدم دليلًا مختصرًا حول كيفية إعدادها واستخدامها بناءً على المعرفة العامة بالمكتبة. يرجى ملاحظة أن الإصدار `0.7.6` قديم جدًا (صدر حوالي عام 2017)، لذا قد تختلف بعض الميزات أو واجهات برمجة التطبيقات عن الأحدث. إذا كنت تحتاج إلى تفاصيل مرتبطة بهذا الإصدار بالضبط، فإخبرني وسأقوم بتحسين الإجابة أكثر!

### خطوات لاستخدام `hls.js` (v0.7.6)

#### 1. **تثبيت أو تضمين المكتبة**
يمكنك تضمين `hls.js` في مشروعك بطرق مختلفة:

- **من خلال npm** (إذا كنت تستخدم أداة بناء مثل Webpack):
  ```bash
  npm install hls.js@^0.7.6
  ```
  ثم قم بإستيرادها في JavaScript:
  ```javascript
  var Hls = require('hls.js');
  ```

- **من خلال CDN** (إذا كنت تضيفها مباشرة إلى ملف HTML):
  ```html
  <script src="https://cdn.jsdelivr.net/npm/hls.js@0.7.6"></script>
  ```
  هذا يجعل `Hls` متاحًا كمتغير عالمي.

#### 2. **إعداد HTML**
أنت بحاجة إلى عنصر `<video>` في HTML لتعلق تيار HLS إليه:
```html
<video id="video" controls></video>
```

#### 3. **تهيئة `hls.js`**
هنا مثال أساسي عن كيفية استخدام `hls.js` لتحميل وتشغيل تيار HLS (مثل ملف `.m3u8`):

```javascript
// تحقق من أن المتصفح يدعم HLS بشكل طبيعي (مثل Safari)
// إذا لم يكن كذلك، استخدم hls.js
var video = document.getElementById('video');
var videoSrc = 'https://example.com/playlist.m3u8'; // استبدل بURL HLS الخاص بك

if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource(videoSrc);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, function () {
        video.play();
    });
} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    // للمتصفحات التي تدعم HLS بشكل طبيعي (مثل Safari)
    video.src = videoSrc;
    video.addEventListener('loadedmetadata', function () {
        video.play();
    });
}
```

#### 4. **مفاهيم رئيسية**
- **`Hls.isSupported()`**: تحقق من أن المتصفح يحتاج إلى `hls.js` (يرجع `true` إذا كانت Media Source Extensions مدعومة).
- **`loadSource(url)`**: تحميل الملف HLS (`.m3u8`).
- **`attachMedia(video)`**: ربط عنصر الفيديو بمثال `hls.js`.
- **`Hls.Events.MANIFEST_PARSED`**: حدث ينطلق عندما يتم تحميل الملف، مما يشير إلى أن التيار جاهز للتشغيل.

#### 5. **مثال مع معالجة الأخطاء**
لجعله أكثر استقرارًا:
```javascript
var video = document.getElementById('video');
var videoSrc = 'https://example.com/playlist.m3u8';

if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource(videoSrc);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, function () {
        video.play();
    });
    hls.on(Hls.Events.ERROR, function (event, data) {
        console.error('HLS Error:', data);
        if (data.fatal) {
            switch (data.type) {
                case Hls.ErrorTypes.NETWORK_ERROR:
                    console.log('Network error, retrying...');
                    hls.startLoad();
                    break;
                case Hls.ErrorTypes.MEDIA_ERROR:
                    console.log('Media error, recovering...');
                    hls.recoverMediaError();
                    break;
                default:
                    hls.destroy();
                    break;
            }
        }
    });
} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = videoSrc;
}
```

#### ملاحظات حول الإصدار `^0.7.6`
- هذا الإصدار من عام 2017، لذا فهو يفتقر إلى ميزات جديدة مثل تحسينات تبديل معدل البتات المتكيف أو دعم HLS منخفض اللاتنسي الذي أضيف في الأحدث.
- يجب أن تعمل واجهات برمجة التطبيقات الأساسية (`loadSource`, `attachMedia`, الأحداث مثل `MANIFEST_PARSED`) كما هو موضح أعلاه.
- تحقق من [إصدارات `hls.js` الرسمية على GitHub](https://github.com/video-dev/hls.js/releases/tag/v0.7.6) للحصول على سجل التغييرات الدقيق إذا كنت تحتاج إلى تفاصيل دقيقة.

#### 6. **الاختبار**
- استخدم تيار HLS متاح علنًا للاختبار، مثل:
  ```
  https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8
  ```
- افتح أدوات التطوير في المتصفح الخاص بك (F12) لتشخيص أي مشاكل.

إذا كان لديك حالة استخدام أو مشكلة محددة (مثل التكامل مع إطار عمل، معالجة النص الفرعي، إلخ)، فإخبرني وسأقوم بتخصيص الإجابة أكثر!