---
audio: false
generated: true
lang: ar
layout: post
title: خادم العرض X11 الافتراضي Xvfb
translated: true
type: note
---

### ما هو Xvfb؟

Xvfb (إطار المخزن المؤقت الظاهري X) هو خادم عرض X11 يشغل التطبيقات الرسومية دون الحاجة إلى شاشة فعلية أو تسريع رسومي للأجهزة. إنه في الأساس خادم X "بدون رأس" يحاكي شاشة في الذاكرة، مما يسمح للتطبيقات التي تتطلب بيئة رسومية (مثل المتصفحات، أو اختبارات واجهة المستخدم، أو أدوات التقديم) بالعمل على الخوادم أو في بيئات بدون شاشة أو لوحة مفاتيح أو فأرة.

يُستخدم عادةً في الاختبارات الآلية (مثل استخدام Selenium لاستخراج بيانات الويب أو اختبار واجهة المستخدم)، أو خطوط أنابيب CI/CD، أو أي سيناريو تحتاج فيه لتشغيل تطبيقات تعتمد على X11 في الخلفية دون عرض أي شيء على الشاشة.

### كيف يعمل Xvfb؟

1. **إنشاء شاشة افتراضية**:
   - عند بدء تشغيل Xvfb، فإنه ينشئ شاشة افتراضية (مثل `:99` أو رقم عرض آخر) موجودة بالكامل في ذاكرة الوصول العشوائي. تحتوي هذه الشاشة على دقة محددة، وعمق ألوان، ومعلمات أخرى تحددها عند التشغيل.
   - أمر مثال: `Xvfb :99 -screen 0 1024x768x24` (يبدأ شاشة افتراضية بدقة 1024x768 وبعمق لون 24 بت).

2. **معالجة العمليات الرسومية**:
   - يعترض Xvfb طلبات بروتوكول X11 من التطبيقات (مثل رسم النوافذ، أو تقديم الصور، أو معالجة الأحداث).
   - بدلاً من إرسال الإخراج إلى شاشة فعلية، ينفذ جميع العمليات في مخزن مؤقت في الذاكرة ("إطار المخزن المؤقت"). يعمل هذا المخزن المؤقت كشاشة افتراضية حيث يتم كتابة البكسل ولكن لا يتم عرضها مطلقًا.
   - يدعم ميزات X11 الأساسية لكنه يفتقر إلى التسريع المادي، لذا فهو غير مناسب للرسوميات عالية الأداء مثل الألعاب—إنه مخصص أكثر للتقديم البسيط أو الاختبار.

3. **محاكاة الأحداث**:
   - يمكن لـ Xvfb محاكاة أحداث الإدخال (مثل الفأرة/لوحة المفاتيح) إذا لزم الأمر، ولكن عادةً، تعمل التطبيقات كما لو كانت على شاشة حقيقية.
   - الإخراج غير مرئي، ولكن يمكنك التقاط لقطات شاشة أو تفريغ إطار المخزن المؤقت إلى ملفات (باستخدام أدوات مثل `xwd` أو `import` من ImageMagick) للتحقق.

4. **التكامل مع الأدوات**:
   - تقوم مكتبات مثل pyvirtualdisplay (كما في تتبع الخطأ الخاص بك) بتغليف Xvfb لتسهيل البدء/التوقف من الكود. على سبيل المثال، في Python:
     ```python
     from pyvirtualdisplay import Display
     display = Display(visible=0, size=(1024, 768))
     display.start()
     # شغل تطبيقك الرسومي هنا
     display.stop()
     ```
   - يعمل في الخلفية، ويقوم تطبيقك بتعيين متغير البيئة `DISPLAY` (مثل `export DISPLAY=:99`) للإشارة إلى الخادم الافتراضي.

5. **القيود**:
   - لا يوجد تفاعل مادي حقيقي، لذا لا يوجد دعم لبطاقة الرسوميات أو إخراج فيديو مباشر.
   - يمكن أن يزداد استخدام الذاكرة مع الدقات الأكبر أو الجلسات طويلة الأمد.
   - إنه جزء من مشروع X.org ومتاح على أنظمة Linux/Unix؛ وليس أصليًا في macOS أو Windows (على الرغم من وجود بدائل مثل Xming لنظام Windows).

بخصوص الخطأ الذي لصقته: يبدو أن Xvfb غير مثبت على نظامك (خطأ `FileNotFoundError` لـ 'Xvfb'). على نظام macOS (استنادًا إلى مسارات Homebrew الخاصة بك)، يمكنك تثبيته عبر `brew install --cask xvfb` أو ما شابه، ولكن تأكد من وجوده في المسار PATH الخاص بك. تعتمد pyvirtualdisplay على توافره كملف قابل للتنفيذ.

[صفحة الدليل لـ Xvfb](https://www.x.org/releases/X11R7.7/doc/man/man1/Xvfb.1.xhtml)  
[ويكيبيديا: Xvfb](https://en.wikipedia.org/wiki/Xvfb)  
[كيفية استخدام Xvfb للاختبار بدون رأس](https://www.browserstack.com/guide/what-is-xvfb)