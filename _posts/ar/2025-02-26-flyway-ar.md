---
audio: false
generated: true
lang: ar
layout: post
title: ترحيل قواعد البيانات باستخدام Flyway في Spring Boot
translated: true
type: note
---

إليك دليلًا موجزًا وعمليًا حول كيفية استخدام Flyway مع تطبيق Spring Boot لإدارة مخطط قاعدة البيانات الخاصة بك:

---

### ما هو Flyway؟
Flyway هو أداة لترحيل قواعد البيانات تساعدك في التحكم بالإصدارات لمخطط قاعدة البيانات. تقوم بتطبيق نصوص SQL (ترحيل) بترتيب معين لتطوير قاعدة البيانات، مما يجعلها مثالية لمشاريع Spring Boot حيث يكون الاتساق والأتمتة أمرًا أساسيًا.

---

### الخطوة 1: إضافة تبعية Flyway
للبدء، أضف Flyway إلى مشروعك. إذا كنت تستخدم **Maven**، فقم بتحديث ملف `pom.xml` الخاص بك:

```xml
<dependency>
    <groupId>org.flywaydb</groupId>
    <artifactId>flyway-core</artifactId>
</dependency>
```

أما إذا كنت تستخدم **Gradle**، فأضف هذا إلى ملف `build.gradle` الخاص بك:

```groovy
implementation 'org.flywaydb:flyway-core'
```

هذا سيسحب Flyway إلى تطبيق Spring Boot الخاص بك.

---

### الخطوة 2: تكوين اتصال قاعدة البيانات
يحتاج Flyway إلى معرفة قاعدة البيانات التي يجب إدارتها. قم بتعريف اتصال قاعدة البيانات في `application.properties` (أو `application.yml`). على سبيل المثال، مع PostgreSQL:

```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/mydb
spring.datasource.username=myuser
spring.datasource.password=mypassword
```

يقوم Spring Boot تلقائيًا بتكوين Flyway لاستخدام مصدر البيانات هذا، لذا لا حاجة لإعداد إضافي هنا.

---

### الخطوة 3: إنشاء نصوص الترحيل
يستخدم Flyway نصوص SQL مرقمة بالإصدارات لتحديث قاعدة البيانات. ضع هذه النصوص في المجلد الافتراضي: `src/main/resources/db/migration`. يجب أن يتبع كل نص نمط التسمية هذا: `V<رقم_الإصدار>__<وصف>.sql`. يضمن رقم الإصدار تشغيل عمليات الترحيل بالترتيب.

على سبيل المثال، أنشئ ملفًا باسم `V1__create_users_table.sql`:

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL
);
```

احفظه في `src/main/resources/db/migration`.

---

### الخطوة 4: تشغيل تطبيقك
ابدأ تشغيل تطبيق Spring Boot الخاص بك (على سبيل المثال، عبر `mvn spring-boot:run` أو من خلال بيئة التطوير المتكاملة). سيقوم Flyway بما يلي:
- التحقق من قاعدة البيانات للبحث عن سجل الترحيل.
- تطبيق أي ترحيل معلق (مثل `V1__create_users_table.sql`) بالتسلسل.

يحدث هذا تلقائيًا عند بدء التشغيل بفضل تكامل Spring Boot — لا حاجة لأي تدخل يدوي.

---

### الخطوة 5: تخصيص Flyway (اختياري)
يمكنك ضبط سلوك Flyway باستخدام الخصائص في `application.properties`. إليك بعض الخيارات الشائعة:

```properties
spring.flyway.locations=classpath:db/migration  # مكان العثور على النصوص
spring.flyway.baseline-on-migrate=true          # التعامل مع قواعد البيانات الموجودة
spring.flyway.enabled=true                      # تشغيل/إيقاف Flyway
```

هذه الخصائص تتيح لك تخصيص Flyway ليناسب احتياجات مشروعك.

---

### ميزات متقدمة
يقدم Flyway أكثر من مجرد عمليات ترحيل أساسية:
- **عمليات الترحيل القائمة على Java**: اكتب عمليات ترحيل بلغة Java للمنطق المعقد.
- **عمليات الترحيل القابلة للتكرار**: استخدم `R__<وصف>.sql` للنصوص التي تعاد عند تغييرها (مثل العروض Views).
- **عمليات ترحيل التراجع**: تراجع عن التغييرات (يتطلب Flyway Pro).

راجع [توثيق Flyway](https://flywaydb.org/documentation/) للاستكشاف المتعمق.

---

### الملخص
لاستخدام Flyway في Spring Boot:
1. أضف تبعية Flyway إلى مشروعك.
2. قم بإعداد اتصال قاعدة البيانات في `application.properties`.
3. اكتب نصوص SQL مرقمة بالإصدارات في `src/main/resources/db/migration`.
4. شغل تطبيقك — سيطبق Flyway عمليات الترحيل تلقائيًا.

يبسط Flyway إدارة مخطط قاعدة البيانات مع التحكم بالإصدارات والأتمتة، مكملًا بشكل مثالي تجربة التطوير المبسطة لـ Spring Boot.