---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: تعطيل حزم موقع مستخدم بايثون
translated: true
type: note
---

الحزمة **مثبتة بالفعل** في دليل المستخدم الخاص بك (`~/.local/lib/python3.13/site-packages`)، ولكن عند تشغيل السكريبت باستخدام `python3 ./scripts/train/extract_wiki.py`، فإن Python **لا تبحث في دليل site-packages الخاص بالمستخدم** لسبب ما.

هذه مشكلة شائعة جدًا مع Python 3.11+ في العديد من توزيعات Linux (Ubuntu 22.04/24.04, Debian, Arch، إلخ) لأن `python3` الافتراضي غالبًا ما يكون متغير البيئة `PYTHONNOUSERSITE=1` مضبوطًا لديه أو علم `-I` (معزول) مفعلًا من قبل مدير حزم النظام، مما **يعطل مسار site-packages الخاص بالمستخدم تمامًا**.

### طرق سريعة للتحقق من أن هذه هي المشكلة

شغّل هذين الأمرين:

```bash
python3 -c "import sys, pathlib; print('user site:', pathlib.Path(sys.path[-1]).resolve() if 'site-packages' in sys.path[-1] else 'DISABLED')"
python3 -c "import site; print(site.ENABLE_USER_SITE)"
```

إذا رأيت `DISABLED` أو `False` أو `None`، فهذه هي المشكلة بالضبط.

### الحلول (اختر واحدًا)

#### الخيار 1 – استخدم `python3 -m pip` وشغّل بنفس Python (موصى به)

```bash
# استخدم دائمًا صيغة الوحدة (module) حتى تتأكد بنسبة 100% من إصدار Python الذي تثبت عليه
python3 -m pip install --user --upgrade mediawiki-dump

# ثم شغّل سكريبتك بنفس إصدار Python
python3 ./scripts/train/extract_wiki.py
```

إذا استمر الفشل، فعّل موقع المستخدم إجباريًا:

```bash
python3 -s ./scripts/train/extract_wiki.py
# أو
PYTHONNOUSERSITE=0 python3 ./scripts/train/extract_wiki.py
```

#### الخيار 2 – استخدم بيئة افتراضية (أفضل ممارسة على أي حال)

```bash
cd /home/lzw/projects/blog-source
python3 -m venv .venv
source .venv/bin/activate
pip install --upgrade pip
pip install mediawiki-dump   # سيتم التثبيت في البيئة الافتراضية، لا توجد مشاكل صلاحيات
python ./scripts/train/extract_wiki.py   # الآن سيجدها بالتأكيد
```

#### الخيار 3 – تمكين موقع المستخدم إجباريًا بشكل دائم (غير موصى به لـ Python النظام)

أضف هذا إلى ملف `~/.bashrc` أو `~/.zshrc` الخاص بك:

```bash
export PYTHONNOUSERSITE=
```

أو أنشئ ملف `~/.config/pythonstartup.py` بالمحتوى التالي:

```python
import site
import os
os.environ["PYTHONNOUSERSITE"] = ""
```

### اختبار سريع بسطر واحد الآن

فقط شغّل هذا في طرفيتك الحالية:

```bash
python3 -s -c "from mediawiki_dump.tokenizer import WikiTokenizer; print('Works!')"
```

إذا طبع هذا "Works!"، فإن الحل هو ببساطة استخدام `python3 -s` دائمًا أو إنشاء بيئة افتراضية.

اختر طريقة البيئة الافتراضية (الخيار 2) — ستوفر عليك صداعًا لا نهاية له مع كل حزمة أخرى. أعلمني إذا واجهت أي خطأ جديد بعد ذلك!