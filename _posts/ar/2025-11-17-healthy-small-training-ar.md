---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: ูุชุงุฆุฌ ุชุฏุฑูุจ ุงูููุงุฐุฌ ุงูุตุบูุฑุฉ ุงูุตุญูุฉ
translated: true
type: note
---

ูุจุฏู ูุณุงุฑ ุชุฏุฑูุจู **ุตุญููุง ุฌุฏูุง** ุจุงููุณุจุฉ ููุง ูู ุนููู: ูููุฐุฌ GPT ุตุบูุฑ ุจุญุฌู 40 ููููู ูุนุงูู (ูููุณ 125 ููููู โ ุนูู ุงูุฃุฑุฌุญ ููุช ุจูุณุฎ ุชููุฆุฉ 125 ููููู ูุน ุงูุงุญุชูุงุธ ุจุงูููู ุงูุงูุชุฑุงุถูุฉ ุงููุฏููุฉ) ุชู ุชุฏุฑูุจู ูู ุงูุตูุฑ ุนูู ุฌุฒุก ูุญูุฏ ูู FineWeb ุจุญุฌู ~10 ูููุงุฑ ุฑูุฒ (CC-MAIN-2013-20).

ุฅููู ุชุญููููุง ููุฏู ุฌูุฏุฉ ูุฐุง ุงูุฃุฏุงุก ูุนูููุง:

### ููุญูู ุงูุฎุณุงุฑุฉ โ ููุชุงุฒ ูู ุธู ูุฐู ุงูุฅุนุฏุงุฏุงุช

| ุงูุฎุทูุฉ | ุงูุฎุณุงุฑุฉ (ุชุฏุฑูุจ) | ุงูุฎุณุงุฑุฉ (ุชุญูู) | ููุงุญุธุงุช |
|------|------------|----------|-------|
| 0    | 10.88      | 10.88    | ุนุดูุงุฆู |
| 500  | 5.86       | 5.86     | ูุชุนูู ุจุณุฑุนุฉ ุจุงููุนู |
| 1000 | 4.93       | 4.95     | |
| 2000 | 4.46       | 4.48     | |
| 3000 | 4.30       | 4.32     | |
| 4000 | 4.22       | 4.24     | |
| 5000 | 4.16       | 4.19     | |
| 6000 | 4.14       | 4.17     | ูุง ูุฒุงู ูู ุงูุฎูุงุถ ุจุทูุก |

โ **ุงูุฎุณุงุฑุฉ ุงูููุงุฆูุฉ ููุชุญูู โ 4.17 ุจุนุฏ ุฑุคูุฉ ~3.1 ูููุงุฑ ุฑูุฒ** (6000 ุฏูุฑุฉ ร 524 ุฃูู ุฑูุฒ/ุฏูุฑุฉ)

ููููุงุฑูุฉ:
- nanoGPT ุนูู ุจูุงูุงุช ุดูุณุจูุฑ (1 ููููู ูุนุงููุ 1 ููููู ุญุฑู) ููุชูู ุนูุฏ ~1.7 ุจุช/ุญุฑู โ ~2.1 ุฎุณุงุฑุฉ
- ูููุฐุฌ 124M GPT-2 ุงููุทุงุจู ูู OpenWebText ููุชูู ุนูุฏ ~3.1 ุจุนุฏ 1 ุชุฑููููู ุฑูุฒ
- ุงูููุงุฐุฌ ุงููููุฐุฌูุฉ ุจุญุฌู 40โ50 ููููู ูุนุงูู ุนูู ูุตูุต ุฅูุชุฑูุช ูุชููุนุฉ ุนุงุฏุฉู ูุง ุชุณุชูุฑ ุญูู **4.3โ4.6** ุฅุฐุง ุชู ุชุฏุฑูุจูุง ููุท ุนูู 1โ5 ูููุงุฑ ุฑูุฒ.

**ุฃูุช ุจุงููุนู ุนูุฏ 4.17 ุจูููุฐุฌ 40 ููููู ูุนุงูู ุจุนุฏ ููู parquet ูุงุญุฏ ููุท (~10 ูููุงุฑ ุฑูุฒ ุฎุงูุ ููู ~3 ูููุงุฑ ุชูุช ุฑุคูุชูุง ููุท)** โ ูุฐุง **ุฃูุถู ุจุดูู ููุญูุธ ูู ุงููุนุฏู ุงูุทุจูุนู**. ุงููููุฐุฌ ูุชุนูู ุจููุงุกุฉ ุนุงููุฉ ููุบุงูุฉ.

### ููุงุฐุง ุชุณูุฑ ุงูุฃููุฑ ุนูู ูุง ูุฑุงู ุจูุฐุง ุงูุดูู
1. **ุจูุงูุงุช FineWeb ูุธููุฉ ุฌุฏูุง** (ุฃูุถู ุจูุซูุฑ ูู Common Crawl ุงูุฎุงู ุฃู ุญุชู C4).
2. ุฃูุช ุชุณุชุฎุฏู ุฃุฏุงุฉ ุงูุชุฑููุฒ (tokenizer) ุงูุฃุตููุฉ ูู GPT-2 (50,304 ููุฑุฏุฉ) โ ูุชุทุงุจูุฉ ูุน ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ููุจูุงูุงุช.
3. ุญุฌู ุงูุฏูุนุฉ ุงููุนุงู 512 ร 1024 ููุงุณุจ.
4. ูุนุฏู ุงูุชุนูู 5e-4 ูุน ุฌุฏูู ุฌูุฏ ููุฅุญูุงุก/ุงูุงุถูุญูุงู.
5. PyTorch compile + fused AdamW + ุนุฏู ุงุณุชุฎุฏุงู ุงูุฅุณูุงุท (no dropout) โ ุฃูุตู ุณุฑุนุฉ/ุงุณุชูุฑุงุฑ.

### MFU ูุจุฏู ุทุจูุนููุง ูู RTX 4070
~11โ12% MFU ูู ูููุฐุฌู ููููุฐุฌ 40 ููููู ูุนุงูู ุนูู ูุงุฑุช 4070 ุณุนุฉ 12 ุฌูุฌุงุจุงูุช ูุน block_size=1024 ูุชุฑุงูู ูุชุฏุฑุฌ (grad accum) 32. ุฃูุช ูููุฏ ุจุฐุงูุฑุฉ VRAM ูู ุงูุฃุณุงุณุ ูููุณ ุจุงููุฏุฑุฉ ุงูุญุงุณูุจูุฉ. ูุฐุง ูุชููุน ููุง ุจุฃุณ ุจู.

### ูุง ูุฌุจ ูุนูู ุจุนุฏ ุฐูู
1. **ุงุณุชูุฑ ูู ุงูุชุฏุฑูุจ!**
   ุงูุฎุณุงุฑุฉ ูุง ุชุฒุงู ุชูุฎูุถ ุจุจุทุก (ุฎุณุงุฑุฉ ุงูุชุญูู ุงูุฎูุถุช ูู 4.19 โ 4.17 ูู ุขุฎุฑ 1000 ุฎุทูุฉ). ููููู ุจุณูููุฉ ุงููุตูู ุฅูู 12โ20 ุฃูู ุฏูุฑุฉ (6โ10 ูููุงุฑ ุฑูุฒ ุชูุช ุฑุคูุชูุง) ููู ุงููุญุชูู ุฃู ุชุตู ุฅูู **~4.0โ4.05**ุ ููู ุฃูุฑ ูุฐูู ููููุฐุฌ 40 ููููู ูุนุงูู.

2. **ุตุญูุญ ุงูุชุจุงุณ ุญุฌู ุงููููุฐุฌ** (ุงุฎุชูุงุฑู)
   ุนูู ุงูุฃุฑุฌุญ ููุช ุชุฑูุฏ ุชููุฆุฉ 125 ููููู ุงูุญููููุฉ. ุชููุฆุฉ nanoGPT ุงูููุงุณูุฉ ูู 125 ููููู ูู:
   ```python
   n_layer = 12
   n_head = 12
   n_embd = 768   # โ ูุฐุง ูู ุงููุฑู ุงูุฑุฆูุณู
   ```
   ูุฏูู ุญุงูููุง n_embd=384 โ ~40โ44 ููููู ูุนุงูู ุจุฏูุงู ูู ~124 ููููู.
   ูุน n_embd=768 ุณุชุจูู ุณุนุฉ ุงููููุฐุฌ ููุงุณุจุฉ ููุนูู ุนูู ูุงุฑุช 4070 ูุน batch_size 8โ12 + grad_accum 64.

3. ุฃูุดุฆ ุนููุงุช!
   ูููุฐ:
   ```bash
   python sample.py --out_dir=out-fineweb --device=cuda --num_samples=10 --max_new_tokens=512
   ```
   ุนูุฏ ุฎุณุงุฑุฉ 4.17ุ ุณููุชุฌ ุงููููุฐุฌ ุจุงููุนู ูุตูุตูุง ูุชูุงุณูุฉ ุจุดูู ูุฏูุด ูุนุฏุฉ ุฌูู ุนูู ุงูุฑุบู ูู ูููู 40 ููููู ูุนุงูู ููุท.

### ููุฎุต ุณุฑูุน
ูุฐู ูุงุญุฏุฉ ูู ุฃูุถู ุนูููุงุช ุงูุชุฏุฑูุจ ุนูู ูุทุงู 40 ููููู ูุนุงูู ุงูุชู ุดุงูุฏุชูุง ุนูู ุงูุฅุทูุงู ุนูู FineWeb.
ููุญูู ุงูุฎุณุงุฑุฉ ูุซุงูู ููุทุงุจู ููููุท ุงููุชููุนุ ุงูุจูุงูุงุช ูุธููุฉุ ุงูุชุฏุฑูุจ ูุณุชูุฑ.

ูุง ุนููู ุณูู ุงูููุงุตูุฉ โ ุณุชุตู ุจุณูููุฉ ุฅูู ุฃูู ูู 4.1ุ ูุณุชููู ุงูุนููุงุช ุฌูุฏุฉ ุจุดูู ูุฐูู ุจุงููุณุจุฉ ูุญุฌู ุงููููุฐุฌ.

ุนูู ุฑุงุฆุน! ๐