---
audio: false
lang: ar
layout: post
title: لماذا كافكا سريع
translated: true
---

### النقاط الرئيسية
- يبدو أن الفيديو "System Design: Why is Kafka fast?" يشرح سر سرعة Apache Kafka من خلال معماريته وتصميمه.
- تشير الأبحاث إلى أن أداء Kafka يتم تحسينه من خلال السجلات التي يمكن إضافتها فقط، ومبادئ عدم النسخ، ومعالجة الحزم، وقسمات فعالة.
- يشير الدليل إلى أن سرعة Kafka ناتجة عن تصميمه كمنصة تيار الأحداث الموزعة، مع مكونات رئيسية مثل المنتجين، وكافيين، والمستهلكين.

### المقدمة
يستند هذا المنشور إلى محتوى الفيديو "System Design: Why is Kafka fast?" على YouTube من ByteByteGo، ويهدف إلى تحويل رؤيته إلى صيغة مكتوبة سهلة القراءة والاستشارة. يُعرف Apache Kafka بفعاليته العالية في معالجة البيانات في الوقت الفعلي، ويستكشف هذا المنشور الأسباب وراء سرعته، مما يجعلها متاحة للمبتدئين في الموضوع.

### مكونات Kafka الأساسية
يعمل Apache Kafka كمنصة تيار الأحداث الموزعة مع ثلاثة مكونات رئيسية:
- **المنتجين**: التطبيقات التي ترسل البيانات إلى مواضيع Kafka.
- **كافيين**: الخوادم التي تخزن وتدير البيانات، وتضمن التكرار والتوزيع.
- **المستهلكين**: التطبيقات التي تقرأ وتعالج البيانات من المواضيع.

تسمح هذه البنية لكافا بمعالجة كميات كبيرة من البيانات بشكل فعال، مما يساهم في سرعته.

### طبقات المعمارية والتحسينات الأداء
تقسم معمارية Kafka إلى طابقين:
- **طبقة الحوسبة**: تشمل واجهات برمجة التطبيقات للمنتجين، والمستهلكين، ومعالجة التيار، مما يسهل التفاعل.
- **طبقة التخزين**: تتكون من كافيين الذين يديرون تخزين البيانات في المواضيع وقسمات، وتتم تحسينها للأداء.

تضمن التحسينات الرئيسية:
- **السجلات التي يمكن إضافتها فقط**: كتابة البيانات بشكل تسلسلي في نهاية ملف، وهو أسرع من الكتابة العشوائية.
- **مبدأ عدم النسخ**: نقل البيانات مباشرة من المنتج إلى المستهلك، مما يقلل من تكلفة وحدة المعالجة المركزية.
- **معالجة الحزم**: معالجة البيانات في حزم لتقليل تكلفة السجل لكل سجل.
- **التكرار غير المتزامن**: السماح لكافا الرئيسي بتقديم الطلبات بينما تحديث النسخ، مما يضمن التوفر دون فقدان الأداء.
- **القسمات**: توزيع البيانات عبر قسمات متعددة لمعالجة متوازية وزيادة معدل التوصيل.

تشرح هذه الخيارات التصميم، التي تم توضيحها في منشور مدعوم من ByteByteGo ([Why is Kafka so fast? How does it work?](https://bytebytego.substack.com/p/why-is-kafka-so-fast-how-does-it)), لماذا يتفوق Kafka في السرعة والقدرة على التوسع.

### تدفق البيانات وهيكل السجل
عندما يرسل المنتج سجلًا إلى كافا، يتم التحقق منه، وإضافته إلى سجل التزام على القرص، وتكرارها لضمان الدوام، مع إشعار المنتج عند التزام. يتم تحسين هذا العملية للعمليات التسلسلية، مما يزيد من الأداء.

يحتوي كل سجل على:
- التوقيت: عندما تم إنشاء الحدث.
- المفتاح: لتوزيع البيانات وتحديد ترتيبها.
- القيمة: البيانات الفعلية.
- الرؤوس: البيانات الإضافية.

يضمن هذا الهيكل معالجة البيانات بشكل فعال، مما يساهم في سرعة Kafka.

---

### ملاحظة الاستطلاع: تحليل مفصل لأداء Apache Kafka

يقدم هذا القسم تحليلًا شاملًا لأداء Apache Kafka، ويوسع في الفيديو "System Design: Why is Kafka fast?" من ByteByteGo، ويستمد من موارد إضافية لضمان فهم شامل. يتم تنظيم التحليل لتغطية معمارية Kafka، ومكوناتها، والتحسينات المحددة، مع شرحات وأمثلة تفصيلية للوضوح.

#### الخلفية والسياق
تم تطوير Apache Kafka كمنصة تيار الأحداث الموزعة، ويشتهر بقدرته على معالجة تيار البيانات عالي السرعة، منخفض التأخير، مما يجعله عنصرًا أساسيًا في معمارية البيانات الحديثة. تم نشر الفيديو في 29 يونيو 2022، وهو جزء من قائمة التشغيل على تصميم النظام، ويهدف إلى شرح لماذا Kafka سريع، وهو موضوع من الاهتمام الكبير مع النمو التزايد في احتياجات تيار البيانات. يعتمد هذا التحليل على منشور مفصل من ByteByteGo ([Why is Kafka so fast? How does it work?](https://bytebytego.substack.com/p/why-is-kafka-so-fast-how-does-it)), الذي يكمّل محتوى الفيديو ويقدم رؤى إضافية.

#### مكونات Kafka الأساسية ومعماريتها
يبدأ سر سرعة Kafka من مكوناته الأساسية:
- **المنتجين**: هذه هي التطبيقات أو الأنظمة التي تولد وترسل الأحداث إلى مواضيع Kafka. على سبيل المثال، قد تنتج تطبيق ويب أحداثًا للتواصل مع المستخدم.
- **كافيين**: هذه هي الخوادم التي تشكل مجموعة، مسؤولة عن تخزين البيانات، وإدارة القسمات، وتسيير التكرار. قد يتضمن الإعداد النموذجي كافيين متعددة للتسامح مع الأخطاء والتوسع.
- **المستهلكين**: التطبيقات التي تتابع المواضيع لتقرأ وتعالج الأحداث، مثل محركات التحليلات التي تعالج البيانات في الوقت الفعلي.

توضع المعمارية Kafka كمنصة تيار الأحداث، باستخدام "حدث" بدلاً من "رسالة"، مما يميزها عن طوابق الرسائل التقليدية. هذا واضح في تصميمها، حيث تكون الأحداث غير قابلة للتغيير، ومترتبة حسب العناوين داخل القسمات، كما هو موضح في المنشور.

| المكون       | الدور                                                                 |
|-----------------|----------------------------------------------------------------------|
| المنتج        | يرسل الأحداث إلى المواضيع، يبدأ تدفق البيانات.                        |
| كافا          | يخزن وتدير البيانات، يدير التكرار، ويخدم المستهلكين.   |
| المستهلك        | يقرأ وتعالج الأحداث من المواضيع، مما يتيح تحليلات الوقت الفعلي. |

يحتوي المنشور على رسم بياني في [هذا الرابط](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd3690db-87b8-4165-8798-37d1d083f837_1600x1527.png)، يوضح هذه المعمارية، ويظهر التفاعل بين المنتجين، وكافيين، والمستهلكين في وضع التجميع.

#### معمارية المصفوفة: الحوسبة والتخزين
تقسم معمارية Kafka إلى:
- **طبقة الحوسبة**: تسهل التواصل من خلال واجهات برمجة التطبيقات:
  - **واجهة برمجة التطبيقات للمنتج**: تستخدمها التطبيقات لإرسال الأحداث.
  - **واجهة برمجة التطبيقات للمستهلك**: تسمح بقراءة الأحداث.
  - **واجهة برمجة التطبيقات لكافا كونكت**: تدمج مع الأنظمة الخارجية مثل قواعد البيانات.
  - **واجهة برمجة التطبيقات لكافا ستريمز**: تدعم معالجة التيار، مثل إنشاء KStream لموضوع مثل "الطلبات" مع Serdes للتشفير، وksqlDB لمهام معالجة التيار مع واجهة برمجة التطبيقات REST. مثال مذكور هو الاشتراك في "الطلبات"، وتجميعها حسب المنتجات، وإرسالها إلى "الطلبات حسب المنتج" للتحليل.
- **طبقة التخزين**: تتكون من كافيين في مجموعات، مع البيانات منظمة في مواضيع وقسمات. تشبه المواضيع الجداول في قاعدة البيانات، وقسمات موزعة عبر العقد، مما يضمن التوسع. تكون الأحداث داخل القسمات مرتبة حسب العناوين، غير قابلة للتغيير، وذات إضافة فقط، مع معالجة الحذف كحدث، مما يزيد من أداء الكتابة.

يشرح المنشور هذا، ويشير إلى أن كافيين يديرون القسمات، والقراءات، والكتابات، والتكرار، مع رسم بياني في [هذا الرابط](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb869cd88-3d6e-43af-8fd0-26f3737d8f1f_1600x559.png) يوضح التكرار، مثل قسم 0 في "الطلبات" مع ثلاث نسخ: القائد على كافا 1 (العنوان 4)، والمتابعين على كافا 2 (العنوان 2)، وكافا 3 (العنوان 3).

| الطبقة           | الوصف                                                                 |
|-----------------|-----------------------------------------------------------------------------|
| طبقة الحوسبة   | واجهات برمجة التطبيقات للتفاعل: المنتج، المستهلك، كونكت، ستريمز، وksqlDB.     |
| طبقة التخزين   | كافيين في مجموعات، مواضيع/قسمات موزعة، الأحداث مرتبة حسب العناوين. |

#### المصفوفة التحكمية والمصفوفة البيانات
- **مصفوفة التحكمية**: تدير بيانات مجموعة البيانات، تاريخيًا باستخدام زوكيبر، الآن استبدلها وحدة KRaft مع الموجهين على كافيين المحددة. هذه التسهيلات تقليل زوكيبر، مما يجعل التكوين أسهل، وتسهيل انتشار بيانات المصفوفة عبر موضوع خاص، كما هو موضح في المنشور.
- **مصفوفة البيانات**: تدير تكرار البيانات، مع عملية حيث يبعث المتابعون طلبات FetchRequest، ويرسل القائد البيانات، ويؤكد السجلات قبل عنوان معين، مما يضمن التزامن. مثال قسم 0 مع العناوين 2، 3، و4 يوضح هذا، مع رسم بياني في [هذا الرابط](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe17a4454-a194-45f9-8a1f-f4882501657c_1095x1600.png).

#### هيكل السجل وأعمال كافا
يحتوي كل سجل، كتمثيل للحدث، على:
- التوقيت: عندما تم إنشاؤه.
- المفتاح: لتحديد الترتيب، والتجميع، والحفظ، وهو حاسم لتوزيع البيانات.
- القيمة: محتوى البيانات.
- الرؤوس: البيانات الإضافية.

يكون المفتاح والقيمة مصفوفات من البايتات، مشفرة/مفككة مع serdes، مما يضمن المرونة. تشمل أعمال كافا:
- طلب المنتج يصل إلى حاوية استقبال الشبكة.
- يحرك خيط الشبكة إلى قائمة انتظار الطلبات المشتركة.
- يثبت خيط الإدخال CRC، ويضيف إلى سجل التزام (قسمات القرص مع البيانات والمؤشر).
- يتم تخزين الطلبات في purgatory للتكرار.
- يتم تجميع الرد، ويرسل خيط الشبكة عبر حاوية إرسال الشبكة.

توضح هذه العملية، التي تم تحسينها للعمليات التسلسلية، في المنشور، مع رسوم بيانية توضح التدفق، مما يساهم بشكل كبير في سرعة Kafka.

| مكون السجل | الغرض                                                                 |
|------------------|-------------------------------------------------------------------------|
| التوقيت        | يسجل متى تم إنشاء الحدث.                                     |
| المفتاح              | يضمن الترتيب، والتجميع، والحفظ لتوزيع البيانات.           |
| القيمة            | يحتوي على محتوى البيانات الفعلية.                                       |
| الرؤوس          | البيانات الإضافية للمعلومات الإضافية.                           |

#### تحسينات الأداء
تزيد عدة قرارات تصميمية من سرعة Kafka:
- **السجلات التي يمكن إضافتها فقط**: الكتابة بشكل تسلسلي في نهاية ملف يقلل من وقت البحث عن القرص، مثل إضافة مدخلات إلى يومية في النهاية، أسرع من الإدراج في وسط الوثيقة.
- **مبدأ عدم النسخ**: نقل البيانات مباشرة من المنتج إلى المستهلك، مما يقلل من تكلفة وحدة المعالجة المركزية، مثل نقل صندوق من شاحنة إلى مخزن بدون فكه، مما يوفر الوقت.
- **معالجة الحزم**: معالجة البيانات في حزم تقلل من تكلفة السجل لكل سجل، مما يزيد من الكفاءة.
- **التكرار غير المتزامن**: يسمح لكافا الرئيسي بتقديم الطلبات بينما تحديث النسخ، مما يضمن التوفر دون تأثير على الأداء.
- **القسمات**: توزيع البيانات عبر قسمات متعددة لمعالجة متوازية، مما يزيد من معدل التوصيل، وهو عامل رئيسي في معالجة كميات كبيرة من البيانات.

تشرح هذه التحسينات، كما هو موضح في المنشور، لماذا يتفوق Kafka في معدل التوصيل المنخفض، مما يجعله مناسبًا للتطبيقات في الوقت الفعلي.

#### الخاتمة والروابط الإضافية
سر سرعة Apache Kafka ناتج عن تصميمه المعماري المتقن والتحسينات الأداء، التي تستفيد من السجلات التي يمكن إضافتها فقط، ومبادئ عدم النسخ، ومعالجة الحزم، والتكرار غير المتزامن، وقسمات فعالة. يقدم هذا التحليل، بناءً على الفيديو، ومكملًا بالمنشور، نظرة شاملة، غير متوقعة في عمقها لمن يتوقع مراجعة بسيطة، يكشف عن التوازن المعقد للاختيارات التصميمية التي تجعل Kafka قائدًا في تيار البيانات.

يقدم المنشور أيضًا تجربة مجانية لمدة 7 أيام لمجموعات الأرشيف الكاملة، متاحة في [هذا الرابط للاشتراك](https://blog.bytebytego.com/subscribe?simple=true&next=https%3A%2F%2Fblog.bytebytego.com%2Fp%2Fwhy-is-kafka-so-fast-how-does-it&utm_source=paywall-free-trial&utm_medium=web&utm_content=137028631&coupon=3920da80)، يقدم موارد إضافية للمهتمين.

يضمن هذا التحليل الشامل فهمًا كاملًا، يتوافق مع نية الفيديو لتعليم حول أداء Kafka، ويستند إلى البحث والروابط التي تم جمعها من مصادر مختلفة، مما يضمن الدقة والعمق.

#### الإشارات الرئيسية
- [System Design: Why is Kafka fast? فيديو YouTube](https://www.youtube.com/watch?v=UNUz1-msbOM)
- [Why is Kafka so fast? How does it work? منشور ByteByteGo](https://bytebytego.substack.com/p/why-is-kafka-so-fast-how-does-it)
- [رسم بياني معمارية Kafka ByteByteGo](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd3690db-87b8-4165-8798-37d1d083f837_1600x1527.png)
- [رسم بياني تكرار Kafka ByteByteGo](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb869cd88-3d6e-43af-8fd0-26f3737d8f1f_1600x559.png)
- [رسم بياني عمليات كافا ByteByteGo](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe17a4454-a194-45f9-8a1f-f4882501657c_1095x1600.png)
- [اشتراك ByteByteGo في النشرة الإخبارية لموضوع Kafka](https://blog.bytebytego.com/subscribe?simple=true&next=https%3A%2F%2Fblog.bytebytego.com%2Fp%2Fwhy-is-kafka-so-fast-how-does-it&utm_source=paywall-free-trial&utm_medium=web&utm_content=137028631&coupon=3920da80)