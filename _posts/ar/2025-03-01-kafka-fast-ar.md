---
audio: false
generated: true
lang: ar
layout: post
title: لماذا كافكا سريع
translated: true
type: note
---

### النقاط الرئيسية
- يبدو من المرجح أن مقطع الفيديو "System Design: Why is Kafka fast?" يشرح سرعة Apache Kafka من خلال هيكله المعماري وخيارات التصميم.
- تشير الأبحاث إلى أن أداء Kafka يُعزز بواسطة السجلات ذات الإلحاق فقط، ومبادئ zero-copy، والمعالجة الدفعية، والتقسيم الفعال.
- تميل الأدلة إلى أن سرعة Kafka تعود إلى تصميمه كمنصة موزعة لتدفق الأحداث، مع مكونات رئيسية مثل المنتجين، والوسطاء، والمستهلكين.

### المقدمة
تستند هذه المدونة إلى محتوى مقطع الفيديو على يوتيوب "System Design: Why is Kafka fast?" من ByteByteGo، بهدف تحويل رؤاه إلى تنسيق مكتوب لتسهيل القراءة والمرجعية. تشتهر Apache Kafka بأدائها العالي في معالجة البيانات في الوقت الفعلي، وتستكشف هذه المقالة الأسباب الكامنة وراء سرعتها، مما يجعلها في متناول المبتدئين في الموضوع.

### المكونات الأساسية لـ Kafka
تعمل Apache Kafka كمنصة موزعة لتدفق الأحداث مع ثلاثة مكونات رئيسية:
- **المنتجون**: التطبيقات التي ترسل البيانات إلى مواضيع Kafka.
- **الوسطاء**: الخوادم التي تخزن البيانات وتديرها، وتضمن التكرار والتوزيع.
- **المستهلكون**: التطبيقات التي تقرأ البيانات وتعالجها من المواضيع.

يسمح هذا الهيكل لـ Kafka بالتعامل مع أحجام كبيرة من البيانات بكفاءة، مما يساهم في سرعتها.

### الطبقات المعمارية وتحسينات الأداء
تنقسم بنية Kafka إلى طبقتين:
- **طبقة الحوسبة**: تتضمن واجهات برمجة التطبيقات للمنتجين والمستهلكين ومعالجة التدفق، مما يسهل التفاعل.
- **طبقة التخزين**: تشمل الوسطاء الذين يديرون تخزين البيانات في المواضيع والأقسام، والمحسّنة للأداء.

تشمل التحسينات الرئيسية:
- **السجلات ذات الإلحاق فقط**: كتابة البيانات بشكل تسلسلي في نهاية الملف، وهو أسرع من الكتابة العشوائية.
- **مبدأ Zero-Copy**: نقل البيانات مباشرة من المنتج إلى المستهلك، مما يقلل من عبء وحدة المعالجة المركزية.
- **المعالجة الدفعية**: معالجة البيانات على شكل دفعات لتقليل النفقات العامة لكل سجل.
- **التكرار غير المتزامن**: السماح للوسيط الرئيسي بتلبية الطلبات بينما تقوم النسخ المتماثلة بالتحديث، مما يضمن التوفر دون فقدان الأداء.
- **التقسيم**: توزيع البيانات عبر أقسام متعددة للمعالجة المتوازية وإنتاجية عالية.

هذه الخيارات التصميمية، الموضحة في منشور المدونة الداعم من ByteByteGo ([Why is Kafka so fast? How does it work?](https://bytebytego.substack.com/p/why-is-kafka-so-fast-how-does-it))، تشرح سبب تفوق Kafka في السرعة والقابلية للتوسع.

### تدفق البيانات وبنية السجل
عندما يرسل منتج سجلاً إلى وسيط، يتم التحقق من صحته، وإلحاقه بسجل commit log على القرص، وتكراره لضمان المتانة، مع إخطار المنتج عند الالتزام. تم تحسين هذه العملية للإدخال/الإخراج التسلسلي، مما يعزز الأداء.

يتضمن كل سجل:
- الطابع الزمني: وقت إنشاء الحدث.
- المفتاح: للتقسيم والترتيب.
- القيمة: البيانات الفعلية.
- الرؤوس: بيانات وصفية اختيارية.

هذه البنية، كما هو موضح في منشور المدونة، تضمن التعامل الفعال مع البيانات وتساهم في سرعة Kafka.

---

### ملاحظة استقصائية: تحليل مفصل لأداء Apache Kafka

يقدم هذا القسم استكشافًا شاملاً لأداء Apache Kafka، مع توسيع نطاق مقطع الفيديو "System Design: Why is Kafka fast?" من ByteByteGo، والاستعانة بموارد إضافية لضمان فهم شامل. تم هيكلة التحليل لتغطية بنية Kafka ومكوناته وتحسيناته المحددة، مع تفسيرات مفصلة وأمثلة للتوضيح.

#### الخلفية والسياق
تُعرف Apache Kafka، التي تم تطويرها كمنصة موزعة لتدفق الأحداث، بقدرتها على التعامل مع تدفق البيانات عالي الإنتاجية ومنخفض الكمون، مما يجعلها ركيزة أساسية في البنى التحتية الحديثة للبيانات. يهدف الفيديو، الذي نُشر في 29 يونيو 2022 وهو جزء من قائمة تشغيل حول تصميم النظام، إلى توضيح سبب سرعة Kafka، وهو موضوع يثير اهتمامًا كبيرًا نظرًا للنمو المتسارع في احتياجات تدفق البيانات. يستند التحليل هنا إلى منشور مدونة مفصل من ByteByteGo ([Why is Kafka so fast? How does it work?](https://bytebytego.substack.com/p/why-is-kafka-so-fast-how-does-it))، والذي يكمل محتوى الفيديو ويوفر رؤى إضافية.

#### المكونات الأساسية وبنية Kafka
تبدأ سرعة Kafka بمكوناته الأساسية:
- **المنتجون**: هذه هي التطبيقات أو الأنظمة التي تولد الأحداث وترسلها إلى مواضيع Kafka. على سبيل المثال، قد ينتج تطبيق ويب أحداثًا لتفاعلات المستخدم.
- **الوسطاء**: هذه هي الخوادم التي تشكل مجموعة، مسؤولة عن تخزين البيانات، وإدارة الأقسام، والتعامل مع التكرار. قد تتضمن الإعدادات النموذجية وسطاء متعددين لضمان تحمل الأخطاء والقابلية للتوسع.
- **المستهلكون**: التطبيقات التي تشترك في المواضيع لقراءة الأحداث ومعالجتها، مثل محركات التحليلات التي تعالج البيانات في الوقت الفعلي.

تضع البنية Kafka كمنصة لتدفق الأحداث، باستخدام مصطلح "حدث" بدلاً من "رسالة"، مما يميزها عن طابور الرسائل التقليدية. هذا واضح في تصميمها، حيث تكون الأحداث غير قابلة للتغيير ومرتبة حسب الإزاحات داخل الأقسام، كما هو مفصل في منشور المدونة.

| المكون       | الدور                                                                 |
|--------------|------------------------------------------------------------------------|
| المنتج       | يرسل الأحداث إلى المواضيع، مبتدئًا تدفق البيانات.                     |
| الوسيط       | يخزن البيانات ويديرها، ويتعامل مع التكرار، ويخدم المستهلكين.           |
| المستهلك     | يقرأ الأحداث ويعالجها من المواضيع، مما يمكن من التحليلات في الوقت الفعلي. |

يتضمن منشور المدونة رسمًا بيانيًا على [هذا الرابط](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd3690db-87b8-4165-8798-37d1d083f837_1600x1527.png) يوضح هذه البنية، والذي يُظهر التفاعل بين المنتجين والوسطاء والمستهلكين في وضع المجموعة.

#### البنية الطبقية: الحوسبة والتخزين
تنقسم بنية Kafka إلى:
- **طبقة الحوسبة**: تسهل الاتصال عبر واجهات برمجة التطبيقات:
  - **واجهة برمجة تطبيقات المنتج**: تُستخدم من قبل التطبيقات لإرسال الأحداث.
  - **واجهة برمجة تطبيقات المستهلك**: تمكن من قراءة الأحداث.
  - **واجهة برمجة تطبيقات Kafka Connect**: تدمج مع الأنظمة الخارجية مثل قواعد البيانات.
  - **واجهة برمجة تطبيقات Kafka Streams**: تدعم معالجة التدفق، مثل إنشاء KStream لموضوع مثل "orders" مع Serdes للتسلسل، و ksqlDB لوظائف معالجة التدفق مع واجهة برمجة تطبيقات REST. مثال مُقدم هو الاشتراك في "orders"، والتجميع حسب المنتجات، والإرسال إلى "ordersByProduct" لأغراض التحليل.
- **طبقة التخزين**: تتكون من وسطاء Kafka في مجموعات، مع تنظيم البيانات في مواضيع وأقسام. تشبه المواضيع جداول قواعد البيانات، وتوزع الأقسام عبر العقد، مما يضمن قابلية التوسع. تكون الأحداث داخل الأقسام مرتبة حسب الإزاحات، غير قابلة للتغيير، وقابلة للإلحاق فقط، مع معاملة الحذف كحدث، مما يعزز أداء الكتابة.

يفصل منشور المدونة هذا، مشيرًا إلى أن الوسطاء يديرون الأقسام، والقراءات، والكتابات، والتكرارات، مع رسم بياني على [هذا الرابط](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb869cd88-3d6e-43af-8fd0-26f3737d8f1f_1600x559.png) يوضح التكرار، مثل القسم 0 في "orders" بثلاث نسخ متماثلة: القائد على الوسيط 1 (الإزاحة 4)، والأتباع على الوسيط 2 (الإزاحة 2)، والوسيط 3 (الإزاحة 3).

| الطبقة           | الوصف                                                                 |
|------------------|-----------------------------------------------------------------------|
| طبقة الحوسبة   | واجهات برمجة التطبيقات للتفاعل: المنتج، المستهلك، Connect، Streams، و ksqlDB. |
| طبقة التخزين   | الوسطاء في مجموعات، مواضيع/أقسام موزعة، أحداث مرتبة حسب الإزاحات.        |

#### مستويي التحكم والبيانات
- **مستوى التحكم**: يدير بيانات وصفية للمجموعة، استخدم تاريخيًا Zookeeper، واستبدل الآن بوحدة KRaft مع وحدات تحكم على وسطاء مختارين. يبسط هذا الإجراء إلغاء Zookeeper، مما يجعل التكوين أسهل ونشر البيانات الوصفية أكثر كفاءة عبر موضوع خاص، كما هو مذكور في منشور المدونة.
- **مستوى البيانات**: يتعامل مع تكرار البيانات، مع عملية يقوم فيها الأتباع بإصدار FetchRequest، ويرسل القائد البيانات، ويلتزم بالسجلات قبل إزاحة معينة، مما يضمن الاتساق. يسلط مثال القسم 0 مع الإزاحات 2، 3، و4 الضوء على هذا، مع رسم بياني على [هذا الرابط](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe17a4454-a194-45f9-8a1f-f4882501657c_1095x1600.png).

#### بنية السجل وعمليات الوسيط
يتضمن كل سجل، وهو تجريد لحدث، ما يلي:
- الطابع الزمني: وقت الإنشاء.
- المفتاح: للترتيب، والتجميع المكاني، والاحتفاظ، وهو أمر بالغ الأهمية للتقسيم.
- القيمة: محتوى البيانات.
- الرؤوس: بيانات وصفية اختيارية.

المفتاح والقيمة هما مصفوفات بايت، يتم ترميزهما/فك ترميزهما باستخدام serdes، مما يضمن المرونة. تتضمن عمليات الوسيط:
- هبوط طلب المنتج في buffer استقبال المقبس.
- نقل مؤشر الشبكة إلى طابور طلبات مشترك.
- مؤشر I/O يتحقق من صحة CRC، ويلحق بـ commit log (قطاعات القرص بالبيانات والفهرس).
- تخزين الطلبات في purgatory للتكرار.
- وضع الاستجابة في طابور، وإرسال مؤشر الشبكة عبر buffer إرسال المقبس.

هذه العملية، المحسنة للإدخال/الإخراج التسلسلي، مفصلة في منشور المدونة، مع رسوم بيانية توضح التدفق، مما يساهم بشكل كبير في سرعة Kafka.

| مكون السجل       | الغرض                                                                 |
|------------------|-----------------------------------------------------------------------|
| الطابع الزمني    | يسجل وقت إنشاء الحدث.                                                |
| المفتاح          | يضمن الترتيب، والتجميع المكاني، والاحتفاظ لأغراض التقسيم.            |
| القيمة           | تحتوي على محتوى البيانات الفعلي.                                     |
| الرؤوس           | بيانات وصفية اختيارية لمعلومات إضافية.                               |

#### تحسينات الأداء
تعزز عدة قرارات تصميمية من سرعة Kafka:
- **السجلات ذات الإلحاق فقط**: الكتابة التسلسلية في نهاية الملف تقلل من وقت البحث على القرص، تشبه إضافة إدخالات في مذكرات في النهاية، أسرع من الإدراج في منتصف المستند.
- **مبدأ Zero-Copy**: ينقل البيانات مباشرة من المنتج إلى المستهلك، مما يقلل من عبء وحدة المعالجة المركزية، مثل نقل صندوق من الشاحنة إلى المستودع دون فتحه، مما يوفر الوقت.
- **المعالجة الدفعية**: التعامل مع البيانات على شكل دفعات يقلل النفقات العامة لكل سجل، مما يحسن الكفاءة.
- **التكرار غير المتزامن**: يخدم الوسيط القائد الطلبات بينما تقوم النسخ المتماثلة بالتحديث، مما يضمن التوفر دون تأثير على الأداء.
- **التقسيم**: يوزع البيانات عبر الأقسام للمعالجة المتوازية، مما يزيد الإنتاجية، وهو عامل رئيسي في التعامل مع أحجام كبيرة من البيانات.

هذه التحسينات، كما تم استكشافها في منشور المدونة، هي السبب في تحقيق Kafka لإنتاجية عالية وكمون منخفض، مما يجعلها مناسبة للتطبيقات في الوقت الفعلي.

#### الخاتمة ورؤى إضافية
سرعة Apache Kafka هي نتيجة لبنيتها المصممة بدقة وتحسينات الأداء، مستفيدة من السجلات ذات الإلحاق فقط، ومبادئ zero-copy، والمعالجة الدفعية، والتكرار غير المتزامن، والتقسيم الفعال. يقدم هذا التحليل، المستند إلى الفيديو والمكمل بمنشور المدونة، رؤية شاملة، غير متوقعة في عمقها لأولئك الذين يتوقعون نظرة عامة بسيطة، ويكشف عن التوازن المعقد لخيارات التصميم التي تجعل Kafka رائدة في تدفق البيانات.

يقدم منشور المدونة أيضًا نسخة تجريبية مجانية لمدة 7 أيام للأرشيف الكامل، يمكن الوصول إليها على [رابط الاشتراك هذا](https://blog.bytebytego.com/subscribe?simple=true&next=https%3A%2F%2Fblog.bytebytego.com%2Fp%2Fwhy-is-kafka-so-fast-how-does-it&utm_source=paywall-free-trial&utm_medium=web&utm_content=137028631&coupon=3920da80)، مما يوفر موارد إضافية للمهتمين.

يضمن هذا الاستكشاف المفصل فهمًا كاملاً، متوافقًا مع نية الفيديو لتثقيف المستخدمين حول أداء Kafka، ومستنيرًا بالأبحاث والرؤى المجمعة من مصادر مختلفة، مما يضمن الدقة والعمق.

#### الاقتباسات الرئيسية
- [مقطع فيديو يوتيوب: System Design: Why is Kafka fast?](https://www.youtube.com/watch?v=UNUz1-msbOM)
- [منشور مدونة ByteByteGo: Why is Kafka so fast? How does it work?](https://bytebytego.substack.com/p/why-is-kafka-so-fast-how-does-it)
- [رسم بياني لبنية Kafka من ByteByteGo](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd3690db-87b8-4165-8798-37d1d083f837_1600x1527.png)
- [رسم بياني لتكرار Kafka من ByteByteGo](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb869cd88-3d6e-43af-8fd0-26f3737d8f1f_1600x559.png)
- [رسم بياني لعمليات وسيط Kafka من ByteByteGo](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe17a4454-a194-45f9-8a1f-f4882501657c_1095x1600.png)
- [اشتراك في نشرة ByteByteGo الإخبارية للمقالة عن Kafka](https://blog.bytebytego.com/subscribe?simple=true&next=https%3A%2F%2Fblog.bytebytego.com%2Fp%2Fwhy-is-kafka-so-fast-how-does-it&utm_source=paywall-free-trial&utm_medium=web&utm_content=137028631&coupon=3920da80)