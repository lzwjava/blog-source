---
audio: false
generated: false
image: false
lang: ar
layout: post
title: ุฃุชูุชุฉ ุฅุฏุงุฑุฉ ุจุฑููุณู ุงูุชุตุงุฏู
translated: true
type: post
---

ูุฐุง ุงูููุดูุฑ ููุถุญ ุจุฑูุงูุฌูุง ูุตููุง ุจูุบุฉ ุจุงูุซููุ `clash.py`ุ ูุตูููุง **ูุฃุชูุชุฉ ุฅุฏุงุฑุฉ ุชูููู ุจุฑููุณู Clash ุงูุฎุงุต ุจู**. ูุชููู ูู ุดูุก ุจุฏุกูุง ูู **ุชูุฒูู ุชููููุงุช ุงูุจุฑููุณู ุงููุญุฏุซุฉ ุฏูุฑููุง** ู**ุฅุนุงุฏุฉ ุชุดุบูู ุฎุฏูุฉ Clash** ูุญุชู **ุงุฎุชูุงุฑ ุงูุชุญููู ุงูุฐูู ุฅูู ุฃุณุฑุน ุจุฑููุณู ูุชุงุญ** ุถูู ูุฌููุนุฉ ูุญุฏุฏุฉ. ุฅูู ุฌุงูุจ `clash.py`ุ ูุฅู ูุญุฏุฉ `speed.py` ุชุณูู **ุงุฎุชุจุงุฑ ุฒูู ุงููุตู ููู ุจุฑููุณู Clash ุจุดูู ูุชุฒุงูู**ุ ููุง ูุถูู ุฃู ุงุชุตุงูู ุฏุงุฆููุง ูุง ูุชู ุชูุฌููู ุนุจุฑ ุงูุฎุงุฏู ุงูุฃูุซู.

## clash.py

```python
import os
import subprocess
import time
import shutil
import argparse
import logging
import requests
import json
import urllib.parse

# ุจุงูุชุฑุงุถ ุฃู speed.py ููุฌูุฏ ูู ููุณ ุงูุฏููู ุฃู ูุชุงุญ ูู PYTHONPATH
from speed import get_top_proxies 

# --- ุงูุชูููู ---
CLASH_CONTROLLER_HOST = "127.0.0.1"
CLASH_CONTROLLER_PORT = 9090
CLASH_API_BASE_URL = f"http://{CLASH_CONTROLLER_HOST}:{CLASH_CONTROLLER_PORT}"
# ุงุณู ูุฌููุนุฉ ุงูุจุฑููุณู ุงูุชู ุณูุชู ุชุนููู ุฃูุถู ุจุฑููุณู ูุฑุฏู ุฅูููุง.
# ุชุฃูุฏ ูู ูุฌูุฏ ูุฐู ุงููุฌููุนุฉ ูู ุชูููู Clash ุงูุฎุงุต ุจู.
TARGET_PROXY_GROUP = "๐งProxy" 

def setup_logging():
    """ูุถุจุท ุชุณุฌูู ุงูุฃุญุฏุงุซ ุงูุฃุณุงุณู ูููุต ุงูุจุฑูุฌู."""
    logging.basicConfig(
        filename='clash.log', 
        level=logging.INFO,
        format='%(asctime)s - %(message)s',
        datefmt='%Y-%m-%d %H:%M:%S'
    )

def start_system_proxy(global_proxy_address):
    """ูุถุจุท ูุชุบูุฑุงุช ุจูุฆุฉ ุงูุจุฑููุณู ุนูู ูุณุชูู ุงููุธุงู."""
    os.environ["GLOBAL_PROXY"] = global_proxy_address # ูุชู ุชุนูููู ููุงุชุณุงู ุฅุฐุง ูุงู ูุทููุจูุง ูู ููุงู ุขุฎุฑ
    os.environ["HTTP_PROXY"] = f"http://{global_proxy_address}"
    os.environ["HTTPS_PROXY"] = f"http://{global_proxy_address}"
    os.environ["http_proxy"] = f"http://{global_proxy_address}"
    os.environ["https_proxy"] = f"http://{global_proxy_address}"
    # ูุฐู ุนุงุฏุฉู ูุง ุชุญุชุงุฌ ุฅูู ุชุนููู ุตุฑูุญ ุฅูู "false" ูุน ุงูุฃุฏูุงุช ุงูุญุฏูุซุฉุ
    # ูููู ูุชู ุงูุงุญุชูุงุธ ุจูุง ูุชูุงูููุง ูุน ููุฉ ุงููุต ุงูุจุฑูุฌู ุงูุฃุตูู.
    os.environ["HTTP_PROXY_REQUEST_FULLURI"] = "false" 
    os.environ["HTTPS_PROXY_REQUEST_FULLURI"] = "false"
    os.environ["ALL_PROXY"] = os.environ["http_proxy"]
    logging.info(f"ุชู ุชุนููู ุงูุจุฑููุณู ุนูู ูุณุชูู ุงููุธุงู ุฅูู: {global_proxy_address}")

def stop_system_proxy():
    """ููุณุญ ูุชุบูุฑุงุช ุจูุฆุฉ ุงูุจุฑููุณู ุนูู ูุณุชูู ุงููุธุงู."""
    os.environ["http_proxy"] = ""
    os.environ["HTTP_PROXY"] = ""
    os.environ["https_proxy"] = ""
    os.environ["HTTPS_PROXY"] = ""
    os.environ["HTTP_PROXY_REQUEST_FULLURI"] = "true" # ุงูุนูุฏุฉ ุฅูู ุงูุฅุนุฏุงุฏ ุงูุงูุชุฑุงุถู
    os.environ["HTTPS_PROXY_REQUEST_FULLURI"] = "true"
    os.environ["ALL_PROXY"] = ""
    logging.info("ุชู ุฅููุงู ุงูุจุฑููุณู ุนูู ูุณุชูู ุงููุธุงู (ุชู ูุณุญ ูุชุบูุฑุงุช ุงูุจูุฆุฉ).")

def switch_clash_proxy_group(group_name, proxy_name):
    """
    ูุญูู ุงูุจุฑููุณู ุงููุดุท ูู ูุฌููุนุฉ ุจุฑููุณู Clash ูุญุฏุฏุฉ ุฅูู ุจุฑููุณู ุฌุฏูุฏ.
    """
    encoded_group_name = urllib.parse.quote(group_name)
    url = f"{CLASH_API_BASE_URL}/proxies/{encoded_group_name}"
    headers = {"Content-Type": "application/json"}
    payload = {"name": proxy_name}
    
    try:
        response = requests.put(url, headers=headers, data=json.dumps(payload), timeout=5)
        response.raise_for_status()
        logging.info(f"ุชู ุงูุชุญููู ุจูุฌุงุญ ูู '{group_name}' ุฅูู '{proxy_name}'.")
        return True
    except requests.exceptions.ConnectionError:
        logging.error(f"ุฎุทุฃ: ูุง ูููู ุงูุงุชุตุงู ุจู Clash API ูู {CLASH_API_BASE_URL} ูุชุญููู ุงูุจุฑููุณู.")
        logging.error("ุชุฃูุฏ ูู ุฃู Clash ูุนูู ูุฃู external-controller ูุถุจูุท.")
        return False
    except requests.exceptions.Timeout:
        logging.error(f"ุฎุทุฃ: ุงูุชูุช ูููุฉ ุงูุงุชุตุงู ุจู Clash API ุฃุซูุงุก ุชุญููู ุงูุจุฑููุณู ูู '{group_name}'.")
        return False
    except requests.exceptions.RequestException as e:
        logging.error(f"ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน ุฃุซูุงุก ุชุญููู ุงูุจุฑููุณู ูู '{group_name}': {e}")
        return False

def main():
    """ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ูุฅุฏุงุฑุฉ ุชูููู Clashุ ุฅุนุงุฏุฉ ุงูุชุดุบููุ ูุงุฎุชูุงุฑ ุฃูุถู ุจุฑููุณู."""
    setup_logging()
    
    parser = argparse.ArgumentParser(description="ูุต ุจุฑูุฌู ูุฅุฏุงุฑุฉ ูุชูููู Clash.")
    parser.add_argument("--minutes", type=int, default=10, help="ุงูุฏูุงุฆู ุจูู ุงูุชุญุฏูุซุงุช (ุงูุงูุชุฑุงุถู: 10)")
    parser.add_argument("--iterations", type=int, default=1000, help="ุนุฏุฏ ุงูุชูุฑุงุฑุงุช (ุงูุงูุชุฑุงุถู: 1000)")
    parser.add_argument(
        "--config-url", 
        type=str, 
        default=os.getenv("CLASH_DOWNLOAD_URL"),
        help="ุฑุงุจุท ุชูุฒูู ุชูููู Clash ููู. ุงูุงูุชุฑุงุถู ูู ูุชุบูุฑ ุงูุจูุฆุฉ CLASH_DOWNLOAD_URL ุฅุฐุง ุชู ุชุนููููุ ูุฅูุง ูุณูุชู ุงุณุชุฎุฏุงู ุฑุงุจุท ุซุงุจุช."
    )
    args = parser.parse_args()

    ITERATIONS = args.iterations
    SLEEP_SECONDS = args.minutes * 60
    config_download_url = args.config_url

    if not config_download_url:
        logging.critical("ุฎุทุฃ: ูู ูุชู ุชูุฏูู ุฑุงุจุท ุชูุฒูู ุงูุชูููู. ูุฑุฌู ุชุนููู ูุชุบูุฑ ุงูุจูุฆุฉ CLASH_DOWNLOAD_URL ุฃู ุงุณุชุฎุฏุงู ูุณูุทุฉ --config-url.")
        return # ุงูุฎุฑูุฌ ุฅุฐุง ูู ููู ููุงู ุฑุงุจุท ูุชุงุญ

    clash_executable_path = "/home/lzw/clash-linux-386-v1.17.0/clash-linux-386"
    clash_config_dir = os.path.expanduser("~/.config/clash")
    clash_config_path = os.path.join(clash_config_dir, "config.yaml")

    for i in range(1, ITERATIONS + 1):
        logging.info(f"--- ุจุฏุก ุงูุชูุฑุงุฑ {i} ูู {ITERATIONS} ---")

        # ุงูุฎุทูุฉ 1: ุฅููุงู ุฃู ุฅุนุฏุงุฏุงุช ุจุฑููุณู ูุธุงููุฉ ููุฌูุฏุฉ
        stop_system_proxy()
        
        # ุงูุฎุทูุฉ 2: ุชูุฒูู ูุชุญุฏูุซ ุชูููู Clash
        try:
            logging.info(f"ุฌุงุฑู ุชูุฒูู ุงูุชูููู ุงูุฌุฏูุฏ ูู: {config_download_url}")
            subprocess.run(["wget", config_download_url, "-O", "zhs4.yaml"], check=True, capture_output=True)
            os.makedirs(clash_config_dir, exist_ok=True)
            shutil.move("zhs4.yaml", clash_config_path)
            logging.info("ุชู ุชุญุฏูุซ ุชูููู Clash ุจูุฌุงุญ!")
        except subprocess.CalledProcessError as e:
            logging.error(f"ูุดู ูู ุชูุฒูู ุฃู ููู ููู ุงูุชูููู: {e.stderr.decode().strip()}")
            logging.error("ุชุฎุทู ุฅูู ุงูุชูุฑุงุฑ ุงูุชุงูู.")
            time.sleep(10) # ุงูุงูุชุธุงุฑ ููููุงู ูุจู ุฅุนุงุฏุฉ ุงููุญุงููุฉ
            continue
        except Exception as e:
            logging.error(f"ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน ุฃุซูุงุก ุชุญุฏูุซ ุงูุชูููู: {e}")
            logging.error("ุชุฎุทู ุฅูู ุงูุชูุฑุงุฑ ุงูุชุงูู.")
            time.sleep(10)
            continue

        # ุงูุฎุทูุฉ 3: ุชุดุบูู Clash ูู ุงูุฎูููุฉ
        clash_process = None
        try:
            # ูู ุงูุถุฑูุฑู ุฃู ูุจุฏุฃ Clash ูุน ุชูุนูู external-controller ููููู ุงููุตูู ุฅููู
            # ูุฐุง ุนุงุฏุฉู ูุง ูุชู ุชููููู ุฏุงุฎู ููู config.yaml ููุณู.
            clash_process = subprocess.Popen([clash_executable_path], 
                                             stdout=subprocess.PIPE, stderr=subprocess.PIPE)
            logging.info(f"ุชู ุชุดุบูู Clash ุจูุนุฑู ุงูุนูููุฉ {clash_process.pid}")
            # ุฅุนุทุงุก Clash ูุญุธุฉ ููุชููุฆุฉ ุงููุงููุฉ ููุชุญ ูููุฐ API ุงูุฎุงุต ุจู
            time.sleep(5) 
        except FileNotFoundError:
            logging.critical(f"ูู ูุชู ุงูุนุซูุฑ ุนูู ููู ุชูููุฐ Clash ูู: {clash_executable_path}")
            logging.critical("ูุฑุฌู ุงูุชุฃูุฏ ูู ุตุญุฉ ุงููุณุงุฑ ูุฃู Clash ูุซุจุช.")
            return # ุฎุทุฃ ุญุฑุฌุ ุงูุฎุฑูุฌ ูู ุงููุต ุงูุจุฑูุฌู
        except Exception as e:
            logging.error(f"ูุดู ูู ุชุดุบูู Clash: {e}")
            logging.error("ุชุฎุทู ุฅูู ุงูุชูุฑุงุฑ ุงูุชุงูู.")
            if clash_process: clash_process.terminate()
            time.sleep(10)
            continue

        # ุงูุฎุทูุฉ 4: ุงุฎุชุจุงุฑ ุณุฑุนุงุช ุงูุจุฑููุณู ูุงุฎุชูุงุฑ ุงูุฃูุถู
        best_proxy_name = None
        try:
            logging.info("ุฌุงุฑู ุงุฎุชุจุงุฑ ุณุฑุนุงุช ุงูุจุฑููุณู ููุนุซูุฑ ุนูู ุงูุฃูุถู...")
            top_proxies = get_top_proxies(num_results=1) # ุงูุญุตูู ุนูู ุฃูุถู ุจุฑููุณู ูุงุญุฏ ููุท
            if top_proxies:
                best_proxy_name = top_proxies[0]['name']
                logging.info(f"ุชู ุชุญุฏูุฏ ุฃูุถู ุจุฑููุณู: '{best_proxy_name}' ุจุฒูู ูุตู {top_proxies[0]['latency']}ms")
            else:
                logging.warning("ูุง ุชูุฌุฏ ุงุฎุชุจุงุฑุงุช ุจุฑููุณู ูุงุฌุญุฉ. ูุง ูููู ุงุฎุชูุงุฑ ุฃูุถู ุจุฑููุณู ููุฐุง ุงูุชูุฑุงุฑ.")
        except Exception as e:
            logging.error(f"ุฎุทุฃ ุฃุซูุงุก ุงุฎุชุจุงุฑ ุณุฑุนุฉ ุงูุจุฑููุณู: {e}")

        # ุงูุฎุทูุฉ 5: ุชุญููู ูุฌููุนุฉ ุจุฑููุณู Clash ุฅูู ุงูุจุฑููุณู ุงูุฃูุถู (ุฅุฐุง ุชู ุงูุนุซูุฑ ุนููู)
        if best_proxy_name:
            # ูุจู ุชุนููู ุจุฑููุณู ุงููุธุงูุ ุชุฃูุฏ ูู ุฃู Clash ูุถุจูุท ุจุดูู ุตุญูุญ.
            # ุชุนููู ุจุฑููุณู ุงููุธุงู ููุฅุดุงุฑุฉ ุฅูู ุจุฑููุณู HTTP ุงููุญูู ูู Clash.
            # ุนุงุฏุฉู ูุง ูุนูู Clash ุจุฑููุณู HTTP ุนูู ุงููููุฐ 7890 (ุฃู ูุง ุดุงุจูุ ุชุญูู ูู ุชููููู).
            clash_local_proxy_address = f"{CLASH_CONTROLLER_HOST}:7890" # ุงุถุจุท ุฅุฐุง ูุงู ูููุฐ HTTP ูู Clash ูุฎุชูููุง
            start_system_proxy(clash_local_proxy_address)
            
            if not switch_clash_proxy_group(TARGET_PROXY_GROUP, best_proxy_name):
                logging.error(f"ูุดู ูู ุชุญููู ูุฌููุนุฉ Clash '{TARGET_PROXY_GROUP}' ุฅูู '{best_proxy_name}'.")
        else:
            logging.warning("ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃูุถู ุจุฑููุณูุ ุชุฎุทู ุชุญููู ูุฌููุนุฉ ุงูุจุฑููุณู ูุฅุนุฏุงุฏ ุจุฑููุณู ุงููุธุงู ููุฐุง ุงูุชูุฑุงุฑ.")
            
        # ุงูุฎุทูุฉ 6: ุงูุงูุชุธุงุฑ ูููุฏุฉ ุงููุญุฏุฏุฉ
        logging.info(f"ุงูุงูุชุธุงุฑ ููุฏุฉ {SLEEP_SECONDS / 60} ุฏูุงุฆู ูุจู ุงูุชูุฑุงุฑ ุงูุชุงูู...")
        time.sleep(SLEEP_SECONDS)

        # ุงูุฎุทูุฉ 7: ุฅููุงู ุนูููุฉ Clash
        if clash_process:
            logging.info("ุฌุงุฑู ุฅููุงุก ุนูููุฉ Clash...")
            clash_process.terminate()
            try:
                clash_process.wait(timeout=10) # ุฅุนุทุงุก Clash ููุชูุง ุฅุถุงูููุง ููุฅุบูุงู ุจูุทู
                logging.info("ุชู ุฅููุงู Clash ุจูุฌุงุญ.")
            except subprocess.TimeoutExpired:
                logging.warning("ูู ูุชู ุฅููุงุก Clash ุจูุทูุ ุฌุงุฑู ูุชู ุงูุนูููุฉ.")
                clash_process.kill()
                clash_process.wait() # ุงูุชุฃูุฏ ูู ูุชู ุงูุนูููุฉ ุจุงููุงูู
            except Exception as e:
                logging.error(f"ุฎุทุฃ ุฃุซูุงุก ุงูุชุธุงุฑ ุฅููุงู Clash: {e}")
        
        logging.info(f"--- ุงูุชูู ุงูุชูุฑุงุฑ {i} ---")

    logging.info(f"ุชู ุฅููุงู {ITERATIONS} ุชูุฑุงุฑุงุช. ุงูุชูู ุงููุต ุงูุจุฑูุฌู.")

if __name__ == "__main__":
    main()
```

## speed.py

```python
import requests
import json
import urllib.parse
import time
from concurrent.futures import ThreadPoolExecutor, as_completed
import logging # ุงุณุชูุฑุงุฏ ูุญุฏุฉ ุชุณุฌูู ุงูุฃุญุฏุงุซ

# --- ุงูุชูููู ---
CLASH_CONTROLLER_HOST = "127.0.0.1"  # ุงุณุชุฎุฏุงู 127.0.0.1 ุญูุซ ุฃู ุงููุชุญูู ุนูู ููุณ ุงูุฌูุงุฒ
CLASH_CONTROLLER_PORT = 9090
CLASH_API_BASE_URL = f"http://{CLASH_CONTROLLER_HOST}:{CLASH_CONTROLLER_PORT}"
LATENCY_TEST_URL = "https://github.com" # ุฑุงุจุท ุงูุงุฎุชุจุงุฑ ุงููุญุฏุซ
LATENCY_TEST_TIMEOUT_MS = 5000  # ูููู ุซุงููุฉ
CONCURRENT_CONNECTIONS = 10 # ุนุฏุฏ ุงูุงุฎุชุจุงุฑุงุช ุงููุชุฒุงููุฉ

# ูุงุฆูุฉ ุจุฃุณูุงุก ูุฌููุนุงุช ุงูุจุฑููุณู ุงููุนุฑููุฉ ูุงุณุชุจุนุงุฏูุง ูู ุงุฎุชุจุงุฑ ุงูุณุฑุนุฉ
# ูุฐู ุนุงุฏุฉู ูุง ูุง ุชููู ุนูุฏูุง ูุฑุฏูุฉ ูููู ูุฌููุนุงุช ุณูุงุณุงุช ุฃู ุจุฑููุณูุงุช ุฎุงุตุฉ.
EXCLUDE_PROXY_GROUPS = [
    "DIRECT",
    "REJECT",
    "GLOBAL", # ูุณุชุจุนุฏ ุจุงููุนู ุงูุชุฑุงุถููุง ูู API
    "๐จ๐ณๅฝๅ็ฝ็ซๆ่ตๆบ",
    "๐ตๅถๅฎ่งๅๅค",
    "๐ฌNetflix็ญๅฝๅคๆตๅชไฝ",
    "๐ฆChatGPT",
    "๐นYoutube",
    "๐บ็ฑๅฅ่บ็ญๅฝๅๆตๅชไฝ",
    "๐งProxy",
    # ุฃุถู ุฃู ุฃุณูุงุก ูุฌููุนุงุช ุฃุฎุฑู ุชุฑูุฏ ุงุณุชุจุนุงุฏูุง ููุง
]

# --- ุฅุนุฏุงุฏ ุชุณุฌูู ุงูุฃุญุฏุงุซ ูู speed.py ---
# ุชูููู ุชุณุฌูู ุงูุฃุญุฏุงุซ ููุฐุง ุงููุต ุงูุจุฑูุฌู ุงููุญุฏุฏ
# ูุฐุง ูุถูู ุฃูู ุนูุฏ ุงุณุชูุฑุงุฏ speed.py ูุงุณุชุฏุนุงุก ูุธุงุฆููุ
# ูุฐูุจ ุฅุฎุฑุงุฌู ุฅูู speed.logุ ูููุตู ุนู clash_manager.log.
logging.basicConfig(
    filename='clash.log',
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    datefmt='%Y-%m-%d %H:%M:%S'
)
# ุงุฎุชูุงุฑููุงุ ุฅุฐุง ููุช ุชุฑูุฏ ุฃูุถูุง ุฑุคูุฉ ุงูุฅุฎุฑุงุฌ ูู ูุญุฏุฉ ุงูุชุญููุ ุฃุถู StreamHandler:
# console_handler = logging.StreamHandler()
# console_handler.setLevel(logging.INFO)
# formatter = logging.Formatter('%(asctime)s - %(levelname)s - %(message)s')
# console_handler.setFormatter(formatter)
# logging.getLogger().addHandler(console_handler)

# --- ููุทู ุงููุต ุงูุจุฑูุฌู ---

def get_all_proxy_names():
    """ูุฌูุจ ุฌููุน ุฃุณูุงุก ุงูุจุฑููุณู ูู Clash APIุ ุจุงุณุชุซูุงุก ุงููุฌููุนุงุช ุงููุนุฑููุฉ."""
    try:
        response = requests.get(f"{CLASH_API_BASE_URL}/proxies", timeout=5)
        response.raise_for_status()  # ุฅุซุงุฑุฉ ุงุณุชุซูุงุก ูุฃุฎุทุงุก HTTP (4xx ุฃู 5xx)
        proxies_data = response.json()
        
        all_names = proxies_data.get("proxies", {}).keys()
        
        # ุชุตููุฉ ุฃุณูุงุก ุงููุฌููุนุงุช
        filtered_names = [name for name in all_names if name not in EXCLUDE_PROXY_GROUPS]
        
        logging.info(f"ุชู ุฌูุจ {len(filtered_names)} ุฃุณูุงุก ุจุฑููุณู ูุงุจูุฉ ููุงุฎุชุจุงุฑ ุจูุฌุงุญ.")
        return filtered_names
    except requests.exceptions.ConnectionError:
        logging.error(f"ูุง ูููู ุงูุงุชุตุงู ุจู Clash API ูู {CLASH_API_BASE_URL}. ุชุฃูุฏ ูู ุฃู Clash ูุนูู.")
        return []
    except requests.exceptions.Timeout:
        logging.error(f"ุงูุชูุช ูููุฉ ุงูุงุชุตุงู ุจู Clash API ุจุนุฏ 5 ุซูุงูู.")
        return []
    except requests.exceptions.RequestException as e:
        logging.error(f"ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน ุฃุซูุงุก ุฌูุจ ุฃุณูุงุก ุงูุจุฑููุณู: {e}")
        return []

def test_proxy_latency(proxy_name):
    """ูุฎุชุจุฑ ุฒูู ุงููุตู ูุจุฑููุณู ูุงุญุฏ ุจุงุณุชุฎุฏุงู Clash API.
    ูุนูุฏ tuple (ุงุณู ุงูุจุฑููุณู, ุฒูู ุงููุตู) ุฃู (ุงุณู ุงูุจุฑููุณู, None) ูู ุญุงูุฉ ุงููุดู.
    """
    encoded_proxy_name = urllib.parse.quote(proxy_name)
    url = f"{CLASH_API_BASE_URL}/proxies/{encoded_proxy_name}/delay"
    params = {
        "url": LATENCY_TEST_URL,
        "timeout": LATENCY_TEST_TIMEOUT_MS
    }
    try:
        # ูููุฉ requests ุจุงูุซูุงููุ ุชุญููู ุงููููู ุซุงููุฉ
        response = requests.get(url, params=params, timeout=(LATENCY_TEST_TIMEOUT_MS / 1000) + 1)
        response.raise_for_status()
        latency_data = response.json()
        latency = latency_data.get("delay")
        logging.info(f"ุงูุจุฑููุณู: {proxy_name} - ุฒูู ุงููุตู: {latency}ms")
        return proxy_name, latency
    except requests.exceptions.RequestException as e:
        logging.warning(f"ุฎุทุฃ ูู ุงุฎุชุจุงุฑ '{proxy_name}': {e}")
        return proxy_name, None

def get_top_proxies(num_results=5):
    """
    ูุฎุชุจุฑ ุณุฑุนุงุช ุจุฑููุณู Clash ุจุดูู ูุชุฒุงูู ููุนูุฏ ุฃูุถู N ุจุฑููุณู ูุฑุฏู ูู ุญูุซ ุงูุณุฑุนุฉ.

    ุงูุฅุฑุฌุงุน:
        list: ูุงุฆูุฉ ูู ุงูููุงููุณุ ูู ูููุง ูุญุชูู ุนูู 'name' ู 'latency' ูุฃูุถู ุงูุจุฑููุณูุงุช.
              ุชุนูุฏ ูุงุฆูุฉ ูุงุฑุบุฉ ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนูู ุจุฑููุณ