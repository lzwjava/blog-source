---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: شرح الوصول الصادر لبوابة NAT في AWS
translated: true
type: note
---

### توضيح الوصول الصادر أحادي الاتجاه مع NAT في AWS

نعم، لقد فهمت الأمر بشكل صحيح تمامًا—هذا هو الجمال (وميزة الأمان) في طريقة عمل بوابات NAT في VPCs الخاصة بـ AWS. دعني أوضح الأمر خطوة بخطوة لتأكيد فهمك، باستخدام أمثلتك.

#### 1. **الطبيعة "أحادية الاتجاه" لـ NAT لحركة المرور الصادرة**
   - **الشبكة الخاصة → الإنترنت العام (صادر، بدأته الشبكة الخاصة)**:
     - يمكن للحالات الموجودة في شبكة فرعية خاصة (على سبيل المثال، بعناوين IP مثل 10.0.1.10) الوصول إلى الإنترنت العام لأشياء مثل تحديثات البرامج. هذا هو "خروج فقط" أو صادر أحادي الاتجاه.
     - مثال: تشغيل `apt install` على instance من نوع EC2 يعمل بنظام Ubuntu في الشبكة الفرعية الخاصة. تقوم الـ instance ببدء اتصال بمستودعات Ubuntu العامة (مثل archive.ubuntu.com). تقوم بوابة NAT بترجمة عنوان IP المصدر الخاص إلى عنوانها العام المرن (Elastic IP)، وإرسال الطلب، وتوجيه الاستجابة مرة أخرى إلى الـ instance الأصلي.
     - لماذا أحادي الاتجاه؟ تقوم الـ NAT فقط بمعالجة حركة المرور *التي بدأتها* الـ instance الخاصة. لا تفتح منافذ أو تسمح باتصالات واردة غير مرغوب فيها من الجانب العام. هذا يحافظ على إخفاء الشبكة الفرعية الخاصة وتأمينها—لا يتم تعيين عنوان IP عام مباشرة لتلك الـ instances.
   - **الإنترنت العام → الشبكة الخاصة (وارد، محظور افتراضيًا)**:
     - لا يمكن للإنترنت العام الوصول مباشرة إلى الشبكة الفرعية الخاصة. لا يوجد مسار أو ترجمة معدة لحركة المرور الواردة إلا إذا قمت بتكوينها صراحةً (المزيد عن هذا لاحقًا).
     - هذا يمنع الهجمات أو الوصول غير المرغوب فيه إلى خوادمك وقواعد البيانات الخلفية في الشبكة الفرعية الخاصة.

#### 2. **تحديثات البرامج مقابل كشف خدمة التطبيق الخاصة بك**
   - **تحديثات البرامج (صادر، بدأته الخاص)**:
     - كما قلت، هذا هو قيام الـ instances الخاصة بتحديث *نفسها*—على سبيل المثال، `apt update && apt upgrade` الذي يسحب الحزم من المستودعات العامة، أو تنزيل صور Docker من Docker Hub.
     - لا حاجة للكشف: تقوم بوابة NAT بمعالجة الترجمة بشفافية. تبقى instances الخاصة بك مخفية ولا يمكن فحصها/استكشافها من الخارج.
   - **خدمة التطبيق للمستخدمين (وارد، يتطلب كشفًا)**:
     - إذا كنت تشغل تطبيق/خادم ويب يحتاج المستخدمون إلى الوصول إليه (على سبيل المثال، عبر طلبات GET/POST إلى واجهة برمجة التطبيقات API الخاصة بك)، فهذا هو العكس: عام → خادمك (وارد).
     - أنت *بحاجة* إلى كشف هذا، ولكن ليس عن طريق وضعه في الشبكة الفرعية الخاصة. إعدادات AWS الشائعة:
       - ضع خادم التطبيق في **شبكة فرعية عامة** مع عنوان IP عام أو عنوان IP مرن (Elastic IP).
       - استخدم **موزع حمل التطبيقات (ALB)** أو **موزع حمل الشبكة (NLB)** أمامه—يمكن لهذه أن تكون في شبكات فرعية عامة وتعيد توجيه حركة المرور إلى الـ instances الخلفية الخاصة (مثل مجموعات التوسع التلقائي).
       - للأمان الكامل: احتفظ بالمكونات الخلفية الحساسة (قواعد البيانات، الحوسبة) في شبكات فرعية خاصة، ولكن استخدم موزع الحمل لتحويل الطلبات. يمكن لـ ALB حتى فرض HTTPS وقواعد WAF.
     - الـ NAT ليست مخصصة مباشرة لهذا السيناريو الوارد؛ يمكنك استخدام **بوابة الإنترنت (IGW)** للشبكات الفرعية العامة أو **ما يعادلها من إعادة توجيه المنافذ/DNAT** عبر موزعات الحمل.

#### مثال سريع على البنية (النمط الشائع)
- **الشبكة الفرعية العامة**: ALB (مكشوف للإنترنت) → يوجه حركة المرور إلى...
- **الشبكة الفرعية الخاصة**: خوادم التطبيقات/ instances EC2 الخاصة بك (تتعامل مع الطلبات، ولكن لا يمكن الوصول إليها مباشرة).
- **بوابة NAT**: في الشبكة الفرعية العامة، تسمح للـ instances الخاصة بجلب التحديثات/دفع السجلات للخارج.
- النتيجة: يصل المستخدمون إلى تطبيقك عبر نقطة نهاية عامة (مثل api.yourapp.com)، ولكن تبقى المكونات الداخلية محمية.

هذا الإعداد قابل للتوسع جيدًا ويتبع أفضل ممارسات AWS للأمان (أقل صلاحيات). إذا كنت تقوم بإعداد هذا وواجهت مشكلة (مثل تكوين جدول المسارات)، شارك المزيد من التفاصيل—يمكنني المساعدة في استكشاف الأخطاء وإصلاحها!