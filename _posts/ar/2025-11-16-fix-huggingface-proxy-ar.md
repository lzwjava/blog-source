---
audio: false
generated: true
image: false
lang: ar
layout: post
model: openai/gpt-5
title: إصلاح البروكسي لتحميل هاجينج فيس
translated: true
type: note
---

نعم — يمكنه **استخدام** البروكسي الخاص بك، لكن من الناتج الذي لصقته، **بروكسيك لا يُستخدم حاليًا**.

لهذا السبب التحميل عالق عند **17.6 بايت/ثانية** — هذه علامة نموذجية على الاتصال المباشر بين الصين وخوادم HuggingFace.

دعني أوضح لك **كيف تتأكد** و**كيف تصلح** المشكلة.

---

# 1. لماذا تشغيلك الحالي *لا* يستخدم البروكسي

السطر:

```
78.0/630M [00:16<9947:51:33, 17.6B/s]
```

واضح: إذا كان بروكسي صحيح (Clash، V2Ray، Shadowsocks) نشطًا عبر `HTTP_PROXY` / `HTTPS_PROXY`، كنت سترى سرعات مثل:

* مئات الكيلوبايت/ثانية
* أو عدة ميجابايت/ثانية
* وليس ~17 بايت/ثانية

إذن، عملية Python لا تلتقط أي متغيرات بيئة للبروكسي.

---

# 2. تحقق مما إذا كانت متغيرات بيئة البروكسي موجودة

في نفس نافذة الطرفية بالضبط حيث تشغل:

```
python data/openwebtext_10k/prepare.py
```

شغل:

```bash
echo $HTTP_PROXY
echo $HTTPS_PROXY
```

إذا لم يطبع أي شيء → فهذا يعني أنها غير مضبوطة، لذا لا يمكن لـ HuggingFace استخدامها.

---

# 3. الإصلاح: اضبط البروكسي لجلسة الطرفية هذه

مثال لـ Clash شغال على المنفذ 7890:

```bash
export HTTP_PROXY="http://127.0.0.1:7890"
export HTTPS_PROXY="http://127.0.0.1:7890"
```

إذا كنت تستخدم SOCKS5 (مثل Shadowsocks):

```bash
export HTTP_PROXY="socks5://127.0.0.1:1080"
export HTTPS_PROXY="socks5://127.0.0.1:1080"
```

**ثم شغل مرة أخرى:**

```bash
python data/openwebtext_10k/prepare.py
```

الآن يجب أن تقفز سرعتك بشكل كبير.

---

# 4. فحص إضافي داخل Python

أضف هذه الأسطر في أعلى ملف `prepare.py` فقط للاختبار:

```python
import os
print("HTTP_PROXY:", os.getenv("HTTP_PROXY"))
print("HTTPS_PROXY:", os.getenv("HTTPS_PROXY"))
```

إذا طبعوا `None` → فهذا يعني أن الطرفية لم تمررهم → أصلح بيئتك.

---

# 5. اختياري: تحقق باستخدام `requests` قبل تحميل مجموعة البيانات

شغل:

```python
import requests
print(requests.get("https://api.ipify.org?format=json", timeout=5).text)
```

* إذا كان عنوان IP الذي تم إرجاعه هو من بروكسي/شبكة VPN الخاصة بك → جيد.
* إذا كان عنوان IP مزود خدمة الإنترنت (ISP) الخاص بمنزلك → البروكسي لم يُستخدم.

---

# 6. تفصيل مهم: HuggingFace يستخدم **HTTP**، وليس SOCKS**، إلا إذا استخدمت pysocks

إذا كان بروكسيك من نوع SOCKS5، بعض تثبيتات Python لا تعمل معه إلا إذا كان `PySocks` مثبتًا:

```bash
pip install pysocks
```

عندها تعمل بروكسيات SOCKS بشكل طبيعي.

---

# 7. الملخص

✔ HuggingFace *سيستخدم* البروكسي
✔ لكن فقط إذا كانت متغيرات البيئة مضبوطة
✘ سجلاتك تظهر أن بروكسيك غير نشط
✔ الحل: اضبط متغيرات بيئة البروكسي في نفس الطرفية

---

إذا أردت، يمكنني:

* تعديل إعدادات طرفيتك (`.bashrc` أو `.zshrc`) لاستخدام البروكسي دائمًا
* عمل برنامج نصي "تفعيل-بروكسي" / "إيقاف-بروكسي"
* تعديل ملفك `prepare.py` في NanoGPT لإجبار استخدام البروكسي داخل Python

أخبرني أي اتجاه تفضل.