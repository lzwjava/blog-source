---
audio: false
generated: true
lang: ar
layout: post
title: تهيئة إن جين إكس
translated: true
type: note
---

استخدام `server_name 0.0.0.0` في تهيئة Nginx الخاص بك ليس النهج الصحيح، لأن `server_name` مخصص لمطابقة أسماء النطاقات أو أسماء المضيفين، وليس عناوين IP. بالإضافة إلى ذلك، `0.0.0.0` هو عنوان خاص يعني "الاستماع على جميع الواجهات"، والذي تتم معالجته بواسطة توجيه `listen`، وليس `server_name`. نظرًا لأن عنوان IP لجهاز الكمبيوتر المحمول الخاص بك (الخادم) يتغير ديناميكيًا، فأنت بحاجة إلى حل يستوعب هذا التغيير. فيما يلي خطوات لإصلاح تهيئة Nginx ومعالجة مشكلة IP الديناميكي بشكل فعال.

### المشكلة
عنوان IP لجهاز الكمبيوتر المحمول الخاص بك (على سبيل المثال، `192.168.1.27`) يتغير بسبب DHCP، لكنك تريد أن يخدم خادم Nginx الخاص بك ملفات الأفلام بموثوقية بغض النظر عن عنوان IP. يؤدي ترميز عنوان IP يدويًا في توجيه `server_name` أو تهيئة العميل إلى حدوث مشكلات عندما يتغير عنوان IP.

### الحل
لجعل خادم Nginx الخاص بك يعمل بسلاسة على الرغم من تغير عنوان IP، يمكنك استخدام واحد أو أكثر من الأساليب التالية:

#### 1. استخدام DNS ديناميكي (DDNS) أو اسم مضيف محلي
بدلاً من الاعتماد على عنوان IP، استخدم اسم مضيف لخادمك. يمكن تحقيق هذا عن طريق:
- **استخدام اسم مضيف الكمبيوتر المحمول**: تقوم معظم أنظمة التشغيل بتعيين اسم مضيف افتراضي (على سبيل المثال، `mylaptop.local` على macOS أو `mylaptop` على Linux/Windows). يمكنك استخدام هذا في `server_name` في Nginx والوصول إلى الخادم عبر اسم المضيف.
- **إعداد DNS محلي أو mDNS**: استخدم خدمة مثل Avahi (لـ Linux) أو Bonjour (لـ macOS/Windows) لحل اسم مضيف الكمبيوتر المحمول محليًا (على سبيل المثال، `mylaptop.local`).
- **استخدام خدمة DDNS**: إذا كنت بحاجة إلى الوصول من خارج شبكتك المحلية، يمكن لخدمات مثل No-IP أو DynDNS تعيين اسم نطاق (على سبيل المثال، `mymovies.ddns.net`) يتتبع عنوان IP لجهاز الكمبيوتر المحمول الخاص بك، حتى لو تغير.

**مثال تهيئة Nginx**:
```nginx
server {
    listen 80;
    server_name mylaptop.local; # استخدم اسم مضيف الكمبيوتر المحمول أو اسم DDNS
    root /path/to/movies;
    location / {
        try_files $uri $uri/ /index.html; # اضبط حسب الحاجة لإعداداتك
    }
}
```
- استبدل `mylaptop.local` باسم المضيف الفعلي لجهاز الكمبيوتر المحمول أو اسم DDNS.
- على أجهزة العميل، قم بالوصول إلى الخادم عبر `http://mylaptop.local` بدلاً من عنوان IP.

**كيفية العثور على اسم مضيف الكمبيوتر المحمول الخاص بك**:
- Linux/macOS: قم بتشغيل `hostname` في الطرفية.
- Windows: قم بتشغيل `hostname` في موجه الأوامر أو تحقق من الإعدادات > النظام > حول.
- تأكد من أن شبكتك تدعم mDNS (معظم أجهزة التوجيه المنزلية تفعل ذلك عبر Bonjour/Avahi).

#### 2. ربط Nginx بجميع الواجهات
إذا كنت تريد أن يستمع Nginx على جميع عناوين IP المتاحة (مفيد عندما يتغير عنوان IP)، قم بتكوين توجيه `listen` لاستخدام `0.0.0.0` أو احذف العنوان تمامًا (Nginx يستمع افتراضيًا على جميع الواجهات).

**مثال تهيئة Nginx**:
```nginx
server {
    listen 80; # يستمع على جميع الواجهات (مكافئ لـ 0.0.0.0:80)
    server_name _; # يطابق أي اسم مضيف أو IP
    root /path/to/movies;
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```
- `listen 80`: يربط بجميع الواجهات، لذا يستجيب الخادم للطلبات على أي IP معين للكمبيوتر المحمول.
- `server_name _`: مطابقة شاملة تطابق أي اسم مضيف أو IP مستخدم للوصول إلى الخادم.
- يمكن للعملاء الوصول إلى الخادم باستخدام أي من عناوين IP الحالية للكمبيوتر المحمول (على سبيل المثال، `http://192.168.1.27` أو `http://192.168.1.28`) أو اسم المضيف.

#### 3. تعيين عنوان IP ثابت للكمبيوتر المحمول
لتجنب تغير عنوان IP، قم بتكوين الكمبيوتر المحمول الخاص بك لاستخدام عنوان IP ثابت داخل شبكتك المحلية (على سبيل المثال، `192.168.1.27`). يمكن القيام بذلك عبر:
- **إعدادات الموجه**: احجز عنوان IP لعنوان MAC لجهاز الكمبيوتر المحمول الخاص بك في إعدادات DHCP للموجه (غالبًا ما يسمى "DHCP reservation").
- **إعدادات شبكة الكمبيوتر المحمول**: قم بتعيين عنوان IP ثابت يدويًا خارج نطاق DHCP (على سبيل المثال، `192.168.1.200`) في تكوين شبكة الكمبيوتر المحمول الخاص بك.

بمجرد أن يصبح عنوان IP ثابتًا، قم بتحديث تهيئة Nginx:
```nginx
server {
    listen 192.168.1.27:80; # الربط بعنوان IP الثابت
    server_name 192.168.1.27; # اختياري، إذا كان العملاء يستخدمون عنوان IP مباشرة
    root /path/to/movies;
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```
- يصل العملاء إلى الخادم عبر `http://192.168.1.27`.

#### 4. استخدام وكيل عكسي أو موازن حمل (متقدم)
إذا كان لديك خوادم متعددة أو تريد إعدادًا أكثر قوة، يمكنك إعداد وكيل عكسي (على سبيل المثال، مثيل Nginx آخر) على جهاز بعنوان IP ثابت يقوم بتوجيه الطلبات إلى جهاز الكمبيوتر المحمول الخاص بك. يمكن للوكيل استخدام اسم مضيف الكمبيوتر المحمول أو حل عنوان IP الخاص به ديناميكيًا.

### النهج الموصى به
للتبسيط، أوصي **بـالخيار 1 (استخدام اسم مضيف الكمبيوتر المحمول)** أو **الخيار 2 (الربط بجميع الواجهات)**:
- **الخيار 1** مثالي إذا كانت شبكتك تدعم mDNS وتريد عنوان URL سهل الاستخدام (على سبيل المثال، `http://mylaptop.local`). يتطلب الحد الأدنى من التهيئة ويعمل بشكل جيد مع الشبكات المحلية.
- **الخيار 2** هو الأفضل إذا كنت لا تريد الاعتماد على أسماء المضيفين ولا تمانع في أن يستخدم العملاء عنوان IP الحالي (والذي يمكنك العثور عليه عبر `ip addr` أو `ifconfig` على الكمبيوتر المحمول).

### خطوات التنفيذ
1. **تحرير تهيئة Nginx**:
   - افتح ملف تهيئة Nginx الخاص بك (على سبيل المثال، `/etc/nginx/sites-available/default` أو `/etc/nginx/conf.d/movies.conf`).
   - طبق أحد التهيئات أعلاه (على سبيل المثال، استخدم `server_name mylaptop.local` أو `server_name _` مع `listen 80`).
   - احفظ الملف.

2. **اختبار التهيئة**:
   ```bash
   sudo nginx -t
   ```
   تأكد من عدم وجود أخطاء في الصيغة.

3. **إعادة تحميل Nginx**:
   ```bash
   sudo systemctl reload nginx
   ```
   أو، إذا لم يكن `systemctl` متاحًا:
   ```bash
   sudo nginx -s reload
   ```

4. **اختبار الوصول**:
   - من جهاز عميل، قم بالوصول إلى الخادم باستخدام اسم المضيف (على سبيل المثال، `http://mylaptop.local`) أو عنوان IP الحالي للكمبيوتر المحمول (على سبيل المثال، `http://192.168.1.27`).
   - تحقق من أن ملفات الأفلام يتم خدمتها بشكل صحيح.

5. **اختياري: التحقق من عنوان IP للكمبيوتر المحمول**:
   إذا كنت بحاجة إلى معرفة عنوان IP الحالي للكمبيوتر المحمول:
   - Linux/macOS: `ip addr show` أو `ifconfig`.
   - Windows: `ipconfig` في موجه الأوامر.

### نصائح إضافية
- **جدار الحماية**: تأكد من أن جدار حماية الكمبيوتر المحمول يسمح بحركة مرور HTTP على المنفذ 80 (أو 443 لـ HTTPS). على سبيل المثال، على Linux مع `ufw`:
  ```bash
  sudo ufw allow 80/tcp
  ```
- **أذونات الملفات**: تحقق من أن Nginx لديه الإذن لقراءة ملفات الأفلام:
  ```bash
  sudo chown -R www-data:www-data /path/to/movies
  sudo chmod -R 755 /path/to/movies
  ```
  (اضبط `www-data` إلى المستخدم الذي يعمل به Nginx، على سبيل المثال، `nginx` في بعض الأنظمة.)
- **HTTPS (اختياري)**: للأمان، فكر في إعداد HTTPS بشهادة ذاتية التوقيع أو من Let’s Encrypt، خاصة إذا كنت ستصل إلى الخادم من خارج شبكتك المحلية.
- **تصحيح الأخطاء**: إذا كان الخادم غير قابل للوصول، تحقق من سجلات Nginx:
  ```bash
  sudo tail -f /var/log/nginx/error.log
  sudo tail -f /var/log/nginx/access.log
  ```

### لماذا `server_name 0.0.0.0` لا يعمل
- `server_name` يستخدم لمطابقة رأس `Host` في طلبات HTTP، وليس لتحديد واجهة الاستماع. تعيين `server_name 0.0.0.0` سيتوقع أن يرسل العملاء رأس `Host: 0.0.0.0`، وهو ما لن يحدث.
- للاستماع على جميع الواجهات، استخدم `listen 0.0.0.0:80` (أو فقط `listen 80`)، ولمطابقة أي اسم مضيف، استخدم `server_name _`.

### مثال التهيئة النهائية (الأبسط)
لخادم أفلام محلي يعمل بغض النظر عن تغييرات عنوان IP:
```nginx
server {
    listen 80;
    server_name _;
    root /path/to/movies;
    location / {
        autoindex on; # يمكّن عرض قائمة الدلائل لسهولة التصفح
        try_files $uri $uri/ /index.html;
    }
}
```
- احفظ، اختبر، وأعد تحميل Nginx كما هو موضح أعلاه.
- الوصول عبر `http://<laptop-ip>` أو `http://<laptop-hostname>`.

يضمن هذا الإعداد بقاء خادم الأفلام الخاص بك قابلًا للوصول حتى عندما يتغير عنوان IP للكمبيوتر المحمول، دون الاعتماد على عنوان IP محدد في التهيئة.

إذا كان لديك المزيد من التفاصيل (على سبيل المثال، تهيئة Nginx الحالية، نظام التشغيل، أو إعداد الشبكة)، يمكنني تخصيص الحل بشكل أكبر. دعني أعرف!