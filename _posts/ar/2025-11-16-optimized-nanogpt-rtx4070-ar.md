---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: ุฅุนุฏุงุฏุงุช ูุงูู ุฌู ุจู ุชู ุงูููุญุณูููุฉ ูุจุทุงูุฉ ุขุฑ ุชู ุฅูุณ ูคููงู
translated: true
type: note
---

ุฅููู ุถุจุท nanoGPT ูุญุณูููุง ูุจุทุงูุฉ RTX 4070 ุงูุฎุงุตุฉ ุจู (12 ุฌูุฌุงุจุงูุช VRAM) ุนูุฏ ุงุณุชุฎุฏุงู **ูุฐุง ุงูููู Parquet ุงููุฑุฏู ููุท** (~3.1 ุฌูุฌุงุจุงูุชุ ูู CC-MAIN-2013-20/000_00000.parquet).

### ุงูุชุนุฏููุงุช ุงูุฑุฆูุณูุฉ ูุงูุณุจุจ
- **ุชูุฏูุฑ ุญุฌู ูุฌููุนุฉ ุงูุจูุงูุงุช**: ูุญุชูู ููู Parquet ูุฐุง ุนูู ูุง ููุฑุจ ูู 1-2 ูููุงุฑ ุฑูุฒ (ุจูุงุกู ุนูู ูููู FineWebุ ุญูุซ ูุญุชูู ุงูุฒุญู ุงููุงูู ูู CC-MAIN-2013-20 ุนูู ~144.5 ูููุงุฑ ุฑูุฒ ุนุจุฑ ~100-150 ูููุ ููุจูุบ ูุชูุณุท ูู ููู 2-4 ุฌูุฌุงุจุงูุช ูุน ุถุบุท ุฌูุฏ). ุฅููุง ุฃุตุบุฑ ุจูุซูุฑ ูู FineWeb ุงููุงููุ ูุฐูู ููุช ุจุชูููู `max_iters` ู `lr_decay_iters` ูุงุณุชูุฏุงู ~2-3 ูููุงุฑ ุฑูุฒ ุฅุฌูุงูู ุชูุช ุฑุคูุชูุง (ุญูุงูู 1-2 ุฏูุฑุฉ ุชุฏุฑูุจูุฉ ูุชูุงุฑุจ ุฌูุฏ ุฏูู ูุฑุท ุงูุชุฎุตูุต ุนูู ูููุฐุฌ 125 ููููู ูุนุงูู).
- **ููุงุกูุฉ ุงูุฐุงูุฑุฉ**: ุงูุชุฒู ุจูููุฐุฌ ~125 ููููู ูุนุงูู (12L/12H/512embd) โ ูุณุชุฎุฏู ~9-10 ุฌูุฌุงุจุงูุช VRAM ุฃุซูุงุก ุงูุชุฏุฑูุจ ุนูู ุจุทุงูุฉ 4070 ุงูุฎุงุตุฉ ุจู. ุฅุฐุง ูุงุฌูุช ููุงุฏ ุงูุฐุงูุฑุฉ (OOM)ุ ูููู `batch_size` ุฅูู 12 ุฃู `gradient_accumulation_steps` ุฅูู 24.
- **ูุฏุฉ ุงูุชุฏุฑูุจ**: ูุน 5000-10000 ุชูุฑุงุฑุ ูุฌุจ ุฃู ูุณุชุบุฑู ูุฐุง ~5-10 ุณุงุนุงุช ุนูู ุจุทุงูุฉ 4070 (ุจุงูุชุฑุงุถ ~1-2 ุชูุฑุงุฑ/ุงูุซุงููุฉ). ุฑุงูุจ ุงูุฎุณุงุฑุฉ (loss); ุฃููู ูุจูุฑูุง ุฅุฐุง ุงุณุชูุฑุช.
- **ุชุนุฏููุงุช ุฃุฎุฑู**: ูุนุฏู ุชุนูู (LR) ุฃูู ููููุงู ูุฃู ุงูุจูุงูุงุช ุฃุตุบุฑ (ุชููุน ุฃูู). ุงุณุชุฎุฏู `block_size=1024` ููุญุตูู ุนูู ุฃูุถู ุฌูุฏุฉุ ุญูุซ ุชุคูุฏ ูุซุงุฆู FineWeb ุนูู ุงูุณูุงูุงุช ุงูุฃุทูู.
- **ููุงุญุธุฉ ุงูุฅุนุฏุงุฏ**: ูููู wget ุงูุฎุงุต ุจู ุจุชูุฒูู ููู ูุงุญุฏ ุฅูู `wikipedia_test_dump`. ูุงุณุชุฎุฏุงูู ูู nanoGPT:
  - ุงูููู/ุฃุนุฏ ุชุณููุชู ุฅูู `data/fineweb/train/000_00000.parquet` (ุฃู ุนุฏู `data/fineweb/prepare.py` ููุฅุดุงุฑุฉ ุฅูู ูุฌูุฏู ููุนุงูุฌุฉ ูุฐุง ุงูููู ููุท).
  - ุดุบู `prepare.py` ูุชุญูููู ุฅูู ุฑููุฒ ูู `train.bin`/`val.bin`.
  - ุฅุฐุง ูุงู prepare.py ูุชููุน ูููุงุช ูุชุนุฏุฏุฉุ ููู ุจุชุนุฏููู ููุชูุฑุงุฑ ุฎูุงู ูุฐุง ุงูููู ููุท.

### ุงูุชูููู ุงูููุตู ุจู ูููู Parquet ูุฑุฏู (~1-2 ูููุงุฑ ุฑูุฒ)

```python
out_dir = 'out-fineweb-single-parquet'
eval_interval = 500       # ุชูููู ุฃูุซุฑ ุชูุฑุงุฑูุง ุนูู ุงูุจูุงูุงุช ุงูุตุบูุฑุฉ
eval_iters = 200
log_interval = 50         # ุชุณุฌูู ุฃูุซุฑ ุชูุฑุงุฑูุง
always_save_checkpoint = True

wandb_log = True          # ุงุฎุชูุงุฑู
wandb_project = 'fineweb'
wandb_run_name = '125M-single-parquet-4070'

dataset = 'fineweb'       # ููุชุฑุถ ุฃูู ุนุฏูุช prepare.py ููููู ุงููุฑุฏู
gradient_accumulation_steps = 32     # ุญุฌู ุงูุฏูุนุฉ ุงููุนุงู: 16 * 32 = 512 ุชุณูุณู
batch_size = 16
block_size = 1024                    # ูุทุงุจู ูุนุงูุฌุฉ FineWeb

# ุงููููุฐุฌ (~125 ููููู ูุนุงูู) โ ูุซุงูู ูู 12 ุฌูุฌุงุจุงูุช VRAM
n_layer = 12
n_head = 12
n_embd = 512
dropout = 0.0                        # ุฃุถู 0.1 ุฅุฐุง ูุงู ููุงู ูุฑุท ุชุฎุตูุต
learning_rate = 5e-4                 # ุฃูู ููููุงู ููุจูุงูุงุช ุงูุฃุตุบุฑ
max_iters = 6000                     # ~3 ูููุงุฑ ุฑูุฒ ุชูุช ุฑุคูุชู (ุงุถุจุท ุญุชู 10000 ุฅุฐุง ุงุณุชูุฑุช ุงูุฎุณุงุฑุฉ ูู ุงูุงูุฎูุงุถ)
warmup_iters = 500                   # ุฅุญูุงุก ุฃูุตุฑ
lr_decay_iters = 6000
min_lr = 5e-5
beta2 = 0.99

# ุฅุถุงูุงุช ููุณุฑุนุฉ/ุงูุงุณุชูุฑุงุฑ
compile = True            # ุชุฌููุน PyTorch ูุชุฏุฑูุจ ุฃุณุฑุน ุจูุณุจุฉ 20-30ูช
bias = False              # ูุซู LLaMA/Mistral
weight_decay = 0.1
```

### ุฎูุงุฑ ูููุฐุฌ ุฃุตุบุฑ (ุฅุฐุง ุฃุฑุฏุช ุชุฏุฑูุจูุง ุฃุณุฑุน ุฃู ุฐุงูุฑุฉ ุฃูู)
ุฅุฐุง ูุตู ุงูุชูููู ุฃุนูุงู ุฅูู ุฐุฑูุฉ ~11 ุฌูุฌุงุจุงูุช VRAMุ ุฌุฑุจ ูุฐุง ุงูุชูููู ~84 ููููู ูุนุงูู (ูุณุชุฎุฏู ~7-8 ุฌูุฌุงุจุงูุช):
```python
n_layer = 6
n_head = 6
n_embd = 384
learning_rate = 6e-4      # ุฃุนูู ูููููุฐุฌ ุงูุฃุตุบุฑ
max_iters = 8000          # ุนูุถ ุจุฒูุงุฏุฉ ุงูุชูุฑุงุฑุงุช (~3-4 ูููุงุฑ ุฑูุฒ)
```
ูุง ูุฒุงู ุจุฌูุฏุฉ ุตูุจุฉุ ูููู ุฃุถุนู ูู 125 ููููู.

### ูุตุงุฆุญ ุงูุชุฏุฑูุจ
- **ุฅุฌูุงูู ุงูุฑููุฒ ููู ุชูุฑุงุฑ**: ~512 ุชุณูุณู * 1024 ุฑูุฒ = ~0.5 ููููู ุฑูุฒ.
- **ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ**: ูุน ~1.5 ูููุงุฑ ุฑูุฒ ูู ุงููููุ 6000 ุชูุฑุงุฑ โ 2 ุฏูุฑุฉ ุชุฏุฑูุจูุฉ. FineWeb ุนุงูู ุงูุฌูุฏุฉุ ูุฐุง 1-3 ุฏูุฑุงุช ุชุฏุฑูุจูุฉ ูู ุงูุฃูุซู โ ุฑุงูุจ ุฎุณุงุฑุฉ ุงูุชุญูู (val loss).
- **ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุตุบูุฑุฉ ุฌุฏูุง**: ูุฑุฑ ุฏูุฑุงุช ุชุฏุฑูุจูุฉ ูุชุนุฏุฏุฉ ุนู ุทุฑูู ุฒูุงุฏุฉ `max_iters`. ุฃู ูู ุจุชูุฒูู ุงููุฒูุฏ ูู ูููุงุช Parquet (ูุซูุงูุ 000_00001.parquet) ูุชุญุณูู ุงูุชููุน.
- **ุฑุงูุจ**: ุงุณุชุฎุฏู wandb ูููุชุงุจุนุฉ. ุฅุฐุง ูู ุชูุฎูุถ ุงูุฎุณุงุฑุฉ below ~3.5โ4.0 perplexityุ ุฃุถู dropout=0.1.
- **ุงูุฃุฌูุฒุฉ**: ุนูู ุจุทุงูุฉ 4070ุ ููู `--compile` ูุดุบูู ูุน `torch.backends.cuda.matmul.allow_tf32=True` ููุณุฑุนุฉ.

ูุฐุง ูุฌุจ ุฃู ูููุญู ูููุฐุฌ GPT ุตุบูุฑูุง ูุงุฆููุง ุนูู ูุฐู ุงููุฌููุนุฉ ุงููุฑุนูุฉ. ุฅุฐุง ุดุงุฑูุช ููุญููุงุช ุงูุฎุณุงุฑุฉ ุฃู ุนุฏุฏ ุงูุฑููุฒ ุงูุฏููู ูู prepare.pyุ ูููููู ุงูุชุญุณูู ุฃูุซุฑ! ๐