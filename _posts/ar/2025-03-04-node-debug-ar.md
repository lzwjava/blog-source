---
audio: false
generated: true
lang: ar
layout: post
title: تصحيح الأخطاء في Node.js باستخدام حزمة Debug
translated: true
type: note
---

### النقاط الرئيسية
- يبدو من المرجح أن "التصحيح في npm" يشير إلى استخدام حزمة "debug" للتسجيل في مشاريع Node.js التي تديرها npm.
- تشير الأبحاث إلى تثبيت الحزمة باستخدام `npm install debug`، ثم استخدامها في الكود مع مساحة اسم مثل `require('debug')('myapp:component')`.
- تميل الأدلة إلى تمكين إخراج التصحيح عن طريق تعيين متغير البيئة `DEBUG`، مثل `DEBUG=myapp:component npm run start`.

### تثبيت واستخدام حزمة Debug
لاستخدام حزمة "debug" في مشروع Node.js الخاص بك، قم أولاً بتثبيتها باستخدام npm:
- نفذ `npm install debug` في دليل مشروعك.

ثم، في كود JavaScript الخاص بك، قم باستدعاء الحزمة وإنشاء مثيل تصحيح مع مساحة اسم:
- مثال: `const debug = require('debug')('myapp:component'); debug('some message');`.

### تمكين إخراج التصحيح
لرؤية رسائل التصحيح، عيّن متغير البيئة `DEBUG` عند تشغيل تطبيقك:
- على سبيل المثال، نفذ `DEBUG=myapp:component node app.js` أو `DEBUG=myapp:component npm run start` إذا كنت تستخدم سكريبت npm.

### التحكم في مساحات الأسماء
يمكنك التحكم في رسائل التصحيح التي تظهر باستخدام الأحرف البديلة أو الاستثناءات:
- تمكين مساحات أسماء متعددة باستخدام `DEBUG=myapp:* node app.js`.
- استبعاد مساحات أسماء محددة باستخدام `DEBUG=*,-myapp:exclude node app.js`.

---

### ملاحظة المسح: استكشاف مفصل لاستخدام Debug في npm

يقدم هذا القسم نظرة شاملة حول استخدام حزمة "debug" داخل مشاريع Node.js التي تديرها npm، بناءً على الوثائق والموارد المتاحة. يركز على التنفيذ العملي، والميزات المتقدمة، والاعتبارات للمطورين، مما يضمن فهماً شاملاً لكل من المبتدئين والمستخدمين ذوي الخبرة.

#### مقدمة عن Debug في سياق npm
من المرجح جداً أن العبارة "debug in npm" تشير إلى استخدام حزمة "debug"، وهي أداة تصحيح خفيفة الوزن لبيئات Node.js والمتصفحات، داخل المشاريع التي تديرها npm (مدير حزم Node). نظراً لبروز حزمة "debug" في نتائج البحث وارتباطها بتطوير Node.js، فإن هذا التفسير يتوافق مع احتياجات المطورين الشائعة للتسجيل والتصحيح في المشاريع التي تديرها npm. الحزمة، الموجودة حاليًا في الإصدار 4.4.0 اعتبارًا من التحديثات الأخيرة، مستخدمة على نطاق واسع، حيث تتبناها أكثر من 55,746 مشروعًا آخر في سجل npm، مما يشير إلى وضعها المعياري في النظام البيئي.

#### التثبيت والاستخدام الأساسي
للبدء، قم بتثبيت حزمة "debug" باستخدام npm:
- الأمر: `npm install debug`
- يضيف هذا الحزمة إلى `node_modules` الخاصة بمشروعك ويحدث `package.json`.

في كود JavaScript الخاص بك، قم باستدعاء الحزمة وتهيئتها مع مساحة اسم لتصنيف رسائل التصحيح:
- مثال: `const debug = require('debug')('myapp:component');`.
- استخدم مثيل التصحيح لتسجيل الرسائل: `debug('some message');`.
- تساعد مساحة الاسم، مثل 'myapp:component'، في تحديد مصدر الرسائل، مما يسهل تصفية السجلات في التطبيقات الكبيرة.

لعرض رسائل التصحيح هذه، عيّن متغير البيئة `DEBUG` عند تشغيل تطبيقك:
- مثال: `DEBUG=myapp:component node app.js`.
- إذا بدأ تطبيقك عبر سكريبت npm (مثل `npm run start`)، فاستخدم: `DEBUG=myapp:component npm run start`.
- يتحكم متغير البيئة هذا في مساحات الأسماء المُمكّنة، مما يضمن التصحيح الانتقائي دون تعديل الكود.

#### الميزات المتقدمة والتكوين
تقدم حزمة "debug" العديد من الميزات المتقدمة لتحسين قابلية الاستخدام:

##### التحكم في مساحة الاسم والأحرف البديلة
- استخدم الأحرف البديلة لتمكين مساحات أسماء متعددة: `DEBUG=myapp:* node app.js` ستعرض رسائل التصحيح من جميع مساحات الأسماء التي تبدأ بـ 'myapp:'.
- استبعد مساحات أسماء محددة باستخدام علامة الطرح: `DEBUG=*,-myapp:exclude node app.js` تمكن جميع مساحات الأسماء باستثناء تلك التي تبدأ بـ 'myapp:exclude'.
- يعد هذا التصحيح الانتقائي أمرًا بالغ الأهمية للتركيز على أجزاء محددة من التطبيق دون أن تطغى عليه السجلات.

##### ترميز الألوان والتحليل البصري
- يتضمن إخراج التصحيح ترميز الألوان بناءً على أسماء مساحات الأسماء، مما يساعد في التحليل البصري.
- يتم تمكين الألوان افتراضيًا عندما يكون stderr هو TTY (طرفية) في Node.js، ويمكن تحسينها عن طريق تثبيت الحزمة `supports-color` جنبًا إلى جنب مع debug للحصول على لوحة ألوان أوسع.
- في المتصفحات، تعمل الألوان في أدوات التفتيش القائمة على WebKit، و Firefox (الإصدار 31 وما بعده)، و Firebug، مما يعزز إمكانية القراءة في أدوات التطوير.

##### فرق الوقت ورؤى الأداء
- يمكن للحزمة عرض فرق الوقت بين استدعاءات التصحيح، مسبوقة بـ "+NNNms"، وهو مفيد لتحليل الأداء.
- يتم تمكين هذه الميزة تلقائيًا وتستخدم `Date#toISOString()` عندما لا يكون stdout هو TTY، مما يضمن الاتساق عبر البيئات.

##### متغيرات البيئة والتخصيص
تقوم عدة متغيرات بيئة بضبط إخراج التصحيح بدقة:
| الاسم             | الغرض                              |
|------------------|--------------------------------------|
| DEBUG            | يمكّن/يعطل مساحات الأسماء          |
| DEBUG_HIDE_DATE  | يخفي التاريخ في إخراج non-TTY         |
| DEBUG_COLORS     | يجبر استخدام الألوان في الإخراج         |
| DEBUG_DEPTH      | يحدد عمق فحص الكائن         |
| DEBUG_SHOW_HIDDEN| يظهر الخصائص المخفية في الكائنات   |

- على سبيل المثال، يسمح تعيين `DEBUG_DEPTH=5` بفحص أعمق للكائن، وهو مفيد لهياكل البيانات المعقدة.

##### منسقات للإخراج المخصص
يدعم Debug المنسقات المخصصة لأنواع البيانات المختلفة، مما يعزز إمكانية قراءة السجل:
| المنسق | التمثيل                      |
|-----------|-------------------------------------|
| %O        | طباعة كائن منسقة (أسطر متعددة)|
| %o        | طباعة كائن منسقة (سطر واحد)   |
| %s        | سلسلة نصية                              |
| %d        | رقم (عدد صحيح/عشري)              |
| %j        | JSON، يتعامل مع المراجع الدائرية   |
| %%        | علامة النسبة المئوية المفردة                 |

- يمكن تمديد المنسقات المخصصة، على سبيل المثال `createDebug.formatters.h = (v) => v.toString('hex')` للإخراج السداسي العشري.

#### التكامل مع سكريبتات npm
بالنسبة للمشاريع التي تستخدم سكريبتات npm، فإن دمج التصحيح سلس:
- عدّل سكريبتات `package.json` الخاصة بك لتشمل إعدادات التصحيح إذا لزم الأمر، على الرغم من أن تعيين `DEBUG` أثناء وقت التشغيل يكفي عادةً.
- سكريبت مثال: `"start": "node app.js"`، يُشغل باستخدام `DEBUG=myapp:component npm run start`.
- لمستخدمي Windows، استخدم CMD مع `set DEBUG=* & node app.js` أو PowerShell مع `$env:DEBUG='*';node app.js`، مما يضمن التوافق عبر المنصات.

#### دعم المتصفح والحالات الخاصة
بينما هي مخصصة primarily لـ Node.js، فإن debug تدعم أيضًا بيئات المتصفح:
- أنشئ باستخدام أدوات مثل Browserify أو استخدم خدمات مثل [browserify-as-a-service](https://wzrd.in/standalone/debug@latest) للتضمين من جانب العميل.
- ثبّت الحالة المُمكّنة في المتصفحات باستخدام `localStorage.debug`، على سبيل المثال `localStorage.debug = 'worker:*'`.
- ملاحظة: قد تتطلب المتصفحات القائمة على Chromium (Brave, Chrome, Electron) تمكين مستوى السجل "المفصل" للحصول على الوظائف الكاملة.

#### أفضل الممارسات والاعتبارات
- استخدم مساحات أسماء وصفيّة، مثل "connect:bodyParser"، للحفاظ على الوضوح في السجلات.
- ألحق "*" بمساحات الأسماء للتصحيح المُمكّن دائمًا، على سبيل المثال `DEBUG=connect:*`.
- للإنتاج، تأكد من عدم تعيين `DEBUG` لتجنب التسجيل غير الضروري، حيث تكون عبارات التصحيح صامتة بدون المتغير.
- ضع في اعتبارك الأداء: debug خفيفة الوزن، تقوم بالتسجيل فقط عند التمكين، مما يجعلها مناسبة للتطوير دون التأثير على الإنتاج.

#### تفصيل غير متوقع: تصحيح npm نفسه
بينما ينصب التركيز الأساسي على حزمة "debug"، فمن الجدير بالملاحظة أن "debug in npm" يمكن أن يساء تفسيره على أنه تصحيح أداة npm نفسها (مثل مشاكل `npm install`). في مثل هذه الحالات، استخدم علم `--verbose` الخاص بـ npm للحصول على إخراج مفصل، ولكن هذا يختلف عن استخدام حزمة debug. هذا التمييز مهم للمستخدمين الذين يستكشفون التصحيح المتعلق بـ npm، على الرغم من أن السياق يشير إلى أن الحزمة أكثر صلة.

#### الخلاصة
يوفر استخدام حزمة "debug" في مشاريع Node.js التي تديرها npm طريقة قوية ومرنة لتنفيذ التصحيح الانتقائي. من خلال التثبيت via `npm install debug`، واستدعائها مع مساحات الأسماء، والتحكم في الإخراج via `DEBUG`، يمكن للمطورين إدارة السجلات بكفاءة، وتعزيز إمكانية القراءة بالألوان، وتحليل الأداء. يتوافق هذا النهج مع ممارسات التطوير الحديثة، حيث يقدم توازنًا بين التفاصيل والتحكم في سير عمل التصحيح.

**الاستشهادات الرئيسية:**
- [دليل الاستخدام المفصل لحزمة debug npm](https://www.npmjs.com/package/debug)