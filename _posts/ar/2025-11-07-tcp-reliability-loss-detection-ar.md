---
audio: false
generated: true
image: false
lang: ar
layout: post
model: moonshotai/kimi-k2-thinking
title: موثوقية TCP وكشف الفقد
translated: true
type: note
---

دعني أشرح محادثة موثوقية بروتوكول TCP من خلال مفاهيم واضحة:

## **1. اكتشاف الحزم المفقودة**

يستخدم بروتوكول TCP آليتين رئيسيتين للكشف عن البيانات المفقودة:

- **المهلة الزمنية (Timeout)**: يبدأ مؤقت عد تنازلي بسيط عند إرسال الحزمة. إذا لم تصل إشعارات الاستلام (ACK) قبل انتهاء المؤقت، يتم الإعلان عن فقدان الحزمة وإعادة إرسالها. هذه هي آلية الكشف "كحل أخير".

- **إشعارات الاستلام المكررة (الإعادة السريعة)**: هذه آلية أكثر تطوراً. عندما يستقبل المتلقي الحزم *بترتيب خاطئ*، يستمر في إرسال إشعارات الاستلام (ACK) لآخر حزمة تم استقبالها بنجاح *بالترتيب الصحيح*. على سبيل المثال:
  - إذا استقبل الحزم #1 و #2، ولكن #3 مفقودة، يستمر في إرسال ACK للحزمة #2 حتى عندما يستقبل لاحقاً الحزم #4 و #5، إلخ.
  - **ثلاثة إشعارات استلام مكررة** لنفس رقم التسلسل (#2 في مثالنا) تشير إلى أن الحزمة #3 من المحتمل أن تكون مفقودة (وليس مجرد تأخير)، مما يؤدي إلى إعادة الإرسال *الفوري*—أسرع بكثير من انتظار انتهاء المهلة الزمنية.

## **2. تأثير أداء زمن الذهاب والإياب العالي**

أنت محق تماماً—زمن الذهاب والإياب العالي (RTT) يجعل عملية إعادة الإرسال مؤلمة:
- إذا كان RTT = 200 مللي ثانية (مثلاً، عبر القارات)، وفقدت حزمة، فإنك تنتظر *على الأقل* 200 مللي ثانية لمعرفة ذلك عبر انتهاء المهلة الزمنية
- خلال فترة الانتظار هذه، يظل النطاق الترددي خاملاً، وينخفض الإنتاجية، وتشعر الاتصال بأنه "بطيء"
- الإعادة السريعة تساعد بشكل كبير هنا، حيث تقلل وقت الكشف من ثوانٍ إلى ملي ثوان

## **3. فترات المهلة الزمنية التكيفية**

لا يستخدم بروتوكول TCP قيمة مهلة زمنية ثابتة—بل يتتبع ظروف الشبكة بذكاء:

- **تقدير زمن الذهاب والإياب**: يقيس بروتوكول TCP باستمرار المدة التي تستغرقها إشعارات الاستلام للعودة
- **المهلة الزمنية الديناميكية**: يتم حساب مهلة إعادة الإرسال (RTO) بناءً على زمن الذهاب والإياب المقاس بالإضافة إلى هامش أمان (عادةً RTT + 4×الانحراف)
- **الضبط الذاتي**: عندما يزيد زمن الذهاب والإياب (ازدحام الشبكة، مسارات أطول)، تتمدد المهلة الزمنية تلقائياً لتجنب عمليات الإعادة *المبكرة*
- **تجنب عمليات الإعادة غير الضرورية**: بدون هذا، قد يعيد بروتوكول TCP إرسال حزم سليمة تماماً والتي كانت فقط متأخرة، مما يهدر النطاق الترددي ويتسبب في تسليمات مكررة

**خلاصة القول**: موثوقية بروتوكول TCP لا تقتصر فقط على إعادة الإرسال—بل تتمحور حول الكشف *بذكاء* عن الفقد دون الانتظار طويلاً أو التصرف بتهور.