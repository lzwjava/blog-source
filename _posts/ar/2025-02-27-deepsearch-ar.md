---
audio: false
generated: true
lang: ar
layout: post
title: تجربة بحث متعمق داخل جروك
translated: true
type: note
---

### النقاط الرئيسية
- يبدو من المرجح أن إضافة أمر `create-original` إلى السكريبت سينشئ ملفات Markdown مباشرة في دليل `_posts/en` بنفس تنسيق ملفات المسودات، بما في ذلك التاريخ في اسم الملف.
- تشير الأبحاث إلى أن الأمر الجديد سيستخدم التاريخ الحالي (27 فبراير 2025) وسيتبع اصطلاح التسمية `{date_str}-{name}-en.md`، بما يتطابق مع عملية إنشاء المسودات.
- تميل الأدلة إلى أن front matter سيبقى مطابقًا للمسودات، مع حقول مثل `audio: false`، و`lang: en`، و`layout: post`، و`title: {name}`، و`translated: false`.

### الإجابة المباشرة

#### نظرة عامة
تضيف هذه الاستجابة أمر `create-original` إلى سكريبت Python الخاص بك، مما يسمح لك بإنشاء ملفات Markdown مباشرة في دليل `_posts/en`، متجاوزًا عملية المسودات. ستتبع الملفات نفس تنسيق ملفات المسودات، بما في ذلك التاريخ الحالي في اسم الملف، وتحافظ على نفس بنية front matter.

#### آلية العمل
سيقوم أمر `create-original` الجديد بما يلي:
- استخدام تاريخ اليوم، 27 فبراير 2025، بتنسيق `YYYY-MM-DD` (مثال: `2025-02-27`).
- إنشاء ملفات في دليل `_posts/en` بأسماء مثل `2025-02-27-{name}-en.md`، حيث `{name}` هو الاسم المقدم (مثال: `test-post` يصبح `2025-02-27-test-post-en.md`).
- تضمين نفس front matter الموجود في ملفات المسودات، مثل:
  ```
  ---
  audio: false
  lang: en
  layout: post
  title: {name}
  translated: false
  ---
  ```
- التأكد من وجود دليل `_posts/en`، وإنشاؤه إذا لزم الأمر.

#### تفصيل غير متوقع
من المثير للاهتمام أنه بينما تشارك ملفات المسودات وملفات الأصل الجديدة نفس اصطلاح التسمية القائم على التاريخ، فإن دالة `delete_md` الحالية تبحث عن ملفات بدون تواريخ (مثال: `{name}-en.md`)، مما قد يتسبب في عدم اتساق في إدارة الملفات. قد تحتاج إلى تحديث منطق الحذف للتعامل مع أسماء الملفات المؤرّخة لتحقيق التوافق الكامل.

---

### ملاحظة المسح: التحليل التفصيلي لإضافة أمر `create-original`

يقدم هذا القسم تحليلاً شاملاً لتنفيذ أمر `create-original` في سكريبت Python المقدم، مع توسيع نطاق الإجابة المباشرة برؤى مفصلة حول بنية السكريبت، والمنطق وراء التنفيذ، والآثار المترتبة المحتملة. يستند التحليل إلى الوظائف الحالية للسكريبت وطلب المستخدم لإضافة أمر جديد ينشئ ملفات مباشرة في "original dir" بنفس تنسيق ملفات المسودات.

#### الخلفية والسياق
يتعامل السكريبت، الموجود في دليل "scripts" واسمه "file.py"، مع إنشاء وحذف ملفات Markdown لما يبدو أنه مدونة أو نظام إدارة محتوى متعدد اللغات، ربما باستخدام مولد مواقع ثابت مثل Jekyll. وهو يدعم حاليًا ثلاثة أوامر:
- `create`: ينشئ ملف مسودة Markdown في دليل `_drafts` باسم ملف يتضمن التاريخ الحالي، مثال: `2025-02-27-{name}-en.md`.
- `create-note`: ينشئ ملف ملاحظة في دليل `notes`، أيضًا باسم ملف قائم على التاريخ.
- `delete`: يزيل ملفات Markdown وPDF وملفات الصوت من دليل `_posts` والأدلة المرتبطة بالأصول للغات متعددة، بحثًا عن ملفات باسم `{name}-{lang}.md` بدون تواريخ.

طلب المستخدم إضافة أمر `create-original` ينشئ ملفات مباشرة في "original dir"، مع الحفاظ على نفس تنسيق إنشاء المسودة الافتراضي (أمر `create`). بالنظر إلى السياق، تم تفسير "original dir" على أنه `_posts/en`، دليل المنشورات الإنجليزية، بناءً على بنية السكريبت وسلوك دالة `delete_md`.

#### تفاصيل التنفيذ
لتحقيق الطلب، تم تصميم دالة جديدة `create_original`، تحاكي دالة `create_md` ولكنها تستهدف دليل `_posts/en`. تفاصيل التنفيذ كالتالي:

- **معالجة التاريخ**: تسترجع الدالة التاريخ الحالي باستخدام `datetime.date.today()`، والذي، في 27 فبراير 2025، الساعة 04:00 صباحًا بتوقيت المحيط الهادئ، يؤدي إلى `2025-02-27`. يتم تنسيق هذا التاريخ كـ `YYYY-MM-DD` للاتساق مع أسماء ملفات المسودات.
- **مسار الدليل والملف**: تتحقق الدالة من وجود دليل `_posts/en`، وتنشئه إذا لزم الأمر باستخدام `os.makedirs`. ثم يتم إنشاء الملف في `os.path.join('_posts', 'en', f"{date_str}-{name}-en.md")`، مما يضمن تضمين التاريخ في اسم الملف، مثال: `2025-02-27-test-post-en.md` لاسم `test-post`.
- **front matter**: front matter مطابق لذلك الموجود في `create_md`، معرّف كالتالي:
  ```
  ---
  audio: false
  lang: en
  layout: post
  title: {name}
  translated: false
  ---
  ```
  يضمن هذا الاتساق مع ملفات المسودات، مع الحفاظ على حقول مثل `audio: false` لعدم وجود مرفق صوتي، و`lang: en` للإنجليزية، و`title: {name}` لعنوان المنشور.
- **إنشاء الملف**: يتم كتابة الملف باستخدام `open(file_path, 'w', encoding='utf-8')`، مما يضمن ترميز UTF-8 لتوافق أوسع، ويتم طباعة رسالة تأكيد، مثال: `Created original file: _posts/en/2025-02-27-test-post-en.md`.

تم تحديث الجزء الرئيسي من السكريبت لتضمين `create-original` كإجراء صالح، وتعديل رسالة الاستخدام إلى:
```
Usage: python scripts/file.py <create|create-note|create-original|delete> <name>
```
وإضافة شرط لاستدعاء `create_original(name)` عندما يكون الإجراء هو `create-original`.

#### المقارنة مع الدوال الحالية
لتسليط الضوء على الاختلافات والتشابهات، ضع في الاعتبار الجدول التالي الذي يقارن `create_md`، و`create_note`، و`create_original` الجديدة:

| الدالة           | الدليل         | تنسيق اسم الملف               | حقول front matter                     | ملاحظات                                      |
|------------------|-----------------|-------------------------------|-----------------------------------------|--------------------------------------------|
| `create_md`      | `_drafts`      | `{date_str}-{name}-en.md`     | audio, lang, layout, title, translated  | ينشئ ملفات مسودة للمنشورات الإنجليزية      |
| `create_note`    | `notes`        | `{date_str}-{name}-en.md`     | title, lang, layout, audio, translated  | ينشئ ملفات ملاحظات، front matter مشابه   |
| `create_original`| `_posts/en`    | `{date_str}-{name}-en.md`     | audio, lang, layout, title, translated  | أمر جديد، نفس تنسيق المسودات، في المنشورات|

يوضح هذا الجدول أن `create_original` تتماشى مع `create_md` في تنسيق اسم الملف وfront matter، لكنها تستهدف دليل `_posts/en`، متجاوزة مرحلة المسودة.

#### الآثار والاعتبارات المحتملة
بينما يلبي التنفيذ طلب المستخدم، هناك آثار ملحوظة، خاصة مع دالة `delete_md` الحالية:
- **عدم اتساق اسم الملف**: تبحث دالة `delete_md` عن ملفات مسماة `{name}-{lang}.md` في `_posts/lang`، مثال: `_posts/en/test-post-en.md`، بدون تواريخ. ومع ذلك، تنشئ `create_original` ملفات بتواريخ، مثال: `_posts/en/2025-02-27-test-post-en.md`. يعني هذا التناقض أن `delete_md` قد لا تجد الملفات التي أنشأتها `create_original` ما لم يتم تعديلها للتعامل مع أسماء الملفات المؤرّخة، ربما باستخدام `glob.glob` بأنماط مثل `*{-en,-zh,...}.md` لمراعاة التواريخ.
- **هيكل الموقع**: يشير السكريبت إلى إعداد متعدد اللغات مع أدلة فرعية في `_posts` لكل لغة (`en`، `zh`، إلخ)، ويشير غياب التاريخ في نمط `delete_md` إلى أن المنشورات في `_posts` قد لا تعتمد على تواريخ أسماء الملفات للفرز، ربما باستخدام front matter أو بيانات وصفية أخرى. هذا غير معتاد في المواقع القائمة على Jekyll، حيث تحدد التواريخ في أسماء الملفات عادةً تواريخ المنشورات، لكنه يتماشى مع السلوك الحالي للسكريبت.
- **نطاق اللغة**: يركز التنفيذ على الإنجليزية (`lang: en`)، كما يتضح من `create_md` وطلب المستخدم. إذا احتاج المستخدم إلى `create-original` للغات أخرى، فستحتاج الدالة إلى التوسيع، بشكل مشابه لكيفية تعامل `delete_md` مع لغات متعددة.

#### المنطق واتخاذ القرار
كان تفسير "نفس التنسيق مع إنشاء المسودة الافتراضي" حاسمًا. في البداية، كان هناك عدم يقين مما إذا كان هذا يشير إلى تنسيق اسم الملف (بما في ذلك التاريخ) أو front matter. نظرًا لتأكيد المستخدم على "التنسيق" والمثال في `create_md` (الذي يتضمن التاريخ في أسماء الملفات)، تقرر أن `create_original` يجب أن تستخدم `{date_str}-{name}-en.md`، مما يضمن الاتساق. ومع ذلك، يسلط هذا القرار الضوء على صراع محتمل مع `delete_md`، مما يشير إلى أن التعديلات المستقبلية قد تكون ضرورية لإدارة الملفات.

تم استنتاج "original dir" على أنه `_posts/en` بناءً على بنية السكريبت، وخاصة عمليات `delete_md` في `_posts/lang`. يتماشى هذا الافتراض مع إعدادات المدونات النموذجية حيث توجد المنشورات في `_posts`، ويتناسب الدليل الفرعي `/en` مع السياق متعدد اللغات.

#### الخلاصة
تعزز إضافة أمر `create-original` وظائف السكريبت، مما يسمح بإنشاء مباشر لملفات Markdown مؤرّخة في `_posts/en` بنفس front matter الموجود في المسودات. في 27 فبراير 2025، هذا يعني أنه سيتم إنشاء ملفات مثل `2025-02-27-{name}-en.md`، مع الحفاظ على الاتساق مع تنسيقات المسودات. ومع ذلك، يجب أن يدرك المستخدمون عدم تطابق أسماء الملفات المحتمل مع دالة `delete_md`، الأمر الذي قد يتطلب تحديثات لتحقيق التوافق الكامل.

#### الاقتباسات الرئيسية
- [Python os Module Documentation](https://docs.python.org/3/library/os.html)
- [Python datetime Module Documentation](https://docs.python.org/3/library/datetime.html)
- [Jekyll Posts Documentation](https://jekyllrb.com/docs/posts/)