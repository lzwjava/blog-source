---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast:free
title: استضافة النقاط لنصوص باورشيل
translated: true
type: note
---

### استيراد دوال PowerShell باستخدام النقطة من ملفات .ps1

استيراد النقطة (باستخدام عامل التشغيل `.`) يقوم بتحميل سكريبت PowerShell (ملف .ps1) في ذاكرة الجلسة الحالية، مما يجعل دواله ومتغيراته متاحة للاستخدام دون تنفيذ الكود الأساسي في السكريبت. يُعد هذا مفيدًا لاستيراد الوحدات النمطية أو الأكواد قابلة لإعادة الاستخدام.

#### الصيغة الأساسية
شغّل هذا الأمر في جلسة PowerShell الخاصة بك:
```
. المسار\إلى\السكريبت.ps1
```
- استبدل `المسار\إلى\السكريبت.ps1` بمسار الملف الفعلي (استخدم المسارات المطلقة للحصول على موثوقية أعلى).
- مثال: `. C:\Scripts\MyFunctions.ps1` – يقوم هذا بتحميل الدوال من ذلك الملف إلى جلسة العمل الخاصة بك.

#### آلية العمل
- الدوال المعرفة في السكريبت تصبح قابلة للاستدعاء في جلسة العمل الحالية.
- يتم استيراد المتغيرات أيضًا، ولكن فقط إذا لم تكن محدودة بالنطاق المحلي.
- تجنب استخدام استيراد النقطة في سكريبتات الإنتاج؛ استخدم الوحدات النمطية لتحسين التنظيم.
- نصيحة: إذا كان المسار يحتوي على مسافات، ضعه بين علامتي اقتباس: `. "C:\My Scripts\Functions.ps1"`

مشكلة شائعة: إذا كان السكريبت يحتوي على أخطاء في الصيغة، فسيفشل استيراد النقطة مع ظهور خطأ. اختبر ذلك بتشغيل `PowerShell -Command ". .\YourScript.ps1"` من موجه الأوامر.

### استخدام سياسة تنفيذ PowerShell

سياسات التنفيذ هي إعدادات أمان تقيد السكريبتات التي يمكن لـ PowerShell تشغيلها، مما يمنع تنفيذ الأكواد الضارة. وهي خاصة بنطاق محدد (مثل: على مستوى الجهاز، أو خاص بالمستخدم).

#### التحقق من السياسة الحالية
شغّل هذا في PowerShell:
```
Get-ExecutionPolicy
```
- أمثلة على المخرجات: `Restricted` (يمنع جميع السكريبتات)، `AllSigned` (السكريبتات الموقعة فقط)، `RemoteSigned` (السكريبتات البعيدة الموقعة، والموافق على تشغيل السكريبتات المحلية)، أو `Unrestricted`.

#### تعيين السياسة أو تغييرها
استخدم `Set-ExecutionPolicy` (يتطلب صلاحيات مدير الجهاز للتغييرات على مستوى الجهاز):
- مثال للسماح بالسكريبتات المكتوبة محليًا: `Set-ExecutionPolicy RemoteSigned`
- الإجبار دون مطالبات: `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force`
- حسب النطاق: `Set-ExecutionPolicy -ExecutionPolicy AllSigned -Scope CurrentUser` (يؤثر فقط على حساب المستخدم الخاص بك).

#### السياسات الشائعة
- `Restricted`: الإعداد الافتراضي؛ لا يتم تشغيل أي سكريبتات.
- `AllSigned`: يتطلب توقيعات رقمية (آمن ولكنه غير مريح).
- `RemoteSigned`: يوازن بين الأمان — يسمح بالسكريبتات المحلية، ويتطلب توقيع السكريبتات البعيدة.
- `Unrestricted`: يشغّل جميع السكريبتات (محفوف بالمخاطر؛ استخدم بحذر).
- `Bypass`: غير مقيد بالكامل، مخصص للأتمتة.

نصيحة: تنطبق السياسات على جلسات الكونسول، ولكن ليس على ISE أو VS Code ما لم يتم تعيينها هناك. اختبر التغييرات بتشغيل سكريبت تجريبي مثل `Write-Host "Hello"`. للمزيد، راجع وثائق Microsoft: `help about_Execution_Policies`. إذا كنت في بيئة مؤسسة، فقد تتجاوز سياسة المجموعة الإعدادات المحلية.