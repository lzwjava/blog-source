---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-code-fast-1
title: خيار العقدة يؤثر على في إس كود
translated: true
type: note
---

### 1. **توضيح سريع حول الاستعلام المحدث**
شكرًا على التصحيح — علم `--openssl-legacy-provider` هو خيار حقيقي وصالح لوقت تشغيل Node.js (تم تقديمه في Node.js الإصدار v15/v17 اعتمادًا على الإصدار)، على عكس `--legacy-peer-deps` (وهو علم خاص بمثبت npm ولا ينتمي إلى متغير البيئة `NODE_OPTIONS`). يبدو أن سؤالك الآن هو: لماذا يتأثر أحيانًا استخدام الأمر `code .` (أمر واجهة سطر أوامر VS Code لفتح المجلد الحالي في VS Code) بـ `NODE_OPTIONS="--openssl-legacy-provider"`، وما هي الصلة؟

لتلخيص ردي: خيار Node هذا يعالج مشاكل التوافق مع OpenSSL 3.0 في إصدارات Node.js الأحدث، والتي يعتمد عليها VS Code (لأنه مبني على Electron، وهو إطار عمل قائم على Node.js). تعيين هذا الخيار بشكل عام عبر `NODE_OPTIONS` يمكن أن يتسبب في تغييرات في سلوك VS Code، خاصة عند تشغيله من طرفية. سأشرح السبب والكيفية أدناه.

### 2. **ماذا يفعل `--openssl-legacy-provider`؟**
- **الغرض**: في Node.js الإصدار v17+ (وبعض إصادات v15)، تم تحديث OpenSSL إلى الإصدار v3.0، والذي أعلن تقادم بعض خوارزميات التشفير القديمة ومزودي الخدمة (Providers) لأسباب أمنية ولتلبية المعايير الحديثة. علم `--openssl-legacy-provider` يخبر Node.js بتحميل مزود OpenSSL القديم (Legacy)، مما يسمح بالاستمرار في استخدام طرق التشفير القديمة (مثل تجزئات MD5، لأغراض التوافق مع الإصدارات السابقة). بدونه، قد تظهر تطبيقات تعتمد على هذه الطرق القديمة أخطاء مثل `Error: error:0308010C:digital envelope routines::unsupported`.
- **متى يكون مطلوبًا**: يُستخدم عادةً في بيئات التطوير التي تحتوي على مكتبات قديمة، أو أدوات بناء، أو تبعيات لم يتم تحديثها لتتوافق مع OpenSSL 3.0. على سبيل المثال:
  - أطر العمل مثل React (مع تكوينات معينة لـ Webpack).
  - شهادات SSL/TLS قديمة أو مكتبات عميل قديمة.
  - ملحقات أو أدوات في VS Code تتعامل مع تشفير الملفات، المصادقة، أو عمليات البناء.
- **ليس ضروريًا دائمًا**: إنه حل مؤقت. العديد من المشاريع تقوم بتحديث تبعياتها، ولكن إذا كنت تستخدم أدوات قديمة (مثل إصدار قديم من ملحق قائم على Node)، فإن هذا العلم يحافظ على استمرارية العمل.

### 3. **لماذا يتأثر VS Code**
يعمل VS Code على Electron، الذي يضمّن Node.js كبيئة تشغيل. عندما يبدأ VS Code (أو عندما تعمل العمليات الفرعية الخاصة به مثل الملحقات أو الطرفية المدمجة)، فإنه يستخدم Node.js ويرث متغيرات البيئة مثل `NODE_OPTIONS`. إليك ما يمكن أن يحدث:
- **أخطاء متعلقة بالتشفير**: بعض ميزات VS Code أو ملحقاته (مثل خوادم اللغة لـ JavaScript/TypeScript، أو تكاملات Git، أو أدوات التصحيح، أو الملحقات التي تتعامل مع الملفات/بيانات الاعتماد المشفرة) قد تستخدم واجهات برمجة تطبيقات (APIs) تشفير قديمة. إذا لم يتمكن Node.js من الوصول إليها بدون `--openssl-legacy-provider`، فقد ترى:
  - فشل في تحميل الملحقات (مثل "Cannot load certificate" أو "Error: unsupported operation").
  - تعطل عمليات البناء/التصحيح في الطرفية المدمجة.
  - بطء في الأداء أو تحذيرات في أدوات المطور (Help > Toggle Developer Tools).
- **أداء أو عدم استقرار**: تحميل المزود القديم يضيف حملًا طفيفًا، لذا يمكن أن يتسبب في "تأثر" VS Code (مثل بطء طفيف في بدء التشغيل أو زيادة في استخدام الذاكرة إذا تم تمكين المزود دون داع).
- **ليس مشكلة دائمًا**: إذا تم بناء VS Code بإصدار Node لا يحتوي على تشديدات OpenSSL 3.0، أو إذا كانت مشاريعك/ملحقاتك محدثة، فقد لا يفعل هذا الخيار شيئًا أو حتى يتسبب في مشاكل خفية (مثل إجبار وضع العمل القديم عندما تكون الخيارات الحديثة متاحة).

النقطة الأساسية: نواة VS Code ليست "معطلة" بطبيعتها — فهي مصممة لدعم إصدارات Node وبيئات متنوعة — ولكن تجاوزات `NODE_OPTIONS` العامة يمكن أن تتعارض مع بيئة التشغيل المضمنة فيه.

### 4. **كيف يرتبط هذا باستخدام `code .` لفتح مجلد**
- **رابط مباشر**: `code .` يشغل VS Code كعملية فرعية من جلسة طرفيتك. يرث بيئة shell الخاصة بك (بما في ذلك `NODE_OPTIONS`)، لذلك يتم تمرير أي أعلام عامة لوقت تشغيل Node (مثل `--openssl-legacy-provider`) إلى عمليات Node الخاصة بـ VS Code.
  - **لماذا فقط عبر الطرفية؟** إذا نقرت نقرًا مزدوجًا على أيقونة تطبيق VS Code أو استخدمت الواجهة الرسومية لفتح المجلدات، فإنه يبدأ عملية خاصة به دون أن يرث متغيرات بيئة bash/zsh/PowerShell. هذا يعني أن المشكلة قد تظهر فقط عند استخدام `code .` في الطرفية، وليس بخلاف ذلك.
  - **مثال على التدفق**:
    - قمت بتعيين `export NODE_OPTIONS="--openssl-legacy-provider"` في shell الخاص بك (على سبيل المثال، في `~/.bashrc` أو `~/.zshrc`).
    - قمت بتشغيل `code .` في مجلد به أدوات قائمة على Node (مثل مشروع به مكتبات تشفير قديمة).
    - يبدأ VS Code، ولكن عمليات Node الآن (مثل تلك الخاصة بالملحقات) تجبر وضع OpenSSL القديم، مسببة مشاكل توافق أو أخطاء لم تكن لتحدث إذا عمل VS Code بدون هذا العلم.
- **لماذا "أحيانًا"؟** هذا يعتمد على:
  - **إصدار VS Code**: الإصدارات الأقدم (التي تحتوي على Node <17) لن تحتاج إلى هذا، بينما الإصدارات الأحدث (مثل VS Code 1.70+ مع Electron/Node 18+) قد تثير مشاكل بدونه إذا كان لديك تبعيات قديمة.
  - **محتويات مشروعك**: فتح مجلد عادي (بدون ملفات npm/مشروع) قد لا يظهر أي تأثير، ولكن مشروع Node.js به ملحقات تعتمد بشدة على التشفير (مثل ESLint، أو Prettier، أو أدوات التصحيح) يمكن أن يكشف المشكلة.
  - **إعدادات نظام التشغيل/Node**: يعمل على Linux/macOS/Windows، لكن متغيرات البيئة العامة تتصرف بشكل مختلف (مثل PowerShell مقابل Bash).

إذا واجه VS Code عمليات تشفير غير مدعومة بدون هذا العلم، فإنه يسجل أخطاء أو يفشل بشكل خفي — ومن هنا comes "التأثير" عند استخدام `code .`.

### 5. **استكشاف الأخطاء وإصلاحها**
- **اختبار بدون NODE_OPTIONS**: ألغِ تعيينه مؤقتًا (`unset NODE_OPTIONS` أو صدّره كقيمة فارغة) وشغّل `code .` لترى إذا استمرت المشاكل.
- **إصلاح خاص بالمشروع**: أضف `--openssl-legacy-provider` إلى ملف `.nvmrc`، أو `package.json` scripts، أو ملف بيئة محلي بدلاً من تعيينه عالميًا. على سبيل المثال، في VS Code: افتح الطرفية المدمجة وشغّل أوامر Node مع العلم مباشرة.
- **تحديث التبعيات/الملحقات**: تحقق مما إذا كان VS Code/الملحقات تحتاج إلى تحديثات (Help > Check for Updates). العديد من المشاكل تنبع من مكتبات قديمة — قم بترقية Node/npm إذا أمكن.
- **التحقق من الإصدارات**: شغّل `node --version` و `code --version` للتأكد. إذا كنت تستخدم Node 18+، فقد يحل العلم الأخطاء؛ إذا لم يكن كذلك، فقد يكون غير ضروري.
- **السجلات والوضع المفصل**: استخدم `code --verbose .` أو تحقق من أدوات المطور في VS Code للبحث عن أخطاء متعلقة بـ Node/اللعبة.

إذا كان هذا لا يزال غير واضح (أو إذا ظهرت أخطاء)، شارك نظام التشغيل الخاص بك، وإصدارات VS Code/Node، أو رسائل الخطأ المحددة للحصول على نصائح أكثر دقة. وثائق VS Code حول مشاكل وقت التشغيل والتوافق مع Node مفيدة: https://code.visualstudio.com/docs/supporting/troubleshoot.