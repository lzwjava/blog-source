---
audio: false
generated: true
image: false
lang: ar
layout: post
title: منظم المهام المدار بواسطة حاوية جافا إي إي
translated: true
type: note
---

**ManagedScheduledExecutorService** هو مورد من موارد جافا إي (جاكرتا إي) توفره خادم التطبيق (مثل WebSphere أو WebLogic أو WildFly) يسمح لك بجدولة المهام لتشغيلها في المستقبل أو بشكل دوري، على غرار `ScheduledExecutorService` في جافا ستاندرد، ولكن مع **مزايا إدارة الحاوية**:

---

### آلية العمل

* **التكامل مع الحاوية**
  يتم إدارته بواسطة خادم التطبيق، مما يعني أن المهام تُنفَّذ في سياق أمان التطبيق، ومحمل الفئات (classloader)، وحدود المعاملات (transaction boundaries). هذا يتجنب المشاكل الشائعة للخيوط غير المُدارة في جافا إي.

* **إمكانيات الجدولة**
  يمكنك جدولة المهام لـ:

  * التشغيل مرة واحدة بعد تأخير.
  * التشغيل بمعدل ثابت (مثل كل 5 ثوانٍ).
  * التشغيل بتأخير ثابت بين عمليات التنفيذ.

* **إدارة دورة الحياة**
  تهتم الحاوية بدورة حياة مجموعة الخيوط (thread pool) والتنظيف وإدارة الموارد. لا تحتاج إلى إيقافها يدويًا مثل `ExecutorService` العادي.

---

### المهلة (Timeout)

* لا يوجد إعداد واحد "للمهلة" لمجموعة الخيوط نفسها، لكن هناك شيئان ذوا صلة:

  * **مهلة تنفيذ المهمة**: يمكنك تغليف المهام باستخدام `ManagedTaskListener` وتحديد خصائص مثل `ManagedTask.TIMEOUT` (اعتمادًا على دعم البائع). تتيح بعض الخوادم تكوين مهلات افتراضية للمهام بحيث يتم إلغاء المهام المتعطلة بواسطة الحاوية.
  * **مهلة `()future.get`**: كما هو الحال في `ScheduledExecutorService` العادي، يمكنك استخدام `(future.get(timeout, unit` للحد من المدة التي تنتظر فيها النتائج.

لذا فإن "المهلة" عادة ما تكون خاصة بكل مهمة، وليست على مستوى مجموعة الخيوط.

---

### تكوين حجم مجموعة الخيوط

* لكل خادم تطبيق تكوينه الخاص لمجموعة الخيوط الداعمة.
  أمثلة:

  * **WebSphere Liberty / Traditional**: يمكنك تكوين المجموعة في ملف `server.xml` تحت `<managedScheduledExecutorService>` بسمات مثل `corePoolSize` و `maximumPoolSize`.
  * **WebLogic**: يمكنك تكوينه عبر وحدة التحكم الإدارية (Admin Console) أو `weblogic-managed-executor`.
  * **WildFly / JBoss EAP**: يتم تكوينه تحت subsystem EE.

* تتضمن إعدادات مجموعة الخيوط النموذجية:

  * **حجم المجموعة الأساسي (Core pool size)**: الحد الأدنى لعدد الخيوط التي تبقى نشطة.
  * **الحد الأقصى لحجم المجموعة (Maximum pool size)**: أقصى عدد للخيوط المتزامنة.
  * **حجم قائمة الانتظار / سياسة الرفض (Queue size / rejection policy)**: ما يحدث عندما تكون جميع الخيوط مشغولة.
  * **زمن الاستبقاء (Keep-alive time)**: المدة التي تبقى فيها الخيوط الخاملة قبل إطلاقها.

---

✅ **خلاصة القول**:
يعمل `ManagedScheduledExecutorService` مثل برنامج الجدولة في جافا ستاندرد ولكنه مدرك للحاوية (container-aware)، لذا تحصل على خيوط آمنة في تطبيقات جافا إي. عادةً ما تُطبَّق المهلة لكل مهمة (إما عبر واجهة البرمجة أو إعدادات الخادم)، بينما يتم تكوين حجم مجموعة الخيوط (الخيوط الأساسية/القصوى) على مستوى الحاوية، وليس في كود التطبيق الخاص بك.

---

هل تريد مني أن أعرض لك **مثالًا عن snippet تكوين لـ WebSphere Liberty** لحجم مجموعة الخيوط والمهلة؟