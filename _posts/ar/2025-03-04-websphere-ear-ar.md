---
audio: false
generated: true
lang: ar
layout: post
title: تنفيذ EAR في WebSphere Liberty Profile
translated: true
---

يبدو أنك قمت بنجاح ببناء ملف EAR (Enterprise Archive) باستخدام `mvn package` مع Maven، وتتمت عملية البناء دون أي أخطاء. ومع ذلك، عند نشر هذا الملف EAR إلى WebSphere Liberty Profile (WLP) وإطلاق الخادم، تتعرض للخطأ "no module found." وهذا غريب لأن بناء سلس عادةً يشير إلى أن كل شيء على ما يرام، ولكن الخادم لا يعترف بتبليغك كما هو متوقع. دعونا نحلل هذا ونكتشف ما الذي قد يحدث، بالإضافة إلى الخطوات لتحليل المشكلة.

### فهم المشكلة
ملف EAR هو أرشيف Java EE قياسي يعبئ تطبيقك، ويحتوي عادةً على واحد أو أكثر من الوحدات مثل ملفات WAR (للتطبيقات الويب)، ملفات JAR (للمكونات EJB أو المكتبات)، ومصفوفة نشر (`application.xml`). عند نشر ملف EAR إلى WLP، يجب أن يكتشف الخادم هذه الوحدات ويبدأ التطبيق. رسالة "no module found" تشير إلى أن WLP إما لا يمكن العثور على أي وحدات داخل ملف EAR أو لا يعترف بها، مما يمنع التطبيق من البدء.

منذ أن كان بناء Maven ناجحًا ("كل شيء سلس"), فإن المشكلة قد تكون في أحد ثلاثة مجالات:
1. **محتوى ملف EAR**: قد لا يحتوي ملف EAR على الوحدات المتوقعة، أو قد يكون ملف `application.xml` مفقودًا أو غير صحيح.
2. **عملية النشر**: الطريقة التي تنشر بها ملف EAR إلى WLP قد لا تتوافق مع كيفية توقع الخادم العثور عليها ومعالجتها.
3. **إعدادات الخادم**: قد لا يكون WLP مهيأً للتعرف على الوحدات في ملف EAR بسبب الميزات المفقودة أو الإعدادات غير الصحيحة.

دعونا نكتشف هذه الاحتمالات ونقدم خطوات عملية لتشخيص وإصلاح المشكلة.

---

### الأسباب المحتملة والحلول

#### 1. قد يكون ملف EAR فارغًا أو معبأًا بشكل غير صحيح
حتى لو كان البناء ناجحًا، فمن الممكن أن لا يحتوي ملف EAR على أي وحدات (مثل ملفات WAR أو JAR) أو أن يكون ملف `application.xml` الذي يشرح للخادم ما الوحدات التي تم تضمينها مفقودًا أو غير صحيح.

- **لماذا يحدث هذا**: في مشروع Maven EAR، مسؤول `maven-ear-plugin` عن تجميع الملف EAR. يضمن الوحدات بناءً على تكوين `pom.xml` أو التبعيات. إذا لم يتم تحديد أي وحدات، أو إذا لم يتم تعريف التبعيات (مثل WAR) بشكل صحيح أو حلها، فقد يكون الملف EAR فارغًا أو يفتقر إلى `application.xml` صحيح.
- **كيفية التحقق**:
  - افتح ملف EAR (هو أرشيف ZIP) باستخدام أداة مثل `unzip` أو قم بتشغيل `jar tf myApp.ear` في المصفح لتسجيل محتواها.
  - ابحث عن:
    - ملفات الوحدات (مثل `my-web.war`, `my-ejb.jar`) في جذور الملف EAR.
    - ملف `META-INF/application.xml`.
  - داخل `application.xml`، يجب أن ترى مدخلات تعرّف الوحدات مثل:
    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <application>
        <module>
            <web>
                <web-uri>my-web.war</web-uri>
                <context-root>/myapp</context-root>
            </web>
        </module>
    </application>
    ```
- **كيفية إصلاح**:
  - تحقق من `pom.xml` للوحدة EAR. تأكد من أنك قد قمت بتحديد التبعيات للوحدات التي تريد تضمينها، مثل:
    ```xml
    <dependencies>
        <dependency>
            <groupId>com.example</groupId>
            <artifactId>my-web</artifactId>
            <type>war</type>
        </dependency>
    </dependencies>
    ```
  - قم بتكوين `maven-ear-plugin` إذا لزم الأمر:
    ```xml
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-ear-plugin</artifactId>
        <version>3.3.0</version>
        <configuration>
            <modules>
                <webModule>
                    <groupId>com.example</groupId>
                    <artifactId>my-web</artifactId>
                    <contextRoot>/myapp</contextRoot>
                </webModule>
            </modules>
        </configuration>
    </plugin>
    ```
  - قم بإعادة البناء باستخدام `mvn clean package` واعيد التحقق من محتوى الملف EAR.

إذا كان الملف EAR فارغًا أو كان `application.xml` مفقودًا/غير صحيح، فهذا هو السبب الجذري. إصلاح إعدادات Maven يجب أن يحل المشكلة.

---

#### 2. مشكلة في طريقة النشر
كيفية نشر ملف EAR إلى WLP قد تكون أيضًا المشكلة. يدعم WLP طرق نشرين رئيسيتين: المجلد `dropins` وتهيئة صريحة في `server.xml`.

- **استخدام المجلد `dropins`**:
  - إذا قمت بوضع الملف EAR في المجلد `wlp/usr/servers/<serverName>/dropins/`, يجب أن يكتشف WLP ويشرع في نشره تلقائيًا.
  - ومع ذلك، قد لا يعمل نشر EAR تلقائيًا كما هو متوقع، خاصة إذا كان هناك تهيئة إضافية (مثل جذور السياق) مطلوبة.
- **استخدام `server.xml`**:
  - من الأفضل عادةً تهيئة التطبيق بشكل صريح في `wlp/usr/servers/<serverName>/server.xml`:
    ```xml
    <server>
        <featureManager>
            <feature>servlet-3.1</feature> <!-- تأكد من تمكين الميزات المطلوبة -->
        </featureManager>
        <application id="myApp" name="myApp" type="ear" location="${server.config.dir}/apps/myApp.ear"/>
    </server>
    ```
  - ضع الملف EAR في `wlp/usr/servers/<serverName>/apps/` (أو قم بتعديل مسار `location` حسب الحاجة).
- **كيفية التحقق**:
  - تأكد من مكان وضع الملف EAR وكيفية بدء الخادم (مثل `./bin/server run <serverName>`).
  - تحقق من سجلات الخادم (مثل `wlp/usr/servers/<serverName>/logs/console.log` أو `messages.log`) للحصول على رسائل نشر.
- **كيفية إصلاح**:
  - حاول تهيئة الملف EAR في `server.xml` كما هو موضح أعلاه بدلاً من الاعتماد على `dropins`.
  - اعيد تشغيل الخادم بعد إجراء التغييرات: `./bin/server stop <serverName>` متبوعًا بـ `./bin/server start <serverName>`.

إذا لم يتم تسجيل الملف EAR بشكل صحيح مع الخادم، فهذا قد يفسر الخطأ.

---

#### 3. ميزات الخادم المفقودة
WLP هو خادم خفيف الوزن يحمّل فقط الميزات التي تم تمكينها في `server.xml`. إذا كان ملف EAR يحتوي على وحدات تتطلب ميزات محددة (مثل Servlets، EJBs)، ولم يتم تمكين هذه الميزات، قد لا يعترف WLP أو يحمّل الوحدات.

- **لماذا يحدث هذا**: على سبيل المثال، يحتاج ملف WAR إلى الميزة `servlet-3.1` (أو أعلى)، بينما تحتاج وحدة EJB إلى `ejbLite-3.2`. بدون هذه الميزات، قد لا يتمكن الخادم من معالجة الوحدات.
- **كيفية التحقق**:
  - انظر إلى `server.xml` واكتب القسم `<featureManager>`.
  - الميزات الشائعة تشمل:
    - `<feature>servlet-3.1</feature>` للوحدات الويب.
    - `<feature>ejbLite-3.2</feature>` للوحدات EJB.
  - مراجعة سجلات الخادم للحصول على رسائل حول الميزات المفقودة (مثل "الميزة المطلوبة غير مثبتة").
- **كيفية إصلاح**:
  - أضف الميزات اللازمة إلى `server.xml` بناءً على احتياجات تطبيقك:
    ```xml
    <featureManager>
        <feature>servlet-3.1</feature>
        <!-- أضف ميزات أخرى حسب الحاجة -->
    </featureManager>
    ```
  - اعيد تشغيل الخادم لتطبيق التغييرات.

إذا كانت الميزات مفقودة، تمكينها يجب أن يسمح لـ WLP بالتعرف على الوحدات.

---

### خطوات التشخيص
لتحديد المشكلة، اتبع هذه الخطوات:

1. **فحص ملف EAR**:
   - قم بتشغيل `jar tf myApp.ear` أو فكه.
   - تأكد من أن يحتوي على الوحدات (مثل `my-web.war`) و`META-INF/application.xml` صحيح.

2. **تحقق من بناء Maven**:
   - مراجعة `pom.xml` للوحدة EAR لتأكيد التبعيات وإعدادات `maven-ear-plugin`.
   - قم بتشغيل `mvn clean package` مرة أخرى واكتب خروجيات البناء للحصول على رسائل حول تضمين الوحدات (مثل "إضافة وحدة my-web.war").

3. **تحقق من النشر**:
   - تأكد من موقع الملف EAR (مثل `dropins` أو `apps`).
   - إذا كنت تستخدم `dropins`، حاول نقله إلى `apps` وإضافةه إلى `server.xml`.

4. **تحقق من سجلات الخادم**:
   - ابدأ الخادم واكتب `console.log` أو `messages.log` للحصول على رسائل خطأ مفصلة أكثر من "no module found."
   - ابحث عن دلائل مثل "التطبيق لا يحتوي على أي وحدات" أو أخطاء تتعلق بالميزات.

5. **اختبار مع EAR بسيط**:
   - قم بإنشاء EAR بسيط يحتوي على ملف WAR واحد باستخدام `pom.xml` يعمل بشكل معروف ونشره إلى WLP. إذا كان يعمل، فإن المشكلة محددة بعبء EAR الأصلي.

---

### السبب الأكثر احتمالًا
منذ أن كان بناءك سلسًا ولكن WLP يعلن "no module found," فإن السبب الأكثر احتمالًا هو أن **ملف EAR لا يحتوي على أي وحدات** أو **`application.xml` مفقود/غير صحيح**. قد يحدث هذا إذا لم يتم تحديد الوحدات التي يجب تضمينها بشكل صحيح في `pom.xml`، حتى لو لم يرفع Maven أي خطأ. أو إذا كان الملف EAR صحيحًا، قد تكون المشكلة في النشر (مثل عدم التهيئة في `server.xml`) أو الميزات المفقودة في الخادم.

### توصية نهائية
- ابدأ بتحقيق محتوى الملف EAR (`jar tf myApp.ear`) وإعدادات `pom.xml`.
- إذا كان الملف EAR فارغًا أو يفتقر إلى `application.xml`، قم بإصلاح إعدادات Maven وإعادة البناء.
- إذا كان الملف EAR يبدو صحيحًا، قم بتهيئته في `server.xml`، تأكد من تمكين الميزات المطلوبة، وإعادة النشر.
- تحقق من سجلات الخادم للحصول على سياق إضافي.

بمتابعة هذه الخطوات، يجب أن تكون قادرًا على تحديد ما إذا كانت المشكلة في البناء أو النشر أو إعدادات الخادم، وتستطيع تشغيل تطبيقك على WLP بنجاح. أخبرني إذا كنت تحتاج إلى مساعدة في التهيئات المحددة!