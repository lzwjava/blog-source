---
audio: false
generated: true
lang: ar
layout: post
title: موقع حي في تليجرام
translated: true
type: note
---

أنت تلاحظ نمطًا شائعًا مع تحديثات الموقع المباشر في Telegram، واستنادًا إلى الطوابع الزمنية لـ `edit_date`، يبدو بوضوح أنه يمكن استقبال تحديثات الموقع المباشر بكثافة عالية، ربما كل ثانية أو على فترات زمنية قصيرة جدًا.

إليك السبب وما يشير إليه هذا النمط:

**ملاحظة النمط:**

بالنظر إلى JSON الذي قدمته، تحديدًا كائنات `edited_message` مع حقل `location` وقيمة `edit_date` المتزايدة:

* **`update_id`: 263947386** - `edit_date`: 1749371583
* **`update_id`: 263947388** - `edit_date`: 1749371587 (بعد 4 ثوانٍ من السابق)
* **`update_id`: 263947389** - `edit_date`: 1749371591 (بعد 4 ثوانٍ من السابق)
* **`update_id`: 263947390** - `edit_date`: 1749371595 (بعد 4 ثوانٍ من السابق)
* **`update_id`: 263947391** - `edit_date`: 1749371602 (بعد 7 ثوانٍ من السابق)
* **`update_id`: 263947392** - `edit_date`: 1749371614 (بعد 12 ثانية من السابق)
* **`update_id`: 263947393** - `edit_date`: 1749371624 (بعد 10 ثوانٍ من السابق)
* **`update_id`: 263947394** - `edit_date`: 1749371628 (بعد 4 ثوانٍ من السابق)

وهناك أيضًا كائن `message`:

* **`update_id`: 263947387** - `date`: 1749371586 (هذه رسالة جديدة، وليست تحديث موقع مباشر)

**هل هذا يعني أنه سيتم استقبال رسائل الموقع المباشر كل ثانية؟**

**ليس بالضرورة كل ثانية بالضبط، ولكن بشكل متكرر جدًا، غالبًا بفواصل زمنية أقل من 5 ثوانٍ، خاصة عندما يكون هناك حركة أو حاجة لتحديثات بدقة أعلى.**

إليك السبب:

1.  **طبيعة الموقع المباشر:** تم تصميم الموقع المباشر لتقديم تحديثات شبه فورية لموقع المستخدم. لكي يكون هذا "مباشرًا"، يجب أن تكون التحديثات متكررة.
2.  **`edited_message`:** على عكس الرسائل العادية، يتم إرسال تحديثات الموقع المباشر كتحديثات `edited_message` لرسالة واحدة موجودة. هذا يعني أن الرسالة الأصلية التي تحتوي على الموقع المباشر يتم تحديثها باستمرار بإحداثيات جديدة.
3.  **حقل `edit_date`:** الطابع الزمني `edit_date` في كائن `edited_message` يوضح بوضوح أن هذه التحديثات تحدث على فترات متقاربة جدًا.
4.  **العوامل المؤثرة على التكرار:**
    * **الحركة:** إذا كان المستخدم يتحرك، فستكون التحديثات عادةً أكثر تكرارًا لتعكس الموقع المتغير بدقة.
    * **`live_period`:** يشير حقل `live_period` (على سبيل المثال، 28800 ثانية، أي 8 ساعات) إلى المدة التي سيستمر فيها مشاركة الموقع المباشر. خلال هذه الفترة، ستحدث التحديثات حسب الحاجة.
    * **الدقة الأفقية:** قد تؤدي التغييرات في `horizontal_accuracy` إلى触发 التحديثات أيضًا، حيث يقوم الجهاز بتنقية تقدير موقعه.
    * **ظروف الشبكة:** بينما تحاول Telegram إرسال التحديثات على الفور، فإن زمن الوصول في الشبكة يمكن أن يؤدي إلى اختلافات طفيفة في التوقيت الدقيق لاستلامك لها.
    * **المنطق الداخلي لـ Telegram:** تمتلك Telegram خوارزمياتها الداخلية لتحديد التكرار الأمثل لإرسال التحديثات بناءً على نشاط المستخدم، وبطارية الجهاز، وظروف الشبكة. إنها ليست قاعدة ثابتة "كل ثانية" ولكنها قاعدة تكيفية.

**باختصار:**

النمط الذي تراه مع تغير `edit_date` بسرعة لكائن `edited_message` الذي يحتوي على `location` يشير بقوة إلى أن Telegram يرسل تحديثات الموقع المباشر بشكل متكرر جدًا. بينما قد لا يكون التوقيت بالضبط كل ثانية، فإن الفواصل الزمنية لبضع ثوانٍ (على سبيل المثال، 1-5 ثوانٍ، أو أطول قليلاً إذا كان المستخدم ثابتًا) هي النمط المعتاد للموقع المباشر. قد يكون الفجوة الأطول العرضية بسبب ظروف الشبكة، أو كون المستخدم ثابتًا، أو التحسين الداخلي لـ Telegram.