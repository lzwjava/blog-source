---
audio: false
generated: true
lang: ar
layout: post
title: تصحيح الأخطاء عن بُعد المدمج في IntelliJ IDEA
translated: true
type: note
---

للاتصال بـ IntelliJ IDEA بمنفذ تصحيح الأخطاء (debug port) لخادم WebSphere Liberty الذي بدأته باستخدام `server debug default`، دون استخدام إضافة WebSphere Liberty، يمكنك الاستفادة من ميزة التصحيح عن بُعد المدمجة في IntelliJ IDEA. تعمل هذه الطريقة لأن WebSphere Liberty، عند بدئه في وضع التصحيح، يعرض منفذ تصحيح (عادةً 7777 افتراضيًا) يمكن لأي مصحح أخطاء JVM، بما في ذلك IntelliJ IDEA، الاتصال به. فيما يلي الخطوات التفصيلية لتحقيق ذلك:

---

### الخطوة 1: بدء خادم WebSphere Liberty في وضع التصحيح
عند تشغيل `server debug default` (بافتراض أن "default" هو اسم خادمك؛ استبدله باسم الخادم الفعلي إذا كان مختلفًا)، يبدأ WebSphere Liberty مع تمكين التصحيح. افتراضيًا، تضبط هذه الأمر الخادم على الاستماع لاتصالات التصحيح على المنفذ **7777**.

- **الأمر**:
  ```bash
  server debug default
  ```
- **ما يفعله**: يبدأ هذا الأمر خادم "default" في وضع التصحيح، مما يمكّن خيارات تصحيح JVM تلقائيًا (مثل `-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=7777`).
- **التحقق**: بعد تشغيل الأمر، تحقق من ناتج وحدة التحكم للخادم أو السجلات (مثل `messages.log`) لتأكيد أن الخادم يستمع على منفذ التصحيح. ابحث عن رسالة تشير إلى منفذ التصحيح (عادةً 7777 ما لم يتم تجاوزه أو عدم توفره).

---

### الخطوة 2: تأكيد منفذ التصحيح
منفذ التصحيح الافتراضي لـ WebSphere Liberty هو **7777**. ومع ذلك، إذا كان هذا المنفذ قيد الاستخدام أو تم تخصيصه:
- تحقق من ناتج وحدة التحكم بعد بدء الخادم. قد يقول شيئًا مثل "Listening for debugger connections on port 7777."
- إذا اختلف المنفذ (على سبيل المثال، تم تعيين منفذ عشوائي بسبب تعارض)، لاحظ رقم المنفذ الفعلي للاستخدام في IntelliJ IDEA.

في هذا الدليل، سنفترض المنفذ الافتراضي **7777** ما لم يشير إعدادك إلى خلاف ذلك.

---

### الخطوة 3: تكوين التصحيح عن بُعد في IntelliJ IDEA
تتيح لك ميزة التصحيح عن بُعد في IntelliJ IDEA الاتصال بـ JVM الخاص بالخادم دون الحاجة إلى إضافة WebSphere محددة. إليك طريقة إعداده:

1. **فتح تكوينات التشغيل/التصحيح (Run/Debug Configurations)**:
   - في IntelliJ IDEA، انتقل إلى القائمة العلوية وحدد **Run > Edit Configurations**.

2. **إضافة تكوين تصحيح عن بُعد جديد (Remote Debug Configuration)**:
   - انقر فوق زر **+** (أو "Add New Configuration") في الزاوية العلوية اليسرى.
   - من القائمة، حدد **Remote JVM Debug** (قد يظهر باسم "Remote" فقط اعتمادًا على إصدار IntelliJ الخاص بك).

3. **تعيين تفاصيل التكوين**:
   - **الاسم (Name)**: أعطه اسمًا ذا معنى، مثل "WebSphere Liberty Debug."
   - **المضيف (Host)**: عيّنه إلى `localhost` (بافتراض أن الخادم يعمل على نفس الجهاز الذي يعمل عليه IntelliJ IDEA؛ استخدم عنوان IP الخاص بالخادم إذا كان بعيدًا).
   - **المنفذ (Port)**: عيّنه إلى `7777` (أو منفذ التصحيح الفعلي إذا كان مختلفًا).
   - **النقل (Transport)**: تأكد من تعيينه إلى **Socket**.
   - **وضع المصحح (Debugger Mode)**: اختر **Attach** (هذا يخبر IntelliJ بالاتصال بـ JVM قيد التشغيل بالفعل).
   - اترك الإعدادات الأخرى (مثل "Command line arguments for remote JVM") افتراضية ما لم تكن بحاجة إلى خيارات JVM محددة.

4. **حفظ التكوين**:
   - انقر فوق **Apply** ثم **OK** للحفظ.

---

### الخطوة 4: بدء التصحيح
مع تشغيل الخادم في وضع التصحيح وإعداد التكوين:
- انتقل إلى **Run > Debug** (أو انقر على أيقونة الخنفساء) وحدد التكوين الجديد الخاص بك (مثل "WebSphere Liberty Debug").
- ستحاول IntelliJ IDEA الاتصال بـ JVM الخاص بالخادم على المضيف والمنفذ المحددين.
- إذا نجح الاتصال، سترى رسالة في نافذة التصحيح (Debug window) مثل "Connected to the target VM, address: 'localhost:7777'."

---

### الخطوة 5: تصحيح تطبيقك
- **تعيين نقاط التوقف (Set Breakpoints)**: في الكود المصدري الخاص بك، انقر في الهامش بجوار أرقام الأسطر لإضافة نقاط توقف حيث تريد إيقاف التنفيذ.
- **تشغيل التنفيذ (Trigger Execution)**: تفاعل مع تطبيقك (على سبيل المثال، أرسل طلبًا إلى الخادم) للوصول إلى نقاط التوقف.
- **التصحيح (Debug)**: بمجرد الوصول إلى نقطة توقف، استخدم أدوات التصحيح في IntelliJ (التنفيذ خطوة بخطوة، الدخول إلى الدالة، الاستئناف، إلخ) لفحص المتغيرات والتحكم في التنفيذ.

---

### ملاحظات إضافية
- **الخادم المحلي مقابل البعيد (Local vs. Remote Server)**: إذا كان WebSphere Liberty يعمل على جهاز مختلف، استبدل `localhost` بعنوان IP الخاص بالخادم في تكوين التصحيح عن بُعد. تأكد من أن منفذ التصحيح (مثل 7777) مفتوح وغير محظور بواسطة جدار الحماية.
- **تعارض المنافذ (Port Conflicts)**: إذا كان المنفذ 7777 غير متوفر عند بدء الخادم، فقد يختار WebSphere Liberty منفذًا عشوائيًا. تحقق من ناتج الخادم لتأكيد المنفذ وقم بتحديث تكوين IntelliJ وفقًا لذلك.
- **لا حاجة لإضافة (No Plugin Needed)**: تستخدم هذه الطريقة ميزة التصحيح عن بُعد القياسية في IntelliJ IDEA، لذلك لا حاجة إلى إضافة WebSphere Liberty.

---

### الملخص
من خلال بدء خادم WebSphere Liberty الخاص بك باستخدام `server debug default` (والذي يمكّن التصحيح على المنفذ 7777 افتراضيًا) وتكوين إعداد تصحيح عن بُعد في IntelliJ IDEA، يمكنك الاتصال بمنفذ تصحيح الخادم دون إضافة WebSphere Liberty. هذا يمنحك قدرات تصحيح كاملة — نقاط التوقف، فحص المتغيرات، والتنفيذ خطوة بخطوة — مباشرة داخل IntelliJ IDEA.

---

إن تشغيل وتصحيح تطبيقات WebSphere Liberty في IntelliJ IDEA دون إضافة Liberty Tools المخصصة يمكن تحقيقه من خلال إعداد وقت تشغيل Liberty يدويًا وتكوين IntelliJ IDEA للتصحيح عن بُعد وتنفيذ الأدوات الخارجية. تتطلب هذه الطريقة بعض الخطوات اليدوية مقارنة باستخدام الإضافة المدمجة، لكنها توفر الوظائف اللازمة لتطوير تطبيقات Liberty الخاصة بك واستكشاف أخطائها وإصلاحها.

فيما يلي تفصيل للعملية:

**1. الحصول على وتثبيت وقت تشغيل WebSphere Liberty (WebSphere Liberty Runtime):**

نظرًا لأنك لا تملك الإضافة لإدارة وقت التشغيل نيابة عنك، ستحتاج إلى تنزيل وتثبيت وقت تشغيل WebSphere Liberty يدويًا. يمكنك الحصول على وقت التشغيل من الموقع الرسمي لـ IBM أو من خلال طرق توزيع أخرى مثل Maven أو Gradle إذا كنت تدير مشروعك باستخدام هذه الأدوات.

عادةً، يتضمن التثبيت اليدوي تنزيل ملف ZIP أو JAR واستخراجه إلى دليل على نظامك. سيكون هذا الدليل هو المسار الرئيسي لتثبيت Liberty (`<LIBERTY_HOME>`).

**2. تكوين خادم Liberty للتصحيح:**

لتصحيح تطبيقك، تحتاج إلى بدء خادم Liberty مع تمكين التصحيح. يتم ذلك عن طريق إضافة خيارات JVM محددة عند بدء الخادم. تخبر هذه الخيارات آلة Java الافتراضية (JVM) بالاستماع لاتصال مصحح الأخطاء على منفذ محدد.

حدد موقع ملف `jvm.options` في دليل تكوين خادم Liberty الخاص بك (`<LIBERTY_HOME>/usr/servers/<your_server_name>/`). إذا لم يكن هذا الملف موجودًا، يمكنك إنشاؤه. أضف السطر التالي إلى ملف `jvm.options`:

```
-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005
```

  * `-agentlib:jdwp`: يحمّل مكتبة بروتوكول تصحيح Java (JDWP).
  * `transport=dt_socket`: يحدد أن المصحح سيتصل باستخدام مأخذ (socket).
  * `server=y`: يشير إلى أن JVM ستعمل كخادم، تستمع لاتصال المصحح.
  * `suspend=n`: يحدد أن JVM لا يجب أن تنتظر اتصال المصحح قبل البدء. يمكنك تغيير هذا إلى `suspend=y` إذا كنت بحاجة إلى تصحيح الكود الذي يعمل أثناء بدء تشغيل الخادم.
  * `address=5005`: يضبط رقم المنفذ الذي سيتصل به المصحح. يمكنك تغيير هذا إلى أي منفذ متاح.

**3. تكوين IntelliJ IDEA لتشغيل Liberty:**

يمكنك استخدام تكوين "الأدوات الخارجية (External Tools)" في IntelliJ IDEA لبدء خادم Liberty من داخل بيئة التطوير.

  * انتقل إلى `File` \> `Settings` (أو `IntelliJ IDEA` \> `Preferences` على macOS).
  * انتقل إلى `Tools` \> `External Tools`.
  * انقر على أيقونة `+` لإضافة أداة خارجية جديدة.
  * قم بتكوين الأداة بالتفاصيل التالية:
      * **الاسم (Name):** أعطها اسمًا وصفيًا، مثل "Start Liberty Server".
      * **البرنامج (Program):** انتقل إلى سكريبت خادم Liberty. سيكون هذا عادةً `<LIBERTY_HOME>/bin/server` لنظامي Linux/macOS أو `<LIBERTY_HOME>\bin\server.bat` لنظام Windows.
      * **الوسائط (Arguments):** أضف الوسائط لبدء مثيل الخادم المحدد الخاص بك. هذا عادةً `start <your_server_name>`، حيث `<your_server_name>` هو اسم دليل الخادم الخاص بك في `<LIBERTY_HOME>/usr/servers/`.
      * **دليل العمل (Working directory):** عيّن هذا إلى `<LIBERTY_HOME>/bin`.

الآن يمكنك بدء خادم Liberty بالذهاب إلى `Tools` \> `External Tools` وتحديد الأداة التي قمت بتكوينها للتو.

**4. تكوين IntelliJ IDEA للتصحيح عن بُعد:**

لتصحيح تطبيقك الذي يعمل على خادم Liberty الذي بدأته يدويًا، ستستخدم تكوين "Remote JVM Debug" في IntelliJ IDEA.

  * انتقل إلى `Run` \> `Edit Configurations`.
  * انقر على أيقونة `+` وحدد `Remote JVM Debug`.
  * قم بتكوين الإعدادات:
      * **الاسم (Name):** أعطها اسمًا وصفيًا، مثل "Debug Liberty Server".
      * **وضع المصحح (Debugger mode):** اختر `Attach to remote JVM`.
      * **المضيف (Host):** أدخل `localhost` (أو عنوان IP للجهاز الذي يعمل عليه Liberty إذا لم يكن على جهازك المحلي).
      * **المنفذ (Port):** أدخل رقم المنفذ الذي قمت بتكوينه في ملف `jvm.options` (على سبيل المثال، `5005`).
      * **Use module classpath of:** حدد الوحدة النمطية (module) في مشروع IntelliJ IDEA الخاص بك التي تحتوي على كود تطبيق Liberty الخاص بك. هذا يساعد IntelliJ IDEA في تعيين الكود قيد التشغيل إلى ملفاتك المصدرية لأغراض التصحيح.

**5. التشغيل والتصحيح:**

1.  ابدأ خادم Liberty باستخدام تكوين "الأدوات الخارجية (External Tools)" الذي أنشأته في IntelliJ IDEA.
2.  انتظر حتى يبدأ الخادم ويشير إلى أنه يستمع للمصحح على المنفذ المُكون (يجب أن ترى رسالة في ناتج وحدة تحكم الخادم).
3.  عيّن نقاط التوقف في كود تطبيقك داخل IntelliJ IDEA.
4.  انتقل إلى `Run` \> `Debug` وحدد تكوين "Debug Liberty Server" الذي أنشأته.

ستحاول IntelliJ IDEA الاتصال بخادم Liberty قيد التشغيل على المنفذ المحدد. بمجرد الاتصال، يمكنك استخدام جميع ميزات التصحيح في IntelliJ IDEA، مثل التنفيذ خطوة بخطوة عبر الكود، وفحص المتغيرات، وتقييم التعبيرات.

باتباع هذه الخطوات، يمكنك تشغيل وتصحيح تطبيقات WebSphere Liberty الخاصة بك بشكل فعال في IntelliJ IDEA دون الاعتماد على إضافة Liberty Tools المخصصة، مما يمنحك تحكمًا مباشرًا في دورة حياة الخادم وعملية التصحيح.