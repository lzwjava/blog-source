---
audio: false
generated: true
image: false
lang: ar
layout: post
title: جلسة الربيع وجلسة الجافا وكشف الخادم
translated: true
type: note
---

لنقسم هذا إلى جزأين: كيفية عمل **Spring Session/JSESSIONID**، وكيفية معرفة ما إذا كان Spring يعمل على **Tomcat أو Netty**.

---

## 1. كيفية عمل Spring Session و `JSESSIONID`

* **JSESSIONID** هو معرف جلسة HTTP القياسي المستخدم من قبل حاويات السيرفليت (Tomcat، Jetty، Undertow، إلخ).
* عندما يقوم العميل بأول طلب يتطلب جلسة، تقوم الحاوية (أو Spring Session إذا كنت تستخدمه) بإنشاء معرف جلسة عشوائي، وتخزن بيانات الجلسة على الخادم، وترسل المعرف مرة أخرى إلى العميل في رأس `Set-Cookie`.
* يدرج العميل كوكي `JSESSIONID` هذا في الطلبات اللاحقة، مما يسمح للخادم بالعثور على الجلسة الصحيحة.
* افتراضيًا، يتم تخزين بيانات الجلسة **في ذاكرة حاوية السيرفليت**. على سبيل المثال:

  * يقوم Tomcat بتخزين الجلسات في الذاكرة (ما لم تقم بتكوين الثبات).
  * إذا كنت تستخدم **Spring Session**، يمكن تخزين الجلسة خارجيًا (في Redis، أو JDBC، أو Hazelcast، إلخ)، مع الاستمرار في استخدام كوكي `JSESSIONID` لتحديد المستخدمين.
* تعتمد Spring Security والميزات الأخرى في Spring على آلية الجلسة هذه لإدارة المصادقة والحالة.

---

## 2. كيفية معرفة ما إذا كان Spring يستخدم Tomcat أم Netty

يمكن لـ Spring Boot أن يعمل مع خوادم مضمنة مختلفة:

* **Tomcat** (الافتراضي لـ spring-boot-starter-web)
* **Jetty** (إذا قمت بتبديل التبعيات)
* **Undertow** (حاوية سيرفليت بديلة)
* **Netty** (يستخدم من قبل Spring WebFlux، ولا يعتمد على السيرفليت)

### طرق التحقق:

1. **انظر إلى التبعيات الخاصة بك**

   * إذا كان ملف `pom.xml` أو `build.gradle` الخاص بك يتضمن `spring-boot-starter-web`، فإنه يستخدم **Tomcat** افتراضيًا.
   * إذا كان يتضمن `spring-boot-starter-webflux`، فإنه يستخدم **Netty** افتراضيًا.

2. **تحقق من سجلات بدء التشغيل**

   * عند بدء تشغيل التطبيق، يقوم Spring Boot بتسجيل الخادم المضمن.
   * مثال (Tomcat):

     ```
     Tomcat started on port(s): 8080 (http)
     ```
   * مثال (Netty):

     ```
     Netty started on port(s): 8080
     ```

3. **تحقق من فئات وقت التشغيل**

   * في الكود أو عبر أداة actuator، تحقق من فئات الخادم التي تم تحميلها.
   * تبدأ فئات Tomcat بـ `org.apache.catalina.`
   * تبدأ فئات Netty بـ `io.netty.`

---

✅ **الخلاصة**:

* `JSESSIONID` هو مجرد كوكي يشير إلى جلسة على جانب الخادم، يتم إدارتها بواسطة Tomcat (افتراضي) أو بواسطة Spring Session (Redis/DB).
* يمكنك معرفة ما إذا كان Spring يستخدم **Tomcat أم Netty** من خلال التحقق من التبعيات، أو سجلات بدء التشغيل، أو فئات وقت التشغيل.

---

هل تريد مني أيضًا شرح **كيف تختلف معالجة الجلسة بين Spring MVC (Tomcat) و Spring WebFlux (Netty)**؟ هذا هو المكان الذي يكون فيه التمييز أكثر أهمية.