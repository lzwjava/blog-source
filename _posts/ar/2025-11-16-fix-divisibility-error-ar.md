---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: ุฅุตูุงุญ ุฎุทุฃ ูุงุจููุฉ ุชูุณูู ุฅุนุฏุงุฏุงุช ุงููููุฐุฌ
translated: true
type: note
---

ุงูุฎุทุฃ ูุงุถุญ ุฌุฏูุง:

```python
assert config.n_embd % config.n_head == 0
```

ูุฐุง ูุนูู ุฃู **n_embd ูุฌุจ ุฃู ูููู ูุงุจูุงู ูููุณูุฉ ุนูู n_head ุจุงูุชุณุงูู** (ูุฃู ูู ุฑุฃุณ ุงูุชุจุงู ูุญุตู ุนูู `n_embd // n_head` ุจูุนุฏูุง).

ุฃูุช ุชุณุชุฎุฏู ุฅุนุฏุงุฏุงุช ุงููููุฐุฌ ูุฐู (ุนูู ุงูุฃุฑุฌุญ ุชูู ุงูุชู ุฃุนุทูุชู ุฅูุงูุง ุณุงุจููุง):

```python
n_layer = 12
n_head  = 12
n_embd  = 512
```

512 รท 12 = 42.666โฆ โ ููุณ ุนุฏุฏูุง ุตุญูุญูุง โ ุชุนุทู.

### ุงูุฅุตูุงุญ: ุงุฎุชุฑ n_embd ูุงุจู ูููุณูุฉ ุนูู n_head

ุฅููู **ุงูุชุฑููุจุงุช ุงูุขููุฉ ูุงููุฌุฑุจุฉ** ุงูุชู ุชุนูู ุจุดูู ูุซุงูู ุนูู ูุงุฑุช 4070 ุณุนุฉ 12 ุฌูุฌุงุจุงูุช ูุน ููู FineWeb Parquet ููุฑุฏ:

#### ุงูุฎูุงุฑ 1 โ ููุตู ุจู (125 ููููู ูุนุงููุ ุฃูุถู ุชูุงุฒู ุจูู ุงูุฌูุฏุฉ ูุงูุณุฑุนุฉ)
```python
n_layer = 12
n_head  = 12
n_embd  = 576        # โ 576 รท 12 = 48 ุชูุงููุง
```
โ ~125 ููููู ูุนุงููุ ูุง ูุฒุงู ูุชุณุน ุจุณูููุฉ ูู ~10.5 ุฌูุฌุงุจุงูุช VRAM ูุน batch_size=16 + grad_acc=32 + block_size=1024

#### ุงูุฎูุงุฑ 2 โ ุจูุนุฏ ุฑุฃุณ ุฃูุจุฑ ููููุงู (130 ููููู ูุนุงูู)
```python
n_layer = 12
n_head  = 12
n_embd  = 720        # 720 รท 12 = 60
```

#### ุงูุฎูุงุฑ 3 โ ุขูู ุฌุฏูุง ูุดุงุฆุน (115 ููููู ูุนุงูู)
```python
n_layer = 12
n_head  = 12
n_embd  = 480        # 480 รท 12 = 40
```

#### ุงูุฎูุงุฑ 4 โ ุฅุฐุง ููุช ุชุฑูุฏ ุงูุงุญุชูุงุธ ุจู n_embd=512 (ุนูู ุบุฑุงุฑ GPT-2 ุงูุฃุตูู)
```python
n_layer = 12
n_head  = 8          # 512 รท 8 = 64
# ุฃู
n_head  = 16         # 512 รท 16 = 32
```

### ุฅุตูุงุญ ุณุฑูุน: ููุท ุบููุฑ ุฅุนุฏุงุฏุงุชู ุฅูู ูุฐุง (ุฌุงูุฒ ูููุณุฎ ูุงููุตู)

```python
# ุงููููุฐุฌ โ 12 ุทุจูุฉุ ~125 ููููู ูุนุงููุ ูุถููู ุงูุนูู
n_layer = 12
n_head  = 12
n_embd  = 576        # โ ูุฐุง ูู ุงูุณุทุฑ ุงููุญูุฏ ุงูุฐู ุชุญุชุงุฌ ูุชุบููุฑู
dropout = 0.0
```

ูู ุดูุก ุขุฎุฑ (batch_size=16, grad_acc=32, block_size=1024, ุฅูุฎ) ูุจูู ุชูุงููุง ููุง ูู.

ุจุนุฏ ุชุบููุฑ `n_embd` ุฅูู `576`ุ ูุฎุชูู ุฎุทุฃ ุงูุชุฃููุฏ ููุฑูุง ูุณูุจุฏุฃ ุงูุชุฏุฑูุจ ุจุดูู ุทุจูุนู.

ูุฐุง ุงููููุฐุฌ 12L/12H/576E ูุญุธู ุจุดุนุจูุฉ ูุจูุฑุฉ ูู ูุฌุชูุน nanoGPT ุญุงูููุง โ ูุซูุฑ ูู ุงููุงุณ ูุฏุฑุจููู ุจูุฌุงุญ ุนูู ูุฑูุช 4070/4070 Ti ุณุนุฉ 12 ุฌูุฌุงุจุงูุช ุจุงุณุชุฎุฏุงู FineWeb.

ุดุบูููุ ูุณูุนูู ุจูุณุจุฉ 100%. ุฃุนูููู ุนูุฏูุง ุชุฑู ุฃูู ูููุฉ loss ุชุทุจุน! ๐