---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-code-fast-1
title: تحليل ملف تكوين شادوروكيت
translated: true
type: note
---

يبدو أن هذا ملف تكوين لـ Shadowrocket، وهو تطبيق وكيل يعتمد على القواعد لنظام iOS (يشبه أدوات مثل Surge أو Quantumult). وهو مُنظم كملف تكوين نصي يحدد كيفية توجيه حركة المرور في التطبيق، والتعامل مع DNS، وتطبيق القواعد، وإجراء إعادة الكتابة أو اعتراض MITM (رجل في المنتصف). الملف مؤرخ بـ "2025-10-02 20:25:43"، والذي قد يكون طابعًا زمنيًا أو عنصرًا نائبًا.

سأشرحه قسمًا تلو الآخر، موضحًا كل جزء، وما يفعله، ولماذا قد يتم تكوينه بهذه الطريقة. يبدو أن هذا التكوين مُحسّن للمستخدمين في المناطق ذات القيود على الإنترنت (مثل الصين)، حيث يقوم بتوجيه بعض الخدمات العالمية/المحظورة عبر خادم وكيل مع إبقاء حركة المرور المحلية/الداخلية مباشرة لتحقيق سرعة أفضل وتجنب إعادة التوجيه غير الضرورية. هذا ليس إعدادًا كاملاً—ستظل بحاجة إلى تكوين خادم وكيل (عبر Shadowsocks أو V2Ray وما إلى ذلك) بشكل منفصل في التطبيق، ويشير هذا التكوين إلى مجموعات قواعد خارجية يتم تحديثها تلقائيًا من GitHub.

### الافتراضات والملاحظات الرئيسية
- **إعداد الوكيل**: يفترض هذا التكوين أن لديك خادم وكيل يعمل في Shadowrocket (مثل SOCKS5 أو HTTP أو البروتوكولات المشفرة). بدون ذلك، لن تعمل قواعد "PROXY".
- **الغرض**: يبدو أنه مصمم لتجاوز الرقابة (مثل الجدار الناري العظيم في الصين). يتم تمرير خدمات الذكاء الاصطناعي (مثل OpenAI/ChatGPT) عبر الوكيل، بينما تذهب النطاقات/عنوانات IP الصينية مباشرة لتجنب التقييد.
- **وضع TUN**: يشير إلى "tun" (وضع النفق) لتوجيه كل حركة المرور عبر الجهاز.
- **التبعيات الخارجية**: تحمّل بعض القواعد من عناوين URL على GitHub (مثل قوائم القواعد). تأكد من أنك تثق بهذه المصادر، حيث يمكنها التحديث تلقائيًا.
- إذا كان أي شيء غير واضح أو كنت بحاجة إلى المساعدة في تطبيقه، أعلمني بتفاصيل إعدادك.

### تفصيل الأقسام

#### **[General]**
يحدد هذا السلوكيات العامة للتطبيق، وتحليل DNS، وتوجيه الشبكة. إنه يشبه "التفضيلات" أو "إعدادات النظام" لـ Shadowrocket.

- `bypass-system = true`: تجاهل إعدادات الوكيل النظامية في iOS. يقوم Shadowrocket بالتعامل مع كل عمليات التوكيل بنفسه بدلاً من الاعتماد على تكوينات النظام الشاملة.
  
- `skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,captive.apple.com,*.ccb.com,*.abchina.com.cn,*.psbc.com,www.baidu.com`: قائمة مفصولة بفواصل للنطاقات/نطاقات عناوين IP **يجب توجيهها دائمًا مباشرة** (بدون وكيل). يتضمن هذا:
  - الشبكات الخاصة (مثل عناوين IP لشبكة Wi-Fi المنزلية مثل 192.168.x.x).
  - النطاقات المحلية (*.local) والنطاق المحلي (localhost).
  - فحص البوابة الاحتجازية (captive portal) من Apple.
  - نطاقات البنوك الصينية (*.ccb.com لبنك الصين الإنشائي، *.abchina.com.cn للبنك الزراعي الصيني، *.psbc.com لبنك البريد والمدخرات).
  - Baidu (www.baidu.com)، محرك بحث صيني رئيسي.
  - *لماذا؟* يمكن الوصول إلى المواقع الصينية المحلية (خاصة البنوك ومحركات البحث) بدون وكيل وقد يتم تقييدها أو الإبلاغ عنها إذا تم توجيهها عبر واحد.

- `tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32, 239.255.255.250/32`: في وضع النفق (TUN)، يتم **استبعاد** نطاقات عناوين IP هذه من نفق الوكيل. يمنع هذا التداخل مع حركة المرور المحلية/التوجيهية مثل عناوين IP loopback والبث المتعدد والنطاقات الاختبارية.

- `dns-server = https://doh.pub/dns-query,https://dns.alidns.com/dns-query,223.5.5.5,119.29.29.29`: قائمة مفضلة لحلّالات DNS لحركة مرور الوكيل. هذه هي خوادم DoH (DNS over HTTPS) و DNS عادي (Tencent's 119.29.29.29 و Aliyun's 223.5.5.5). تبدأ بالخوادم المشفرة/العامة (doh.pub و alidns.com) للخصوصية/الأمان.

- `fallback-dns-server = system`: إذا فشل DNS الأساسي، فانتقل إلى DNS النظامي في iOS.

- `ipv6 = true`: تمكين دعم IPv6. `prefer-ipv6 = false`: تفضيل IPv4 على IPv6 للاتصالات (مثلًا للاستقرار أو التوافق).

- `dns-direct-system = false`: عدم استخدام DNS النظامي للاتصالات المباشرة—استخدم DNS المُكون بدلاً من ذلك.

- `icmp-auto-reply = true`: الرد تلقائيًا على طلبات ICMP (ping). مفيد لفحوصات الاتصال.

- `always-reject-url-rewrite = false`: السماح بإعادة كتابة URL (المستخدمة لاحقًا في التكوين) أن يتم تشغيلها.

- `private-ip-answer = true`: السماح باستجابات DNS التي تحتوي على عناوين IP خاصة (مثل جهاز التوجيه الخاص بك).

- `dns-direct-fallback-proxy = true`: إذا فشل استعلام DNS المباشر، أعد المحاولة عبر الوكيل.

- `tun-included-routes = `: (فارغ) لا توجد مسارات مخصصة مضمنة في وضع TUN—استخدم الإعدادات الافتراضية.

- `always-real-ip = `: (فارغ) لا يوجد إجبار لكشف عنوان IP الحقيقي—السلوك القياسي.

- `hijack-dns = 8.8.8.8:53,8.8.4.4:53`: اعتراض حركة مرور DNS من DNS العام لـ Google (8.8.8.8/8.8.4.4 على المنفذ 53) وتوجيهها عبر الوكيل. هذا يفرض استخدام DNS الذي قمت بتكوينه بدلاً من الخوادم العامة، والتي قد تكون محظورة أو مراقبة.

- `udp-policy-not-supported-behaviour = REJECT`: إذا لم يتم دعم حركة مرور UDP بواسطة سياسة ما، ارفضها بدلاً من السماح.

- `include = `: (فارغ) لا توجد ملفات تكوين إضافية مضمنة.

- `update-url = `: (فارغ) لا توجد تحديثات تلقائية للتكوين من عنوان URL.

#### **[Rule]**
يحدد هذا قواعد توجيه حركة المرور، والتي تتم معالجتها بالترتيب. إنه يشبه قائمة التحكم بالوصول (ACL) التي تخبر Shadowrocket بما يجب توكيله، وما يجب إرساله مباشرة، بناءً على النطاقات والكلمات الرئيسية و GEOIP وما إلى ذلك. إذا لم تطابق أي قاعدة، فإنها تنتقل إلى `FINAL,DIRECT`.

- `DOMAIN-SUFFIX,anthropic.com,PROXY`: توجيه كل النطاقات الفرعية لـ anthropic.com عبر الوكيل (مثل api.anthropic.com). Anthropic هي شركة ذكاء اصطناعي—على الأرجح لتجاوز الحظر.

- `DOMAIN-SUFFIX,chatgpt.com,PROXY`: توجيه نطاقات ChatGPT عبر الوكيل. غالبًا ما تكون ChatGPT مقيدة في مناطق معينة.

- `DOMAIN-SUFFIX,openai.com,PROXY`: توجيه نطاقات OpenAI عبر الوكيل (لسبب مماثل).

- `DOMAIN-SUFFIX,googleapis.com,PROXY`: توجيه خدمات API من Google عبر الوكيل (قد يكون للوصول إلى خدمات Google بشكل غير مباشر).

- `DOMAIN-SUFFIX,zhs.futbol,DIRECT`: توجيه هذا النطاق المحدد (على الأرجح موقع رياضي بالإسبانية/الصينية) مباشرة.

- `RULE-SET,https://github.com/lzwjava/lzwjava.github.io/raw/refs/heads/main/scripts/auto-ss-config/AI.list,PROXY`: تحميل مجموعة قواعد خارجية من GitHub (قائمة بالنطاقات المتعلقة بالذكاء الاصطناعي) وتوكيلها. يقوم هذا بالتحديث التلقائي وتوسيع قواعد وكيل الذكاء الاصطناعي.

- `RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Lan/Lan.list,DIRECT`: تحميل مجموعة قواعد لشبكة المنطقة المحلية (LAN) وتوجيهها مباشرة. يتجنب توكيل حركة المرور المنزلية/الداخلية.

- `DOMAIN-KEYWORD,cn,DIRECT`: أي نطاق يحتوي على الكلمة الرئيسية "cn" (مثل anything.cn) يذهب مباشرة. مفيد للمواقع الصينية.

- `GEOIP,CN,DIRECT`: أي IP يتم تحديد موقعه الجغرافي على أنه في الصين (CN) يذهب مباشرة. يمنع توكيل حركة المرور المحلية، والتي تكون سريعة وغير مقيدة.

- `FINAL,DIRECT`: الإجراء الافتراضي—إذا لم تطابق أي قواعد، فوجه مباشرة. يحافظ على معظم حركة المرور غير موكلة للكفاءة.

*التأثير العام*: هذا إعداد "وكيل للخدمات العالمية المحظورة". يتم إجبار حركة مرور الذكاء الاصطناعي/ChatGPT/OpenAI عبر VPN/الوكيل لتجاوز القيود الإقليمية، بينما تبقى الأشياء الصينية/المحلية مباشرة.

#### **[Host]**
تعيينات مضيف يدوية (مثل ملف hosts المحلي).

- `localhost = 127.0.0.1`: تعيين "localhost" إلى عنوان IP loopback. قياسي—يضمن أن التطبيق يمكنه الاتصال بالخدمات المحلية.

#### **[URL Rewrite]**
يعيد كتابة عناوين URL الواردة قبل تقديم الطلبات. يستخدم مطابقة regex.

- `^https?://(www.)?g.cn https://www.google.com 302`: إعادة كتابة أي عنوان URL لـ HTTP/HTTPS لـ g.cn (أو www.g.cn) لإعادة التوجيه إلى google.com مع حالة 302 (إعادة توجيه مؤقتة). g.cn هو النطاق الصيني لـ Google—هذا يتجاوزه.

- `^https?://(www.)?google.cn https://www.google.com 302`: نفس الشيء لـ google.cn إلى google.com. غالبًا ما تمنع الصين google.cn أو تعيد توجيهها، لذا فإن هذا يفرض إعادة توجيه نظيفة.

*لماذا؟* في المناطق التي تخضع للرقابة، قد يقدم google.cn نتائج معدلة/محظورة. يضمن هذا الوصول إلى موقع Google العالمي مباشرة.

#### **[MITM]**
إعدادات رجل في المنتصف لاعتراض وتعديل حركة مرور HTTPS (يتطلب شهادة CA جذرية في Shadowrocket).

- `hostname = *.google.cn`: اعتراض حركة المرور لأي نطاق فرعي من google.cn. بالاقتران مع إعادة كتابة URL، قد يقوم هذا بفك تشفير/إعادة توجيه حركة المرور لنطاقات Google CN.

*لماذا؟* قد يكون هذا لفرض عمليات إعادة الكتابة أو معالجة مشاكل تثبيت الشهادات في الصين، حيث يستخدم google.cn شهادات مختلفة.

### كيفية استخدام هذا التكوين
1. **الاستيراد**: في Shadowrocket، قم باستيراد هذا كملف تكوين.
2. **خادم الوكيل**: أضف خادم الوكيل الفعلي الخاص بك (مثل خادم Shadowsocks) تحت قسم "Servers"—تعتمد القواعد مثل "PROXY" عليه.
3. **التمكين**: انتقل إلى هذا التكوين وقم بتمكين وضع النفق (VPN) إذا لزم الأمر.
4. **شهادة CA**: لـ MITM، قم بتثبيت شهادة CA الخاصة بـ Shadowrocket والثقة بها إذا لم تكن قد فعلت ذلك بالفعل.
5. **الاختبار**: تحقق من مواقع مثل whatismyipaddress.com لمعرفة ما إذا كانت عناوين IP/التوجيه تعمل كما هو متوقع. راقب المواقع الصينية البطيئة.
6. **استكشاف الأخطاء وإصلاحها**: إذا فشلت مجموعات القواعد في التحميل، فقد يكون ذلك بسبب تحديد المعدل أو تغييرها. قد تحتاج تفضيلات IPv6 إلى التبديل للاتصال.

### المشكلات المحتملة/ملاحظات الأمان
- **الخصوصية**: يمكن لمجموعات القواعد المكشوفة (روابط GitHub) أن تسرب ما تقوم بتوجيهه. يمكن لـ MITM اعتراض حركة المرور الحساسة—استخدم فقط شهادات CA موثوقة.
- **التحديثات**: يتم تحميل مجموعات القواعد تلقائيًا؛ إذا كان GitHub محظورًا، فاستخدم وكيلاً لها.
- **التاريخ المستقبلي**: التكوين مؤرخ بأكتوبر 2025—قد يكون خطأ مطبعيًا أو لحماية مستقبلية، ولكن لا توجد ميزات تعتمد عليه.
- **الشرعية**: توكيل حركة المرور لتجاوز الرقابة مسموح به في بعض الأماكن ولكنه مقيد في أماكن أخرى—استخدمه على مسؤوليتك الخاصة.
- إذا شاركت سجلات الأخطاء أو ما تحاول تحقيقه، يمكنني تحسين النصيحة!