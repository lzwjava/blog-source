---
audio: false
generated: false
lang: ar
layout: post
title: استخدام رموز التوثيق مع URLs سجل npm
translated: true
---

### النقاط الرئيسية
- يبدو أن استخدام رمز المصادقة مع عنوان URL لمستودع npm يتطلب تهيئته في ملف `.npmrc`، حيث يتم ربط الرمز مع عنوان URL لمستودع.
- تشير الأبحاث إلى أن الطريقة القياسية هي إضافة `//registry.url.com/:_authToken=your_token` في ملف `.npmrc`، حيث `registry.url.com` هو عنوان URL لمستودع و `your_token` هو رمز المصادقة الخاص بك.
- تشير الأدلة إلى استخدام ملف `.npmrc` لمصادقة، حيث تضمين الرمز مباشرة في URL (مثل في طلب HTTP) ليس قياسيًا للنم و قد لا يعمل.

### الإجابة المباشرة

#### نظرة عامة
لاستخدام رمز المصادقة مع عنوان URL لمستودع npm، عادةً ما يتم تهيئته في ملف خاص يسمى `.npmrc`. هذا الملف يشرح أداة npm من سطر الأوامر كيفية المصادقة عند الوصول إلى مستودعات حزم محددة، مثل مستودع npm العام أو مستودع خاص. إليك كيفية القيام بذلك خطوة بخطوة، مع الحفاظ على بساطتها للمبتدئين.

#### خطوات التهيئة
1. **إيجاد عنوان URL لمستودع**: حدد المستودع الذي تريد استخدامه، مثل `registry.npmjs.org` لمستودع npm العام أو عنوان URL مثل `privateregistry.com` لمستودع خاص.
2. **الحصول على رمزك المصادقة**: احصل على رمز المصادقة من مزود المستودع، والذي يمكن أن يكون رمزًا شخصيًا أو نوعًا آخر يوفرها منظمة.
3. **تحرير ملف `.npmrc`**: افتح أو أنشئ ملف `.npmrc`. يمكن أن يكون هذا الملف في مجلد المشروع لمُعدلات المشروع أو في مجلد المنزل (مثل `~/.npmrc` في أنظمة Unix) لمُعدلات المستخدم.
   - أضف سطرًا مثل هذا: `//registry.url.com/:_authToken=your_token`. استبدل `registry.url.com` بعنوان URL لمستودع و `your_token` برمزك الفعلي.
   - على سبيل المثال، لمستودع npm العام، قد يبدو ذلك: `//registry.npmjs.org/:_authToken=abc123`.
4. **تأمين الملف**: تأكد من أن ملف `.npmrc` يمكن قراءته وكتابته فقط من قبلك لحماية رمزك. في أنظمة Unix، يمكنك تعيين الإذن باستخدام `chmod 600 ~/.npmrc`.
5. **التحقق من عمله**: حاول تشغيل أمر npm، مثل `npm install`، لرؤية إذا كان يمكن الوصول إلى المستودع دون مشاكل.

#### التفاصيل غير المتوقعة
قد تظن أنك يمكنك وضع رمز المصادقة مباشرة في URL (مثل `https://registry.url.com?token=your_token`), ولكن هذا ليس القياسي للنم. بدلاً من ذلك، يستخدم npm ملف `.npmrc` لتسجيل الدخول في الخلفية، مما يجعله أكثر أمانًا وسهولة في الإدارة.

للمزيد من التفاصيل، راجع الوثائق الرسمية للنم حول تهيئة ملف `.npmrc` [هنا](https://docs.npmjs.com/configuring-npm/npmrc).

---

### ملاحظة الاستطلاع: استكشاف مفصل لاستخدام رموز المصادقة مع عنوان URL لمستودع npm

يقدم هذا القسم تحليلًا شاملًا لاستخدام رموز المصادقة مع عنوان URL لمستودع npm، مع توسيع الإجابة المباشرة مع سياق إضافي، تفاصيل فنية، وأمثلة. يهدف إلى تغطية جميع الجوانب التي تم بحثها، مع ضمان فهم شامل للمستخدمين بمختلف مستويات الخبرة.

#### مقدمة إلى npm ومصادقة
Node Package Manager (npm) هو أداة حاسمة للمطورين الذين يستخدمون JavaScript، حيث يوفر إدارة الحزم والاعتماديات. يتفاعل مع مستودعات الحزم، مثل المستودع العام في [registry.npmjs.org](https://registry.npmjs.org) و المستودعات الخاصة التي تستضيفها المنظمات. غالبًا ما يتطلب المصادقة لمستودعات خاصة أو إجراءات معينة مثل نشر الحزم، ويتم ذلك عادةً من خلال رموز المصادقة المخزنة في ملفات التهيئة.

يكون ملف `.npmrc` في مركز تهيئة npm، مما يسمح بتخصيص الإعدادات مثل عنوان URL لمستودع، طرق المصادقة، وغيرها. يمكن أن يكون موجودًا في مواقع متعددة، مثل:
- **مستودع المشروع**: موجود في جذور المشروع (على سبيل المثال، بجانب `package.json`). هذا مناسب لمُعدلات المشروع وتغلب على الإعدادات العالمية.
- **مستودع المستخدم**: موجود في مجلد المستخدم (على سبيل المثال، `~/.npmrc` في Unix، `C:\Users\<Username>\.npmrc` في Windows). هذا يؤثر على جميع عمليات npm لهذا المستخدم.
- **مستودع عالمي**: موجود في `/etc/npmrc` أو محدد بواسطة `globalconfig`، عادةً ما يستخدم للإعدادات النظامية.

#### تهيئة رموز المصادقة في `.npmrc`
لاستخدام رمز المصادقة مع عنوان URL لمستودع معين، تهيئ ملف `.npmrc` لتربط الرمز بمستودع. الشكل القياسي هو:

```
registry.url.com/:_authToken=your_token
```

حيث `registry.url.com` هو عنوان URL لمستودع (على سبيل المثال، `registry.npmjs.org` لمستودع العام أو `privateregistry.com` لمستودع خاص) و `your_token` هو رمز المصادقة الذي يوفره المستودع. المفتاح `:_authToken` يشير إلى أن هذا هو مصادقة بناءً على الرمز، والذي يستخدمه npm لتحديد رأس `Authorization` ك `Bearer your_token` عند إجراء طلبات HTTP إلى المستودع.

على سبيل المثال، إذا كان لديك رمز `abc123` لمستودع npm العام، فسيكون مدخل `.npmrc` الخاص بك:

```
registry.npmjs.org/:_authToken=abc123
```

تضمن هذه التهيئة أن أي أمر npm يتفاعل مع `registry.npmjs.org` سيشمل الرمز للمصادقة، مما يتيح الوصول إلى الحزم الخاصة أو قدرات النشر، اعتمادًا على نطاق الرمز.

#### معالجة الحزم المخصصة
لحزم المخصصة (الحزم التي تبدأ بـ `@` مثل `@mycompany/mypackage`) يمكنك تحديد مستودع مختلف لهذه المسماة. أولاً، قم بتعيين المستودع للمسماة:

```
@mycompany:registry=https://mycompany.artifactory.com/
```

ثم، ربط الرمز المصادقة بمستودع:

```
mycompany.artifactory.com/:_authToken=your_token
```

تضمن هذه التهيئة توجيه جميع الطلبات لحزم `@mycompany` إلى المستودع الخاص المحدد واستخدام الرمز المقدم للمصادقة. هذا مفيد في بيئات الشركات حيث تستضيف المنظمات مستودعات npm الخاصة بها للحزم الداخلية.

#### موقع و أمان `.npmrc`
يمكن أن يكون ملف `.npmrc` موجودًا في مواقع متعددة، كل منها يخدم غرضًا مختلفًا:
- **مستودع المشروع**: موجود في جذور المشروع (على سبيل المثال، بجانب `package.json`). هذا مناسب لمُعدلات المشروع وتغلب على الإعدادات العالمية.
- **مستودع المستخدم**: موجود في مجلد المستخدم (على سبيل المثال، `~/.npmrc` في Unix، `C:\Users\<Username>\.npmrc` في Windows). هذا يؤثر على جميع عمليات npm لهذا المستخدم.
- **مستودع عالمي**: موجود في `/etc/npmrc` أو محدد بواسطة `globalconfig`، عادةً ما يستخدم للإعدادات النظامية.

بسبب أن `.npmrc` يمكن أن يحتوي على معلومات حساسة مثل رموز المصادقة، فإن الأمان حاسم. يجب أن يكون الملف قابلًا للقراءة والكتابة فقط من قبل المستخدم لمنع الوصول غير المصرح به. في أنظمة Unix، يمكنك التأكد من ذلك باستخدام الأمر `chmod 600 ~/.npmrc`، مما يحدد الإذن إلى القراءة والكتابة للمالك فقط.

#### طرق المصادقة البديلة
على الرغم من أن المصادقة بناءً على الرمز شائعة، إلا أن npm يدعم أيضًا المصادقة الأساسية، حيث يمكنك تضمين اسم المستخدم وكلمة المرور في ملف `.npmrc`:

```
registry.url.com/:username=your_username
registry.url.com/:_password=your_password
```

ومع ذلك، من أجل الأمن، يتم تفضيل المصادقة بناءً على الرمز، حيث يمكن استرداد الرموز وإعادة تعيينها وتحديد الصلاحيات المحددة، مما يقلل من المخاطر مقارنة باحتفاظ بكلمات المرور النصية.

#### تضمين URL المباشر: هل هو ممكن؟
يمكن أن يشير السؤال إلى "استخدام مصادقة أو رمز مصادقة في URL لمستودع npm"، مما قد يشير إلى تضمين الرمز مباشرة في URL، مثل `https://registry.url.com?token=your_token`. ومع ذلك، تشير الأبحاث إلى أن هذا ليس الممارسة القياسية للنم. وثائق API لمستودع npm و الموارد ذات الصلة، مثل [NPM registry authentication | Rush](https://rushjs.io/pages/maintainer/npm_registry_auth/)، تركز على استخدام ملف `.npmrc` لمصادقة، مع الرمز المرسل في رأس `Authorization` ك `Bearer your_token`.

حاول تضمين الرمز في URL كمتغير استعلام ليس مدعومًا من قبل مستودع npm القياسي و قد لا يعمل، حيث يتم معالجة المصادقة على مستوى رأس HTTP. قد يدعم بعض المستودعات الخاصة مصادقة URL مخصصة، ولكن هذا ليس مستندًا لمستودع npm الرسمي. على سبيل المثال، يمكن أن تسمح المصادقة الأساسية بURL مثل `https://username:password@registry.url.com`، ولكن هذا مهجور وغير آمن مقارنة بأسلوب المصادقة بناءً على الرمز.

#### أمثلة عملية و حالات استخدام
لإلحاح، راجع هذه الحالات:

- **مستودع عام مع رمز**: إذا كنت بحاجة إلى نشر إلى مستودع npm العام و لديك رمز، أضف:
  ```
  registry.npmjs.org/:_authToken=abc123
  ```
  ثم، قم بتشغيل `npm publish` لتحميل حزمة، وسيستخدم npm الرمز للمصادقة.

- **مستودع خاص للحزم المخصصة**: لمؤسسة تستخدم مستودع خاصًا في `https://company.registry.com` لحزم `@company`، قم بتهيئة:
  ```
  @company:registry=https://company.registry.com/
  company.registry.com/:_authToken=def456
  ```
  الآن، سيتم تثبيت `@company/mypackage` باستخدام المستودع الخاص مع الرمز.

- **تكامل CI/CD**: في بيئات التكامل المستمر، احفظ الرمز كمتغير بيئي (على سبيل المثال، `NPM_TOKEN`) واستخدمه في ملف `.npmrc` بشكل ديناميكي:
  ```
  registry.npmjs.org/:_authToken=${NPM_TOKEN}
  ```
  هذا النهج، الذي يشرحه [Using private packages in a CI/CD workflow | npm Docs](https://docs.npmjs.com/using-private-packages-in-a-ci-cd-workflow/)، يضمن أن الرموز لا تكون محفوظة و هي آمنة.

#### حل المشكلات و أفضل الممارسات
إذا فشلت المصادقة، تأكد من:
- أن عنوان URL لمستودع صحيح وموصول.
- أن الرمز صالح و لديه الصلاحيات اللازمة (على سبيل المثال، قراءة للتثبيت، كتابة للنشر).
- أن ملف `.npmrc` في الموقع الصحيح و لديه الإذن المناسب.

أفضل الممارسات تشمل:
- لا تقم بتسجيل `.npmrc` مع الرموز في نظام التحكم بالنسخ؛ أضفها إلى `.gitignore`.
- استخدم متغيرات البيئة للرموز في أنابيب CI/CD لتحسين الأمان.
- قم بتغيير الرموز بانتظام وإلغاء الرموز غير المستخدمة لتقلل من المخاطر.

#### تحليل مقارنة لمethods المصادقة
لإعطاء نظرة عامة منظمة، إليك جدولًا يوضح المصادقة بناءً على الرمز والمصادقة الأساسية في npm:

| **الطريقة**          | **تهيئة في `.npmrc`**                          | **الأمان**                     | **حالة الاستخدام**                     |
|---------------------|-------------------------------------------------------|-----------------------------------|-----------------------------------|
| مصادقة بناءً على الرمز (المفضل) | `registry.url.com/:_authToken=your_token`            | عالية (قابل للاسترداد، محدد النطاق)         | مستودعات خاصة، CI/CD        |
| مصادقة أساسية| `registry.url.com/:username=your_username`<br>`registry.url.com/:_password=your_password` | منخفضة (كلمة مرور نصية)         | أنظمة قديمة، مستودع عام  |

يوضح هذا الجدول لماذا يتم تفضيل المصادقة بناءً على الرمز، خاصة في أنماط العمل الحديثة.

#### الخاتمة
استخدام رمز المصادقة مع عنوان URL لمستودع npm يركز بشكل أساسي على تهيئة ملف `.npmrc` لتربط الرمز بمستودع. هذا النهج قياسي وآمن ومدعوم بشكل واسع، مما يضمن أن npm يمكن أن يصادق على الطلبات دون كشف الرموز في URLs. على الرغم من أن تضمين الرموز مباشرة في URLs ليس قياسيًا للنم و قد لا يعمل، فإن نهج `.npmrc` يوفر حلًا قويًا للتواصل مع مستودعات عامة و خاصة.

للمزيد من القراءة، راجع الوثائق الرسمية للنم حول [تهيئة npmrc](https://docs.npmjs.com/configuring-npm/npmrc) و [مصادقة مستودع](https://docs.npmjs.com/using-private-packages-in-a-ci-cd-workflow/).

### الإشارات الرئيسية
- [NPM registry authentication Rush documentation](https://rushjs.io/pages/maintainer/npm_registry_auth/)
- [registry-auth-token npm package details](https://www.npmjs.com/package/registry-auth-token)
- [Globally configure NPM with token Stack Overflow question](https://stackoverflow.com/questions/38764714/globally-configure-npm-with-a-token-registry-to-a-specific-scope-organisation)
- [Configure authentication Artifact Registry Google Cloud](https://cloud.google.com/artifact-registry/docs/nodejs/authentication)
- [Official npm documentation for npmrc file](https://docs.npmjs.com/configuring-npm/npmrc)
- [Using private packages in CI/CD workflow npm Docs](https://docs.npmjs.com/using-private-packages-in-a-ci-cd-workflow/)