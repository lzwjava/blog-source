---
audio: false
generated: true
lang: ar
layout: post
title: استخدام رموز المصادقة مع عناوين سجل npm
translated: true
type: note
---

### النقاط الرئيسية
- يبدو من المرجح أنه لاستخدام رمز مصادقة مع عنوان URL لسجل npm، يمكنك تكوينه في ملف `.npmrc`، بربط الرمز بعنوان URL للسجل.
- تشير الأبحاث إلى أن الطريقة القياسية هي إضافة `//registry.url.com/:_authToken=your_token` في ملف `.npmrc`، حيث `registry.url.com` هو عنوان URL للسجل و `your_token` هو رمز المصادقة الخاص بك.
- تميل الأدلة نحو استخدام ملف `.npmrc` للمصادقة، حيث أن تضمين الرمز مباشرة في عنوان URL (كما في طلب HTTP) ليس معياريًا في npm وقد لا يعمل.

### الإجابة المباشرة

#### نظرة عامة
لاستخدام رمز مصادقة مع عنوان URL لسجل npm، تقوم عادةً بتكوينه في ملف خاص يسمى `.npmrc`. يخبر هذا الملف أداة سطر أوامر npm بكيفية المصادقة عند الوصول إلى سجلات الحزم المحددة، مثل سجل npm العام أو السجل الخاص. إليك كيف يمكنك القيام بذلك خطوة بخطوة، مع الحفاظ على البساطة للمبتدئين.

#### خطوات التكوين
1.  **ابحث عن عنوان URL للسجل**: حدد السجل الذي تريد استخدامه، مثل `registry.npmjs.org` لسجل npm العام أو عنوان URL مثل `privateregistry.com` للسجل الخاص.
2.  **احصل على رمز المصادقة الخاص بك**: احصل على رمز المصادقة من موفر السجل، والذي قد يكون رمز وصول شخصي أو نوع آخر توفره مؤسستك.
3.  **قم بتحرير ملف `.npmrc`**: افتح أو أنشئ ملف `.npmrc`. يمكن أن يكون هذا الملف في مجلد مشروعك للإعدادات الخاصة بالمشروع أو في دليل المستخدم الرئيسي الخاص بك (مثل `~/.npmrc` على أنظمة Unix) للإعدادات على مستوى المستخدم.
    - أضف سطرًا مثل هذا: `//registry.url.com/:_authToken=your_token`. استبدل `registry.url.com` بعنوان URL للسجل الخاص بك واستبدل `your_token` بالرمز الفعلي الخاص بك.
    - على سبيل المثال، لسجل npm العام، قد يبدو كما يلي: `//registry.npmjs.org/:_authToken=abc123`.
4.  **امنح الملف الأمان**: تأكد من أن ملف `.npmrc` قابل للقراءة والكتابة من قبلك فقط للحفاظ على أمان الرمز الخاص بك. على أنظمة Unix، يمكنك تعيين الأذونات باستخدام `chmod 600 ~/.npmrc`.
5.  **تحقق من عمل الإعدادات**: حاول تشغيل أمر npm، مثل `npm install`، لمعرفة ما إذا كان يمكنه الوصول إلى السجل دون مشاكل.

#### تفصيل غير متوقع
بينما قد تعتقد أنه يمكنك وضع رمز المصادقة مباشرة في عنوان URL (مثل `https://registry.url.com?token=your_token`)، إلا أن هذه ليست الطريقة القياسية لـ npm. بدلاً من ذلك، يستخدم npm ملف `.npmrc` للتعامل مع المصادقة خلف الكواليس، مما يجعله أكثر أمانًا وسهولة في الإدارة.

لمزيد من التفاصيل، تحقق من الوثائق الرسمية لـ npm حول تكوين ملف `.npmrc` [هنا](https://docs.npmjs.com/configuring-npm/npmrc).

---

### ملاحظة المسح: استكشاف مفصل لاستخدام رموز المصادقة مع عناوين URL لسجل npm

يقدم هذا القسم تحليلاً شاملاً لكيفية استخدام رموز المصادقة مع عناوين URL لسجل npm، مع التوسع في الإجابة المباشرة لتشمل سياقًا إضافيًا وتفاصيل تقنية وأمثلة. يهدف إلى تغطية جميع الجوانب التي تمت مناقشتها في البحث، مما يضمن فهماً شاملاً للمستخدمين بمستويات خبرة مختلفة.

#### مقدمة إلى npm والمصادقة
يعد Node Package Manager (npm) أداة حاسمة لمطوري JavaScript، حيث يدير الحزم والتبعيات. يتفاعل مع سجلات الحزم، مثل السجل العام على [registry.npmjs.org](https://registry.npmjs.org)، والسجلات الخاصة التي تستضيفها المؤسسات. غالبًا ما تكون المصادقة مطلوبة للسجلات الخاصة أو الإجراءات المحددة مثل نشر الحزم، ويتم التعامل مع هذا عادةً من خلال رموز المصادقة المخزنة في ملفات التكوين.

يعد ملف `.npmrc` أساسيًا لتكوين npm، حيث يسمح بتخصيص الإعدادات مثل عناوين URL للسجلات وطرق المصادقة والمزيد. يمكن أن يوجد في مواقع متعددة، مثل لكل مشروع (في جذر المشروع)، لكل مستخدم (في الدليل الرئيسي للمستخدم، على سبيل المثال `~/.npmrc`)، أو عالميًا (على سبيل المثال، `/etc/npmrc`). يستخدم هذا الملف تنسيق INI، حيث تحدد المفاتيح والقيم كيفية تصرف npm، بما في ذلك كيفية المصادقة مع السجلات.

#### تكوين رموز المصادقة في `.npmrc`
لاستخدام رمز مصادقة مع عنوان URL محدد للسجل، تقوم بتكوين ملف `.npmrc` لربط الرمز بهذا السجل. التنسيق القياسي هو:

```
registry.url.com/:_authToken=your_token
```

هنا، `registry.url.com` هو عنوان URL الأساسي للسجل (على سبيل المثال، `registry.npmjs.org` للسجل العام أو `privateregistry.com` للسجل الخاص)، و `your_token` هو رمز المصادقة المقدم من السجل. يشير المفتاح `:_authToken` إلى أن هذه مصادقة قائمة على الرمز، والتي يستخدمها npm لتعيين رأس `Authorization` كـ `Bearer your_token` عند إجراء طلبات HTTP إلى السجل.

على سبيل المثال، إذا كان لديك رمز `abc123` لسجل npm العام، سيكون إدخال `.npmrc` الخاص بك كما يلي:

```
registry.npmjs.org/:_authToken=abc123
```

يضمن هذا التكوين أن أي أمر npm يتفاعل مع `registry.npmjs.org` سيتضمن الرمز للمصادقة، مما يسمح بالوصول إلى الحزم الخاصة أو إمكانيات النشر، اعتمادًا على نطاق الرمز.

#### التعامل مع الحزم ذات النطاق
بالنسبة للحزم ذات النطاق (الحزم التي تبدأ بـ `@`، مثل `@mycompany/mypackage`)، يمكنك تحديد سجل مختلف لهذا النطاق. أولاً، قم بتعيين السجل للنطاق:

```
@mycompany:registry=https://mycompany.artifactory.com/
```

ثم، اربط رمز المصادقة بهذا السجل:

```
mycompany.artifactory.com/:_authToken=your_token
```

يقوم هذا الإعداد بتوجيه جميع الطلبات الخاصة بحزم `@mycompany` إلى السجل الخاص المحدد ويستخدم الرمز المقدم للمصادقة. هذا مفيد بشكل خاص في البيئات المؤسسية حيث تستضيف المنظمات سجلات npm الخاصة بها للحزم الداخلية.

#### موقع وأمان ملف `.npmrc`
يمكن أن يقع ملف `.npmrc` في عدة أماكن، يخدم كل منها أغراضًا مختلفة:
- **لكل مشروع**: موجود في جذر المشروع (على سبيل المثال، بجانب `package.json`). هذا مثالي للتكوينات الخاصة بالمشروع ويتجاوز الإعدادات العامة.
- **لكل مستخدم**: موجود في الدليل الرئيسي للمستخدم (على سبيل المثال، `~/.npmrc` على أنظمة Unix، `C:\Users\<Username>\.npmrc` على Windows). هذا يؤثر على جميع عمليات npm لهذا المستخدم.
- **عالمي**: موجود في `/etc/npmrc` أو محدد بواسطة المعامل `globalconfig`، يُستخدم عادةً للإعدادات على مستوى النظام.

نظرًا لأن `.npmrc` يمكن أن يحتوي على معلومات حساسة مثل رموز المصادقة، فإن الأمان أمر بالغ الأهمية. يجب أن يكون الملف قابلاً للقراءة والكتابة من قبل المستخدم فقط لمنع الوصول غير المصرح به. على أنظمة Unix، يمكنك ضمان ذلك باستخدام الأمر `chmod 600 ~/.npmrc`، مما يضبط الأذونات على القراءة/الكتابة للمالك فقط.

#### طرق المصادقة البديلة
بينما تعد المصادقة القائمة على الرمز شائعة، فإن npm يدعم أيضًا المصادقة الأساسية، حيث يمكنك تضمين اسم المستخدم وكلمة المرور في ملف `.npmrc`:

```
registry.url.com/:username=your_username
registry.url.com/:_password=your_password
```

ومع ذلك، لأسباب أمنية، يُفضل استخدام المصادقة القائمة على الرمز، حيث يمكن إبطال الرموز ولها أذونات محددة النطاق، مما يقلل المخاطر مقارنة بتخزين كلمات المرور كنص عادي.

#### التضمين المباشر في عنوان URL: هل هو ممكن؟
تشير المسألة إلى "استخدام auth أو authtoken في عنوان URL لسجل npm"، مما قد يشير إلى تضمين الرمز مباشرة في عنوان URL، مثل `https://registry.url.com?token=your_token`. ومع ذلك، تشير الأبحاث إلى أن هذه ليست الممارسة القياسية لـ npm. تؤكد وثائق API لسجل npm والموارد ذات الصلة، مثل [NPM registry authentication | Rush](https://rushjs.io/pages/maintainer/npm_registry_auth/)، على استخدام ملف `.npmrc` للمصادقة، مع تمرير الرمز في رأس `Authorization` كـ `Bearer your_token`.

إن محاولة تضمين الرمز في عنوان URL كمعامل استعلام غير مدعوم من قبل سجل npm القياسي وقد لا يعمل، حيث يتم التعامل مع المصادقة على مستوى رأس HTTP. قد تدعم بعض السجلات الخاصة المصادقة القائمة على عنوان URL المخصصة، ولكن هذا غير موثق لسجل npm الرسمي. على سبيل المثال، تسمح المصادقة الأساسية بعناوين URL مثل `https://username:password@registry.url.com`، ولكن هذا مهمل وغير آمن مقارنة بالطرق القائمة على الرمز.

#### أمثلة عملية وحالات استخدام
للتوضيح، ضع في اعتبارك هذه السيناريوهات:

-   **السجل العام مع الرمز**: إذا كنت بحاجة إلى النشر إلى سجل npm العام ولديك رمز، أضف:
    ```
    registry.npmjs.org/:_authToken=abc123
    ```
    ثم، قم بتشغيل `npm publish` لتحميل الحزمة الخاصة بك، وسيستخدم npm الرمز للمصادقة.

-   **السجل الخاص للحزم ذات النطاق**: لشركة تستخدم سجلاً خاصًا على `https://company.registry.com` لحزم `@company`، قم بالتكوين:
    ```
    @company:registry=https://company.registry.com/
    company.registry.com/:_authToken=def456
    ```
    الآن، سيؤدي تثبيت `@company/mypackage` إلى المصادقة مع السجل الخاص باستخدام الرمز.

-   **التكامل مع CI/CD**: في بيئات التكامل المستمر/التسليم المستمر، قم بتخزين الرمز كمتغير بيئة (على سبيل المثال، `NPM_TOKEN`) واستخدمه في ملف `.npmrc` ديناميكيًا:
    ```
    registry.npmjs.org/:_authToken=${NPM_TOKEN}
    ```
    تضمن هذه الطريقة، الموضحة في [Using private packages in a CI/CD workflow | npm Docs](https://docs.npmjs.com/using-private-packages-in-a-ci-cd-workflow/)، عدم ترميز الرموز وتكون آمنة.

#### استكشاف الأخطاء وإصلاحها وأفضل الممارسات
إذا فشلت المصادقة، تحقق من:
-   عنوان URL للسجل صحيح ويمكن الوصول إليه.
-   الرمز صالح وله الأذونات اللازمة (على سبيل المثال، القراءة للتثبيت، الكتابة للنشر).
-   ملف `.npmrc` في الموقع الصحيح وله الأذونات المناسبة.

تشمل أفضل الممارسات:
-   لا تقم أبدًا بإيداع `.npmrc` مع الرموز في نظام التحكم في الإصدار؛ أضفه إلى `.gitignore`.
-   استخدم متغيرات البيئة للرموز في خطوط أنابيب CI/CD لتعزيز الأمان.
-   قم بتدوير الرموز بانتظام وألغِ الرموز غير المستخدمة لتقليل المخاطر.

#### التحليل المقارن لطرق المصادقة
لتقديم نظرة عامة منظمة، إليك جدول يقارن بين المصادقة القائمة على الرمز والمصادقة الأساسية في npm:

| **الطريقة**          | **التكوين في `.npmrc`**                          | **الأمان**                     | **حالة الاستخدام**                     |
|---------------------|-------------------------------------------------------|-----------------------------------|-----------------------------------|
| قائمة على الرمز (مفضلة) | `registry.url.com/:_authToken=your_token`            | مرتفع (قابل للإلغاء، محدد النطاق)         | السجلات الخاصة، CI/CD        |
| المصادقة الأساسية| `registry.url.com/:username=your_username`<br>`registry.url.com/:_password=your_password` | منخفض (كلمة مرور نصية عادي)         | الأنظمة القديمة، السجل العام  |

يسلط هذا الجدول الضوء على سبب التوصية بالمصادقة القائمة على الرمز، خاصةً لسير العمل الحديثة.

#### الخلاصة
يتضمن استخدام رمز مصادقة مع عنوان URL لسجل npm بشكل أساسي تكوين ملف `.npmrc` لربط الرمز بالسجل. هذه الطريقة معيارية وآمنة ومدعومة على نطاق واسع، مما يضمن أن npm يمكنه المصادقة على الطلبات دون الكشف عن الرموز في عناوين URL. بينما لا يعد تضمين الرموز مباشرة في عناوين URL معياريًا لـ npm وقد لا يعمل، فإن طريقة `.npmrc` توفر حلاً قويًا لكل من التفاعلات مع السجلات العامة والخاصة.

لمزيد من القراءة، استشر الوثائق الرسمية لـ npm حول [تكوين npmrc](https://docs.npmjs.com/configuring-npm/npmrc) و [مصادقة السجل](https://docs.npmjs.com/using-private-packages-in-a-ci-cd-workflow/).

### الاقتباسات الرئيسية
- [NPM registry authentication Rush documentation](https://rushjs.io/pages/maintainer/npm_registry_auth/)
- [registry-auth-token npm package details](https://www.npmjs.com/package/registry-auth-token)
- [Globally configure NPM with token Stack Overflow question](https://stackoverflow.com/questions/38764714/globally-configure-npm-with-a-token-registry-to-a-specific-scope-organisation)
- [Configure authentication Artifact Registry Google Cloud](https://cloud.google.com/artifact-registry/docs/nodejs/authentication)
- [Official npm documentation for npmrc file](https://docs.npmjs.com/configuring-npm/npmrc)
- [Using private packages in CI/CD workflow npm Docs](https://docs.npmjs.com/using-private-packages-in-a-ci-cd-workflow/)