---
audio: false
generated: true
lang: ar
layout: post
title: استخدام تشوكيدار لمراقبة الملفات
translated: true
type: note
---

تشوكيدار هي مكتبة Node.js مصممة أساسًا لمراقبة الملفات على جانب الخادم، لذا فإن استخدامها مباشرة في الواجهة الأمامية (أي في بيئة المتصفح) ليس حالة الاستخدام النموذجية لها. المتصفح لا يملك وصولاً مباشرًا لنظام الملفات مثل Node.js، ولهذا فإن تشوكيدار أكثر ملاءمة لبيئات الخلفية أو وقت البناء. ومع ذلك، إذا كنت تعمل على مشروع تستخدم فيه أداة حزم مثل Webpack أو Vite أو Parcel في إعداد تطوير، أو إذا كنت تبني تطبيق إلكترون (الذي يجمع Node.js مع واجهة أمامية)، فيمكنك الاستفادة من تشوكيدار بشكل غير مباشر. دعني أوضح كيف يمكنك التعامل مع هذا بناءً على السياق.

### لماذا لا تعمل تشوكيدار مباشرة في المتصفح
- تعتمد تشوكيدار على واجهات برمجة تطبيقات Node.js مثل `fs` (نظام الملفات) لمراقبة الملفات، وهي غير متوفرة في بيئة المتصفح.
- يعمل كود الواجهة الأمامية في بيئة معزولة (المتصفح)، حيث يكون الوصول إلى نظام الملفات مقيدًا لأسباب أمنية.

### السيناريوهات المحتملة لاستخدام تشوكيدار في سياق "الواجهة الأمامية"
إليك كيف يمكنك استخدام تشوكيدار بطريقة تتعلق بتطوير الواجهة الأمامية:

#### 1. **خلال التطوير باستخدام أداة بناء**
إذا كنت تسأل عن استخدام تشوكيدار لمراقبة الملفات (مثلًا لإعادة التحميل الفوري أو التحديثات المباشرة) أثناء تطوير الواجهة الأمامية، فستقوم بدمجها في عملية البناء بدلاً من وقت تشغيل المتصفح.

مثال مع سكريبت Node.js مخصص:
```javascript
const chokidar = require('chokidar');

// راقب التغييرات في ملفات مصدر الواجهة الأمامية الخاصة بك
chokidar.watch('./src/**/*.{html,js,css}').on('all', (event, path) => {
  console.log(event, path);
  // قم بتشغيل إعادة بناء أو أبلغ خادم تطوير الواجهة الأمامية هنا
});
```
- **حالة الاستخدام**: يمكنك إقران هذا باتصال WebSocket لدفع التحديثات إلى المتصفح أثناء التطوير.
- **الأدوات**: اجمعها مع شيء مثل `esbuild` أو خادم تطوير (على سبيل المثال، Vite لديه مراقبة ملفات مدمجة بالفعل، ولكن يمكنك تخصيصها باستخدام تشوكيدار).

#### 2. **في تطبيق إلكترون**
إذا كانت "واجهتك الأمامية" جزءًا من تطبيق إلكترون، فيمكنك استخدام تشوكيدار في العملية الرئيسية (Node.js) وإبلاغ التغييرات إلى عملية العارض (الواجهة الأمامية).

مثال:
```javascript
// main.js (عملية إلكترون الرئيسية)
const { ipcMain } = require('electron');
const chokidar = require('chokidar');

chokidar.watch('./files').on('change', (path) => {
  ipcMain.send('file-changed', path); // أرسل الحدث إلى العارض
});
```
```javascript
// renderer.js (الواجهة الأمامية)
const { ipcRenderer } = require('electron');

ipcRenderer.on('file-changed', (event, path) => {
  console.log(`File changed: ${path}`);
  // قم بتحديث واجهة المستخدم وفقًا لذلك
});
```

#### 3. **الواجهة الأمامية مع وكيل خادم خلفي**
إذا كنت تبني تطبيق ويب وتريد وظيفة مراقبة الملفات، فستقوم بتشغيل تشوكيدار على خادم Node.js خلفي وإرسال التحديثات إلى الواجهة الأمامية عبر WebSockets أو أحداث مرسلة من الخادم.

مثال (الخادم الخلفي مع Express و WebSocket):
```javascript
const express = require('express');
const WebSocket = require('ws');
const chokidar = require('chokidar');

const app = express();
const server = app.listen(3000);
const wss = new WebSocket.Server({ server });

chokidar.watch('./public').on('change', (path) => {
  wss.clients.forEach((client) => {
    if (client.readyState === WebSocket.OPEN) {
      client.send(`File changed: ${path}`);
    }
  });
});
```
الواجهة الأمامية (مثال React):
```javascript
const socket = new WebSocket('ws://localhost:3000');
socket.onmessage = (event) => {
  console.log(event.data); // "File changed: ..."
  // قم بتحديث الحالة أو واجهة المستخدم
};
```

### التثبيت
لاستخدام تشوكيدار في أي من هذه الإعدادات، يجب أولاً تثبيته في مشروع Node.js الخاص بك:
```bash
npm install chokidar
```

### طرق تشوكيدار الرئيسية
- `chokidar.watch(path, [options])`: ابدأ في مراقبة ملف أو مجلد.
- الأحداث: `.on('add', callback)`, `.on('change', callback)`, `.on('unlink', callback)`, `.on('all', (event, path) => {})`.
- الخيارات: `{ ignored: /node_modules/, persistent: true }` (قم بالتخصيص حسب الحاجة).

### إذا كنت تقصد شيئًا آخر
إذا كنت لا تعمل مع بيئة Node.js على الإطلاق وتريد سلوكًا يشبه مراقبة الملفات بحتة في المتصفح (مثل مراقبة تغييرات `<input type="file">`)، فأعلمني! سيتضمن ذلك واجهة برمجة تطبيقات `File` ومستمعي الأحداث، وليس تشوكيدار.

ما هو إعدادك أو هدفك المحدد؟ يمكنني تخصيص هذا further!