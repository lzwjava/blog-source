---
audio: false
generated: true
lang: ar
layout: post
title: استيراد الشهادات باستخدام كيتول
translated: true
type: note
---

لمعالجة استفسارك حول استخدام أمر `keytool -importcert` لاستيراد شهادة إلى ملف `jre/lib/security/cacerts` ومواجهة خطأ "فشل التحقق من كلمة المرور" مع `java.security.UnrecoverableException`، دعنا نقسم المشكلة خطوة بخطوة لفهم القضية، وكيفية إصلاحها، وما قد تكون كلمة المرور المحتملة.

### فهم المشكلة

أداة `keytool` هي أداة سطر أوامر مرفقة مع Java Development Kit (JDK) تُستخدم لإدارة مخازن المفاتيح. مخزن المفاتيح هو ملف يخزن المفاتيح المشفرة والشهادات، غالبًا لتأمين اتصالات الشبكة مثل SSL/TLS. ملف `cacerts`، الموجود في `jre/lib/security`، هو مخزن مفاتيح محدد يأتي مع Java Runtime Environment (JRE). وهو يحتوي على مجموعة من شهادات الجذر الموثوقة من جهات إصدار الشهادات المعروفة، والتي تستخدمها تطبيقات Java افتراضيًا للتحقق من الاتصالات الآمنة.

عند تشغيل أمر `keytool -importcert` لإضافة شهادة جديدة إلى ملف `cacerts`، تحتاج إلى تقديم كلمة المرور الصحيحة لمخزن المفاتيح. رسالة الخطأ التي تراها—"فشل التحقق من كلمة المرور" متبوعة بـ `java.security.UnrecoverableException`—تشير إلى أن كلمة المرور التي قدمتها (أو لم تقدمها بشكل صحيح) لا تطابق كلمة مرور مخزن المفاتيح. ينشأ هذا الاستثناء عادةً عندما تكون كلمة المرور المقدمة غير صحيحة، مما يمنع `keytool` من الوصول إلى مخزن المفاتيح أو تعديله.

### الأمر المعني

الأمر الذي تستخدمه على الأرجح يبدو كالتالي:

```
keytool -importcert -file mycert.crt -keystore /path/to/jre/lib/security/cacerts -alias myalias
```

- `-file mycert.crt`: يحدد ملف الشهادة الذي تريد استيراده.
- `-keystore /path/to/jre/lib/security/cacerts`: يشير إلى مخزن المفاتيح `cacerts`.
- `-alias myalias`: يعين اسمًا فريدًا (اسمًا مستعارًا) للشهادة في مخزن المفاتيح.

عند تنفيذ هذا الأمر، يطلب منك `keytool` إدخال كلمة مرور مخزن المفاتيح. إذا كانت كلمة المرور التي أدخلتها غير صحيحة، تحصل على الخطأ الذي وصفته.

### تحديد كلمة المرور المحتملة

لملف `cacerts` في تثبيت JRE القياسي (مثل تلك من Oracle أو OpenJDK)، **كلمة المرور الافتراضية** هي **"changeit"**. هذا إعداد افتراضي موثق جيدًا عبر إصدارات Java والتوزيعات المختلفة. يخدم الاسم "changeit" كتذكير بأن المسؤولين قد يرغبون في تغييره لأسباب أمنية، ولكن في معظم التثبيتات القياسية غير المعدلة، يبقى دون تغيير.

نظرًا لأن أمرك يفشل بخطأ في التحقق من كلمة المرور، فإن المشكلة الأكثر احتمالاً هي إما:
1. أنك لم تدخل "changeit" بشكل صحيح (على سبيل المثال، خطأ مطبعي أو حالة أحرف غير صحيحة—كلمات المرور حساسة لحالة الأحرف).
2. لم تتم معاملة مطالبة كلمة المرور بشكل صحيح.
3. في بيئتك المحددة، تم تغيير كلمة المرور الافتراضية (على الرغم من أن هذا أقل شيوعًا لـ `cacerts` ما لم يتم تعديله صراحةً من قبل مسؤول النظام).

نظرًا لأن استفسارك لا يشير إلى إعداد مخصص، دعنا نفترض تثبيت JRE قياسيًا حيث يجب أن ينطبق "changeit".

### كيفية إصلاح المشكلة

إليك كيف يمكنك حل المشكلة:

1. **تأكد من إدخال كلمة المرور الصحيحة عند المطالبة**
   قم بتشغيل الأمر مرة أخرى:

   ```
   keytool -importcert -file mycert.crt -keystore /path/to/jre/lib/security/cacerts -alias myalias
   ```

   عند المطالبة بكلمة المرور، اكتب بعناية **"changeit"** (جميع الأحرف صغيرة، بدون مسافات) واضغط على Enter. تحقق مرة أخرى من الأخطاء المطبعية أو مشاكل تخطيط لوحة المفاتيح.

2. **حدد كلمة المرور في سطر الأوامر**
   لتجنب مشاكل المطالبة التفاعلية (على سبيل المثال، في البرامج النصية أو سلوك الطرفية الخاطئ)، يمكنك تضمين كلمة المرور مباشرة باستخدام خيار `-storepass`:

   ```
   keytool -importcert -file mycert.crt -keystore /path/to/jre/lib/security/cacerts -alias myalias -storepass changeit
   ```

   هذا يمرر "changeit" صراحةً ككلمة مرور، متجاوزًا المطالبة. إذا نجح هذا بدون أخطاء، فمن المحتمل أن المشكلة كانت في كيفية إدخال كلمة المرور سابقًا.

3. **تحقق من الأذونات**
   نظرًا لأن `cacerts` يوجد في دليل JRE (على سبيل المثال، `/usr/lib/jvm/java-11-openjdk/lib/security/cacerts` على Linux أو مسار مشابه على Windows)، تأكد من أن لديك أذونات الكتابة. قم بتشغيل الأمر بامتيازات المسؤول إذا لزم الأمر:
   - على Linux/Mac: `sudo keytool ...`
   - على Windows: قم بتشغيل موجه الأوامر كمسؤول.

   ومع ذلك، نظرًا لأن خطأك يتعلق بالتحقق من كلمة المرور وليس الوصول إلى الملف، فمن المرجح أن هذه ليست المشكلة الأساسية—ولكن من الجيد التأكد.

4. **تحقق من كلمة المرور**
   إذا فشل "changeit"仍然، فقد تم تغيير كلمة المرور في بيئتك. لاختبار كلمة المرور دون تعديل مخزن المفاتيح، حاول سرد محتوياته:

   ```
   keytool -list -keystore /path/to/jre/lib/security/cacerts
   ```

   أدخل "changeit" عند المطالبة. إذا قام بسرد الشهادات، فإن كلمة المرور صحيحة. إذا حصلت على نفس الخطأ، فإن كلمة المرور تختلف عن الافتراضي.

### ماذا لو لم تكن "changeit" هي كلمة المرور؟

إذا لم يعمل "changeit"، ففكر في هذه الاحتمالات:
- **كلمة مرور مخصصة**: في حالات نادرة، قد يكون مسؤول النظام قد قام بتغيير كلمة مرور `cacerts`. ستحتاج إلى الرجوع إلى وثائق النظام الخاصة بك أو المسؤول للحصول عليها. لا توجد طريقة لاستعادة كلمة مرور مخزن المفاتيح المفقودة مباشرةً؛ إذا كانت مجهولة حقًا، فقد تحتاج إلى استبدال ملف `cacerts` بنسخة جديدة من تثبيت JRE جديد (مما يعيد تعيينه إلى "changeit").
- **الإعدادات الافتراضية الخاصة بالبيئة**: قد تستخدم بعض توزيعات Java غير القياسية (مثل IBM JDK) افتراضيًا مختلفًا، ولكن هذا غير شائع، ويشير استفسارك إلى إعداد نموذجي.

بدون سياق إضافي، تظل "changeit" كلمة المرور الأكثر احتمالاً في بيئة JRE قياسية.

### الحل النهائي

لإصلاح مشكلتك:
- استخدم هذا الأمر، بافتراض وجود JRE قياسي:

  ```
  keytool -importcert -file mycert.crt -keystore /path/to/jre/lib/security/cacerts -alias myalias -storepass changeit
  ```

- إذا فشل، تحقق من كلمة المرور باستخدام أمر `-list` أو تحقق مع مسؤول النظام.

**كلمة المرور المحتملة** في هذا السيناريو، بناءً على اصطلاحات Java القياسية، هي **"changeit"**. يجب أن يحل هذا `java.security.UnrecoverableException` إذا تم إدخاله بشكل صحيح وإذا لم يتم تخصيص ملف `cacerts`.