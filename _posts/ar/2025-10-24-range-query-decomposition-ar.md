---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: تحليل الجذر التربيعي للاستعلامات النطاقية
translated: true
type: note
---

### تحليل الجذر التربيعي

تحليل الجذر التربيعي (يُختصر غالبًا باسم √-decomposition) هو أسلوب في علوم الكمبيوتر والبرمجة التنافسية يُستخدم لتحسين الاستعلامات النطاقية والتحديثات على المصفوفات أو هياكل البيانات الكبيرة. إنه مفيد بشكل خاص عندما تحتاج إلى الإجابة على استعلامات مثل "إيجاد المجموع/القيمة القصوى/الدنيا للعناصر في مصفوفة فرعية" بكفاءة، دون الاعتماد على آليات معقدة مثل أشجار القطاعات أو أشجار فينويك، والتي قد تكون أكثر تعقيدًا في التنفيذ.

#### لماذا نستخدمه؟
- **مقايضة تعقيد الوقت**: لمصفوفة بحجم \\( n \\)، تستغرق الاستعلامات النطاقية الساذجة وقتًا قدره \\( O(n) \\) لكل استعلام. يقلل تحليل الجذر التربيعي هذا إلى \\( O(\sqrt{n}) \\) لكل استعلام وتحديث، وهو ما يمثل توازنًا جيدًا للعديد من المسائل حيث يصل \\( n \\) إلى \\( 10^5 \\) أو \\( 10^6 \\).
- **البساطة**: إنه أسهل في البرمجة وتصحيح الأخطاء مقارنة بهياكل البيانات المتقدمة.
- **التطبيقات**: شائع في المسائل التي تتضمن استعلامات مجموع نطاقي، استعلامات الحد الأدنى النطاقي (RMQ)، أو عد التكرار في النوافذ المنزلقة.

#### كيف يعمل
1. **التقسيم إلى كتل**: قسّم المصفوفة إلى كتل بحجم \\( \sqrt{n} \\) (مقربًا للأسفل). إذا كان \\( n = 100 \\)، فإن حجم الكتلة \\( b = 10 \\)، وبالتالي تحصل على 10 كتل.
   - تخزن كل كتلة معلومات محسوبة مسبقًا (مثل مجموع العناصر في تلك الكتلة لاستعلامات المجموع).

2. **الاستعلام عن نطاق [L, R]**:
   - **الكتل الكاملة**: بالنسبة للكتل الكاملة التي تقع بالكامل ضمن [L, R]، ما عليك سوى جلب القيمة المحسوبة مسبقًا في وقت \\( O(1) \\) لكل كتلة. على الأكثر \\( O(\sqrt{n}) \\) كتل كاملة.
   - **الكتل الجزئية**: بالنسبة للحواف (الكتل الجزئية اليسرى واليمنى)، كرر عبر العناصر الفردية يدويًا، مما يستغرق إجمالي وقت \\( O(\sqrt{n}) \\) (نظرًا لأن حجم كل كتلة جزئية هو \\( \sqrt{n} \\)).
   - الإجمالي: \\( O(\sqrt{n}) \\).

3. **التحديثات**: عند تحديث عنصر، أعد بناء القيمة المحسوبة مسبقًا للكتلة التي ينتمي إليها في وقت \\( O(\sqrt{n}) \\) (عن طريق إعادة جمع الكتلة).

#### مثال بسيط: استعلام مجموع نطاقي
لنفترض أن لدينا مصفوفة `A = [1, 3, 2, 4, 5]` و \\( n=5 \\)، لذا حجم الكتلة \\( b = \sqrt{5} \approx 2 \\). الكتل:
- الكتلة 0: [1, 3] → المجموع = 4
- الكتلة 1: [2, 4] → المجموع = 6
- الكتلة 2: [5] → المجموع = 5 (قد تكون الكتلة الأخيرة أصغر)

استعلام المجموع من الفهرس 1 إلى 4 (على أساس الصفر: العناصر 3,2,4,5):
- جزئي يسار: الفهرس 1 (في الكتلة 0) → أضف 3
- الكتلة الكاملة 1: أضف 6
- جزئي يمين: الفهرس 4 (في الكتلة 2) → أضف 5
- الإجمالي: 3 + 6 + 5 = 14

لتنفيذه في الكود (كود زائف بلغة Python):
```python
import math

class SqrtDecomp:
    def __init__(self, arr):
        self.n = len(arr)
        self.b = int(math.sqrt(self.n))
        self.arr = arr[:]
        self.block_sums = [0] * ((self.n + self.b - 1) // self.b)
        self._build()
    
    def _build(self):
        for i in range(self.n):
            block_id = i // self.b
            self.block_sums[block_id] += self.arr[i]
    
    def update(self, idx, val):
        diff = val - self.arr[idx]
        self.arr[idx] = val
        block_id = idx // self.b
        self.block_sums[block_id] += diff
    
    def query(self, left, right):
        res = 0
        l_block, r_block = left // self.b, right // self.b
        
        if l_block == r_block:
            for i in range(left, right + 1):
                res += self.arr[i]
        else:
            # Left partial
            for i in range(left, (l_block + 1) * self.b):
                res += self.arr[i]
            # Full blocks
            for blk in range(l_block + 1, r_block):
                res += self.block_sums[blk]
            # Right partial
            for i in range(r_block * self.b, right + 1):
                res += self.arr[i]
        return res
```

هذا إصدار أساسي—قم بتكييفه للحد الأدنى/الأقصى عن طريق تخزين الحد الأدنى/الأقصى لكل كتلة بدلاً من المجاميع.

للتعمق أكثر، تحقق من مصادر مثل [GeeksforGeeks حول تحليل الجذر التربيعي](https://www.geeksforgeeks.org/sqrt-decomposition-algorithm-square-root-decomposition-technique-set-1-introduction/) أو [CP-Algorithms](https://cp-algorithms.com/data_structures/sqrt_decomposition.html).