---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-code-fast-1
title: مصفوفات تهيئة وكيل مستخدم CodeIgniter
translated: true
type: note
---

### نظرة عامة
هذا المقتطف البرمجي PHP هو جزء من إطار عمل CodeIgniter (إطار عمل ويب PHP)، وتحديداً من ملف تكوين فئة وكيل المستخدم. يحدد أربعة مصفوفات (`$platforms`، `$browsers`، `$mobiles`، و `$robots`) تربط أجزاء سلسلة وكيل المستخدم بأسماء مقروءة للإنسان للمتصفحات وأنظمة التشغيل والأجهزة المحمولة وزواحف الويب/البوتات. يُستخدم الكود لتحليل وتحديد نوع الجهاز أو المتصفح أو البوت الذي يزور موقع ويب بناءً على رأس HTTP User-Agent الذي يرسله العملاء.

المصفوفات ترابطية (أزواج مفتاح-قيمة)، حيث تكون المفاتيح عبارة عن سلاسل جزئية من سلاسل وكيل المستخدم (مطابقات غير حساسة لحالة الأحرف)، والقيم هي أسماء العرض المقابلة. تستخدم مكتبة User Agent في CodeIgniter هذه المصفوفات للكشف، مثل تحديد ما إذا كان الزائر يستخدم Android، أو Chrome، أو إذا كان بوت بحث.

### مصفوفة $platforms
تحدد هذه المصفوفة أنظمة التشغيل أو المنصات. المفاتيح هي سلاسل فرعية قد تظهر في رأس User-Agent، والقيم هي أسماء نظيفة للعرض.

- **إدخالات مثال**:
  - `'windows nt 10.0'` → `'Windows 10'`
  - `'android'` → `'Android'`
  - `'os x'` → `'Mac OS X'`
- **الغرض**: يساعد في اكتشاف نظام تشغيل العميل (مثل Windows، iOS، Linux) لأغراض التحليلات، أو تخصيص المحتوى، أو تعديل الميزات.
- **ملاحظة**: الترتيب مهم للدقة، حيث قد تتداخل بعض السلاسل الفرعية (مثل `'windows'` كحالة شاملة في النهاية).

### مصفوفة $browsers
تحدد متصفحات الويب. غالبًا ما تبلغ المتصفحات عن معرّفات متعددة، لذا فإن الترتيب يعطي الأولوية للأنواع الفرعية أولاً (حسب التعليق الموجود في الكود).

- **إدخالات مثال**:
  - `'Chrome'` → `'Chrome'`
  - `'MSIE'` → `'Internet Explorer'`
  - `'Firefox'` → `'Firefox'`
  - حالة خاصة: `'Opera.*?Version'` (مطابقة تشبه التعبير النمطي) لأوبرا الحديثة التي تبلغ باسم "Opera/9.80" مع إصدار.
- **الغرض**: يحدد المتصفح (مثل Chrome، Safari) لتقديم ميزات خاصة بمتصفح معين أو إعادة التوجيه.
- **ملاحظة حول التعبير النمطي**: تستخدم بعض المفاتيح أنماط تعابير نمطية أساسية (مثل `.*?` للمطابقة العامة)، ويتم التعامل معها في المكتبة.

### مصفوفة $mobiles
تربط علامات وكيل المستخدم للأجهزة المحمولة والهواتف والأجهزة/المتصفحات ذات الصلة. إنها أكبر وتشمل الهواتف والأجهزة اللوحية ومنصات الألعاب وفئات الاحتياط.

- **أقسام منظمة**:
  - الهواتف/الشركات المصنعة: `'iphone'` → `'Apple iPhone'`، `'samsung'` → `'Samsung'`.
  - أنظمة التشغيل: `'android'` → `'Android'`، `'symbian'` → `'Symbian'`.
  - المتصفحات: `'opera mini'` → `'Opera Mini'`، `'fennec'` → `'Firefox Mobile'`.
  - أخرى/احتياطية: `'mobile'` → `'Generic Mobile'` للعلامات المحمولة غير المطابقة.
- **الغرض**: يحدد الأجهزة المحمولة لتصميم متجاوب، أو ميزات مخصصة للمحمول فقط، أو إعادة توجيه للتطبيقات. يتضمن إدخالات قديمة (بعضها معلق كإدخالات قديمة).

### مصفوفة $robots
تسرد زواحف الويب والبوتات الشائعة. المفاتيح هي سلاسل فرعية من وكلاء مستخدم البوتات.

- **إدخالات مثال**:
  - `'googlebot'` → `'Googlebot'`
  - `'bingbot'` → `'Bing'`
  - `'yandex'` → `'YandexBot'`
- **الغرض**: يحدد الزواحف للتعامل مع تحسين محركات البحث، مثل تقديم محتوى مختلف للبوتات (مثل عدم عرض الإعلانات) أو تسجيل حركة مرور البوتات.

### الاستخدام في CodeIgniter
- تقوم فئة User Agent بتحميل هذا الملف وتستخدم طرقًا مثل `is_browser()`، `is_mobile()`، `is_robot()`، و `platform()` لتحليل سلسلة User-Agent.
- تقوم بإجراء عمليات بحث غير حساسة لحالة الأحرف عبر هذه المصفوفات لمطابقة المفاتيح مع السلسلة.
- بالنسبة للتناقضات (مثل الأجهزة أو المتصفحات الجديدة غير المدرجة)، يمكنك تحديث هذه المصفوفات يدويًا أو عبر امتدادات المجتمع.

### ملاحظات إضافية
- **الأمان**: هذا مخصص لجمع البيانات فقط؛ لا ينفذ كودًا ضارًا. يمكن تزوير سلاسل User-Agent، لذا لا تعتمد على هذا للفحوصات الأمنية الحرجة.
- **التحديثات**: قد تكون إصدارات CodeIgniter قد أضافت أو عدلت إدخالات؛ يبدو هذا لقطة قديمة (على سبيل المثال، Edge باسم 'Spartan' قديم).
- **كيفية الاختبار**: في سكريبت PHP، يمكنك تحميل هذا واستخدام `strpos` أو التعبير النمطي للمطابقة ضد سلسلة User-Agent نموذجية.

إذا كان لديك جزء محدد أو لديك سؤال حول التنفيذ، دعني أعلم!