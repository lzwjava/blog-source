---
audio: false
date: 2025-09-11
generated: true
image: false
lang: ar
layout: post
model: openai/gpt-5
title: دليل وكلاء الذكاء الاصطناعي في مستودع Mono لـ Java Spring
translated: true
type: note
---

سؤال رائع. إليك وكالات الذكاء الاصطناعي العملية عالية الاستفادة التي يمكنك تخصيصها لـ monorepo يعمل بتقنية Java/Spring (متعدد الوحدات، Maven/Jetty/Liberty، JaCoCo، إلخ). سأركز على المحفزات الملموسة، وما تنتجه، وكيفية ربطها — دون استخدام جداول.

# وكلاء الهندسة الأساسية

**1) مراجع كود طلبات السحب (المدرك لتقنية Spring)**

* **المحفزات:** عند فتح طلب سحب.
* **ما يفعله:** يقرأ الاختلافات + حبوب Spring والإعدادات التي تم التعديل عليها؛ يحدد مشاكل حقن التبعيات، والحبوب ذات النطاق الخاطئ، والـ `@Transactional` المفقودة، ومخاطر N+1 مع JPA، وإساءة استخدام `@Scheduled`، وتسريبات الخيوط مع العمليات غير المتزامنة، والمكالمات المعيقة في سلاسل reactive.
* **المدخلات:** الاختلافات + `pom.xml` + `application*.yml` + فئات `@Configuration`.
* **المخرجات:** اقتراحات تعليقات على الأسطر، ملخص للمخاطر، تصحيحات سريعة.

**2) مُحسّن التبعيات والإضافات**

* **المحفزات:** وظيفة يومية/أسبوعية.
* **ما يفعله:** يقترح ترقيات إصدارات متوافقة لـ Spring Boot/Framework، وSpring Data/Cloud، وJetty/Liberty، وإضافات Maven، يتحقق من الثغرات الأمنية CVE، ويشغل بناء تجريبي.
* **المخرجات:** طلبات سحب مجمعة حسب مستوى الخطورة (ترقيع، ثانوي، رئيسي)، مع سجل التغييرات وملاحظة التراجع.

**3) حارس عقد واجهة برمجة التطبيقات**

* **المحفزات:** عند طلبات السحب التي تمس وحدات التحكم أو ملف `openapi.yaml`.
* **ما يفعله:** يحافظ على تزامن مواصفات OpenAPI مع تعريفات Spring MVC؛ يكتشف التغييرات غير المتوافقة (رموز HTTP، إعادة تسمية الحقول، nullable/required).
* **المخرجات:** تعليق يوضح الاختلاف في سطح واجهة برمجة التطبيقات؛ نماذج اختيارات عقدية اختيارية على غرار Pact.

**4) كاتب الاختبارات وطبيب الاختبارات غير المستقرة**

* **المحفزات:** عند طلب سحب (مع انخفاض في نسبة التغطية بالاختبارات) وليلاً.
* **ما يفعله:** يولد/يوسع اختبارات JUnit 5 للخدمات ووحدات التحكم والمستودعات؛ يثبت الاختبارات غير المستقرة (الوقت، المجلدات المؤقتة، التزامن)، يقترح أنماطًا حتمية، يعزل الساعة باستخدام `Clock`.
* **المخرجات:** اختبارات جديدة، معاملات، تلميحات لاستبدال أوامر الانتظار بـ Awaitility.

**5) منسق التغطية (اختبار وحدة+اختبار تكامل، متعدد الوحدات)**

* **المحفزات:** بعد اختبارات التكامل في التكامل المستمر.
* **ما يفعله:** يربط وكيل JaCoCo بـ Jetty/Liberty، يدمج `jacoco.exec`/`jacoco-it.exec`، يعين الفئات عبر الوحدات، يسلط الضوء على المسارات الحرجة غير المختبرة.
* **المخرجات:** تقرير HTML/XML مدمج؛ تعليق يسرد أهم 10 دوال غير مغطاة لكل وحدة مع اقتراح هيكل للاختبارات.

**6) فرز السجلات والحوادث**

* **المحفزات:** عند فشل وظائف التكامل المستمر، أو البث المباشر من بيئة التدقيق أو الإنتاج.
* **ما يفعله:** يجمع متتبعات المكدس في مجموعات، يرتبطها بآخر نشر، يربطها بالعمليات المشبوهة؛ يقترح تصحيحات سريعة وأعلام ميزات للتبديل.
* **المخرجات:** فرضيات عن السبب الجذري، قائمة مراجعة "الخطوة التالية"، روابط لـ Grafana/ELK.

**7) مدرب تحليل الأداء**

* **المحفزات:** عند تشغيل اختبار حمل أو تنبيه لنقطة نهاية بطيئة.
* **ما يفعله:** يقرأ مخرجات JFR/async-profiler + مقاييس Spring actuator؛ يكتشف حدود `@Transactional` البطيئة، ومشاكل N+1، وأدوات التعيين الثقيلة، وأحجام المجموعات غير المناسبة.
* **المخرجات:** خطة أداء مركزة (تلميحات لجلب JPA، فهارس، أحجام مجمعات، ذاكرة تخزين مؤقت).

**8) مساعد ترحيل قواعد البيانات (المدرك لـ Db2/MySQL/Postgres)**

* **المحفزات:** عند تغيير Flyway/Liquibase أو تقارير الاستعلامات البطيئة.
* **ما يفعله:** يراجع لغة تعريف البيانات من حيث القفل، يضيف فهارس، يحاكي ترتيب الترحيل؛ ينتج نصوصًا للتراجع؛ يعيد كتابة استعلامات JPQL/Criteria غير الفعالة إلى SQL مع تلميحات.
* **المخرجات:** طلب سحب للمرحلية تمت مراجعته، ملاحظات explain-plan، خطوات نشر آمنة.

**9) الحارس الأمني والأسرار**

* **المحفزات:** عند كل طلب سحب ومسح ليلي.
* **ما يفعله:** فحص SAST للإعدادات الخاطئة في Spring Security، وCSRF/الترويسات، وإزالة التسلسل، وحقن SpEL؛ يفحص البحث عن الأسرار في YAML، وخصائص، وأدوات الاختبار.
* **المخرجات:** تعليقات داخلية على طلب السحب، اقتراحات لاختلافات `SecurityFilterChain`.

**10) مدقق انحراف الإعدادات والملفات الشخصية**

* **المحفزات:** عند طلبات السحب التي تمس `application*.yml`.
* **ما يفعله:** يتحقق من صحة تراكبات الملفات الشخصية، وربط متغيرات البيئة، والإعدادات الافتراضية المفقودة؛ يكتشف المفاجآت الخاصة بالإنتاج فقط (مثل `spring.jpa.open-in-view` مختلف).
* **المخرجات:** معاينة "للإعدادات الفعالة" حسب الملف الشخصي والبيئة.

**11) شرطي البناء (Maven متعدد الوحدات)**

* **المحفزات:** عند كل بناء.
* **ما يفعله:** يشخص ترتيب الإضافات، البناء القابل للتكرار، تحذيرات الترميز، إعدادات fork للاختبارات، تسليم Surefire/Failsafe، انحدارات الرسم البياني للوحدات.
* **المخرجات:** تصحيحات محددة لـ `pom.xml` ووصفة لبناء أسرع.

**12) كاتب ملاحظات الإصدار وسجل التغييرات**

* **المحفزات:** عند وضع علامة أو دمج فرع إصدار.
* **ما يفعله:** يجمع العمليات حسب النطاق/الوحدة التقليدي؛ يسحب تغييرات واجهة برمجة التطبيقات البارزة والترحيل؛ يتضمن خطوات الترقية.
* **المخرجات:** قسم في `CHANGELOG.md` + مسودة لجسم إصدار GitHub.

# أنماط "الربط" الشاملة

**مصادر الأحداث:** طلبات سحب/أحداث GitHub، Jenkins، مراحل Maven، مهام Gradle (إن وجدت)، خطوات أنابيب السجلات، مخرجات JFR، مقاييس Actuator، عمليات تشغيل Pact/Postman.
**حزم السياق:** الاختلافات + الوحدات التي تم التعديل عليها، أشجار `pom.xml`، OpenAPI، `application*.yml`، الإعدادات الرئيسية (`SecurityFilterChain`، `DataSource`، `JpaRepositories`)، تقارير الاختبار، JaCoCo XML، مخططات اللهب لأداء البرنامج.
**أهداف الاستجابة:** تعليقات على طلبات السحب مع تصحيحات داخل الكود، فحوصات الحالة، طلبات سحب تلقائية، تقارير markdown مخزنة كقطع أثرية للبناء.

# ربط بسيط (سهل النسخ واللصق)

**1) خطوة GitHub Action لإعداد سياق المستودع للوكلاء**

```yaml
- name: Prepare Spring context bundle
  run: |
    mkdir -p .agent_ctx
    git diff -U0 origin/main... > .agent_ctx/diff.patch || true
    find . -name "pom.xml" -o -name "build.gradle*" > .agent_ctx/build_files.txt
    find . -name "application*.yml" -o -name "application*.properties" > .agent_ctx/configs.txt
    find . -name "openapi*.yaml" -o -name "openapi*.yml" > .agent_ctx/openapi.txt
```

**2) دمج JaCoCo (اختبار وحدة + اختبار تكامل) لمتعدد الوحدات**

```bash
mvn -q -DskipITs=false -P it-tests verify
mvn -q org.jacoco:jacoco-maven-plugin:prepare-agent verify
mvn -q org.jacoco:jacoco-maven-plugin:report-aggregate
# إذا كنت تجمع اختبارات تكامل خارجية مع تشغيل Jetty/Liberty:
# java -javaagent:jacocoagent.jar=destfile=jacoco-it.exec,append=true ...
# ثم الدمج:
mvn -q org.jacoco:jacoco-maven-plugin:merge \
  -DdestFile=target/jacoco-merged.exec \
  -Dfile1=target/jacoco.exec -Dfile2=target/jacoco-it.exec
mvn -q org.jacoco:jacoco-maven-plugin:report \
  -DdataFile=target/jacoco-merged.exec
```

**3) مساعد التعليق على طلبات السحب (ChatOps style)**

```yaml
- name: Post agent findings
  if: always()
  run: |
    echo "### API Contract Changes" > agent-comment.md
    echo "" >> agent-comment.md
    cat target/api-diff.md >> agent-comment.md || true
- uses: marocchino/sticky-pull-request-comment@v2
  with:
    path: agent-comment.md
```

# ما يجب بناؤه أولاً (أعلى عائد استثمار)

1.  **مراجعة كود طلبات السحب + مدقق الإعدادات**: يكتشف 70% من أخطاء Spring الشائعة مبكرًا.
2.  **منسق التغطية**: يدمج اختبارات الوحدة واختبارات التكامل الخارجية (في حالتك) ويخرج مهام اختبار لكل وحدة.
3.  **حارس عقد واجهة برمجة التطبيقات**: يمنع كسر العملاء؛ جهد صغير، يتفادى ألمًا كبيرًا.
4.  **مُحسّن التبعيات + الحارس الأمني**: نظافة مستمرة بأقل ضوضاء.

# الضوابط والجودة

*   **الحتمية:** يجب أن يتضمن الوكلاء معرفات القواعد وروابط لأسطر الكود الدقيقة التي قاموا بتحليلها.
*   **ميزانيات التغيير:** حدد التعديلات التلقائية بتصحيحات صغيرة؛ التحويلات الأكبر تصبح طلبات سحب مسودة.
*   **الخصوصية/الوصول:** قيد سجلات الإنتاج/لقطات قاعدة البيانات؛ احذف الأسرار قبل استدعاء النموذج.
*   **المقاييس:** تتبع MTTR (فشل → إصلاح)، معدل عدم الاستقرار، دلتا تغطية الاختبار، مؤشرات مستوى خدمة الأداء. استخدم بطاقات تقييم أسبوعية للوكيل.

# إذا أردت، يمكنني:

*   صياغة **سير عمل GitHub Actions جاهز للإسقاط** يشغل "مراجعة كود طلبات السحب + حارس عقد واجهة برمجة التطبيقات + منسق التغطية" باستخدام وحداتك وإعداد JaCoCo الخاص بك.
*   إنشاء **قواعد بداية** مضبوطة لتقنيتك (Jetty/Liberty، Db2، Maven متعدد الوحدات).

أخبرني بهيكل مستودعك (أسماء الوحدات) وكيفية تشغيلك لاختبارات التكامل حاليًا (Jetty مقابل Liberty)، وسأقدم لك ملف YAML + نصوص مساعدة صغيرة.