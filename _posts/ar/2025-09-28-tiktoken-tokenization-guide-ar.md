---
audio: false
generated: true
image: false
lang: ar
layout: post
model: anthropic/claude-sonnet-4
title: دليل ترميز TikToken وأمثلة عليه
translated: true
type: note
---

يعرض هذا الكود كيفية استخدام مكتبة **TikToken**، وهي أداة OpenAI لعد ومعالجة الرموز المميزة (tokens) في النص الذي سيتم إرساله إلى نماذج اللغة مثل GPT-3.5، GPT-4، إلخ.

## ما الذي تقوم به TikToken

تقوم TikToken بتحويل النص إلى **رموز مميزة (tokens)** - وهي الوحدات الأساسية التي تعالجها نماذج اللغة. كل رمز مميز يقابل تقريبًا كلمة أو جزءًا من كلمة. فهم عملية الترميز (tokenization) أمر بالغ الأهمية لأن:

- تكاليف الـ API تعتمد على عدد الرموز المميزة
- للنماذج حدود قصوى للرموز المميزة للمدخلات والمخرجات
- عدد الرموز المميزة يؤثر على سرعة المعالجة

## شرح الكود

### 1. الترميز الأساسي (`basic_encoding()`)
```python
enc = tiktoken.encoding_for_model("gpt-3.5-turbo")
tokens = enc.encode("Hello, how are you doing today?```
- ينشئ أداة ترميز لنموذج GPT-3.5-turbo
- يحول النص إلى قائمة من معرفات الرموز المميزة: `[9906, 11, 1268, 527, 499, 3815, 3432, 30]`
- يوضح أن جملة "Hello, how are you doing today?" تساوي 8 رموز مميزة
- يمكن فك ترميز الرموز المميزة لإعادة النص الأصلي

### 2. مقارنة النماذج (`different_models()`)
تقارن كيف تقوم النماذج المختلفة بترميز نفس النص:
- **GPT-4**: 10 رموز مميزة لجملة "The quick brown fox jumps over the lazy dog."
- **GPT-3.5-turbo**: 10 رموز مميزة (نفس الترميز)
- **text-davinci-003**: 10 رموز مميزة (نفس الترميز)

قد تستخدم النماذج المختلفة أدوات ترميز مختلفة، لذا يمكن أن يختلف عدد الرموز المميزة.

### 3. المعالجة المجمعة (`batch_processing()`)
توضح كيفية معالجة نصوص متعددة بكفاءة:
- تعالج 3 رسائل بأطوال مختلفة
- تحسب إجمالي الرموز المميزة عبر جميع الرسائل (15 إجمالاً)
- مفيدة لتقدير التكاليف عند إرسال رسائل متعددة

### 4. الرموز المميزة الخاصة (`special_tokens()`)
تتعامل مع رموز التحكم الخاصة مثل `<|endoftext|>`:
- تعرض الرموز المميزة الخاصة المتاحة للنموذج
- توضح ترميز النص الذي يحتوي على رموز مميزة خاصة
- تستخدم `allowed_special="all"` لمعالجة الرموز المميزة الخاصة

### 5. العد الفعال (`count_tokens_efficiently()`)
طريقتان لحساب الرموز المميزة:
- **الطريقة 1**: تخزين الرموز ثم العد (`len(enc.encode(text))`)
- **الطريقة 2**: العد المباشر (أكثر كفاءة في استخدام الذاكرة للنصوص الكبيرة)
- تحسب نسبة الرموز المميزة لكل كلمة (1.29 في هذا المثال)

## التطبيقات العملية

1. **تقدير التكلفة**: حساب تكاليف الـ API قبل إجراء الطلبات
2. **التحقق من صحة المدخلات**: التأكد من أن النص يتناسب مع حدود الرموز المميزة للنموذج
3. **تحسين المجموعات**: تجميع الرسائل بكفاءة لاستدعاءات الـ API
4. **مراقبة الأداء**: تتبع استخدام الرموز المميزة في التطبيقات

## الرؤى الأساسية من المخرجات

- العبارات البسيطة تستخدم رموزًا مميزة أقل مما قد تتوقع
- عدد الرموز المميزة لا يساوي دائمًا عدد الكلمات
- النماذج المختلفة قد تقوم بالترميز بشكل مختلف
- الرموز المميزة الخاصة تتطلب معالجة دقيقة

هذه المكتبة ضرورية لأي شخص يبني تطبيقات باستخدام واجهات برمجة التطبيقات (APIs) من OpenAI، حيث توفر عدًا دقيقًا للرموز المميزة يتطابق مع ما ستحاسبك عليه واجهة برمجة التطبيقات فعليًا.