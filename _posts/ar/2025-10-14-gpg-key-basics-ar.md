---
audio: false
generated: true
image: false
lang: ar
layout: post
model: openai/gpt-5
title: أساسيات إدارة مفاتيح GPG
translated: true
type: note
---

## مقدمة إلى إدارة مفاتيح GPG

GPG (GNU Privacy Guard) هو تطبيق مجاني لمعيار OpenPGP يستخدم للاتصال الآمن، ويُستخدم لتشفير البيانات وتوقيعها والتحقق منها. في صميم عمله تقع **التشفير باستخدام المفتاح العام**، حيث يمتلك كل مستخدم **مفتاحًا عامًا** (يُشارك علانية للتشفير والتحقق) و**مفتاحًا خاصًا** (يُحفظ سرًا لفك التشفير والتوقيع). تتضمن إدارة المفاتيح إنشاءها وتوزيعها وصيانتها وتأمينها لمنع العبث بها أو اختراقها أو إساءة استخدامها. يمكن أن تؤدي الإدارة السيئة إلى هجمات مثل استبدال المفتاح، حيث يستبدل المهاجم مفتاحك بمفتاحه الخاص لاعتراض الاتصالات.

يسمح نموذج "شبكة الثقة" في GPG للمستخدمين بالتصديق على مفاتيح بعضهم البعض، مما يبني شبكة من الهويات الموثوقة. يتم تخزين المفاتيح في **حلقات المفاتيح** (ملفات عامة وخاصة، مثل `pubring.kbx` و`secring.gpg` في الإصدارات القديمة، أو موحدة في الإصدارات الأحدث). دائمًا قم بنسخ مفاتيحك الخاصة احتياطيًا واستخدم عبارات مرور قوية.

## هيكل المفتاح

زوج مفاتيح GPG ليس مجرد مفتاح واحد — إنه حزمة:
- **المفتاح الأساسي**: مفتاح رئيسي للتوقيع (مثل RSA أو DSA) يُستخدم للتصديق (توقيع) المفاتيح الأخرى وتوقيع مكونات مفتاحك ذاتيًا.
- **المفاتيح الفرعية**: مفاتيح تابعة اختيارية لمهام محددة:
  - مفتاح فرعي للتوقيع: لتوقيع الرسائل.
  - مفتاح فرعي للتشفير: لتشفير البيانات (غالبًا ما يتم تدويره دوريًا).
  - مفتاح فرعي للمصادقة: لـ SSH أو ما شابه.
- **معرفات المستخدم (UIDs)**: سلاسل مثل "Alice (تعليق) <alice@example.com>" تربط المفتاح بهوية حقيقية. يمكن أن يوجد معرفات مستخدم متعددة لأدوار مختلفة.
- **التوقيعات الذاتية**: يوقع المفتاح الأساسي على مكوناته الخاصة لمنع العبث.

عرض هيكل المفتاح بشكل تفاعلي:
```
gpg --edit-key <معرف-المفتاح-أو-البريد-الإلكتروني>
```
داخل القائمة، استخدم `check` للتحقق من التوقيعات الذاتية أو `toggle` لرؤية الأجزاء الخاصة (إذا كانت متاحة).

## إنشاء المفاتيح

ابدأ بزوج المفاتيح الأساسي. استخدم الطريقة التفاعلية للمبتدئين:

1. شغِّل `gpg --full-gen-key` (أو `--gen-key` للإعدادات الافتراضية).
2. اختر نوع المفتاح (الافتراضي: RSA لكل من التوقيع والتشفير).
3. حدد حجم المفتاح (مثل 4096 بت لأمان أقوى؛ الحد الأدنى الموصى به هو 2048).
4. عيّن تاريخ انتهاء الصلاحية (مثل 1y لمدة سنة واحدة؛ "0" لعدم الانتهاء — تجنب عدم التحديد إن أمكن).
5. أدخل معرف المستخدم (الاسم، البريد الإلكتروني).
6. عيّن عبارة مرور قوية (20+ حرفًا، مزيج من الأحرف الكبيرة/الصغيرة والرموز).

للإنشاء السريع (غير التفاعلي):
```
gpg --quick-generate-key "Alice <alice@example.com>" rsa default 1y
```

بعد الإنشاء، أنشئ **شهادة إلغاء** (ملف لإبطال مفتاحك إذا تم اختراقه):
```
gpg --output revoke.asc --gen-revoke <معرف-مفتاحك>
```
احفظ هذا الملف بأمان (مطبوع في خزنة مثلًا) — لا تشاركه حتى الحاجة إليه.

لإضافة مفاتيح فرعية أو معرفات مستخدم لاحقًا:
- ادخل إلى `gpg --edit-key <معرف-المفتاح>`، ثم `addkey` (للمفتاح الفرعي) أو `adduid` (لمعرف المستخدم). يتم توقيع هذه تلقائيًا ذاتيًا.

## سرد وعرض المفاتيح

- سرد المفاتيح العامة: `gpg --list-keys` (أو `--list-public-keys`).
- سرد المفاتيح الخاصة: `gpg --list-secret-keys`.
- عرض مفصل: `gpg --list-keys --with-subkey-fingerprint <معرف-المفتاح>` (يعرض بصمات المفاتيح الفرعية).

يُظهر الناتج معرف المفتاح (قصير/طويل)، تواريخ الإنشاء/انتهاء الصلاحية، الإمكانيات (مثل `[SC]` للتوقيع/التصديق)، ومعرفات المستخدم.

## تصدير واستيراد المفاتيح

**التصدير** لمشاركة مفتاحك العام أو نسخ المفاتيح الخاصة احتياطيًا:
- المفتاح العام: `gpg --armor --export <معرف-المفتاح> > mykey.asc` (مشفر بـ ASCII للبريد الإلكتروني).
- المفتاح الخاص (للنسخ الاحتياطي فقط): `gpg --armor --export-secret-keys <معرف-المفتاح> > private.asc`.
- إلى خادم مفاتيح: `gpg --keyserver hkps://keys.openpgp.org --send-keys <معرف-المفتاح>`.

**الاستيراد** يضيف مفاتيح الآخرين إلى حلقة مفاتيحك العامة:
- `gpg --import <file.asc>` (يدمج مع الموجود؛ يضيف توقيعات/مفاتيح فرعية جديدة).
- من خادم مفاتيح: `gpg --keyserver hkps://keys.openpgp.org --recv-keys <معرف-المفتاح>`.

بعد الاستيراد، تحقق باستخدام `gpg --edit-key <معرف-المفتاح>` و `check` للتحقق من التوقيعات الذاتية.

## توقيع والتصديق على المفاتيح

لبناء الثقة:
- وقّع على مفتاح (صدّق على صحته): `gpg --sign-key <معرف-مفتاح-آخر>` (أو `lsign-key` للمحلي فقط).
- توقيع سريع: `gpg --quick-sign-key <البصمة> "معرف المستخدم"`.
- عيّن مستوى الثقة: في `--edit-key`، استخدم `trust` (مثل "5" للثقة المطلقة).

هذا ينشئ توقيعات على المفتاح، تكون مرئية في القوائم. تحسب شبكة الثقة الصلاحية بناءً على ثقتك في الموقعين.

## إلغاء المفاتيح

إلغاء المفتاح يبطله أو يبطل أحد مكوناته دون حذفه، مما يضمن أن الآخرين يرون أنه لم يعد صالحًا:
- المفتاح الكامل: استورد شهادة الإلغاء الخاصة بك: `gpg --import revoke.asc`، ثم صدّر/أرسل المفتاح المحدث.
- المفتاح الفرعي/معرف المستخدم: في `--edit-key`، اختر باستخدام `key 1` أو `uid 1`، ثم `revkey` أو `revuid`.
- إلغاء سريع لمعرف المستخدم: `gpg --quick-revoke-uid <معرف-المفتاح> <معرف-المستخدم-الملغي>`.

أسباب الإلغاء: تم اختراقه، لم يعد مستخدمًا، تم استبداله. دائمًا انشر المفاتيح الملغاة.

## أفضل الممارسات

- **الأمان**: استخدم الرموز المادية (مثل YubiKey) للمفاتيح الخاصة. دوّر مفاتيح التشفير الفرعية سنويًا (`gpg --quick-add-key <البصمة> rsa encr 1y`). غيّر عبارات المرور بانتظام (`gpg --change-passphrase <معرف-المفتاح>`).
- **انتهاء الصلاحية**: عيّن تواريخ انتهاء صلاحية معقولة (1-2 سنوات) لإجبار التحديثات واكتشاف الاختراقات.
- **التوزيع**: شارك المفاتيح العامة عبر خوادم المفاتيح أو مباشرة؛ تحقق من البصمات شخصيًا أو عبر قنوات موثوقة لتجنب هجمات الرجل في المنتصف.
- **النسخ الاحتياطي**: صدّر المفاتيح الخاصة إلى تخزين مشفر. أنشئ شهادات الإلغاء فورًا.
- **التنظيف**: استخدم `gpg --edit-key` مع `clean` لإزالة التوقيعات غير الصالحة.
- **التحديثات**: اعتبارًا من 2025، يدعم GnuPG 2.5+ خوارزميات مقاومة للحوسبة الكمومية (مثل `--quick-generate-key ... pqc`)؛ فكّر في الانتقال لضمان الاستدامة المستقبلية.
- **المزالق الشائعة**: لا تشارك المفاتيح الخاصة أبدًا. تجنب تواريخ انتهاء الصلاحية غير المحددة. اختبر عمليات الإلغاء في بيئة اختبار.

للتجربة العملية، جرّب في دليل اختبار باستخدام `gpg --homedir ./test-gpg`.

[كتيب GnuPG: إدارة المفاتيح](https://www.gnupg.org/gph/en/manual/c235.html)  
[دليل GNU Privacy Guard: إدارة مفاتيح OpenPGP](https://www.gnupg.org/documentation/manuals/gnupg/OpenPGP-Key-Management.html)  
[بدء استخدام GnuPG](https://www.gnupg.org/gph/en/manual/c14.html)