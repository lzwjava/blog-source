---
audio: true
lang: ar
layout: post
title: ماسح الشبكة (IP)
translated: true
---

## ماسح عنوان IP للشبكة المحلية

هذا البرنامج النصي بلغة بايثون يمسح شبكة محلية بحثًا عن عناوين IP نشطة. وهو يستخدم الأمر `ping` للتحقق مما إذا كان المضيف متصلاً، ويستخدم تعدد الخيوط لتسريع عملية المسح. ويحدد إشارة مرور عدد الخيوط المتزامنة لتجنب إثقال كاهل النظام. يأخذ البرنامج النصي عنوان الشبكة (مثل "192.168.1.0/24") كمدخل، ويطبع ما إذا كان كل عنوان IP في الشبكة قيد التشغيل أو معطل.

يساعد هذا البرنامج النصي على تحديد الأجهزة الموجودة على الشبكة، مثل جهاز توجيه شبكي من TP-LINK يعمل في وضع الجسر السلكي، من خلال البحث عن عناوين IP النشطة.


```python
import subprocess
import ipaddress
import threading
import os

MAX_THREADS = 50  # الحد الأقصى لعدد الخيوط المستخدمة

def is_host_up(host):
    """
    يتحقق مما إذا كان المضيف قيد التشغيل باستخدام ping.
    يُرجع True إذا كان المضيف قيد التشغيل، و False بخلاف ذلك.
    """
    try:
        # -c 1: إرسال حزمة واحدة فقط
        # -W 1: الانتظار لمدة ثانية واحدة للحصول على استجابة
        subprocess.check_output(["ping", "-c", "1", "-W", "1", host], timeout=1)
        return True
    except subprocess.CalledProcessError:
        return False
    except subprocess.TimeoutExpired:
        return False

def scan_ip(ip_str):
    """
    يمسح عنوان IP واحدًا ويطبع حالته.
    """
    if is_host_up(ip_str):
        print(f"{ip_str} is up")
    else:
        print(f"{ip_str} is down")

def scan_network(network):
    """
    يمسح شبكة بحثًا عن مضيفين نشطين باستخدام الخيوط، مع تحديد الحد الأقصى لعدد الخيوط المتزامنة.
    """
    print(f"Scanning network: {network}")
    threads = []
    semaphore = threading.Semaphore(MAX_THREADS)  # تحديد الحد الأقصى لعدد الخيوط المتزامنة

    def scan_ip_with_semaphore(ip_str):
        semaphore.acquire()
        try:
            scan_ip(ip_str)
        finally:
            semaphore.release()

    for ip in ipaddress.IPv4Network(network):
        ip_str = str(ip)
        thread = threading.Thread(target=scan_ip_with_semaphore, args=(ip_str,))
        threads.append(thread)
        thread.start()

    for thread in threads:
        thread.join()

if __name__ == "__main__":
    network_to_scan = "192.168.1.0/24"  # غيّر هذا إلى شبكتك
    scan_network(network_to_scan)

```

## تجاوز عناوين IP المحلية

يحدد البرنامج النصي عناوين IP النشطة. للتأكد من الاتصال الصحيح بالشبكة، تأكد من أن إعدادات الوكيل مُهيأة لتجاوز عناوين IP المحلية هذه.

```bash
192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,127.0.0.1,localhost,*.local,timestamp.apple.com,sequoia.apple.com,seed-sequoia.siri.apple.com, 192.168.1.0/16
```
