---
audio: false
generated: true
lang: ar
layout: post
title: تهيئة Checkstyle
translated: true
type: note
---

هذا ملف تكوين Checkstyle مكتوب بلغة XML، مصمم لفرض معايير الترميز وأفضل الممارسات لكود Java بناءً على معايير ترميز Sun، ومواصفات لغة Java، وإرشادات Javadoc، وبعض أفضل الممارسات الإضافية. Checkstyle هو أداة تحليل ثابتة للكود تتحقق من كود Java المصدر للالتزام بمجموعة من القواعد المحددة. أدناه، سأشرح الهيكل والمكونات الرئيسية لملف التكوين هذا.

---

### **نظرة عامة**
- **الغرض**: يحدد الملف قواعد التحقق من ملفات Java و properties و XML لانتهاكات معايير الترميز، مثل التنسيق، وأعراف التسمية، ومتطلبات Javadoc، وبنية الكود.
- **الهيكل**: يتم تنظيم التكوين هرميًا باستخدام عناصر `<module>`، بدءًا من وحدة `Checker` الجذرية، والتي تحتوي على وحدات أخرى للتحقق أو التصفية المحددة.
- **المعايير**: يتماشى مع:
  - مواصفات لغة Java (Java SE 11)
  - أعراف ترميز Sun
  - إرشادات Javadoc
  - وثائق JDK API
  - أفضل الممارسات العامة
- **الميزات الرئيسية**:
  - شدة قابلة للتكوين (مضبوطة على `error`).
  - يدعم امتدادات الملفات: `.java`, `.properties`, `.xml`.
  - يسمح بكبح عمليات التحقق المحددة عبر ملفات الكبح أو تعليقات `@SuppressWarnings`.

---

### **الوحدة الجذرية: `<module name="Checker">`**
وحدة `Checker` هي الوحدة ذات المستوى الأعلى التي تنسق جميع عمليات التحقق والمرشحات.

- **الخصائص**:
  - `severity="error"`: تعامل جميع الانتهاكات كأخطاء (تشمل الخيارات الأخرى `warning` أو `info`).
  - `fileExtensions="java, properties, xml"`: يطبق عمليات التحقق على ملفات `.java` و `.properties` و `.xml`.

- **الوحدات الفرعية**:
  - **مرشحات الملفات**:
    - `BeforeExecutionExclusionFileFilter`: يستثني ملفات `module-info.java` من عمليات التحقق (باستخدام regex `module\-info\.java$`).
  - **مرشحات الكبح**:
    - `SuppressionFilter`: يحمل قواعد الكبح من ملف (افتراضي: `checkstyle-suppressions.xml`). إذا كان الملف مفقودًا، فهو اختياري (`optional="true"`).
    - `SuppressWarningsFilter`: يمكّن كبح عمليات تحقق محددة باستخدام تعليقات `@SuppressWarnings("checkstyle:...")` في الكود.
  - **عمليات تحقق متنوعة**:
    - `JavadocPackage`: يضمن أن كل حزمة تحتوي على ملف `package-info.java` مع Javadoc.
    - `NewlineAtEndOfFile`: يتحقق من أن الملفات تنتهي بحرف سطر جديد.
    - `Translation`: يتحقق من أن ملفات properties (مثل تلك المستخدمة للتدويل) تحتوي على نفس المفاتيح عبر الترجمات.
  - **عمليات تحقق الحجم**:
    - `FileLength`: يتحقق من الطول الإجمالي للملف (تنطبق الحدود الافتراضية ما لم يتم تجاوزها).
    - `LineLength`: يضمن أن الأسطر في ملفات `.java` لا تتجاوز طولًا افتراضيًا (عادة 80 أو 120 حرفًا، قابل للتكوين).
  - **عمليات تحقق المسافات البيضاء**:
    - `FileTabCharacter`: يمنع أحرف الجدولة في الملفات المصدر (يفرض استخدام المسافات للمسافة البادئة).
    - `RegexpSingleline`: يكتشف المسافات البيضاء الزائدة في نهاية السطر (الأسطر المنتهية بـ `\s+$`) ويبلغ عنها بالرسالة "Line has trailing spaces."
  - **تحقق الرأسية (معلق بتعليق)**:
    - `Header`: إذا تم إلغاء تعليقه، فسيفرض رأسية ملف محددة (مثل إشعار حقوق الطبع) من ملف محدد في `checkstyle.header.file` لملفات `.java`.

---

### **الوحدة الفرعية: `<module name="TreeWalker">`**
وحدة `TreeWalker` تعالج شجرة بناء الجملة المجردة (AST) لكود Java المصدر لإجراء عمليات تحقق مفصلة. تحتوي على مجموعة متنوعة من الوحدات الفرعية مجمعة حسب الفئة.

#### **عمليات تحقق Javadoc**
تفرض هذه العمليات تعليقات Javadoc صحيحة للفئات، والطرق، والمتغيرات:
- `InvalidJavadocPosition`: يضمن وضع تعليقات Javadoc بشكل صحيح (مثلًا، قبل الفئة أو الطريقة، وليس في مكان آخر).
- `JavadocMethod`: يتحقق من أن للطرق تعليقات Javadoc صحيحة، بما في ذلك المعاملات، وأنواع الإرجاع، والاستثناءات.
- `JavadocType`: يضمن أن للفئات، والواجهات، والتعدادات تعليقات Javadoc.
- `JavadocVariable`: يتطلب Javadoc للحقول العامة/المحمية.
- `JavadocStyle`: يفرض قواعد أسلوبية لـ Javadoc (مثلًا، وسوم HTML صحيحة، لا تعليقات مشوهة).
- `MissingJavadocMethod`: يعلن عن الطرق المفقودة تعليقات Javadoc.

#### **أعراف التسمية**
تضمن هذه العمليات أن المعرفات (المتغيرات، والطرق، والفئات، إلخ) تتبع أعراف التسمية:
- `ConstantName`: الثوابت (مثل `static final`) يجب أن تتبع نمط تسمية (عادة `UPPER_CASE`).
- `LocalFinalVariableName`: المتغيرات المحلية `final` يجب أن تتبع نمط تسمية (مثل `camelCase`).
- `LocalVariableName`: المتغيرات المحلية يجب أن تتبع نمط تسمية (مثل `camelCase`).
- `MemberName`: الحقول الخاصة بنسخة الكائن يجب أن تتبع نمط تسمية (مثل `camelCase`).
- `MethodName`: الطرق يجب أن تتبع نمط تسمية (مثل `camelCase`).
- `PackageName`: الحزم يجب أن تتبع نمط تسمية (مثل أحرف صغيرة مع نقاط، مثل `com.example`).
- `ParameterName`: معاملات الطرق يجب أن تتبع نمط تسمية (مثل `camelCase`).
- `StaticVariableName`: الحقول الساكنة (غير النهائية) يجب أن تتبع نمط تسمية.
- `TypeName`: أسماء الفئات/الواجهات/التعدادات يجب أن تتبع نمط تسمية (مثل `UpperCamelCase`).

#### **عمليات تحقق الاستيراد**
تنظم هذه العمليات استخدام عبارات `import`:
- `AvoidStarImport`: تمنع عمليات الاستيراد باستخدام النجمة (مثل `import java.util.*`).
- `IllegalImport`: تمنع الاستيراد من الحزم المقيدة (الافتراضي `sun.*`).
- `RedundantImport`: تعلن عن عمليات الاستيراد المكررة أو غير الضرورية.
- `UnusedImports`: تكتشف عمليات الاستيراد غير المستخدمة (تتجاهل عمليات الاستيراد المرتبطة بـ Javadoc مع `processJavadoc="false"`).

#### **عمليات تحقق الحجم**
تحد هذه العمليات من حجم الطرق والمعاملات:
- `MethodLength`: يضمن ألا تتجاوز الطرق عددًا أقصى من الأسطر (عادة 150 افتراضيًا).
- `ParameterNumber`: يحد من عدد المعاملات في الطريقة (عادة 7 افتراضيًا).

#### **عمليات تحقق المسافات البيضاء**
تفرض هذه العمليات استخدامًا متسقًا للمسافات البيضاء في الكود:
- `EmptyForIteratorPad`: يتحقق من المسافة البادئة في مكررات حلقة `for` الفارغة (مثل `for (int i = 0; ; i++)`).
- `GenericWhitespace`: يضمن تباعدًا مناسبًا حول الأنواع العامة (مثل `List<String>`).
- `MethodParamPad`: يتحقق من المسافة قبل قوائم معاملات الطرق.
- `NoWhitespaceAfter`: تمنع المسافات البيضاء بعد رموز معينة (مثل `++` أو المصفوفات).
- `NoWhitespaceBefore`: تمنع المسافات البيضاء قبل رموز معينة (مثل الفواصل المنقوطة).
- `OperatorWrap`: يضمن أن العوامل (مثل `+`، `=`) تكون على السطر الصحيح.
- `ParenPad`: يتحقق من المسافة داخل الأقواس (مثل `( x )` مقابل `(x)`).
- `TypecastParenPad`: يضمن تباعدًا مناسبًا في تحويلات النوع.
- `WhitespaceAfter`: يتطلب مسافات بيضاء بعد رموز معينة (مثل الفواصل، الفواصل المنقوطة).
- `WhitespaceAround`: يضمن وجود مسافات بيضاء حول العوامل والكلمات المفتاحية (مثل `if (x == y)`).

#### **عمليات تحقق المعدِّلات**
تنظم هذه العمليات استخدام معدِّلات Java:
- `ModifierOrder`: يضمن أن المعدِّلات في الترتيب الصحيح (مثل `public static final`، حسب JLS).
- `RedundantModifier`: تعلن عن المعدِّلات غير الضرورية (مثل `final` في فئة `final`).

#### **عمليات تحقق الكتل**
تفرض هذه العمليات الاستخدام الصحيح لكتل الكود (`{}`):
- `AvoidNestedBlocks`: تمنع الكتل المتداخلة غير الضرورية (مثل `{ { ... } }`).
- `EmptyBlock`: تعلن عن الكتل الفارغة (مثل `{}`) ما لم تكن مقصودة.
- `LeftCurly`: يضمن وضع الأقواس المتعرجة الافتتاحية (`{`) بشكل صحيح (مثل في نهاية السطر).
- `NeedBraces`: يتطلب أقواسًا متعرجة للكتل ذات العبارة الواحدة (مثل `if (x) y();` يجب أن تكون `if (x) { y(); }`).
- `RightCurly`: يضمن وضع الأقواس المتعرجة الختامية (`}`) بشكل صحيح (مثل على سطر جديد أو نفس السطر، اعتمادًا على النمط).

#### **عمليات تحقق مشاكل الترميز**
تحدد هذه العمليات مشاكل الترميز الشائعة:
- `EmptyStatement`: تعلن عن العبارات الفارغة (مثل `;;`).
- `EqualsHashCode`: يضمن أنه إذا تمت تجاوز `equals()`، فإن `hashCode()` يتم تجاوزها أيضًا.
- `HiddenField`: تكتشف الحقول التي يحجبها متغيرات محلية أو معاملات.
- `IllegalInstantiation`: تمنع إنشاء كائنات من فئات معينة (مثل فئات `java.lang` مثل `String`).
- `InnerAssignment`: تمنع التعيينات داخل التعبيرات (مثل `if (x = y)`).
- `MagicNumber`: تعلن عن القيم الرقمية الثابتة في الكود (مثل `42`) ما لم تكن في سياقات محددة.
- `MissingSwitchDefault`: تتطلب حالة `default` في عبارات `switch`.
- `MultipleVariableDeclarations`: تمنع التصريح عن متغيرات متعددة في سطر واحد (مثل `int x, y;`).
- `SimplifyBooleanExpression`: تعلن عن التعبيرات المنطقية المعقدة بشكل مفرط (مثل `if (x == true)`).
- `SimplifyBooleanReturn`: تبسط عبارات الإرجاع المنطقية (مثل `if (x) return true; else return false;`).

#### **عمليات تحقق تصميم الفئة**
تفرض هذه العمليات ممارسات تصميم فئة جيدة:
- `DesignForExtension`: يضمن أن الفئات غير النهائية لها طرق محمية أو مجردة للتوسع.
- `FinalClass`: تعلن عن الفئات التي تحتوي على منشئات خاصة فقط كمرشحة لأن تكون `final`.
- `HideUtilityClassConstructor`: يضمن أن فئات الأدوات (ذات الأعضاء الساكنة فقط) لها منشئات خاصة.
- `InterfaceIsType`: تمنع الواجهات المستخدمة فقط كواجهات وسم (بدون طرق).
- `VisibilityModifier`: يفرض رؤوية مناسبة للحقول (مثل يفضل الحقول الخاصة مع الحصول على/وضع).

#### **عمليات تحقق متنوعة**
- `ArrayTypeStyle`: يفرض نمط تصريح مصفوفة متسق (مثل `int[]` مقابل `int []`).
- `FinalParameters`: يتطلب أن تكون معاملات الطرق `final` حيثما أمكن.
- `TodoComment`: تعلن عن تعليقات `TODO` في الكود (مفيدة لتتبع العمل غير المكتمل).
- `UpperEll`: يضمن استخدام الحرف `L` للقيم الحرفية الطويلة (مثل `100L` بدلاً من `100l`).

#### **مرشحات الكبح (داخل TreeWalker)**
- `SuppressionXpathFilter`: يسمح بكبح عمليات التحقق باستخدام تعبيرات XPath محددة في ملف (افتراضي: `checkstyle-xpath-suppressions.xml`، اختياري).
- `SuppressWarningsHolder`: يدعم تعليقات `@SuppressWarnings("checkstyle:...")` لكبح عمليات تحقق محددة داخل AST.

---

### **نقاط رئيسية**
- **القدرة على التكوين**: معظم الوحدات لها إعدادات افتراضية ولكن يمكن تخصيصها عبر الخصائص (مثل `LineLength` يمكنه تعيين طول `max` محدد).
- **الكبح**: يدعم التكوين الكبح المرن لعمليات التحقق عبر ملفات خارجية (`checkstyle-suppressions.xml`, `checkstyle-xpath-suppressions.xml`) أو عبر التعليقات.
- **القدرة على التوسع**: يمكن إضافة عمليات تحقق إضافية، ويمكن تعطيل العمليات الحالية بوضعها في تعليق أو إزالتها.
- **التوثيق**: يشير التكوين إلى وثائق Checkstyle (مثل `https://checkstyle.org`) للحصول على تفاصيل حول كل وحدة.
- **تحقق الرأسية**: وحدة `Header` معلقة بتعليق، لذا فهي غير نشطة ما لم يتم إلغاء تعليقها وتكوينها بملف رأسية.

---

### **كيفية استخدامه**
1. **الدمج**: يُستخدم هذا الملف عادةً مع أداة بناء مثل Maven، أو Gradle، أو ملحق بيئة تطوير متكاملة لتشغيل Checkstyle أثناء عملية البناء أو في التطوير.
2. **الإبلاغ عن الانتهاكات**: عندما ينتهك الكود قاعدة (مثل تجاوز سطر للطول الأقصى)، يبلغ Checkstyle عنه كخطأ (بسبب `severity="error"`).
3. **الكبح**: يمكن للمطورين كبح انتهاكات محددة باستخدام `@SuppressWarnings("checkstyle:<check-name>")` أو عن طريق تعريف قواعد في ملفات الكبح.
4. **التخصيص**: يمكن تعيين خصائص مثل `basedir`، أو `checkstyle.header.file`، أو مسارات ملفات الكبح خارجيًا (مثل عبر تكوينات أداة البناء).

---

### **أمثلة على الانتهاكات**
- **JavadocMethod**: طريقة عامة بدون Javadoc ستسبب خطأ.
- **LineLength**: سطر في ملف `.java` يتجاوز الحد الأقصى الافتراضي (مثل 80 حرفًا) سيتم الإعلان عنه.
- **AvoidStarImport**: استخدام `import java.util.*` سيسبب خطأ.
- **MagicNumber**: كتابة `int x = 42;` بدون ثابت مسمى سيتم الإعلان عنه.

---

إذا كنت بحاجة إلى شرح أعمق لوحدة محددة، أو أمثلة على الانتهاكات، أو إرشادات حول تخصيص هذا التكوين، دعني أعلم!