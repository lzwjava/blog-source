---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast:free
title: استكشاف أخطاء تحويل OGG_OPUS إلى نص وإصلاحها
translated: true
type: note
---

يبدو أنك تواجه مشكلة في واجهة برمجة تطبيقات تحويل الصوت إلى نص (على الأرجح خدمة Google Cloud Speech-to-Text، استنادًا إلى تفاصيل الإعداد مثل رمز اللغة ونموذج Chirp). يشير الخطأ إلى أن ملف الصوت OGG_OPUS لا يتم التعرف عليه كتنسيق مدعوم صالح، على الرغم من أن OGG_OPUS مدعوم بشكل عام لتلك الخدمة. قد يكون هذا بسبب تلف الملف، أو بيانات وصفية غير صحيحة، أو اختلافات في الترميز، أو كيفية تحميل/معالجة الملف. دعنا نحل هذه المشكلة خطوة بخطوة.

### 1. **التحقق من ملف الصوت**
   - **التحقق من سلامة الملف**: شغل ملف OGG_OPUS في مشغل وسائط (مثل VLC أو Audacity أو FFmpeg) للتأكد من أنه غير تالف. إذا لم يعمل بشكل صحيح، أعد ترميزه أو تصديره مرة أخرى.
   - **فحص البيانات الوصفية**: استخدم أداة مثل `ffprobe` (من FFmpeg) لتأكيد التنسيق:
     ```
     ffprobe your_audio_file.ogg
     ```
     ابحث في الناتج عن تأكيد:
     - برنامج الترميز: opus
     - معدل العينة: 48000 هرتز
     - القنوات: 1 (أحادي)
     إذا لم يتطابق، فقد يكون الملف مُوسومًا بشكل خاطئ.
   - **حجم الملف والمدة**: يظهر النص الذي حصلت عليه ~9.8 ثانية — تأكد من أن الملف غير مبتور.

### 2. **حدد معاملات فك الترميز**
   كما يقترح الخطأ، قم بتقديم تفاصيل فك الترميز صراحة في طلب واجهة برمجة التطبيقات الخاصة بك. بالنسبة إلى Google Cloud Speech-to-Text (الإصدار 2)، قم بتهيئة طلبك بهذه الطريقة (باستخدام عميل Node.js كمثال؛ قم بالتعديل للغة/إطار العمل الذي تستخدمه):

   ```javascript
   const speech = require('@google-cloud/speech').v2;

   const client = new speech.SpeechClient();

   const request = {
     recognizer: 'projects/your-project/locations/us/recognizers/your-recognizer', // استبدل هذه التفاصيل بالخاصة بك
     config: {
       encoding: 'OGG_OPUS',  // حدد هذا صراحة
       sampleRateHertz: 48000,
       languageCode: 'cmn-Hans-CN',
       model: 'chirp',  // ملاحظة: قد يكون Chirp 3 هو 'latest_short' أو ما شابه؛ تحقق من الوثائق
       // أضف أي خيارات أخرى، مثلاً: enableAutomaticPunctuation: true
     },
     audio: {
       content: Buffer.from(fs.readFileSync('your_audio_file.ogg')).toString('base64'), // قم بترميز الملف بصيغة base64
     },
     // إذا كنت تستخدم ميزات، أضفها هنا
   };

   const [response] = await client.recognize(request);
   console.log(response);
   ```

   - **التغييرات الرئيسية**:
     - عيّن صراحة `encoding: 'OGG_OPUS'`, `sampleRateHertz: 48000`، وعدد القنوات ضمنيًا عبر الملف (أو أضف `audioChannelCount: 1` إذا لزم الأمر).
     - تأكد من أن محتوى الصوت مُرمّح بشكل صحيح بصيغة base64 إذا كنت تقوم بتحميل البايتات الأولية.
     - بالنسبة لـ Chirp 3، راجع اسم النموذج مرة أخرى في وثائق واجهة برمجة التطبيقات — قد يكون `chirp_3` أو متغيرًا آخر تحت "models".

   إذا كنت تستخدم إطار عمل مختلف (مثل Python أو curl)، فراجع [وثائق Google Cloud Speech-to-Text v2](https://cloud.google.com/speech-to-text/v2/docs) للحصول على الإعداد المكافئ.

### 3. **قم بتحويل الملف إذا لزم الأمر**
   يمكن أن يسبب OGG_OPUS أحيانًا مشاكل بسبب خصوصيات برنامج ترميز Opus. جرب التحويل إلى تنسيق مدعوم بشكل أوسع مثل LINEAR16 (WAV/PCM) باستخدام FFmpeg (أداة مجانية):
   ```
   ffmpeg -i your_audio_file.ogg -ar 48000 -ac 1 -f wav output.wav
   ```
   - ثم قم بتحديث إعداد واجهة برمجة التطبيقات الخاص بك:
     - `encoding: 'LINEAR16'`
     - `sampleRateHertz: 48000`
   - أعد تشغيل عملية التحويل. غالبًا ما يحل هذا عدم التطابق في الترميز دون فقدان الجودة للمقاطع الصوتية القصيرة.

### 4. **إصلاحات شائعة أخرى**
   - **إصدار/منطقة واجهة برمجة التطبيقات**: أنت تستخدم الإصدار 2 في `us` — هذا جيد لـ Chirp، ولكن تأكد من أن مشروعك لديه الأذونات اللازمة (مثل تمكين واجهة برمجة تطبيقات Speech-to-Text) والحصة.
   - **طريقة تحميل الملف**: إذا كنت تقوم بالتحميل عبر مسار الملف أو عنوان URL، فتأكد من أنه يمكن الوصول إليه ولم يتم تعديله أثناء النقل. بالنسبة للملفات الكبيرة، استخدم التعرف غير المتزامن (`longRunningRecognize`).
   - **عدم تطابق اللغة/النموذج**: `cmn-Hans-CN` مع Chirp 3 يجب أن يعمل مع اللغة الصينية الماندرين، ولكن جرب اختباره بنموذج أبسط مثل `latest_long` إذا استمرت المشكلة.
   - **اختبر باستخدام ملف نموذجي**: حمّل عينة OGG_OPUS معروفة بأنها سليمة من الإنترنت (مثل ويكيميديا Commons) وقم بتشغيلها عبر إعداداتك لعزل ما إذا كانت المشكلة خاصة بالملف.
   - **سجلات الخطأ**: تحقق من استجابة واجهة برمجة التطبيقات الكاملة أو سجلات وحدة التحكم لمزيد من التفاصيل (مثل رموز الخطأ الداخلية). إذا كانت المشكلة تتعلق بالحصة أو المصادقة، فستظهر بشكل منفصل.

إذا قمت بمشاركة المزيد من التفاصيل — مثل واجهة برمجة التطبيقات الدقيقة التي تستخدمها (Google Cloud؟ OpenAI Whisper؟ شيء آخر؟)، أو مقاطع الشفرة، أو تتبع الخطأ الكامل — يمكنني تقديم نصيحة أكثر تخصيصًا. هل جربت أيًا من هذه الخطوات حتى الآن؟