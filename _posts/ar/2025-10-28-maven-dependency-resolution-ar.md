---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: حل تبعيات مافن متعدد الوحدات
translated: true
type: note
---

نعم، هذا صحيح — في مشروع Maven متعدد الوحدات، عندما تعتمد وحدة واحدة (مثل وحدة EAR) على أخرى (مثل وحدة WAR)، فإن Maven يحل التبعية من المستودع المحلي `.m2/repository` افتراضيًا، وليس مباشرة من دليل `target/` الخاص بالوحدة الأخرى. هذا لأن Maven يعامل تبعيات الوحدات المتقاطعة كمراجع قطع أثرية قياسية (مثل المكتبات الخارجية)، لذا يجب تثبيت القطعة الأثرية المعتمدة عليها (أو على الأقل تجميعها وجعلها قابلة للاكتشاف عبر مفاعل البناء).

### لماذا يحدث هذا
- **الحل عبر المستودع المحلي**: آلية حل التبعيات في Maven تبحث عن القطع الأثرية في المستودع المحلي أولاً. يتم استخدام دليل `target/` مؤقتًا فقط أثناء بناء وحدة واحدة، ولكن للتبعيات المتقاطعة بين الوحدات، فإنه يتوقع أن يتم "نشر" القطعة الأثرية (تثبيتها).
- **بناءات المفاعل تساعد، لكنها ليست كافية دائمًا**: إذا قمت بتشغيل `mvn package` (أو `mvn install`) من **دليل POM الأصلي**، فإن مفاعل Maven يبني الوحدات تلقائيًا بالترتيب الطوبولوجي. يحل تبعيات الوحدات المتقاطعة على الطاير دون الحاجة إلى تثبيت صريح، حيث يسحب الإخراج الحديث من دليل `target/` الخاص بالوحدة الأخرى أثناء جلسة البناء. ولكن إذا قمت ببناء الوحدة المعتمدة (مثل EAR) **بشكل منفصل** (مثل `cd ear-module && mvn package`)، فلن تتمكن من رؤية `target/` الخاصة بالـ WAR — ستفشل إلا إذا كانت القطعة الأثرية للـ WAR موجودة بالفعل في `.m2`.

### بالنسبة للتغليف من WAR إلى EAR تحديدًا
في مشروع EAR:
- يتوقع إضافة EAR plugin (`maven-ear-plugin`) أن تكون الـ WAR (والوحدات الأخرى) كقطع أثرية محلولة ليتم تضمينها في أرشيف الـ EAR (على سبيل المثال، عبر `<modules>` في POM الخاص بالـ EAR).
- إذا لم يتم تثبيت الـ WAR، ستواجه أخطاء مثل "Could not resolve dependencies" أو وحدات مفقودة في الـ EAR.

**الحل**: نعم، تحتاج بشكل عام إلى تشغيل `mvn install` (أو على الأقل `mvn package` في بناء مفاعل كامل) على الوحدة "الأصلية" (التبعية) أولاً إذا كنت تقوم بالبناء بشكل منفصل. أفضل الممارسات:
1. **المفضل: البناء من الدليل الأصلي**: `mvn clean install` في دليل المشروع الرئيسي. يقوم هذا بتثبيت كل شيء في `.m2` ويتعامل مع الترتيب تلقائيًا.
2. **إذا كنت تبني الوحدات بشكل منفصل**:
   - `cd war-module && mvn clean install` (يقوم بتثبيت JAR الخاص بالـ WAR في `.m2`).
   - ثم `cd ear-module && mvn clean package` (أو `install` — غالبًا ما تحتاج وحدات EAR إلى `package` فقط).
3. **تجنب الإشارات المباشرة إلى Target**: لا تحاول الالتفاف حول هذه المشكلة باستخدام `<systemPath>` أو مسارات الملفات إلى `target/` — فهذا حل هش ويتخطى تدقيقات المجاميع والتبعية غير المباشرة في Maven.

لم يتغير هذا السلوك في إصدارات Maven الحديثة (حتى الإصدار 3.9.x اعتبارًا من 2025). لمزيد من التفاصيل، راجع دليل الوحدات المتعددة الرسمي.

[مقدمة لدورة حياة البناء - مشاريع متعددة الوحدات](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#multi-module)  
[وثائق إضافة Maven EAR](https://maven.apache.org/plugins/maven-ear-plugin/ear-mojo.html)