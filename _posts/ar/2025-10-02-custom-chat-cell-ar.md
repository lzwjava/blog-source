---
audio: false
generated: true
image: false
lang: ar
layout: post
model: deepseek/deepseek-v3.2-exp
title: خلية جدول محادثة الدردشة المخصصة
translated: true
type: note
---

هذا تنفيذ Objective-C لخلية جدول مخصصة لعرض عناصر المحادثة في تطبيق دردشة (مثل iMessage أو WhatsApp). دعني أوضح المكونات الرئيسية:

## نظرة عامة
تقوم فئة `LZConversationCell` بإنشاء خلية مخصصة تعرض:
- صورة رمز المستخدم/الصورة الشخصية
- اسم جهة الاتصال
- معاينة آخر رسالة
- الطابع الزمني
- مؤشرات الوسم للرسائل غير المقروءة

## المكونات الرئيسية

### 1. ثوابت التخطيط
```objc
static CGFloat kLZImageSize = 45;           // حجم الصورة الشخصية
static CGFloat kLZVerticalSpacing = 8;      // الحشو العمودي
static CGFloat kLZHorizontalSpacing = 10;   // الحشو الأفقي
static CGFloat kLZTimestampeLabelWidth = 100; // العرض للطابع الزمني
```

### 2. عناصر واجهة المستخدم
- **`avatarImageView`**: صورة ملف المستخدم الشخصي (45x45 نقطة)
- **`nameLabel`**: عرض اسم جهة الاتصال
- **`messageTextLabel`**: معاينة آخر رسالة
- **`timestampLabel`**: وقت/تاريخ الرسالة
- **`litteBadgeView`**: نقطة حمراء صغيرة للرسائل الجديدة
- **`badgeView`**: وسم الأرقام لعدد الرسائل غير المقروءة

### 3. طرق إدارة الخلايا
- **`+dequeueOrCreateCellByTableView:`**: نمط إعادة استخدام خلايا الجدول القياسي
- **`+registerCellToTableView:`**: يسجل فئة الخلية مع الجدول
- **`+heightOfCell`**: حساب الارتفاع الثابت (61 نقطة)

### 4. إعداد التخطيط
طريقة `setup`:
- تحسب ارتفاعات التسميات بناءً على النسب
- تنشئ وتضع جميع العناصر الفرعية
- تستخدم تخطيطًا قائمًا على الإطارات (بدون Auto Layout)

### 5. حسابات الإطارات
يتم وضع كل عنصر فرعي بالنسبة للآخرين:
- الصورة الشخصية على اليسار مع تباعد ثابت
- تسميات الاسم والرسالة على يمين الصورة الشخصية
- الطابع الزمني محاذٍ إلى الحافة اليمنى
- وسمات الأرقام موضوعة فوق الصورة الشخصية

### 6. إدارة الذاكرة
- **`prepareForReuse`**: يمسح كل المحتوى عند إعادة تدوير الخلية
- التهيئة الكسولة لجميع العناصر الفرعية (تُنشأ فقط عند الحاجة)

## نمط الاستخدام
ستُستخدم هذه الخلية في جدول قائمة المحادثات لعرض كل محادثة مع:
- معلومات جهة الاتصال
- معاينة الرسالة
- مؤشرات حالة المقروء/غير المقروء
- الطابع الزمني لآخر رسالة

تتبع الخلية أنماط تصميم iOS وتوفر مؤشرات بصرية شائعة في تطبيقات المراسلة.