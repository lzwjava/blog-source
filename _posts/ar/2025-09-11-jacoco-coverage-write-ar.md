---
audio: false
date: 2025-09-11
generated: true
image: false
lang: ar
layout: post
model: openai/gpt-5
title: سلوك كتابة بيانات تغطية جاكوكو
translated: true
type: note
---

في **اختبارات التكامل** (أي عملية JVM) التي تستخدم **وكيل JaCoCo**، لا يتم كتابة بيانات التغطية **تلقائيًا إلى ملف `.exec` عند خروج JVM**. إليك كيف يعمل:

---

### متى يقوم JaCoCo بكتابة بيانات التغطية؟
- **أثناء إيقاف JVM**: يقوم وكيل JaCoCo **بتفريغ وكتابة** بيانات التغطية المجمعة إلى ملف `.exec` **عند إيقاف JVM بشكل سليم** (مثل انتهاء طريقة main أو اكتمال مجموعة الاختبار).
- **إذا تعطلت JVM**: إذا انتهت JVM فجأة (بسبب تعطل أو `System.exit()`)، فقد **لا** تتاح للوكيل فرصة كتابة البيانات، وقد تفقد بعض معلومات التغطية.

---

### كيف تضمان كتابة البيانات
1. **إيقاف سليم**: تأكد من أن اختبارات التكامل أو التطبيق تنتهي بشكل طبيعي (بدون إجبار على الخروج).
2. **تفريغ صريح (اختياري)**: يمكنك تشغيل تفريغ لبيانات التغطية يدويًا أثناء وقت التشغيل باستخدام واجهة برمجة تطبيقات وقت التشغيل لـ JaCoCo (مثل `org.jacoco.agent.rt.RT.getAgentRuntime().dump(true, outputFile)`). هذا مفيد للعمليات طويلة الأمد أو إذا أردت التقاط بيانات وسيطة.

---

### مثال سيناريو
- إذا كانت مجموعة اختبار التكامل تعمل وتكتمل بشكل طبيعي، فسيقوم وكيل JaCoCo بكتابة بيانات التغطية في `jacoco.exec` (أو الملف المحدد من قبلك) **في نهاية عملية JVM**.
- إذا تم إيقاف JVM (مثل `kill -9`)، فقد لا تتم كتابة البيانات.

---

### أفضل الممارسات
- **استخدم `append=true`**: إذا قمت بتشغيل مجموعات اختبار متعددة، اضبط `append=true` في وسيطات وكيل JaCoCo لتراكم بيانات التغطية عبر عمليات التشغيل.
- **تحقق من البيانات الجزئية**: إذا تعطلت JVM، فقد يكون ملف `.exec` غير مكتمل أو تفتقر البيانات لآخر عملية تشغيل.

---