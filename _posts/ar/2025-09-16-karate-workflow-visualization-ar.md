---
audio: false
generated: true
image: false
lang: ar
layout: post
model: mistralai/mistral-medium-3.1
title: تصور سير عمل إطار الكاراتي باستخدام بايثون
translated: true
type: note
---

يستخدم هذا النص البرمجي في بايثون مكتبتي `networkx` و `matplotlib` **لإنشاء وتصور رسم بياني موجه** يمثل سير عمل **إطار عمل Karate**، وهو أداة شائعة لاختبار واجهات برمجة التطبيقات (API). إليك شرحًا مفصلاً خطوة بخطوة لكيفية عمله:

---

## **1. الإعداد والتخطيط**
### **الاستيراد**
- `networkx` (`nx`): مكتبة لإنشاء ومعالجة الرسوم البيانية.
- `matplotlib.pyplot` (`plt`): تُستخدم لرسم وتصور الرسم البياني.

### **دالة التخطيط**
- `get_layout(G)`: تحاول استخدام **Graphviz** (عبر `nx_agraph` أو `nx_pydot`) للحصول على تخطيط هرمي ونظيف. إذا لم يكن Graphviz متوفرًا، فإنها تعود إلى استخدام **تخطيط النابض** (خوارزمية موجهة بالقوة).
- **لماذا؟** تخطيط `dot` الخاص بـ Graphviz مثالي للرسوم البيانية الموجهة، حيث يرتب العقد في تدفق من أعلى إلى أسفل.

---

## **2. بناء الرسم البياني**
### **إنشاء رسم بياني موجه**
- `G = nx.DiGraph()`: تهيئة رسم بياني موجه.

### **العقد**
- تمثل **العقد** المكونات الرئيسية لسير عمل إطار عمل Karate (مثل "ملفات الميزة"، "المُنفذ"، "محرك Karate").
- يتم تعيين **فئة** لكل عقدة (مثل "التأليف"، "التنفيذ"، "وقت التشغيل") للتلوين والتجميع.

### **الحواف**
- تمثل **الحواف** التدفق بين المكونات، مع وجود تسميات تصف العلاقة (مثل "ينفذ"، "يستدعي"، "استدعاء واجهات برمجة التطبيقات").
- مثال: `"ملفات الميزة (.feature)" → "المُنفذ (CLI/JUnit5/Maven/Gradle)"` مع التسمية "ينفذ".

---

## **3. التصور**
### **تنسيق العقد والحواف**
- **ألوان العقد**: لكل فئة لون مميز (مثل "التأليف" أزرق، "التنفيذ" برتقالي).
- **نمط الحواف**: تُظهر الأسهم الاتجاه، مع وضع التسميات في المنتصف.

### **الرسم**
- `nx.draw_networkx_nodes`: ترسم العقد بألوان وأحجام محددة.
- `nx.draw_networkx_edges`: ترسم الحواف مع أسهم.
- `nx.draw_networkx_labels`: تضيف تسميات العقد.
- `nx.draw_networkx_edge_labels`: تضيف تسميات الحواف.

### **وسيلة الإيضاح (الأسطورة)**
- تتم إضافة وسيلة إيضاح لشرح الترميز اللوني حسب الفئة.

### **المخرجات**
- يتم حفظ الرسم البياني كملف PNG في دليل `tmp`، مع طباعة رسالة لتأكيد موقع الحفظ.

---

## **4. تمثيل سير العمل**
يشرح الرسم البياني بصريًا **سير عمل إطار عمل Karate**:
1.  **التأليف**: كتابة ملفات الميزة (`.feature`).
2.  **التنفيذ**: يُنفذ مُشغل (CLI، JUnit5، Maven، Gradle) الاختبارات.
3.  **وقت التشغيل**: يفسر محرك Karate لغة DSL ويقوم بتنفيذ التأكيدات (Assertions).
4.  **البروتوكولات**: يقوم المحرك بإجراء استدعاءات HTTP/REST/GraphQL للأنظمة الخارجية.
5.  **الخارجية**: تستقبل الأنظمة/الخدمات الخارجية الطلبات وترسل الردود.
6.  **التقارير**: يتم إنشاء النتائج كتقارير (HTML، JUnit، JSON) ونشرها في خطوط أنابيب CI/CD.

---

## **جدول الملخص**

| المكون                     | الفئة        | الدور في سير العمل                          |
|----------------------------|-------------|---------------------------------------------|
| ملفات الميزة (.feature)    | التأليف     | سيناريوهات الاختبار مكتوبة بـ Gherkin       |
| المُنفذ (CLI/JUnit5/...)   | التنفيذ     | ينفذ سيناريوهات الاختبار                    |
| محرك Karate                | وقت التشغيل | يفسر ويشغل الاختبارات                       |
| HTTP/REST/GraphQL          | البروتوكولات| يتعامل مع اتصالات API                       |
| الأنظمة الخارجية           | خارجية      | تستقبل الطلبات وترسل الردود                 |
| التأكيدات ومطابقات القيم   | وقت التشغيل | تحقق من صحة الردود                          |
| التقارير                   | التقارير    | يولد تقارير الاختبار                        |
| CI/CD                      | التقارير    | ينشر التقارير في خطوط أنابيب CI/CD          |

---

## **لماذا هذا التصور؟**
- **الوضوح**: يظهر التدفق الشامل لاختبارات Karate من البداية إلى النهاية.
- **تصحيح الأخطاء**: يساعد في تحديد مكان حدوث المشكلات في خط الأنابيب.
- **التوثيق**: يعمل كمرجع سريع للمستخدمين الجدد.

**باختصار:** يقوم هذا النص البرمجي بأتمتة إنشاء مخطط سير عمل واضح ومرمز بالألوان لإطار عمل Karate، مما يسهل فهم وشرح كيفية تأليف الاختبارات وتنفيذها والإبلاغ عن نتائجها.