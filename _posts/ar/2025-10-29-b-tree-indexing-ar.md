---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: أشجار بي لفهرسة قواعد البيانات بكفاءة
translated: true
type: note
---

### ما هو شجرة B؟

شجرة B (اختصار لـ "شجرة متوازنة") هي بنية بيانات شجرة ذاتية التوازن مصممة للتخزين والإدراج والحذف والاسترجاع الفعال لحجوم كبيرة من البيانات. إنها مُحسنة بشكل خاص للأنظمة التي يتم فيها تخزين البيانات على القرص (مثل قواعد البيانات)، لأنها تقلل من عدد عمليات الإدخال/الإخراج المكلفة للقرص من خلال الحفاظ على الشجرة ضحلة قدر الإمكان.

#### الخصائص الرئيسية لشجرة B
- **الرتبة (أو الدرجة)**: تُعرف بواسطة المعامل *t* (الدرجة الدنيا)، حيث يمكن أن تحتوي كل عقدة على عدد من المفاتيح يتراوح بين *t-1* و *2t-1* (وما يصل إلى *2t* فرع). هذا يسمح للعقد بأن تحتوي على مفاتيح متعددة، مما يجعل الشجرة أوسع وأقصر.
- **هيكل متوازن**: جميع العقد الورقية تكون على نفس المستوى، مما يضمن تعقيدًا زمنيًا لوغاريتميًا للعمليات (O(log n)، حيث n هو عدد المفاتيح).
- **مفاتيح مرتبة**: المفاتيح في كل عقدة مخزنة بترتيب مصفوف، وتحافظ الشجرة على هذا الثابت. تحتوي الفروع الفرعية على يسار المفتاح على قيم أصغر، وعلى اليمين تحتوي على قيم أكبر.
- **هيكل العقدة**: تحتوي العقد الداخلية على مفاتيح لتوجيه عمليات البحث إلى العقد الفرعية. تخزن العقد الورقية البيانات الفعلية (أو مؤشرات إليها).

على عكس أشجار البحث الثنائية (BSTs)، التي تقتصر على فرعين لكل عقدة ويمكن أن تصبح غير متوازنة (مؤدية إلى أداء أسوأ حالة O(n))، فإن أشجار B هي أشجار متعددة المسارات تظل متوازنة من خلال تقسيم ودمج العقد أثناء عمليات الإدراج والحذف.

#### مثال بسيط
تخيل شجرة B من الرتبة 3 (*t=3*، لذا 2-5 مفاتيح لكل عقدة). قد تبدو شجرة صغيرة بهذا الشكل في صورة نصية:

```
       [10, 20, 30]
      /    |    |    \
 [5,7]  [15] [22,25] [35,40]
```

- البحث عن 25: ابدأ من الجذر، قارن مع 10/20/30 → اذهب لليمين إلى [22,25] → تم العثور عليه.

يسمح هذا الهيكل باستعلامات النطاق بكفاءة (مثلاً، جميع المفاتيح بين 15 و 25) من خلال اجتياز عدد قليل من العقد.

### كيف تستخدم قواعد البيانات أشجار B

تعتمد قواعد البيانات (مثل العلاقية: MySQL، PostgreSQL، SQL Server) بشكل كبير على أشجار B (أو متغيراتها مثل أشجار B+) في **الفهرسة** لتسريع الاستعلامات على الجداول الكبيرة المخزنة على القرص. بدون الفهارس، ستتطلب الاستعلامات فحوصًا كاملة للجدول (وقت O(n)، بطيء لملايين الصفوف).

#### الاستخدامات الرئيسية في قواعد البيانات
1. **الفهارس الأساسية والثانوية**:
   - **الفهرس الأساسي** يُبنى على المفتاح الأساسي (المعرف الفريد). فهو ينظم صفوف الجدول بترتيب شجرة B للبحث السريع.
   - **الفهارس الثانوية** تكون على أعمدة أخرى (مثل الاسم، التاريخ). تشير العقد الورقية إلى مواقع الصفوف الفعلية (عبر معرفات الصفوف).

2. **وصول فعال للقرص**:
   - تقرأ الأقراص البيانات في كتل (مثلاً، صفحات 4KB). يتم تحديد حجم عقد شجرة B لتناسب كتلة قرص واحدة، لذا يتطلب البحث عادةً قراءة 3-4 كتل فقط (ارتفاع الشجرة)، مقابل الآلاف المحتملة في قائمة مرتبطة.
   - الارتفاع لوغاريتمي: لمليار مفتاح، قد يكون الارتفاع 4-5 مستويات فقط.

3. **متغير شجرة B+ (شائع في قواعد البيانات)**:
   - تستخدم معظم قواعد البيانات **أشجار B+**، وهي تعديل على شجرة B حيث:
     - فقط العقد الورقية تخزن البيانات/المؤشرات.
     - تحتوي العقد الداخلية على مفاتيح للتوجيه فقط.
     - الأوراق مترابطة (قائمة مرتبطة مزدوجة) لفحوص المسح المتسلسل الفعال واستعلامات النطاق (مثلاً، `SELECT * WHERE age BETWEEN 20 AND 30`).
   - هذا يحسن عمليات النطاق وكفاءة الذاكرة المخبأة.

4. **العمليات في الممارسة العملية**:
   - **الإدراج/التحديث/الحذف**: تقوم الشجرة بتقسيم أو دمج العقد للحفاظ على التوازن. تتعامل قواعد البيانات مع التزامن باستخدام المزالج/الأقفال.
   - **تحسين الاستعلام**: يستخدم مخطط الاستعلام إحصائيات الفهرس لاختيار فهارس شجرة B بدلاً من فحوص الجدول.
   - **المجمعة مقابل غير المجمعة**: في الفهارس المجمعة (مثلاً، InnoDB في MySQL)، يتم تخزين بيانات الجدول فعليًا بترتيب أوراق شجرة B. أما غير المجمعة فتشير فقط إلى البيانات.

#### المزايا والمقايضات
- **الإيجابيات**: سريعة لاستعلامات المساواة والنطاق والبيانات المرتبة؛ تتعامل مع البيانات المتزايدة بشكل جيد.
- **السلبيات**: هناك حمل زائد للإدراج/الحذف (صيانة الشجرة)؛ ليست مثالية للتحديثات المتكررة جدًا بدون تجميع.

باختصار، تشكل أشجار B العمود الفقري لأداء قاعدة البيانات للوصول المفهرس، محولةً ما يمكن أن يكون عمليات بحث خطية إلى عمليات شبه ثابتة الوقت من خلال تصميمها المتوازن والصديق للقرص.

#### المراجع
- [B-tree - Wikipedia](https://en.wikipedia.org/wiki/B-tree)
- [B+ Tree in DBMS - GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-b-tree/)
- [How Indexes Work in SQL Databases - Use The Index, Luke](https://use-the-index-luke.com/sql/anatomy/index-btree)