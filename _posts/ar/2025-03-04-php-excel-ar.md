---
audio: false
generated: true
lang: ar
layout: post
title: مكتبة PHPExcel
translated: true
---

### النقاط الرئيسية
- يبدو أن استخدام "phpoffice/phpexcel": "^1.8" يتطلب تثبيته عبر Composer واستخدام كود PHP لقراءة وكتابة ملفات Excel.
- تشير الأبحاث إلى أن المكتبة قد تم إهمالها، لذا يجب النظر في استخدام PhpSpreadsheet لمشاريع جديدة.
- الدليل يشير إلى الحاجة إلى توسعات PHP مثل mbstring، XML، و XMLWriter.

### التثبيت
لبدء العمل، أضف `"phpoffice/phpexcel": "^1.8"` إلى ملف `composer.json` الخاص بك واسخدم `composer install`. هذا سيقوم بتنزيل المكتبة، والتي هي ضرورية للعمل مع ملفات Excel في PHP.

### الاستخدام الأساسي
للكتابة في ملف Excel:
- أضف المكتبة باستخدام `require 'vendor/autoload.php';`.
- انشئ كائن PHPExcel جديد: `$objPHPExcel = new PHPExcel();`.
- قم بتعيين قيم الخلايا، مثل `$sheet->setCellValue('A1', 'value');`.
- احفظ الملف باستخدام كاتب، مثل `$writer = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');` متبوعًا بـ `$writer->save('filename.xlsx');`.

لقراءة من ملف Excel:
- قم بتحميل الملف باستخدام `$objPHPExcel = PHPExcel_IOFactory::load('filename.xlsx');`.
- قم بالوصول إلى قيم الخلايا، مثل `$cellValue = $sheet->getCell('A1')->getValue();`.

### التفاصيل غير المتوقعة
جوانب غير متوقعة هي أن PHPExcel يدعم أنواع ملفات مختلفة مثل .xls و .xlsx، ويمكنه اكتشاف أنواع الملفات تلقائيًا عند القراءة، مما يسهل الاستخدام.

---

### ملاحظة الاستطلاع: دليل شامل لاستخدام "phpoffice/phpexcel": "^1.8"

تقدم هذه الملاحظة استكشافًا مفصلًا لاستخدام مكتبة PHPExcel، بشكل خاص الإصدار 1.8 أو أعلى، كما هو محدد من قبل التبعية Composer "phpoffice/phpexcel": "^1.8". نظرًا لوضع إهمالها، يوضح هذا الدليل أيضًا استنتاجات لمشاريع بديلة حديثة ويضمن فهم شامل لكل من المبتدئين والمستخدمين المتقدمين. يتم تنظيم المحتوى لتغطية التثبيت، الاستخدام، التبعيات، والمعلومات الإضافية، مما يضمن تضمين جميع التفاصيل ذات الصلة من البحث.

#### الخلفية والسياق
PHPExcel هي مكتبة PHP مصممة لقراءة وكتابة ملفات الجداول، بشكل خاص صيغ Excel مثل .xls و .xlsx. يشير التحديد "1.8" إلى نطاق الإصدار السيميائي، مما يعني أي إصدار من 1.8 حتى 2.0، ولكن ليس 2.0 أو أعلى، مما يشير إلى الإصدار 1.8.1 كآخر إصدار، تم إصداره في عام 2015. ومع ذلك، تشير الأبحاث إلى أن PHPExcel تم إهمالها رسميًا في عام 2017 وتأريخها في عام 2019، مع توصية بالهجرة إلى خلفها PhpSpreadsheet، بسبب نقص الصيانة ووجود مشاكل أمنية محتملة. هذا السياق هو مهم للمستخدمين، لأنه يشير إلى الحذر في مشاريع جديدة، على الرغم من أن الدليل سيركز على استخدام الإصدار المحدد كما هو مطلوب.

تتمثل وظائف المكتبة في إنشاء، قراءة، وتعديل ملفات Excel، ودعم صيغ خارج Excel مثل CSV و HTML. كانت جزءًا من مشروع PHPOffice، الذي انتقل الآن التركيز إلى PhpSpreadsheet، يقدم ميزات محدثة وامتثال للمعايير PHP. مع تاريخ اليوم، 3 مارس 2025، ووضع المكتبة المأرخ، يجب على المستخدمين أن يكونوا على علم بحدودها، خاصة مع إصدارات PHP الجديدة والتحديثات الأمنية.

#### عملية التثبيت
لتثبيت "phpoffice/phpexcel": "^1.8"، تستخدم العملية Composer، مدير التبعيات PHP. الخطوات هي:
- أضف التبعية إلى ملف `composer.json` الخاص بك في قسم "require": `"phpoffice/phpexcel": "^1.8"`.
- قم بتنفيد الأمر `composer install` في مجلد المشروع الخاص بك. هذا الأمر ينزيل المكتبة ويحديث مجلد `vendor` بالملفات اللازمة.

يستخدم الرمز (^) في Composer التسمية السيميائية، مما يضمن أن يتم تثبيت الإصدارات 1.8، 1.8.1، أو أي تحديثات للبرامج، ولكن ليس الإصدارات التي ستفقد التوافق (أي لا 2.0 أو أعلى). نظرًا لأن آخر إصدار للمكتبة كان 1.8.1 في عام 2015، فإن هذا عادةً ما يحدد الإصدار 1.8.1.

تأكيد البحث أن صفحة Packagist لـ phpoffice/phpexcel تدرجها كمهملة، وتوصي باستخدام phpoffice/phpspreadsheet بدلاً من ذلك، ولكنها تبقى متاحة للتثبيت، مما يتوافق مع طلب المستخدم.

#### الاستخدام الأساسي: كتابة في Excel
بعد التثبيت، يستخدم PHPExcel تضمين ملف التحميل الذاتي للتصنيفات وتستخدم فئاتها لتعديل الجداول. إليك تفصيلًا:

- **ضمن ملف التحميل الذاتي:** ابدأ بملف PHP الخاص بك بـ `require 'vendor/autoload.php';`. هذه السطر تضمن أن جميع المكتبات التي تم تثبيتها بواسطة Composer، بما في ذلك PHPExcel، يتم تحميلها تلقائيًا، باستخدام PSR-0 التحميل الذاتي وفقًا لهيكل المكتبة من عام 2015.

- **إنشاء كائن PHPExcel جديد:** قم بإنشاء جدول جديد بـ `$objPHPExcel = new PHPExcel();`. يمثل هذا الكائن الجدول بأكمله، مما يسمح بصفحات متعددة وميزات.

- **عمل مع الصفحات:** قم بالوصول إلى الصفحة النشطة باستخدام `$sheet = $objPHPExcel->getSheet(0);` للصفحة الأولى، أو انشئ صفحة جديدة بـ `$sheet = $objPHPExcel->createSheet();`. الصفحات مرقمة من الصفر، لذلك `getSheet(0)` يهدف إلى الصفحة الأولى.

- **تعيين قيم الخلايا:** قم بتعبئة الخلايا باستخدام طريقة `setCellValue`، مثل `$sheet->setCellValue('A1', 'Hello');`. هذه الطريقة تأخذ مرجع الخلية (مثل 'A1') والقيمة التي سيتم إدراجها، والتي يمكن أن تكون نصًا، أرقامًا، أو صيغًا.

- **حفظ الملف:** لحفظ الملف، انشئ كاتبًا للصيغة المطلوبة. بالنسبة لـ Excel 2007 و أعلى (.xlsx)، استخدم `$writer = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');`. ثم احفظ بـ `$writer->save('filename.xlsx');`. الصيغ الأخرى تشمل 'Excel5' لـ .xls (Excel 95) أو 'CSV' لـ قيم مفصولة بفاصلة.

مثال على كود للكتابة:
```php
require 'vendor/autoload.php';
$objPHPExcel = new PHPExcel();
$sheet = $objPHPExcel->getSheet(0);
$sheet->setCellValue('A1', 'Hello');
$sheet->setCellValue('B1', 'World');
$writer = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');
$writer->save('hello_world.xlsx');
```
هذا يخلق ملف Excel بسيط يحتوي على "Hello" في A1 و "World" في B1.

#### الاستخدام الأساسي: قراءة من Excel
قراءة من ملف Excel تتبع نمطًا مشابهًا، ولكن تبدأ بتحميل الملف:
- **تحميل الملف:** استخدم `$objPHPExcel = PHPExcel_IOFactory::load('filename.xlsx');` لتحميل ملف Excel موجود. يمكن لـ IOFactory اكتشاف نوع الملف تلقائيًا، ولكن يمكنك تحديد قارئ، مثل `$objReader = PHPExcel_IOFactory::createReader('Excel2007'); $objPHPExcel = $objReader->load('filename.xlsx');` للتصنيف الصريح.

- **الوصول إلى الصفحات والخلية:** بعد التحميل، قم بالوصول إلى الصفحات كما سبق، مثل `$sheet = $objPHPExcel->getSheet(0);`. استرجع قيم الخلايا بـ `$cellValue = $sheet->getCell('A1')->getValue();`، والتي تعود بالمحتوى للخلية المحددة.

مثال للقراءة:
```php
require 'vendor/autoload.php';
$objPHPExcel = PHPExcel_IOFactory::load('hello_world.xlsx');
$sheet = $objPHPExcel->getSheet(0);
$cellValue = $sheet->getCell('A1')->getValue();
echo $cellValue; // يخرج "Hello"
```
هذا يقرأ القيمة من A1، مما يوضح استرجاع أساسي.

#### التبعيات والمتطلبات
PHPExcel لديها متطلبات PHP محددة وتوسعات مطلوبة للعمل:
- **إصدار PHP:** يتطلب PHP 5.2 أو 7.0 أو أعلى، وفقًا لمعلومات Packagist. مع تاريخ اليوم، 3 مارس 2025، يجب أن تتوافق معظم الإصدارات الحديثة لـ PHP، ولكن قد تحتاج الإصدارات القديمة إلى تحديثات.
- **التوسعات:** تعتمد المكتبة على `ext-mbstring`، `ext-XML`، و `ext-XMLWriter`، والتي يجب أن تكون مفعلة في تكوين PHP الخاص بك. هذه التوسعات تتعامل مع ترميز النص، تحليل XML، وكتابة XML، على التوالي، وهي ضرورية لعملية ملفات Excel.

يجب على المستخدمين التحقق من أن هذه التوسعات نشطة باستخدام `phpinfo()` أو فحص ملف `php.ini`، لضمان عدم حدوث مشاكل التوافق.

#### الميزات الإضافية والصيغ
بخلاف القراءة والكتابة الأساسية، يدعم PHPExcel صيغ ملفات مختلفة، وهو تفصيل غير متوقع للمستخدمين الذين يعرفون فقط Excel. يمكن للمكتبة التعامل مع:
- Excel 2007 (.xlsx) عبر 'Excel2007' كاتب/قارئ.
- Excel 95 (.xls) عبر 'Excel5'.
- ملفات CSV عبر 'CSV'.
- HTML عبر 'HTML'.

عند الحفظ، قم بتحديد نوع الكاتب؛ عند القراءة، يمكن لـ IOFactory اكتشاف تلقائيًا، ولكن يمكن استخدام قارئ محدد للثقة. على سبيل المثال، لحفظ كـ .xls:
```php
$writer = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');
$writer->save('filename.xls');
```
هذه المرونة مفيدة للنظم القديمة أو الاحتياجات الصرفية، ولكن يجب على المستخدمين أن يكونوا على علم بحدود الصيغة، خاصة مع إصدارات Excel القديمة.

#### إهمال والهجرة
نقطة حاسمة هي إهمال PHPExcel. تشير الأبحاث إلى أن المكتبة تم إهمالها في عام 2019، مع آخر تحديث في عام 2015، ولا يتم صيانتها anymore. هذا يرفع مخاوف بشأن الثغرات الأمنية والتوافق مع إصدارات PHP بعد 7.0، خاصة مع المعايير الحديثة مثل PHP 8.x. يوصي مستودع GitHub وصفحة Packagist بالهجرة إلى PhpSpreadsheet، الذي يقدم فضاءات أسماء، وامتثال PSR، وتطوير نشط.

للمستخدمين، هذا يعني:
- لمشاريع قديمة تستخدم PHPExcel 1.8، استمر بحذر، مع التأكد من الاختبارات الأمنية والتوافق.
- لمشاريع جديدة، يجب النظر في PhpSpreadsheet، مع وجود أدوات هجرة متاحة، كما هو موضح في وثائق PhpSpreadsheet ([هجرة من PHPExcel](https://phpspreadsheet.readthedocs.io/en/latest/topics/migration-from-PHPExcel/)).

هذه النصيحة هي خاصة مع تاريخ اليوم، لضمان أن المستخدمين يتوافقون مع المكتبات الحديثة المدعومة.

#### الوثائق والتعلم الإضافي
لاستكشاف أعمق، يمكن العثور على الوثائق الرسمية لـ PHPExcel في مستودع GitHub الخاص بها في مجلد الوثائق، ولكن قد يتطلب الوصول تنزيل ملفات مثل الوثائق التطويرية DOC. على الإنترنت، يمكن أن توفر الدروس التعليمية مثل تلك على SitePoint ([إنشاء ملفات Excel و الرسوم البيانية مع PHPExcel](https://www.sitepoint.com/generate-excel-files-charts-phpexcel/)) أمثلة عملية، تغطي الرسوم البيانية والتدوين، التي تتجاوز الاستخدام الأساسي. يمكن أن توفر مواضيع Stack Overflow رؤى المجتمع، ولكن يجب أن يكون هناك حذر مع الإجابات القديمة بسبب وضع المكتبة.

#### جدول المقارنة: PHPExcel مقابل PhpSpreadsheet
لإيصال القرار، إليك جدول مقارنة يوضح الاختلافات الرئيسية، بناءً على البحث:

| الميزة                  | PHPExcel (1.8)                     | PhpSpreadsheet                  |
|--------------------------|------------------------------------|---------------------------------|
| آخر تحديث              | 2015                              | نشط (حتى 2025)             |
| فضاءات الأسماء               | لا، فضاء اسم الجذر                | نعم، PSR-4 متوافق            |
| حالة الصيانة       | إهمال، أرشيف 2019         | صيانة نشطة             |
| دعم إصدار PHP      | حتى 7.0                         | PHP 7.4+                        |
| دعم صيغ الملف      | Excel, CSV, HTML, إلخ.            | محدث، بما في ذلك ODS, PDF    |
| الأداء              | معتدل، متطلب للذاكرة        | محدث، قابل للتوسيع             |

يوضح هذا الجدول الانتقال إلى PhpSpreadsheet لمتطلبات حديثة، على الرغم من أن PHPExcel يبقى وظيفيًا لأغراض الأرشيف.

#### الخاتمة
استخدام "phpoffice/phpexcel": "^1.8" يتضمن تثبيته عبر Composer، واستخدام فئاته لعمليات Excel، وتأكد من التوسعات PHP المطلوبة. على الرغم من أنها وظيفية، فإن إهمالها يتطلب الحذر، مع توصية باستخدام PhpSpreadsheet لمشاريع المستقبل. يوفر هذا الدليل نقطة بداية شاملة، مع أمثلة، التبعيات، والموارد الإضافية للمستخدمين لاستكشاف المزيد.