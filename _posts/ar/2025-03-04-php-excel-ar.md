---
audio: false
generated: true
lang: ar
layout: post
title: مكتبة بي إتش بي إكسل
translated: true
type: note
---

### النقاط الرئيسية
- يبدو أنه لاستخدام "phpoffice/phpexcel": "^1.8"، تحتاج إلى تثبيته عبر Composer واستخدام كود PHP لقراءة وكتابة ملفات Excel.
- تشير الأبحاث إلى أن المكتبة قد توقفت عن التطوير، لذا فكر في استخدام PhpSpreadsheet للمشاريع الجديدة.
- تميل الأدلة إلى ضرورة وجود إضافات PHP مثل mbstring و XML و XMLWriter.

### التثبيت
للبدء، أضف `"phpoffice/phpexcel": "^1.8"` إلى ملف `composer.json` الخاص بك وقم بتشغيل `composer install`. سيؤدي هذا إلى تنزيل المكتبة، وهي ضرورية للعمل مع ملفات Excel في PHP.

### الاستخدام الأساسي
لكتابة ملف Excel:
- قم بتضمين المكتبة باستخدام `require 'vendor/autoload.php';`.
- أنشئ كائن PHPExcel جديد: `$objPHPExcel = new PHPExcel();`.
- عيّن قيم الخلايا، على سبيل المثال: `$sheet->setCellValue('A1', 'value');`.
- احفظ الملف باستخدام كاتب، مثل `$writer = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');` متبوعًا بـ `$writer->save('filename.xlsx');`.

لقراءة ملف Excel:
- قم بتحميل الملف باستخدام `$objPHPExcel = PHPExcel_IOFactory::load('filename.xlsx');`.
- الوصول إلى قيم الخلايا، على سبيل المثال: `$cellValue = $sheet->getCell('A1')->getValue();`.

### تفصيل غير متوقع
جانب غير متوقع هو أن PHPExcel تدعم تنسيقات ملفات متنوعة مثل .xls و .xlsx، ويمكنها اكتشاف نوع الملف تلقائيًا عند القراءة، مما يبسط الاستخدام.

---

### ملاحظة المسح: دليل شامل لاستخدام "phpoffice/phpexcel": "^1.8"

توفر هذه الملاحظة استكشافًا مفصلاً لاستخدام مكتبة PHPExcel، تحديدًا الإصدار 1.8 أو الأعلى، كما هو محدد في الاعتماد "phpoffice/phpexcel": "^1.8". نظرًا لوضعها المتوقف عن التطوير، يسلط هذا الدليل الضوء أيضًا على الاعتبارات الخاصة بالبدائل الحديثة ويضمن فهماً شاملاً لكل من المستخدمين المبتدئين والمتقدمين. يتم تنظيم المحتوى لتغطية التثبيت والاستخدام والتبعيات والسياق الإضافي، مما يضمن تضمين جميع التفاصيل ذات الصلة من البحث.

#### الخلفية والسياق
PHPExcel هي مكتبة PHP مصممة لقراءة وكتابة ملفات جداول البيانات، خاصة تنسيقات Excel مثل .xls و .xlsx. يشير تحديد الإصدار "^1.8" إلى نطاق versioning دلالي، مما يعني أي إصدار من 1.8 حتى، ولكن لا يشمل، الإصدار 2.0، والذي، نظرًا لتاريخ المكتبة، يشير إلى الإصدار 1.8.1 كأحدث إصدار، صدر في 2015. ومع ذلك، تشير الأبحاث إلى أن PHPExcel تم إيقاف تطويرها رسميًا في 2017 وأرشفتها في 2019، مع التوصية بالانتقال إلى خليفتها، PhpSpreadsheet، بسبب عدم الصيانة والمشكلات الأمنية المحتملة. هذا السياق حاسم للمستخدمين، لأنه يشير إلى الحذر للمشاريع الجديدة، على الرغم من أن الدليل سيركز على استخدام الإصدار المحدد حسب الطلب.

تشمل وظائف المكتبة إنشاء وقراءة ومعالجة ملفات Excel، مع دعم تنسيقات تتجاوز Excel مثل CSV و HTML. كانت جزءًا من مشروع PHPOffice، الذي حوّل تركيزه منذ ذلك الحين إلى PhpSpreadsheet، مما يقدم ميزات محسنة وامتثالًا لمعايير PHP. نظرًا للتاريخ الحالي، 3 مارس 2025، وحالة أرشفة المكتبة، يجب أن يكون المستخدمون على دراية بقيودها، خاصة مع إصدارات PHP الأحدث والتحديثات الأمنية.

#### عملية التثبيت
لتثبيت "phpoffice/phpexcel": "^1.8"، تستخدم العملية Composer، مدير اعتماديات PHP. الخطوات كالتالي:
- أضف الاعتماد إلى ملف `composer.json` الخاص بك تحت قسم "require": `"phpoffice/phpexcel": "^1.8"`.
- قم بتشغيل الأمر `composer install` في دليل مشروعك. يقوم هذا الأمر بتنزيل المكتبة وتحديث دليل `vendor` بالملفات اللازمة.

يتبع الترميز (^) في Composer الإصدار الدلالي، مما يضمن تثبيت الإصدارات 1.8 أو 1.8.1 أو أي تحديثات ترقيعية، ولكن ليس الإصدارات التي قد تكسر التوافق (أي ليس 2.0 أو أعلى). نظرًا لأن آخر إصدار للمكتبة كان 1.8.1 في 2015، فإن هذا عادة ما يحل إلى الإصدار 1.8.1.

يؤكد البحث أن صفحة Packagist لـ phpoffice/phpexcel تسردها كمهملة، وتقترح بدلاً من ذلك phpoffice/phpspreadsheet، لكنها تظل متاحة للتثبيت، بما يتوافق مع طلب المستخدم.

#### الاستخدام الأساسي: الكتابة إلى Excel
بمجرد التثبيت، يتضمن استخدام PHPExcel تضمين ملف autoload لتحميل الفئات ثم استخدام فئاتها لمعالجة جداول البيانات. إليك تفصيلاً مفصلاً:

- **تضمين ملف Autoload:** ابدأ نصك البرمجي PHP بـ `require 'vendor/autoload.php';`. يضمن هذا السطر تحميل جميع المكتبات المثبتة عبر Composer، بما في ذلك PHPExcel، تلقائيًا، مستفيدًا من التحميل التلقائي PSR-0 وفقًا لهيكل المكتبة من 2015.

- **إنشاء كائن PHPExcel جديد:** ابدأ جدول بيانات جديد بـ `$objPHPExcel = new PHPExcel();`. يمثل هذا الكائن المصنف بالكامل، مما يسمح بأوراق متعددة وخصائص.

- **العمل مع الأوراق:** الوصول إلى الورقة النشطة باستخدام `$sheet = $objPHPExcel->getSheet(0);` للورقة الأولى، أو إنشاء ورقة جديدة بـ `$sheet = $objPHPExcel->createSheet();`. الأوراق مفهرسة بصفر، لذا فإن `getSheet(0)` تستهدف الورقة الأولى.

- **تعيين قيم الخلايا:** املأ الخلايا باستخدام طريقة `setCellValue`، على سبيل المثال: `$sheet->setCellValue('A1', 'Hello');`. تأخذ هذه الطريقة مرجع خلية (مثل 'A1') والقيمة المطلوب إدراجها، والتي يمكن أن تكون نصًا أو أرقامًا أو صيغًا.

- **حفظ الملف:** للحفظ، أنشئ كاتبًا للتنسيق المطلوب. لـ Excel 2007 وما فوق (.xlsx)، استخدم `$writer = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');`. ثم احفظ بـ `$writer->save('filename.xlsx');`. تتضمن التنسيقات الأخرى 'Excel5' لـ .xls (Excel 95) أو 'CSV' للقيم المفصولة بفواصل.

قد يبدو النص البرمجي النموذجي للكتابة كما يلي:
```php
require 'vendor/autoload.php';
$objPHPExcel = new PHPExcel();
$sheet = $objPHPExcel->getSheet(0);
$sheet->setCellValue('A1', 'Hello');
$sheet->setCellValue('B1', 'World');
$writer = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');
$writer->save('hello_world.xlsx');
```
ينشئ هذا ملف Excel بسيط يحتوي على "Hello" في A1 و "World" في B1.

#### الاستخدام الأساسي: القراءة من Excel
تتبع القراءة من ملف Excel نمطًا مشابهًا ولكنها تبدأ بتحميل الملف:
- **تحميل الملف:** استخدم `$objPHPExcel = PHPExcel_IOFactory::load('filename.xlsx');` لتحميل ملف Excel موجود. يمكن لـ IOFactory اكتشاف نوع الملف تلقائيًا، ولكن يمكنك تحديد قارئ، على سبيل المثال `$objReader = PHPExcel_IOFactory::createReader('Excel2007'); $objPHPExcel = $objReader->load('filename.xlsx');` للنوع الصريح.

- **الوصول إلى الأوراق والخلايا:** بعد التحميل، قم بالوصول إلى الأوراق كما كان من قبل، على سبيل المثال `$sheet = $objPHPExcel->getSheet(0);`. استرجع قيم الخلايا باستخدام `$cellValue = $sheet->getCell('A1')->getValue();`، والتي تُرجع محتوى الخلية المحددة.

مثال للقراءة:
```php
require 'vendor/autoload.php';
$objPHPExcel = PHPExcel_IOFactory::load('hello_world.xlsx');
$sheet = $objPHPExcel->getSheet(0);
$cellValue = $sheet->getCell('A1')->getValue();
echo $cellValue; // يخرج "Hello"
```
يقرأ هذا القيمة من A1، موضحًا الاسترجاع الأساسي.

#### التبعيات والمتطلبات
لـ PHPExcel متطلبات PHP محددة وإضافات ضرورية للتشغيل:
- **إصدار PHP:** يتطلب PHP 5.2 أو 7.0 أو أعلى، وفقًا لبيانات وصف Packagist. نظرًا للتاريخ الحالي، 3 مارس 2025، يجب أن تفي معظم تثبيتات PHP الحديثة بهذا، ولكن الإعدادات الأقدم قد تحتاج إلى تحديثات.
- **الإضافات:** تعتمد المكتبة على `ext-mbstring` و `ext-XML` و `ext-XMLWriter`، والتي يجب تمكينها في تكوين PHP الخاص بك. تتعامل هذه الإضافات مع ترميز النصوص وتحليل XML وكتابة XML، على التوالي، وهي ضرورية لعمليات ملفات Excel.

يجب على المستخدمين التحقق من أن هذه الإضافات نشطة باستخدام `phpinfo()` أو التحقق من ملف `php.ini`، مما يضمن عدم ظهور مشكلات توافق.

#### ميزات وتنسيقات إضافية
تتجاوز القراءة/الكتابة الأساسية، تدعم PHPExcel تنسيقات ملفات متنوعة، وهو تفصيل غير متوقع للمستخدمين المطلعين فقط على Excel. يمكن للمكتبة التعامل مع:
- Excel 2007 (.xlsx) عبر كاتب/قارئ 'Excel2007'.
- Excel 95 (.xls) عبر 'Excel5'.
- ملفات CSV عبر 'CSV'.
- HTML عبر 'HTML'.

عند الحفظ، حدد نوع الكاتب؛ عند القراءة، يكتشف IOFactory غالبًا تلقائيًا، ولكن يمكن استخدام القراء الصريحين لتحسين الموثوقية. على سبيل المثال، للحفظ كـ .xls:
```php
$writer = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');
$writer->save('filename.xls');
```
هذه المرونة مفيدة للأنظمة القديمة أو احتياجات التنسيق المحددة، على الرغم من أن المستخدمين يجب أن يلاحظوا القيود الخاصة بالتنسيق، خاصة مع إصدارات Excel الأقدم.

#### إيقاف التطوير ونصيحة الهجرة
نقطة حرجة هي إيقاف تطوير PHPExcel. تظهر الأبحاث أنه تم أرشفتها في 2019، مع آخر تحديث في 2015، ولم تعد تُصان. هذا يثير مخاوف بشأن الثغرات الأمنية والتوافق مع إصدارات PHP بعد 7.0، خاصة مع المعايير الحديثة مثل PHP 8.x. يوصي مستودع GitHub وصفحة Packagist كليهما بالانتقال إلى PhpSpreadsheet، الذي يقدم مساحات أسماء Namespaces وامتثالًا لـ PSR وتطويرًا نشطًا.

للمستخدمين، هذا يعني:
- للمشاريع الحالية التي تستخدم PHPExcel 1.8، تابع بحذر، مع ضمان الاختبار للأمان والتوافق.
- للمشاريع الجديدة، فكر strongly في استخدام PhpSpreadsheet، مع توفر أدوات الهجرة، كما هو مذكور في وثائق PhpSpreadsheet ([Migration from PHPExcel](https://phpspreadsheet.readthedocs.io/en/latest/topics/migration-from-PHPExcel/)).

هذه النصيحة ذات صلة خاصة بالتاريخ الحالي، مما يضمن محاذاة المستخدمين مع المكتبات الحديثة المدعومة.

#### الوثائق والتعلم الإضافي
للاستكشاف الأعمق، الوثائق الرسمية لـ PHPExcel متاحة في مستودع GitHub الخاص بها تحت مجلد Documentation، على الرغم من أن الوصول قد يتطلب تنزيل ملفات مثل وثائق المطور DOC. عبر الإنترنت، توفر البرامج التعليمية مثل الموجود على SitePoint ([Generate Excel Files and Charts with PHPExcel](https://www.sitepoint.com/generate-excel-files-charts-phpexcel/)) أمثلة عملية، تغطي المخططات والتنسيق، والتي تتجاوز الاستخدام الأساسي. تقدم سلاسل Stack Overflow أيضًا رؤى مجتمعية، على الرغم من أنه يجب توخي الحذر مع الإجابات القديمة نظرًا لحالة المكتبة.

#### جدول مقارن: PHPExcel مقابل PhpSpreadsheet
للمساعدة في اتخاذ القرار، إليك جدول مقارنة يسلط الضوء على الاختلافات الرئيسية، بناءً على البحث:

| الميزة                     | PHPExcel (1.8)                     | PhpSpreadsheet                  |
|--------------------------|------------------------------------|---------------------------------|
| آخر تحديث               | 2015                              | نشط (حتى 2025)                 |
| مساحات الأسماء Namespaces | لا، مساحة الاسم الجذرية           | نعم، متوافق مع PSR-4            |
| حالة الصيانة            | متوقفة، مؤرشفة 2019               | تُصان بنشاط                    |
| دعم إصدار PHP           | حتى 7.0                           | PHP 7.4+                        |
| دعم تنسيقات الملفات     | Excel, CSV, HTML, إلخ.            | محسّن، يشمل ODS, PDF           |
| الأداء                   | معتدل، كثيف الاستخدام للذاكرة     | مُحسّن، قابل للتوسع            |

يؤكد هذا الجدول على التحول إلى PhpSpreadsheet للاحتياجات الحديثة، على الرغم من أن PHPExcel تظل وظيفية للأغراض القديمة.

#### الخلاصة
يتضمن استخدام "phpoffice/phpexcel": "^1.8" التثبيت عبر Composer، والاستفادة من فئاتها لعمليات Excel، وضمان وجود إضافات PHP المطلوبة. بينما هي وظيفية، فإن توقف تطويرها يستلزم الحذر، مع التوصية بـ PhpSpreadsheet للمشاريع المستقبلية. يوفر هذا الدليل نقطة بداية شاملة، مع أمثلة وتبعيات وموارد إضافية للمستخدمين لاستكشاف المزيد.

### الاقتباسات الرئيسية
- [صفحة Packagist لـ phpoffice/phpexcel مع تفاصيل التثبيت](https://packagist.org/packages/phpoffice/phpexcel)
- [البرنامج التعليمي لـ SitePoint حول إنشاء ملفات Excel باستخدام PHPExcel](https://www.sitepoint.com/generate-excel-files-charts-phpexcel/)
- [حالة أرشفة مستودع PHPExcel على GitHub](https://github.com/PHPOffice/PHPExcel)
- [دليل هجرة PhpSpreadsheet من PHPExcel](https://phpspreadsheet.readthedocs.io/en/latest/topics/migration-from-PHPExcel/)