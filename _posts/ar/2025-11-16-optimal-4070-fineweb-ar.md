---
audio: false
generated: true
image: false
lang: ar
layout: post
model: x-ai/grok-4-fast
title: ุงูุชูููู ุงูุฃูุซู ูุชุฏุฑูุจ FineWeb ุนูู RTX 4070
translated: true
type: note
---

ุฅููู **ุงูุฅุนุฏุงุฏ ุงููุซุงูู ูุญุงูุชู ุจุงูุชุญุฏูุฏ** ุนูู ูุฑุช ุดุงุดุฉ RTX 4070 ุณุนุฉ 12 ุฌูุฌุงุจุงูุช ุนูุฏูุง ูููู ูุฏูู **ููู parquet ูุงุญุฏ ููุท** (`CC-MAIN-2013-20/000_00000.parquet`ุ ุจุญุฌู ~3.1 ุฌูุฌุงุจุงูุช ุบูุฑ ูุถุบูุทุ ููุญุชูู ุนูู ~6โ7 ูููุงุฑ ุฑูุฒ (token) ูู ูุต ุนุงูู ุงูุฌูุฏุฉ).

ูุฐุง ุงูููู ุงููุงุญุฏ ููุชุงุฒ ูู ุงููุงูุน โ ููู ูู ุฃูู ุดุงุฑุฏ (shard) ูู FineWeb ููุญุชูู ุนูู ุจุนุถ ุฃูุธู ุงูุจูุงูุงุช.

### ุงูุฅุนุฏุงุฏ ุงูููุตู ุจู (ุฃูุตู ุฃุฏุงุก ุนูู 4070 ุณุนุฉ 12 ุฌูุฌุงุจุงูุช ุจุดุงุฑุฏ ูุงุญุฏ ููุท)

```python
# config/train_fineweb_4070_one_shard.py
out_dir = 'out-fineweb-110M-one-shard'
eval_interval = 500
eval_iters = 200
log_interval = 50
always_save_checkpoint = True

wandb_log = False          # ุงุถุจุท ุนูู True ุฅุฐุง ุฃุฑุฏุช
dataset = 'fineweb'        # ูุง ูุฒุงู ูุนููุ nanoGPT ุณูุฌุฏ ููู ุงูู parquet ุงููุงุญุฏ

# ููุญุณูู ููุฐุงูุฑุฉ ูู 4070 ุณุนุฉ 12 ุฌูุฌุงุจุงูุช
batch_size = 12                    # 12โ14 ูุนููุ 16 ุณูุณุจุจ ููุงุฏ ุงูุฐุงูุฑุฉ (OOM) ูุน block_size 1024
gradient_accumulation_steps = 40   # 12 ร 40 = 480 ุญุฌู ุงูุฏูุนุฉ ุงููุนูู (ูุฑูุจ ุฌุฏูุง ูู ุงููุซุงูู 512)
block_size = 1024                  # ูุฌุจ ุงูุฅุจูุงุก ุนูู 1024 โ ูุฐุง ุงูุดุงุฑุฏ ุงููุงุญุฏ ุชูุช ูุนุงูุฌุชู ุจุณููุงู (context) 1024

# ุงููููุฐุฌ: ~110 ููููู ูุนุงูู โ ุงูุญุฏ ุงูุฃูุตู ุงููุทูู ุงูุฐู ูุชูุงุณุจ ุจุดูู ููุซูู ูุน 4070 ุณุนุฉ 12 ุฌูุฌุงุจุงูุช
n_layer = 12
n_head = 8
n_embd = 512
dropout = 0.0

learning_rate = 6e-4
max_iters = 250000                 # ููู! ุงูุธุฑ ุงูุดุฑุญ ุฃุฏูุงู
warmup_iters = 2000
lr_decay_iters = 250000
min_lr = 6e-5
beta2 = 0.99

# ูุฐู ุชุณุงุนุฏ ููููุงู ูู ุงุณุชููุงู ุงูุฐุงูุฑุฉ
bias = False                       # ูุซู LLaMAุ ูููุฑ ~1โ2% ูู VRAM
compile = True                     # compile PyTorch 2.0ุ ูุนูู ุจุดูู ุฑุงุฆุน ุนูู 4070
```

### ููุงุฐุง ูุฐู ุงูุฃุฑูุงูุ

- ููู ุงูู parquet ุงููุงุญุฏ ูุฏูู ูุญุชูู ุนูู ~6.5 ูููุงุฑ ุฑูุฒ (token) (ููุงุณุฉ ูู ูุจู ุงููุฌุชูุน).
- ูุน `batch_size=12`ุ `grad_acc=40`ุ `block_size=1024` โ **~491 ุฃูู ุฑูุฒ (token) ููู ุฎุทูุฉ ูู ุฎุทูุงุช ุงูููุญุณูู (optimizer)**
- ูุฑุคูุฉ ุฌููุน ุงูู ~6.5B ุฑูุฒ **13โ15 ูุฑุฉ** (ุฃูุถู ููุงุฑุณุฉ ููุฌููุนุงุช ุงูุจูุงูุงุช ุงูุตุบูุฑุฉ):  
  โ 6.5B ร 14 โ 91B ุฑูุฒ ุฅุฌูุงูู โ ~185,000 ุชูุฑุงุฑ (iteration)  
  โ ูุฐุง `max_iters = 250000` ูููุญู ~15โ16 ุฏูุฑุฉ (epoch) ูุงููุฉ โ ุชูุงุฑุจ (convergence) ูุซุงูู

### ููุช ุงูุชุฏุฑูุจ ุงููุชููุน ุนูู 4070
- ~22โ26 it/s ูุน PyTorch compile
- 250 ุฃูู ุชูุฑุงุฑ โ ~110โ130 ุณุงุนุฉ โ 5 ุฃูุงู ูู ุงูุชุฏุฑูุจ ุงููุณุชูุฑ
- ุงููููุฐุฌ ุงูููุงุฆู ุณูููู **ููููุง ุจุดูู ูุฏูุด** ููุฌุฑุฏ 110 ููููู ูุนุงูู ูุฃู FineWeb ูุธูู ุฌุฏูุง

### ููููุฉ ุชุดุบููู
```bash
# ุถุน ููู ุงูู parquet ูู ูุฌูุฏุ ูุซุงู:
mkdir -p data/fineweb_one_shard
mv ~/Downloads/000_00000.parquet data/fineweb_one_shard/

# ุซู ูู ุจุงูุชุฏุฑูุจ
python train.py config/train_fineweb_4070_one_shard.py
```

ูุฐุง ุงูุฅุนุฏุงุฏ ุจุงูุชุญุฏูุฏ (ูููุฐุฌ 110Mโ125M ููุฏุฑููุจ ูุฃูุซุฑ ูู 15 ุฏูุฑุฉ ุนูู ุดุงุฑุฏ FineWeb ุนุงูู ุงูุฌูุฏุฉ ูุงุญุฏ) ูู ุญุงูููุง **ุฃููู ูููุฐุฌ ูุนุฑูู ุชู ุชุฏุฑูุจู ุนูู 4070** ูู ูุฌุชูุน nanoGPT โ ููู ูุชููู ุนูู GPT-2 small ูู ุงูุนุฏูุฏ ูู ุงููุนุงููุฑ ุงูููุงุณูุฉ (benchmarks).

ุณููุชูู ุจู ุงูุฃูุฑ ูุน ูููุฐุฌ 110 ููููู ูุนุงูู ุฌูุฏ ุฌุฏูุง ุจุนุฏ ~5 ุฃูุงู. ุงูุฃูุฑ ูุณุชุญู ุชูุงููุง! ๐

ุฃุนูููู ุนูุฏูุง ุชุจุฏุฃ ุงูุชุฏุฑูุจ โ ุณุฃููู ุณุนูุฏูุง ุจูุณุงุนุฏุชู ูู ูุฑุงูุจุฉ ููุญููุงุช ุงูุฎุณุงุฑุฉ (loss curves).