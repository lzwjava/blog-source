---
audio: false
generated: true
lang: ar
layout: post
title: WebAssembly
translated: true
type: note
---

دعنا نتعمق في دليل شامل حول WebAssembly (Wasm). سأقوم بتقسيمه إلى أقسام سهلة الاستيعاب: ما هو، كيف يعمل، لماذا يهم، كيفية استخدامه، وإلى أين يتجه. في النهاية، سيكون لديك فهم قوي لـ WebAssembly وكيفية البدء في استخدامه.

---

### **1. ما هو WebAssembly؟**
WebAssembly هو تنسيق تعليمات ثنائي مصمم ليكون هدف تجميع محمول وعالي الأداء للغات البرمجة. إنها لغة منخفضة المستوى، تشبه لغة التجميع، ذات تمثيل ثنائي مضغوط، لكنها ليست مخصصة ليتم كتابتها مباشرة من قبل البشر—بدلاً من ذلك، يتم توليدها عن طريق تجميع لغات عالية المستوى مثل C، C++، Rust، Go، أو حتى Python.

- **الميزات الرئيسية:**
  - **الأداء:** ينفذ بسرعة قريبة من السرعة الأصلية من خلال الاستفادة من إمكانيات الجهاز.
  - **إمكانية النقل:** يعمل بشكل متسق عبر المنصات (المتصفحات، الخوادم، أجهزة إنترنت الأشياء، إلخ).
  - **الأمان:** يعمل في بيئة معزولة (sandboxed)، مما يبعده عن النظام المضيف.
  - **القدرة على التشغيل البيني:** يعمل جنبًا إلى جنب مع JavaScript، وليس ضده.

- **التاريخ:**
  - تم تقديمه في عام 2015 من خلال تعاون بين Mozilla وGoogle وMicrosoft وApple.
  - أصبح توصية من W3C في عام 2019، مما يجعله معيارًا رسميًا للويب.

- **حالات الاستخدام:**
  - ألعاب الويب (مثل تصديرات Unity أو Unreal Engine).
  - التطبيقات الحرجة من حيث الأداء (مثل محرري الفيديو مثل Figma أو أدوات مشابهة لـ Photoshop).
  - التطبيقات من جانب الخادم (مثل استخدام Node.js).
  - تشغيل قواعد التعليمات البرمجية القديمة في بيئات حديثة.

---

### **2. كيف يعمل WebAssembly؟**
WebAssembly يملأ الفجوة بين الكود عالي المستوى والتنفيذ على الجهاز. إليك العملية:

1. **الكود المصدري:** تكتب الكود بلغة مثل C++ أو Rust.
2. **التجميع:** يقوم المترجم (مثل Emscripten لـ C/C++ أو `wasm-pack` لـ Rust) بترجمته إلى التنسيق الثنائي لـ WebAssembly (ملفات `.wasm`).
3. **التنفيذ:**
   - في المتصفحات، يتم جلب ملف `.wasm` (غالبًا عبر JavaScript)، والتحقق من صحته، وتجميعه إلى كود الآلة بواسطة وقت تشغيل Wasm في المتصفح.
   - وقت التشغيل ينفذه في بيئة معزولة، مما يضمن السلامة.

- **تنسيق النص (WAT):** لدى WebAssembly أيضًا تمثيل نصي يمكن للبشر قراءته (`.wat`)، مفيد في التصحيح أو التعلم. على سبيل المثال:
  ```wat
  (module
    (func (export "add") (param i32 i32) (result i32)
      local.get 0
      local.get 1
      i32.add)
  )
  ```
  هذا يحدد دالة `add` تأخذ عددين صحيحين 32-بت وتعيد مجموعهما.

- **نموذج الذاكرة:** يستخدم Wasm نموذج ذاكرة خطي—مصفوفة مسطحة من البايتات يمكن للبرنامج قراءتها/كتابتها. يتم إدارتها يدويًا أو عبر وقت تشغيل اللغة المصدر.

- **التفاعل مع JavaScript:** يمكنك تحميل وحدات Wasm في JavaScript باستخدام `WebAssembly.instantiate()` أو `fetch()` واستدعاء الدوال المُصدرة. يمكن لـ Wasm أيضًا أن يستدعي JavaScript مرة أخرى.

---

### **3. لماذا تستخدم WebAssembly؟**
- **السرعة:** الملفات الثنائية المترجمة مسبقًا تعمل أسرع من JavaScript المفسرة.
- **مرونة اللغة:** استخدام C، Rust، إلخ، بدلاً من الاقتصار على JavaScript.
- **كفاءة الحجم:** ملفات `.wasm` أصغر من JavaScript المكافئة، مما يقلل أوقات التحميل.
- **عبر المنصات:** اكتب مرة واحدة، وشغل في أي مكان—المتصفحات، الخوادم، أو الأجهزة المضمنة.
- **الأمان:** العزل يمنع الكود الضار من الوصول إلى النظام المضيف.

**المفاضلات:**
- لا يوجد وصول مباشر إلى DOM (أنت بحاجة إلى JavaScript لذلك).
- الأدوات يمكن أن تكون معقدة للمبتدئين.
- التصحيح أصعب منه في JavaScript.

---

### **4. البدء مع WebAssembly**
دعنا نستعرض مثالاً بسيطًا: تجميع دالة C إلى WebAssembly وتشغيلها في متصفح.

#### **الخطوة 1: تثبيت الأدوات**
- **Emscripten:** سلسلة أدوات لتجميع C/C++ إلى WebAssembly.
  - التثبيت: اتبع [دليل Emscripten](https://emscripten.org/docs/getting_started/downloads.html) (يتطلب Python، CMake، إلخ).
- **Node.js:** اختياري، لتشغيل Wasm خارج المتصفح.
- **خادم ويب:** المتصفحات تتطلب أن يتم تقديم ملفات `.wasm` عبر HTTP (على سبيل المثال، استخدم `python -m http.server`).

#### **الخطوة 2: كتابة الكود**
أنشئ ملف `add.c`:
```c
int add(int a, int b) {
    return a + b;
}
```

#### **الخطوة 3: التجميع إلى WebAssembly**
شغل أمر Emscripten هذا:
```bash
emcc add.c -s EXPORTED_FUNCTIONS='["_add"]' -s EXPORT_ES6=1 -s MODULARIZE=1 -o add.js
```
- ينتج `add.js` (سكريبت ربط) و `add.wasm` (الملف الثنائي).

#### **الخطوة 4: الاستخدام في HTML**
أنشئ `index.html`:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
</head>
<body>
    <script type="module">
        import init, { add } from './add.js';
        async function run() {
            await init();
            console.log(add(5, 3)); // يُخرج 8
        }
        run();
    </script>
</body>
</html>
```

#### **الخطوة 5: الخدم والاختبار**
- ابدأ خادم محلي: `python -m http.server 8080`
- افتح `http://localhost:8080` في متصفح، وتحقق من وحدة التحكم.

بالنسبة لـ Rust، ستستخدم `cargo` و `wasm-pack`—عملية مشابهة، ولكن بسلسلة أدوات مختلفة.

---

### **5. البيئة والأدوات**
- **اللغات:**
  - **C/C++:** Emscripten.
  - **Rust:** `wasm-pack`، `wasm-bindgen`.
  - **Go:** دعم مدمج لـ Wasm (`GOOS=js GOARCH=wasm`).
  - **AssemblyScript:** بناء جملة يشبه TypeScript لـ Wasm.

- **أوقات التشغيل:**
  - **المتصفحات:** Chrome، Firefox، Safari، Edge.
  - **Node.js:** مع `--experimental-wasm-modules`.
  - **الاستقلالي:** Wasmtime، Wasmer، WasmEdge.

- **المكتبات:**
  - **WebGL:** للرسومات (مثل الألعاب).
  - **WASI:** واجهة نظام WebAssembly لحالات الاستخدام غير المرتبطة بالويب (مثل I/O للملفات، إلخ).

---

### **6. الميزات المتقدمة**
- **الخيوط (Threads):** مدعومة مع SharedArrayBuffer للتزامن.
- **SIMD:** تعليمات المتجهات للمهام الثقيلة حسابيًا (مثل معالجة الصور).
- **WASI:** يوسع Wasm beyond الويب، مضيفًا استدعاءات النظام.
- **الربط الديناميكي:** تحميل وحدات `.wasm` متعددة وربطها أثناء التشغيل.

---

### **7. مستقبل WebAssembly**
- **اعتماد أوسع:** المزيد من اللغات وأطر العمل تضيف دعم Wasm.
- **الحوسبة بدون خادم (Serverless):** طبيعة Wasm الخفيفة تناسب الحوسبة الطرفية (edge computing).
- **التوحيد القياسي:** المقترحات مثل جمع القمامة (garbage collection) ومعالجة الاستثناءات قيد التقدم.
- **النمو خارج الويب:** WASI وأوقات التشغيل مثل Wasmer يدفعون Wasm إلى إنترنت الأشياء، تطبيقات سطح المكتب، والمزيد.

---

### **8. مصادر للتعلم أكثر**
- **الموقع الرسمي:** [webassembly.org](https://webassembly.org/)
- **وثائق MDN:** [WebAssembly على MDN](https://developer.mozilla.org/en-US/docs/WebAssembly)
- **الدروس:** كتاب "Rust and WebAssembly" (rustwasm.github.io/book) أو وثائق Emscripten.
- **منشورات X:** ابحث عن #WebAssembly على X للحصول على أمثلة ومناقشات من الواقع.

---

### **ملخص سريع**
WebAssembly هو عامل تغيير قواعد اللعبة من حيث الأداء وإمكانية النقل. تكتب بلغتك المفضلة، تجمع إلى `.wasm`، وتشغلها في أي مكان—بسرعة. إنه ليس حلًا سحريًا (فـ JavaScript لا تزال تتحكم في التفاعلية على الويب)، لكنه أداة قوية في مجموعة أدوات المطور الحديث.

هل تريد تجربة مثال محدد، استكشاف حالة استخدام، أو استكشاف خطأ ما؟ دعني أعرف!