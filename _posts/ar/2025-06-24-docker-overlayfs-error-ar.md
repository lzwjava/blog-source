---
audio: false
generated: true
image: false
lang: ar
layout: post
model: google/gemini-2.5-flash
title: إصلاح خطأ إزالة Docker OverlayFS
translated: true
type: note
---

الخطأ الذي تراه، وتحديدًا السطر:
`Error response from daemon: container ccd89a3f36a1528cb923c90de8755faeb36e229cab353c2285222948197b8d18: driver "overlay2" failed to remove root filesystem: readdirnames /var/lib/docker/overlay2/7acbf095f3537e4829397e10f2134499389c724d3378782a8882ff1299fc431f/merged: readdirent merged: bad message`
يشير إلى **مشكلة في برنامج تخزين Docker**، وتحديدًا **OverlayFS (overlay2)**، والتي غالبًا ما تكون مرتبطة بحالة تالفة لنظام الملفات على جهازك المضيف. يحدث هذا عادةً عندما لا يتمكن Daemon Docker من الوصول إلى ملفات الحاوية أو تنظيفها بشكل صحيح.

إليك نهجًا تدريجيًا لإصلاح هذا، بدءًا من الطرق الأقل تدخلاً.

-----

## 1. إيقاف الحاوية وإزالتها قسراً

فشلت إزالة الحاوية `chat-mongodb`. ستحتاج إلى استهداف تلك الحاوية المحددة.

### أ. محاولة الإزالة القسرية

حاول إزالة الحاوية مرة أخرى، ولكن هذه المرة استخدم علم الإجبار (`-f`) لضمان أنها لا تعمل ومحاولة إزالة أكثر قوة:

```bash
docker rm -f chat-mongodb
```

أو استخدم معرف الحاوية:

```bash
docker rm -f ccd89a3f36a1528cb923c90de8755faeb36e229cab353c2285222948197b8d18
```

### ب. إيقاف مجموعة Docker Compose

إذا كانت الحاوية جزءًا من مجموعة أكبر تحاول تفكيكها (كما يشير `[+] Running 3/3`)، فحاول إيقاف الخدمات برفق أولاً قبل محاولة الإزالة مرة أخرى:

```bash
docker compose stop
# ثم حاول الأمر الأصلي مرة أخرى
# e.g., docker compose down
```

-----

## 2. إعادة تشغيل Daemon Docker

يمكن لإعادة تشغيل خدمة Docker ببساطة في كثير من الأحيان أن تزيل أخطاء برنامج التخزين العابرة وملفات القفل.

### لأنظمة Linux (باستخدام systemd):

```bash
sudo systemctl restart docker
```

### لـ Docker Desktop (macOS/Windows):

1.  انقر على **أيقونة Docker** في علبة النظام/شريط القائمة.
2.  انتقل إلى **Troubleshoot** (أو **Settings** $\rightarrow$ **Daemon** $\rightarrow$ **Restart**).
3.  انقر على **Restart**.

بعد إعادة التشغيل، حاول إزالة الحاوية مرة أخرى.

-----

## 3. التنظيف يدويًا للمجلد التالف

**⚠️ تحذير:** تتضمن هذه الخطوة التلاعب المباشر بالهيكل الداخلي لملفات Docker ويجب **تنفيذها فقط كملاذ أخير** و **بينما Daemon Docker متوقف**. يمكن أن يتسبب الحذف اليدوي غير الصحيح في مزيد من التلف.

يشير الخطأ إلى مجلد محدد داخل تخزين OverlayFS: `/var/lib/docker/overlay2/7acbf095f3537e4829397e10f2134499389c724d3378782a8882ff1299fc431f/merged`.

1.  **أوقف Daemon Docker:**

    ```bash
    sudo systemctl stop docker
    ```

2.  **قم بإزالة المجلد المشكل يدويًا:**

    ```bash
    # قم فقط بإزالة المجلد المذكور في رسالة الخطأ الخاصة بك
    sudo rm -rf /var/lib/docker/overlay2/7acbf095f3537e4829397e10f2134499389c724d3378782a8882ff1299fc431f
    ```

    *إذا لم تتمكن من العثور على المجلد المحدد، قد تحتاج إلى تجربة تنظيف أكثر عمومية (انظر الخطوة التالية).*

3.  **ابدأ تشغيل Daemon Docker:**

    ```bash
    sudo systemctl start docker
    ```

4.  **حاول إزالة الحاوية/المجموعة مرة أخرى.**

-----

## 4. تقليم البيانات غير المستخدمة

إذا فشلت الخطوات المذكورة أعلاه، يمكنك استخدام أوامر التنظيف المدمجة في Docker. يزيل هذا الأمر جميع الحاويات المتوقفة، وجميع الشبكات غير المستخدمة من قبل حاوية واحدة على الأقل، وجميع الصور المعلقة، وجميع ذاكرة التخزين المؤقت للبناء.

```bash
docker system prune
```

**ملاحظة:** سيطلب هذا الأمر تأكيدًا وسيزيل البيانات التي قد ترغب في الاحتفاظ بها إذا لم تكن مستخدمة بنشاط (مثل الحاويات المتوقفة). استخدم `-a` لإزالة جميع الصور غير المستخدمة (وليس فقط المعلقة).