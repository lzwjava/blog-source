---
audio: false
generated: true
image: false
lang: ar
layout: post
model: openai/gpt-oss-120b
title: حل أخطاء طلب كبير جدًا
translated: true
type: note
---

## ماذا يعني الخطأ

- **‎413 طلب كبير جدًا** هو رمز حالة HTTP يشير إلى أن الخادم رفض معالجة الطلب لأن الحمولة تتجاوز الحجم المسموح به. في سياق خدمة الاستدلال من OpenAI، فإن "الحمولة" هي العدد الإجمالي للرموز (المدخلات + المخرجات) المرسلة في طلب واحد. [1]

- **حد الرموز في الدقيقة (TPM)**: تم تكوين النموذج `openai/gpt‑oss‑120b` بحد أقصى يبلغ **‎8,000 رمز في الدقيقة** لطبقة الخدمة حسب الطلب. الطلب الذي أرسلته يحتوي على **‎13,701 رمز**، وهو ما يزيد عن الحد المسموح به بمقدار **‎5,701 رمز**. [1]

- **لماذا يحدث هذا**:
  1.  **موجه طويل** – قد يكون نص الإدخال (بما في ذلك تعليمات النظام، ورسائل المستخدم، وأي بيانات مرفقة) طويلاً جدًا.
  2.  **إعداد قيمة `max_tokens` مرتفعة** – إذا طلب الطلب من النموذج إنشاء استكمال طويل، فإن العدد المتوقع لرموز المخرجات يُضاف إلى عدد رموز المدخلات.
  3.  **مكالمات متتالية سريعة** – إذا تم إرسال العديد من الطلبات في تتابع سريع، فقد تتجاوز الرموز التراكمية في الدقيقة الحالية الحصة المسموح بها للرموز في الدقيقة، حتى لو كان كل طلب فردي أقل من الحد المسموح به.

## كيفية حل المشكلة

| الخيار | الإجراء المطلوب | التأثير |
|--------|------------|--------|
| **تقليم الموجه** | إزالة النص غير الضروري، أو استخدام تعليمات موجزة، أو ضغط البيانات (مثل تلخيص الكتل الكبيرة قبل الإرسال). | يقلل من عدد رموز الإدخال. |
| **تقليل `max_tokens`** | طلب استكمال أقصر (مثل ضبط `max_tokens` على 500 بدلاً من 2000). | يقلل من العدد المتوقع لرموز المخرجات. |
| **تقسيم الطلب** | تقسيم المستند الكبير إلى أجزاء أصغر متعددة واستدعاء النموذج بالتتابع، ثم تجميع النتائج معًا لاحقًا. | يحافظ على كل استدعاء ضمن حد الرموز في الدقيقة. |
| **الترقية إلى طبقة أعلى** | الانتقال إلى طبقة ذات سعة أعلى (مثل طبقة المطورين) حيث يكون حد الرموز في الدقيقة أكبر أو غير محدود. | يسمح بحمولة طلب فردي أكبر دون حدوث خطأ. |
| **تقليل وتيرة المكالمات** | إضافة تأخير قصير بين الطلبات أو تنفيذ الحد من المعدل للحفاظ على إجمالي الرموز في الدقيقة ≤ 8,000. | يمنع تجاوز حد الرموز في الدقيقة التراكمي. |

## قائمة مراجعة سريعة قبل إرسال الطلب

1.  **عد الرموز** – استخدم أداة حساب الرموز من OpenAI (أو `tiktoken`) لتقدير إجمالي الرموز (الموجه + أقصى عدد للرموز).
2.  **ابق ضمن ≤ 8,000 رمز في الدقيقة** لطبقة الخدمة حسب الطلب.
3.  **إذا كنت قريبًا من الحد**، ففكر في اتخاذ أحد خطط التخفيف المذكورة أعلاه.

من خلال ضمان بقاء الطلب ضمن الحصة المسموح بها البالغة 8,000 رمز في الدقيقة، سيتم تجنب خطأ 413 "طلب كبير جدًا". [1]

المراجع:
[1] https://www.reddit.com/r/OpenAI/comments/1nbtl2p/wow_weve_been_burning_money_for_6_months/