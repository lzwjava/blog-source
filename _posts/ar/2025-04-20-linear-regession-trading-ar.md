---
audio: false
generated: true
lang: ar
layout: post
title: التداول باستخدام الانحدار الخطي
translated: true
type: note
---

سؤال رائع! أنت تجمع بين مهمتين هنا:

1. **جلب بيانات الأسهم التاريخية (مثل Tencent) باستخدام TigerOpen API**
2. **استخدام تلك البيانات مع كود الانحدار الخطي الحالي القائم على numpy**

---

## هل سيعمل كما هو؟

**لا، ليس مباشرة.** كود التعلم الآلي الحالي الخاص بك يتوقع `x_train` و `y_train` كمصفوفات numpy من القيم الرقمية التي تمثل الميزات والتسميات (مثل عدد السكان مقابل الربح). لكن TigerOpen API تُرجع **أشرطة الأسهم التاريخية** (بيانات OHLCV)، وهي سلسلة زمنية تحتوي على حقول متعددة لكل طابع زمني.

أنت بحاجة إلى:

- استخراج بيانات الأسهم ومعالجتها مسبقًا بشكل صحيح إلى مصفوفات `x_train` و `y_train` مناسبة.
- تكييف نموذجك ورمزك مع سياق بيانات الأسهم (مثل التنبؤ بسعر الإغلاق من الأيام السابقة).

---

## كيفية تكييف بيانات الأسهم الخاصة بك لنموذج الانحدار الخطي؟

### الخطوة 1: جلب البيانات التاريخية لـ Tencent (الرمز `'00700'`)

```python
bars_dict = quote_client.get_bars(
    symbols=['00700'],
    period=BarPeriod.DAY,
    begin_time='2024-01-01',
    end_time=datetime.now().strftime('%Y-%m-%d'),
    limit=100,
    right=QuoteRight.BR
)

bars = bars_dict.get('00700', [])
```

### الخطوة 2: استخراج الميزات والتسميات

نهج بسيط:

- استخدم مؤشر اليوم كـ `x_train` (مثال: 0, 1, 2, ...)
- استخدم سعر الإغلاق كـ `y_train`

```python
import numpy as np

x_train = np.array([i for i in range(len(bars))])
y_train = np.array([bar.close for bar in bars])
```

بدلاً من ذلك، يمكنك استخدام سعر إغلاق اليوم السابق كميزة للتنبؤ بسعر إغلاق اليوم التالي، أو ميزات أكثر تطوراً.

### الخطوة 3: استخدم كود الانحدار الخطي الخاص بك

الآن أصبحت `x_train` و `y_train` الخاصتان بك عبارة عن مصفوفات numpy من الأرقام، لذا يجب أن يعمل الرمز الخاص بك بشكل جيد بعد إصلاح دوال `compute_cost` و `compute_gradient` الخاصة بك (والتي تُرجع حاليًا صفر أو متجهات صفرية).

---

## مثال: تنفيذ compute_cost و compute_gradient

```python
def compute_cost(x, y, w, b):
    m = x.shape[0]
    total_cost = 0.5 * np.sum((w * x + b - y) ** 2) / m
    return total_cost

def compute_gradient(x, y, w, b):
    m = x.shape[0]
    error = w * x + b - y
    dj_dw = np.sum(error * x) / m
    dj_db = np.sum(error) / m
    return dj_dw, dj_db
```

---

## ملخص

- جلب بيانات الأسهم التاريخية باستخدام TigerOpen API
- تحويل بيانات السلسلة الزمنية إلى مصفوفات رقمية (`x_train`, `y_train`)
- تنفيذ أو إصلاح دوال التكلفة والمتجهات
- بعد ذلك، سيعمل كود النزول التدرجي والرسم الخاص بك لملاءمة نموذج خطي لبيانات أسعار الأسهم

---

## مكافأة: رسم أسعار الأسهم

سيظهر مخطط التبعثر الخاص بك سعر الإغلاق على مر الأيام، وسيقوم خط الانحدار بملاءمة الاتجاه.

---

إذا كنت ترغب في ذلك، يمكنني مساعدتك في كتابة مثال كامل يدمج جلب بيانات TigerOpen مع كود الانحدار الخطي الخاص بـ numpy! فقط اسأل.