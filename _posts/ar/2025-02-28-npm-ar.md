---
audio: false
generated: true
lang: ar
layout: post
title: تكوين NPM
translated: true
---

### النقاط الرئيسية
- يبدو أن تهيئة NPM تتضمن تحرير ملف `.npmrc` لتحديد إعدادات الوكيل والسجل، ويمكن القيام بذلك يدويًا أو عبر الأوامر.
- تشير الأبحاث إلى أن إعدادات الوكيل تتطلب الصيغة `proxy = http://user:password@proxy_server:port`، مع تشفير الحروف الخاصة في URL.
- يشير الدليل إلى تعيين السجل على `registry = https://registry.npmjs.org/` بشكل افتراضي، مع خيارات لإلغاء التحقق من SSL إذا لزم الأمر.

### تهيئة NPM والعمل مع `.npmrc`
NPM، أو مدير حزم Node، هو أداة لإدارة التبعيات JavaScript، وتشمل تهيئتها عادةً ملف `.npmrc` لإعدادات السجل والوكيل.

#### ما هو `.npmrc` ومكان وجوده؟
يعد ملف `.npmrc` ملفًا لتهيئة NPM، مما يسمح بتخصيص سلوكه. يمكن أن يكون:
- **عالمي**: موجود في `~./.npmrc` في أنظمة Unix مثل أو `%APPDATA%\npm\npmrc` في Windows (عادة `C:\Users\<username>\AppData\Roaming\npm\npmrc`).
- **محلي في مشروع**: موجود في `./package/.npmrc` في دليل الجذر للمشروع. تسبق الإعدادات المحلية الإعدادات العالمية.

#### تعيين الوكيل و HTTPS الوكيل
لعمل خلف الوكيل، أضف هذه السطور إلى `.npmrc`:
- `proxy = http://user:password@proxy_server:port`
- `https_proxy = http://user:password@proxy_server:port`

لاحظ أن حتى `https_proxy` يستخدم `http://` كبروتوكول. إذا كان اسم المستخدم أو كلمة المرور يحتوي على حروف خاصة (مثل `\`, `@`), فاشفريها (مثل `domain\user` يصبح `domain%5Cuser`). يمكنك أيضًا تعيينها عبر الأوامر:
- `npm config set proxy http://user:password@proxy_server:port`
- `npm config set https_proxy http://user:password@proxy_server:port`

#### تعيين السجل
يعد السجل URL الذي يستخدمه NPM لاسترجاع الحزم، عادةً ما يتم تعيينه على:
- `registry = https://registry.npmjs.org/`

للسجلات المخصصة، قم بالتبديل مع URL الخاص بك (مثل سجل شركة خاصة). قم بتعيينه عبر:
- `npm config set registry https://your_custom_registry.com/`

#### معالجة SSL والتحقق
إذا واجهت مشاكل SSL، فاعتبر:
- `strict-ssl = false` في `.npmrc` لإغفال أخطاء SSL، على الرغم من أن ذلك أقل أمانًا. قم بتعيينه عبر:
- `npm config set strict-ssl false`

#### استخدام وإثبات الإعدادات
قم بتحرير `.npmrc` مباشرة باستخدام محرر نص، أو استخدم الأوامر `npm config set`. لإثبات:
- قائمة جميع الإعدادات مع `npm config list`.
- تحقق من إعداد معين مع `npm config get proxy`.
- حل المشاكل مع `npm install --verbose` للحصول على إخراج مفصل.

قد يبدو ملف `.npmrc` مثالًا على:
```
proxy = http://user:password@proxy_server:8080
https_proxy = http://user:password@proxy_server:8080
registry = https://registry.npmjs.org/
strict-ssl = false
```

### ملاحظة الاستطلاع: دليل شامل لتهيئة NPM مع `.npmrc`
يقدم هذا القسم استكشافًا مفصلًا لتهيئة NPM، مع التركيز على ملف `.npmrc` لإعدادات السجل والوكيل، مع توسيع على الإجابة المباشرة مع سياق وتفاصيل فنية إضافية.

#### مقدمة إلى `.npmrc` ودوره
يعد ملف `.npmrc` ملفًا تهيئةً حاسمًا لـ NPM، مما يسمح بتخصيص سلوك إدارة الحزم. يدعم صيغة INI مع أزواج مفتاح-قيمة، حيث تبدأ التعليقات بعلامة (`;`). يمكن أن يكون موجودًا عالميًا أو محليًا:
- **الموقع العالمي**: في أنظمة Unix مثل، يكون في `~./.npmrc`؛ في Windows، في `%APPDATA%\npm\npmrc`، عادةً `C:\Users\<username>\AppData\Roaming\npm\npmrc`.
- **الموقع المحلي**: داخل دليل الجذر للمشروع ك `./package/.npmrc`. تسبق الإعدادات المحلية الإعدادات العالمية، مما يوفر إعدادات محددة للمشروع.

تضمن هذه التسلسلية مرونة، مما يسمح للمطورين بإدارة الإعدادات على مستوى المستخدم والمشروع، وهو مفيد بشكل خاص في بيئات متعددة المشاريع أو الأنظمة المشتركة.

#### تهيئة الوكيل التفصيلية
عمل خلف الوكيل يتطلب تعيين كل من `proxy` و `https_proxy` في `.npmrc`. الصيغة هي:
- `proxy = http://user:password@proxy_server:port`
- `https_proxy = http://user:password@proxy_server:port`

من المهم ملاحظة أن `https_proxy` يستخدم `http://` كبروتوكول، لا `https://`، بسبب أن الوكيل يدير الاتصال، لا يشفره إلى الوكيل نفسه. هذا نقطة من التوهين الشائعة، حيث يبقى الحمول إلى الوجهة مشفرة SSL.

للتأكد من الصلاحية، أضف اسم المستخدم وكلمة المرور، ولكن إذا كانا يحتويان على حروف خاصة، فاشفريها:
- شريط عكسي (`\`) يصبح `%5C`.
- رمز `@` يصبح `%40`.
- علامة (`:`) تصبح `%3A`.

على سبيل المثال، إذا كان اسم المستخدم `domain\user` وكلمة المرور `pass@word`، فسيكون `proxy = http://domain%5Cuser:pass%40word@proxy_server:8080`. هذا الشفري يضمن تحليل صحيح من قبل NPM.

قد يواجه المستخدمون في Windows، خاصة في بيئات Active Directory، مشاكل مع الشريط العكسي. بعض التقارير تشير إلى أن `domain\username` في `.npmrc` قد يتحول إلى `domain/username` عند القراءة، مما قد يسبب فشل في التأكيد. في هذه الحالات، يمكن استخدام أدوات مثل NTLM Authorization Proxy Server أو Cntlm، على الرغم من أنها خارج تهيئة `.npmrc` المباشرة.

#### تهيئة السجل والتفاصيل SSL
يحدد إعداد السجل من أين يسترجع NPM الحزم، الافتراضي هو `https://registry.npmjs.org/`. للسجلات المخصصة أو الخاصة، قم بتعيين:
- `registry = https://your_custom_registry.com/`

إذا فشل التحقق من SSL، غالبًا بسبب الوكالات المؤقتة في الشركات مع شهادات ذات توقيع ذاتي، يمكنك تعطيل SSL الصارم:
- `strict-ssl = false`

ومع ذلك، فإن ذلك يقلل من الأمان، لأنه يخلع التحقق من الشهادة. بدلاً من ذلك، قم بتهيئة سلطة الشهادة:
- استخدم `npm config -g set cafile [YOUR_CERTIFICATE_DIR]/[CERTIFICATE_NAME].crt` لتحديد ملف CA موثوق به.

يختار بعض المطورين `registry = http://registry.npmjs.org/` لتجنب SSL تمامًا، ولكن هذا غير موصى به لأسباب أمنية، خاصة في الإنتاج.

#### استخدام `.npmrc`: تحرير يدوي مقابل سطر الأوامر
يمكنك تحرير `.npmrc` مباشرة باستخدام أي محرر نص، مع التأكد من أن كل إعداد على سطر جديد مع الصيغة `key = value`. تبدأ التعليقات ب `;`, على سبيل المثال:
```
; إعدادات الوكيل للشبكة الشركات
proxy = http://user:password@proxy_server:8080
https_proxy = http://user:password@proxy_server:8080
registry = https://registry.npmjs.org/
strict-ssl = false
```

بدلاً من ذلك، استخدم الأوامر NPM للمريحة:
- تعيين الوكيل: `npm config set proxy http://user:password@proxy_server:port`
- تعيين السجل: `npm config set registry https://registry.npmjs.org/`
- تعيين strict-ssl: `npm config set strict-ssl false`

تحديث هذه الأوامر الملف `.npmrc` المناسب بناءً على السياق (عالمي أو محلي). لتغيير بين عالمي ومحلي، استخدم `-g` للعالمي، على سبيل المثال `npm config set -g proxy ...`.

#### التحقق والتشخيص
لإثبات الإعدادات، استخدم:
- `npm config list` لجلب جميع الإعدادات، مع عرض القيم الفعالة والافتراضية.
- `npm config get proxy` للحصول على إعداد معين.

لتشخيص المشاكل، خاصة خلف الوكالات، قم بتشغيل:
- `npm install --verbose` للحصول على سجلات مفصلة، والتي يمكن أن تساعد في تحديد مشاكل الاتصال، مثل `ECONNREFUSED` أو `socket hang up`.

إذا لم تتغير الإعدادات، فاحقق من المتغيرات البيئية (`HTTP_PROXY`, `HTTPS_PROXY`) التي قد تسبق `.npmrc`. يمكن أن تكون هذه المتغيرات عالمية وتسبق، لذا تأكد من التوافق.

#### أفضل الممارسات والتفاصيل الإضافية
- **الأمان**: تجنب `strict-ssl = false` في الإنتاج؛ بدلاً من ذلك، قم بتهيئة الشهادات الموثوقة.
- **متغيرات البيئة**: كن على علم أن `NODE_ENV` و `HTTPS_PROXY` يمكن أن تسبق `.npmrc` الإعدادات، مفيدة في أنابيب CI/CD ولكن قد تكون مزعجة محليًا.
- **مستويات السجل**: قم بتعديل `loglevel` في `.npmrc` (على سبيل المثال، `loglevel = http`) للحصول على إخراج مفصل أثناء التشخيص، مع خيارات تتراوح من `silent` إلى `silly` (7 مستويات في المجموع).
- **وكالات الشركات**: للوكالات NTLM، فاعتبر أدوات مثل Cntlm، إعداد خادم الوكيل المحلي، وتهيئة `.npmrc` لإشارة إلى `localhost:3128`، مما يسهل التأكيد.

#### أمثلة الإعدادات
هنا جدول يوضح الإعدادات الشائعة `.npmrc` للوكيل والسجل، مع أمثلة:

| **الإعداد**    | **الوصف**                              | **النموذج**                                      |
|----------------|----------------------------------------------|--------------------------------------------------|
| proxy          | URL خادم الوكيل HTTP                        | `proxy = http://user:password@proxy:8080`        |
| https_proxy    | URL خادم الوكيل HTTPS                       | `https_proxy = http://user:password@proxy:8080`  |
| registry       | URL سجل الحزم                         | `registry = https://registry.npmjs.org/`         |
| strict-ssl     | تمكين/إلغاء التحقق من SSL              | `strict-ssl = false`                             |
| loglevel       | مستوى إخراج الكنسول (من صامت إلى سخيف، 7 مستويات) | `loglevel = http`                                |

يساعد هذا الجدول في الاستشارة السريعة، خاصة للمطورين الجدد في `.npmrc`.

#### التفصيل غير المتوقع: تأثير الإعدادات العالمية على الإعدادات المحلية
جوانب غير متوقعة هي كيفية تأثير الإعدادات العالمية `.npmrc` على جميع المشاريع، بينما يمكن أن تسبق الإعدادات المحلية للمشروعين المحددين. يمكن أن يؤدي هذا التسلسل إلى الارتباك إذا، على سبيل المثال، تم تعيين الوكيل العالمي ولكن المشروع المحلي يستخدم سجلًا مختلفًا، مما قد يسبب مشاكل في التأكيد. فهم هذا التسلسل هو حاسم في بيئات متعددة المشاريع.

#### الخاتمة
تهيئة NPM عبر `.npmrc` لإعدادات الوكيل والسجل هي عملية بسيطة مع الصيغة الصحيحة والتفاصيل حول الشفري والتحقق من SSL. من خلال التحرير المباشر أو استخدام الأوامر، وإثباتها مع `npm config list`، تأكد من إدارة الحزم بشكل سلس، خاصة في الشبكات الشركات مع الوكالات. للحصول على قراءة إضافية، استعرض الوثائق الرسمية في [NPM CLI Config](https://docs.npmjs.com/cli-config) أو استكشف أفضل الممارسات في [Configuring Your .nmprc](https://nodesource.com/blog/configuring-your-nmprc-for-an-optimal-node-js-environment).

### الإشارات الرئيسية
- [NPM CLI Config Documentation](https://docs.npmjs.com/cli-config)
- [Configuring Your .nmprc for an Optimal Node.js Environment](https://nodesource.com/blog/configuring-your-nmprc-for-an-optimal-node-js-environment)
- [How to setup npm proxy settings behind proxy on Windows](https://gist.github.com/zillingen/5c4b8da657025c83ead59e1e547c7436)