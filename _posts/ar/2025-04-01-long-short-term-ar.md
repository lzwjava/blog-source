---
audio: false
generated: true
lang: ar
layout: post
title: شبكات الذاكرة طويلة المدى قصيرة المدى
translated: true
type: note
---

شبكات الذاكرة طويلة المدى قصيرة المدى (LSTM) هي نوع من بنية الشبكة العصبية المتكررة مصممة خصيصًا لمعالجة مشكلة التلاشي في التدرج وتمكين تعلم التبعيات طويلة المدى في البيانات المتسلسلة. تحقق ذلك من خلال هيكل داخلي أكثر تطورًا يسمى **خلية LSTM**.

إليك تفصيلًا لكيفية عمل خلية LSTM:

**الفكرة الأساسية: حالة الخلية**

المفهوم المركزي في LSTM هو **حالة الخلية** (غالبًا ما يشار إليها بالرمز 'C<sub>t</sub>'). فكر في حالة الخلية كحزام ناقل يعمل عبر التسلسل بأكمله. إنه يحمل المعلومات ذات الصلة بالتاريخ طويل المدى للتسلسل. يمكن إضافة المعلومات إلى حالة الخلية أو إزالتها منها أثناء تدفقها عبر الشبكة عبر هياكل تسمى **البوابات**.

**البوابات**

تحتوي خلايا LSTM على ثلاث بوابات رئيسية تنظم تدفق المعلومات:

1.  **بابة النسيان:** تقرر هذه البوابة أي المعلومات من حالة الخلية السابقة يجب التخلص منها.
    * تستقبل الحالة المخفية السابقة (h<sub>t-1</sub>) والإدخال الحالي (x<sub>t</sub>).
    * يتم تمرير هذه المدخلات عبر طبقة شبكة عصبية تليها **دالة التنشيط السيني**.
    * تنتج دالة السيني قيمًا بين 0 و 1. تشير القيمة القريبة من 0 إلى "نسيان هذه المعلومات تمامًا"، بينما تشير القيمة القريبة من 1 إلى "الاحتفاظ بهذه المعلومات تمامًا".
    * رياضياً، يتم حساب ناتج بوابة النسيان (f<sub>t</sub>) كالتالي:
        ```
        f_t = σ(W_f * [h_{t-1}, x_t] + b_f)
        ```
        حيث:
        * σ هي دالة السيني.
        * W<sub>f</sub> هي مصفوفة الأوزان لبابة النسيان.
        * [h<sub>t-1</sub>, x_t] هي عملية ربط للحالة المخفية السابقة والإدخال الحالي.
        * b<sub>f</sub> هي متجه التحيز لبابة النسيان.

2.  **بابة الإدخال:** تقرر هذه البوابة أي معلومات جديدة من الإدخال الحالي يجب إضافتها إلى حالة الخلية. تتضمن هذه العملية خطوتين:
    * **طبقة بوابة الإدخال:** تقرر طبقة السيني أي القيم سنقوم بتحديثها.
        ```
        i_t = σ(W_i * [h_{t-1}, x_t] + b_i)
        ```
        حيث:
        * σ هي دالة السيني.
        * W<sub>i</sub> هي مصفوفة الأوزان لبابة الإدخال.
        * [h<sub>t-1</sub>, x_t] هي عملية ربط للحالة المخفية السابقة والإدخال الحالي.
        * b<sub>i</sub> هي متجه التحيز لبابة الإدخال.
    * **طبقة القيم المرشحة:** تنشئ طبقة tanh متجهًا للقيم المرشحة الجديدة (حالة الخلية المرشحة، يشار إليها بالرمز 'C̃<sub>t</sub>') التي يمكن إضافتها إلى حالة الخلية. تنتج دالة tanh قيمًا بين -1 و 1، مما يساعد في تنظيم الشبكة.
        ```
        C̃_t = tanh(W_C * [h_{t-1}, x_t] + b_C)
        ```
        حيث:
        * tanh هي دالة الظل الزائدية.
        * W<sub>C</sub> هي مصفوفة الأوزان لحالة الخلية المرشحة.
        * [h<sub>t-1</sub>, x_t] هي عملية ربط للحولة المخفية السابقة والإدخال الحالي.
        * b<sub>C</sub> هي متجه التحيز لحالة الخلية المرشحة.

3.  **بابة الإخراج:** تقرر هذه البوابة أي المعلومات من حالة الخلية الحالية يجب إخراجها كحالة مخفية للخطوة الزمنية الحالية.
    * تستقبل الحالة المخفية السابقة (h<sub>t-1</sub>) والإدخال الحالي (x<sub>t</sub>).
    * يتم تمرير هذه المدخلات عبر طبقة شبكة عصبية تليها **دالة التنشيط السيني** لتحديد الأجزاء التي سيتم إخراجها من حالة الخلية.
        ```
        o_t = σ(W_o * [h_{t-1}, x_t] + b_o)
        ```
        حيث:
        * σ هي دالة السيني.
        * W<sub>o</sub> هي مصفوفة الأوزان لبابة الإخراج.
        * [h<sub>t-1</sub>, x_t] هي عملية ربط للحالة المخفية السابقة والإدخال الحالي.
        * b<sub>o</sub> هي متجه التحيز لبابة الإخراج.
    * ثم يتم تمرير حالة الخلية عبر **دالة tanh** لضغط القيم بين -1 و 1.
    * أخيرًا، يتم ضرب ناتج بوابة السيني (عنصرًا بعنصر) مع ناتج دالة tanh المطبقة على حالة الخلية. يصبح هذا الحالة المخفية الجديدة (h<sub>t</sub>) التي يتم تمريرها إلى الخطوة الزمنية التالية ويمكن أيضًا استخدامها لإجراء التنبؤات.
        ```
        h_t = o_t * tanh(C_t)
        ```

**تحديث حالة الخلية**

يتم تحديث حالة الخلية بناءً على القرارات التي تتخذها بوابات النسيان والإدخال:

```
C_t = f_t * C_{t-1} + i_t * C̃_t
```

* تحدد بوابة النسيان (f<sub>t</sub>) مقدار حالة الخلية السابقة (C<sub>t-1</sub>) الذي يجب الاحتفاظ به. إذا كانت f<sub>t</sub> قريبة من 0، يتم نسيان معظم المعلومات. إذا كانت قريبة من 1، يتم الاحتفاظ بمعظم المعلومات.
* تحدد بوابة الإدخال (i<sub>t</sub>) مقدار القيم المرشحة الجديدة (C̃<sub>t</sub>) التي يجب إضافتها إلى حالة الخلية. إذا كانت i<sub>t</sub> قريبة من 0، يتم تجاهل معظم المعلومات الجديدة. إذا كانت قريبة من 1، تتم إضافة معظم المعلومات الجديدة.

**كيف تحل LSTM مشكلة التلاشي في التدرج:**

يكمن سر قدرة LSTM على التعامل مع التبعيات طويلة المدى في حالة الخلية وآليات البوابة. تعمل حالة الخلية كمسار مباشر لتدفق المعلومات عبر العديد من الخطوات الزمنية دون أن يتم ضربها بشكل متكرر في الأوزان، وهو السبب الرئيسي لتلاشي التدرج في الشبكات العصبية المتكررة التقليدية.

تسمح البوابات لـ LSTM بتعلم متى تخزن المعلومات ومتى تصل إليها ومتى تنساها في حالة الخلية. تمكن هذه الآلية الانتقائية للذاكرة الشبكة من الاحتفاظ بالمعلومات ذات الصلة عبر التسلسلات الطويلة واستخدامها عند الحاجة، مما يخفف بشكل فعال من مشكلة التلاشي في التدرج ويسمح بتعلم التبعيات طويلة المدى.

في جوهر الأمر، توفر LSTM طريقة للشبكة للحفاظ على "ذاكرة" على فترات طويلة، مما يجعلها فعالة للغاية في المهام التي تتضمن بيانات متسلسلة ذات تبعيات طويلة المدى.