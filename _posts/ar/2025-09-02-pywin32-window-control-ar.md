---
audio: false
generated: true
image: false
lang: ar
layout: post
title: أساسيات التحكم في نوافذ PyWin32
translated: true
type: note
---

إليك دليل للعمل مع **نوافذ PyWin32**—مركزاً على خصائصها، وتنشيطها، والتعامل مع المنطقة السفلية.

---

## 1. ما هي النافذة في PyWin32؟

في PyWin32، تشير "النافذة" إلى أي عنصر واجهة مستخدم تديره واجهة برمجة تطبيقات Windows ولديها **مُعرِّف (HWND)**. يمكن أن تكون هذه نافذة تطبيق من المستوى الأعلى، أو مربع حوار، أو حتى عنصر تحكم داخل نموذج.

يمكنك عادةً التفاعل مع النوافذ عبر:

* `win32gui` – دوال منخفضة المستوى لمُعرِّفات النوافذ والخصائص والرسائل.
* `win32con` – ثوابت لرسائل وأنماط Windows.
* `win32api` – دوال عامة لواجهة برمجة تطبيقات Windows.

---

## 2. خصائص النافذة الشائعة

تمتلك النافذة العديد من السمات التي يمكنك الاستعلام عنها أو تعديلها:

* **المُعرِّف (HWND)**: المعرف الفريد للنافذة.
* **العنوان (الشرح)**: النص المعروض في شريط العنوان (`win32gui.GetWindowText(hwnd)`).
* **اسم الفئة**: الفئة المسجلة للنافذة (`win32gui.GetClassName(hwnd)`).
* **الأنماط**: تحدد كيفية تصرف النافذة ومظهرها (`GetWindowLong` مع `GWL_STYLE`).
* **الموضع والحجم**: إحداثيات المستطيل عبر `GetWindowRect(hwnd)` أو `MoveWindow`.
* **الرؤية**: ما إذا كانت النافذة معروضة (`IsWindowVisible`).
* **حالة التمكين**: ما إذا كانت تقبل الإدخال (`IsWindowEnabled`).
* **الأصل/المالك**: التسلسل الهرمي للنوافذ (`GetParent(hwnd)`).

---

## 3. تنشيط النافذة

لجلب نافذة إلى المقدمة أو جعلها نشطة:

* **SetForegroundWindow(hwnd)** – يجعل النافذة هي النافذة النشطة.
* **SetActiveWindow(hwnd)** – ينشط النافذة ولكن لا يضمن أن تكون في المقدمة.
* **BringWindowToTop(hwnd)** – يرفعها فوق النوافذ الأخرى.
* **ShowWindow(hwnd, flag)** – يعرض/يخفي/يصغر/يكبر النافذة اعتماداً على `flag` (مثل `SW_SHOW`، `SW_MINIMIZE`، `SW_RESTORE`).

---

## 4. "المنطقة السفلية" (ترتيب Z والموضع)

تتم ترتيب النوافذ في نظام Z-order:

* **في المقدمة دائماً** – تكون دائمًا فوق الآخرين (`SetWindowPos` مع `HWND_TOPMOST`).
* **في الخلف** – يمكن دفع نافذة إلى خلف جميع النوافذ الأخرى باستخدام `SetWindowPos(hwnd, win32con.HWND_BOTTOM, …)`.
* **بدون تنشيط** – يمكنك عرض أو تحديد موضع نافذة دون تنشيطها (باستخدام أعلام مثل `SWP_NOACTIVATE`).

هذا غالبًا ما يكون مفيدًا إذا كنت تريد أن تبقى نافذة أداة في الخلفية مفتوحة ولكن لا تسرق التركيز.

---

## 5. الدوال النموذجية التي ستستخدمها

إليك بعض دوال PyWin32 الرئيسية مع أمثلة:

```python
import win32gui
import win32con

# البحث عن نافذة حسب العنوان
hwnd = win32gui.FindWindow(None, "Untitled - Notepad")

# الحصول على الخصائص
title = win32gui.GetWindowText(hwnd)
rect = win32gui.GetWindowRect(hwnd)  # (left, top, right, bottom)

# تنشيط النافذة
win32gui.SetForegroundWindow(hwnd)

# النقل إلى الخلف (خلف الآخرين)
win32gui.SetWindowPos(hwnd, win32con.HWND_BOTTOM, 0, 0, 0, 0,
                      win32con.SWP_NOMOVE | win32con.SWP_NOSIZE)

# العرض/الاستعادة
win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)
```

---

## 6. التعامل مع الأحداث/الرسائل

يمكنك أيضًا الاشتراك في أحداث النافذة (التنشيط، تغيير الحجم، الإغلاق) باستخدام:

* `SetWindowLong` لإنشاء فئة فرعية.
* `SendMessage` / `PostMessage` لمحاكاة الإجراءات.
* رسائل مثل `WM_ACTIVATE`، `WM_SIZE`، إلخ.

---

✅ باختصار:

* **الخصائص**: العنوان، الفئة، الحجم، النمط، الرؤية، حالة التمكين.
* **التنشيط**: استخدم `SetForegroundWindow`، `BringWindowToTop`.
* **المنطقة السفلية**: إدارة ترتيب Z باستخدام `SetWindowPos` و `HWND_BOTTOM`.

هل تريد مني أيضًا تضمين **برنامج نصي عملي** يسرد جميع نوافذ المستوى الأعلى بخصائصها (العنوان، الموضع، ترتيب Z)، ويسمح لك بتنشيطها أو إرسالها إلى الخلف بشكل تفاعلي؟