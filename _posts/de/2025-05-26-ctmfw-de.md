---
audio: false
generated: true
lang: de
layout: post
title: Der ctmfw-Befehl in Control-M
translated: true
type: note
---

Der Befehl `ctmfw` in Control-M ist Teil des File Watcher-Dienstprogramms, das verwendet wird, um Dateien auf Ereignisse wie Erstellung, Löschung oder Transferabschluss zu überwachen. Der spezifische Befehl `ctmfw %%FILENAME CREATE 0 60 10 3 1410` kann anhand der in der Control-M-Dokumentation definierten Parameter wie folgt aufgeschlüsselt werden. Hier ist die Bedeutung der einzelnen Teile:

- **`ctmfw`**: Das Control-M File Watcher-Dienstprogramm, das dateibezogene Ereignisse erkennt und Aktionen basierend auf Bedingungen auslöst, wie z. B. das Starten eines Jobs oder das Ausführen eines Befehls.

- **`%%FILENAME`**: Eine Variable, die den Namen oder Pfad der zu überwachenden Datei darstellt (z. B. `datafile.txt` oder ein Muster wie `*.csv`). Der tatsächliche Dateiname wird zur Laufzeit aufgelöst, typischerweise definiert im Control-M-Job oder der Umgebung.

- **`CREATE`**: Der Betriebsmodus, der angibt, dass das Dienstprogramm auf die **Erstellung** der angegebenen Datei wartet. Andere mögliche Modi sind `DELETE` zur Überwachung der Dateilöschung.

- **`0`**: Die minimale Dateigröße (in Bytes), die die Datei haben muss, um als gültig betrachtet zu werden. Ein Wert von `0` bedeutet, dass jede Dateigröße akzeptabel ist, sodass das Dienstprogramm die Datei unabhängig von ihrer Größe erkennt.

- **`60`**: Das Intervall (in Sekunden) zwischen aufeinanderfolgenden Versuchen, die Existenz der Datei zu prüfen. Das Dienstprogramm prüft alle 60 Sekunden, ob die Datei erstellt wurde.

- **`10`**: Das Intervall (in Sekunden) zwischen den Versuchen, die Dateigröße zu überwachen, nachdem die Datei erkannt wurde. Dies stellt sicher, dass die Dateigröße stabil ist (nicht mehr geschrieben wird). Das Dienstprogramm prüft die Dateigröße alle 10 Sekunden.

- **`3`**: Die Anzahl der Iterationen, bei denen die Dateigröße statisch (unverändert) bleiben muss, um zu bestätigen, dass die Datei vollständig erstellt ist. Das Dienstprogramm prüft die Dateigröße 3 Mal (in Intervallen von 10 Sekunden, insgesamt 30 Sekunden), um die Stabilität sicherzustellen.

- **`1410`**: Die maximale Zeit (in Minuten), die das Dienstprogramm läuft, während es auf die Erstellung der Datei und das Erfüllen der Größenkriterien wartet. 1410 Minuten entsprechen ungefähr 23,5 Stunden. Wenn die Datei innerhalb dieser Zeit nicht erkannt wird oder sich nicht stabilisiert, wird ein Timeout ausgelöst und möglicherweise eine `DO_NOTOK`-Aktion ausgeführt (z. B. Meldung "FILE WAS NOT CREATED").

### Funktionsweise
Dieser Befehl überwacht die Erstellung einer durch `%%FILENAME` spezifizierten Datei. Er prüft alle 60 Sekunden die Existenz der Datei. Sobald sie erkannt wird, stellt er sicher, dass die Dateigröße für 3 Iterationen von jeweils 10 Sekunden (insgesamt 30 Sekunden) unverändert bleibt. Der Prozess läuft bis zu 1410 Minuten (23,5 Stunden) weiter oder bis die Datei erkannt und stabil ist. Wenn die Datei erstellt wird und die Kriterien erfüllt, wird eine `DO_OK`-Aktion ausgeführt (z. B. das Auslösen eines Jobs oder Befehls). Andernfalls wird eine `DO_NOTOK`-Aktion durchgeführt.

### Beispielszenario
Wenn `%%FILENAME` auf `/home/controlm/datafile.txt` gesetzt ist, führt das Dienstprogramm Folgendes durch:
- Prüft alle 60 Sekunden auf `datafile.txt`.
- Stellt nach dem Auffinden sicher, dass deren Größe für 30 Sekunden stabil ist (3 Prüfungen im 10-Sekunden-Intervall).
- Läuft bis zu 23,5 Stunden oder bis die Datei stabil ist.
- Bei Erfolg könnte es einen Job auslösen (z. B. das Verschieben der Datei in ein anderes Verzeichnis). Bei einem Timeout könnte "FILE WAS NOT CREATED" protokolliert werden.

### Hinweise
- Die Variable `%%FILENAME` muss im Control-M-Job oder der Umgebung definiert sein, sonst schlägt der Befehl fehl.
- Das Dienstprogramm ignoriert Dateien mit einem Änderungszeitpunkt, der älter als 50 Jahre ist.
- Wenn Wildcards in `%%FILENAME` verwendet werden (z. B. `*.csv`), können zusätzliche Parameter wie `MONITOR_FILE_SIZE` erforderlich sein, um mehrere Dateien zu handhaben.
- Für zyklische Überwachung (wiederholte Prüfungen nach der Erkennung) wäre ein `CYCLIC_INTERVAL`-Parameter erforderlich, der hier jedoch nicht angegeben ist.

Diese Erklärung basiert auf der Control-M File Watcher-Dokumentation aus Quellen wie der offiziellen BMC-Dokumentation und Community-Diskussionen.[](https://documents.bmc.com/supportu/controlm-saas/en-US/Documentation/ctmfw.htm)[](https://documents.bmc.com/supportu/9.0.21/en-US/Documentation/ctmfw.htm)[](https://pdfslide.net/documents/file-watcher-for-control-m.html)