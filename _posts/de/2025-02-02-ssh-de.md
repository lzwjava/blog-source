---
audio: false
lang: de
layout: post
title: SSH-Tunneling mit Proxy
translated: true
---

```bash
% GIT_TRACE=1 GIT_CURL_VERBOSE=1 git push
21:32:14.216308 exec-cmd.c:139          trace: resolved executable path from Darwin stack: /Applications/Xcode.app/Contents/Developer/usr/bin/git
21:32:14.216594 exec-cmd.c:238          trace: resolved executable dir: /Applications/Xcode.app/Contents/Developer/usr/bin
21:32:14.216949 git.c:460               trace: built-in: git push
21:32:14.218655 run-command.c:655       trace: run_command: unset GIT_PREFIX; ssh git@github.com 'git-receive-pack '\''lzwjava/lzwjava.github.io.git'\'''
Alles auf dem neuesten Stand

Ich habe langsame `git push` Vorg√§nge erlebt, mit Verz√∂gerungen, die w√§hrend der `ssh git@github.com` Phase auftraten. Um dies zu beheben, habe ich SSH so konfiguriert, dass ein Proxy verwendet wird.

Um `corkscrew` f√ºr SSH-Tunneling zu verwenden, m√ºssen Sie es zuerst installieren. Auf macOS k√∂nnen Sie Homebrew mit dem Befehl `brew install corkscrew` verwenden.

`~/.ssh/config`:

```bash
Host *
    UseKeychain yes
    AddKeysToAgent yes
    IdentityFile ~/.ssh/id_rsa
    ProxyCommand corkscrew localhost 7890 %h %p
```

Protokoll:

```bash
% ssh root@138.201.174.0 -vvv
üöÄ **Proxy-Einstellungen erkannt:**
   - HTTP_PROXY: http://127.0.0.1:7890
   - HTTPS_PROXY: http://127.0.0.1:7890

OpenSSH_9.8p1, LibreSSL 3.3.6
debug1: Lese Konfigurationsdaten /Users/lzwjava/.ssh/config
debug1: /Users/lzwjava/.ssh/config Zeile 1: Anwenden der Optionen f√ºr *
debug1: Lese Konfigurationsdaten /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config Zeile 21: include /etc/ssh/ssh_config.d/* passend keine Dateien
debug1: /etc/ssh/ssh_config Zeile 54: Anwenden der Optionen f√ºr *
debug2: resolve_canonicalize: hostname 138.201.174.0 ist Adresse
debug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/lzwjava/.ssh/known_hosts'
debug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/lzwjava/.ssh/known_hosts2'
debug1: Authenticator provider $SSH_SK_PROVIDER konnte nicht aufgel√∂st werden; deaktiviert
debug3: channel_clear_timeouts: clearing
debug1: Ausf√ºhren des Proxy-Befehls: exec corkscrew localhost 7890 138.201.174.0 22
debug1: Identit√§tsdatei /Users/lzwjava/.ssh/id_rsa Typ 0
debug1: Identit√§tsdatei /Users/lzwjava/.ssh/id_rsa-cert Typ -1
debug1: Lokale Versionszeichenfolge SSH-2.0-OpenSSH_9.8
debug1: Fernprotokollversion 2.0, Fernsoftwareversion OpenSSH_9.6p1 Ubuntu-3ubuntu13.5
debug1: compat_banner: match: OpenSSH_9.6p1 Ubuntu-3ubuntu13.5 pat OpenSSH* compat 0x04000000
debug2: fd 5 setzen O_NONBLOCK
debug2: fd 4 setzen O_NONBLOCK
debug1: Authentifizieren bei 138.201.174.0:22 als 'root'
debug3: record_hostkey: gefunden Schl√ºsseltyp ED25519 in Datei /Users/lzwjava/.ssh/known_hosts:164
debug3: record_hostkey: gefunden Schl√ºsseltyp RSA in Datei /Users/lzwjava/.ssh/known_hosts:165
debug3: record_hostkey: gefunden Schl√ºsseltyp ECDSA in Datei /Users/lzwjava/.ssh/known_hosts:166
debug3: load_hostkeys_file: geladen 3 Schl√ºssel von 138.201.174.0
debug1: load_hostkeys: fopen /Users/lzwjava/.ssh/known_hosts2: Datei oder Verzeichnis nicht gefunden
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: Datei oder Verzeichnis nicht gefunden
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: Datei oder Verzeichnis nicht gefunden
debug3: order_hostkeyalgs: haben passenden besten Pr√§ferenz-Schl√ºsseltyp ssh-ed25519-cert-v01@openssh.com, verwenden HostkeyAlgorithms w√∂rtlich
debug3: send packet: type 20
debug1: SSH2_MSG_KEXINIT gesendet
debug3: receive packet: type 20
debug1: SSH2_MSG_KEXINIT empfangen
debug2: local client KEXINIT proposal
debug2: KEX-Algorithmen: sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,ext-info-c,kex-strict-c-v00@openssh.com
debug2: host key algorithms: ssh-ed25519-cert-v01@openssh.com,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-ed25519,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ssh-ed25519@openssh.com,sk-ecdsa-sha2-nistp256@openssh.com,rsa-sha2-512,rsa-sha2-256
debug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
debug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
debug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1
debug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1
debug2: compression ctos: none,zlib@openssh.com,zlib
debug2: compression stoc: none,zlib@openssh.com,zlib
debug2: languages ctos:
debug2: languages stoc:
debug2: first_kex_follows 0
debug2: reserved 0
debug2: peer server KEXINIT proposal
debug2: KEX-Algorithmen: sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,ext-info-s,kex-strict-s-v00@openssh.com
debug2: host key algorithms: rsa-sha2-512,rsa-sha2-256,ecdsa-sha2-nistp256,ssh-ed25519
debug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
debug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
debug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1
debug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1
debug2: compression ctos: none,zlib@openssh.com
debug2: compression stoc: none,zlib@openssh.com
debug2: languages ctos:
debug2: languages stoc:
debug2: first_kex_follows 0
debug2: reserved 0
debug3: kex_choose_conf: wird strengen KEX-Ordnung verwenden
debug1: kex: algorithm: sntrup761x25519-sha512@openssh.com
debug1: kex: host key algorithm: ssh-ed25519
debug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none
debug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none
debug3: send packet: type 30
debug1: erwartet SSH2_MSG_KEX_ECDH_REPLY
debug3: receive packet: type 31
debug1: SSH2_MSG_KEX_ECDH_REPLY empfangen
debug1: Server host key: ssh-ed25519 SHA256:+5SaMkJXG9yZrsYjXgxFfRZpvb6qjc/arFG2Nk4Vv48
debug3: record_hostkey: gefunden Schl√ºsseltyp ED25519 in Datei /Users/lzwjava/.ssh/known_hosts:164
debug3: record_hostkey: gefunden Schl√ºsseltyp RSA in Datei /Users/lzwjava/.ssh/known_hosts:165
debug3: record_hostkey: gefunden Schl√ºsseltyp ECDSA in Datei /Users/lzwjava/.ssh/known_hosts:166
debug3: load_hostkeys_file: geladen 3 Schl√ºssel von 138.201.174.0
debug1: load_hostkeys: fopen /Users/lzwjava/.ssh/known_hosts2: Datei oder Verzeichnis nicht gefunden
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: Datei oder Verzeichnis nicht gefunden
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: Datei oder Verzeichnis nicht gefunden
debug1: Host '138.201.174.0' ist bekannt und stimmt mit dem ED25519-Host-Schl√ºssel √ºberein.
debug1: Schl√ºssel in /Users/lzwjava/.ssh/known_hosts:164 gefunden
debug3: send packet: type 21
debug1: ssh_packet_send2_wrapped: resetting send seqnr 3
debug2: ssh_set_newkeys: mode 1
debug1: rekey out after 134217728 blocks
debug1: SSH2_MSG_NEWKEYS gesendet
debug1: Senden SSH2_MSG_EXT_INFO
debug3: send packet: type 7
debug1: erwartet SSH2_MSG_NEWKEYS
debug3: receive packet: type 21
debug1: ssh_packet_read_poll2: resetting read seqnr 3
debug1: SSH2_MSG_NEWKEYS empfangen
debug2: ssh_set_newkeys: mode 0
debug1: rekey in after 134217728 blocks
debug2: KEX-Algorithmen: sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,ext-info-c,kex-strict-c-v00@openssh.com
debug2: host key algorithms: ssh-ed25519-cert-v01@openssh.com,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-ed25519,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ssh-ed25519@openssh.com,sk-ecdsa-sha2-nistp256@openssh.com,rsa-sha2-512,rsa-sha2-256
debug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
debug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
debug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1
debug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1
debug2: compression ctos: none,zlib@openssh.com,zlib
debug2: compression stoc: none,zlib@openssh.com,zlib
debug2: languages ctos:
debug2: languages stoc:
debug2: first_kex_follows 0
debug2: reserved 0
debug3: send packet: type 5
debug3: receive packet: type 7
debug1: SSH2_MSG_EXT_INFO empfangen
debug3: kex_input_ext_info: extension server-sig-algs
debug1: kex_ext_info_client_parse: server-sig-algs=<ssh-ed25519,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ssh-ed25519@openssh.com,sk-ecdsa-sha2-nistp256@openssh.com,rsa-sha2-512,rsa-sha2-256>