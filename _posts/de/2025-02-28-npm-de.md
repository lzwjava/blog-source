---
audio: false
generated: true
lang: de
layout: post
title: Konfiguration von NPM
translated: true
type: note
---

### Wichtige Punkte
- Es scheint wahrscheinlich, dass die Konfiguration von NPM das Bearbeiten der `.npmrc`-Datei beinhaltet, um Proxy- und Registry-Einstellungen festzulegen, was manuell oder über Befehle erfolgen kann.
- Recherchen deuten darauf hin, dass Proxy-Einstellungen das Format `proxy = http://user:password@proxy_server:port` erfordern, wobei Sonderzeichen URL-kodiert sein müssen.
- Die Hinweise deuten darauf hin, dass die Registry standardmäßig als `registry = https://registry.npmjs.org/` gesetzt wird, mit der Option, bei Bedarf die SSL-Überprüfung zu deaktivieren.

### Konfiguration von NPM und Arbeiten mit `.npmrc`
NPM, oder Node Package Manager, ist ein Tool zur Verwaltung von JavaScript-Abhängigkeiten, und die Konfiguration erfolgt oft über die `.npmrc`-Datei für Einstellungen wie Registry und Proxy.

#### Was ist `.npmrc` und wo befindet sie sich?
Die `.npmrc`-Datei ist eine Konfigurationsdatei für NPM, die die Anpassung des Verhaltens ermöglicht. Sie kann sich befinden:
- **Global**: Unter `~./.npmrc` auf Unix-ähnlichen Systemen oder `%APPDATA%\npm\npmrc` auf Windows (normalerweise `C:\Users\<username>\AppData\Roaming\npm\npmrc`).
- **Lokal für ein Projekt**: Im Stammverzeichnis des Projekts unter `./package/.npmrc`. Lokale Einstellungen überschreiben globale.

#### Proxy und HTTPS-Proxy einstellen
Um hinter einem Proxy zu arbeiten, fügen Sie diese Zeilen zur `.npmrc`-Datei hinzu:
- `proxy = http://user:password@proxy_server:port`
- `https_proxy = http://user:password@proxy_server:port`

Beachten Sie, dass auch für `https_proxy` das Protokoll `http://` verwendet wird. Wenn Ihr Benutzername oder Passwort Sonderzeichen enthält (z.B. `\`, `@`), müssen diese URL-kodiert werden (z.B. wird `domain\user` zu `domain%5Cuser`). Sie können diese auch über Befehle setzen:
- `npm config set proxy http://user:password@proxy_server:port`
- `npm config set https_proxy http://user:password@proxy_server:port`

#### Die Registry einstellen
Die Registry ist die URL, die NPM zum Abrufen von Paketen verwendet, typischerweise gesetzt als:
- `registry = https://registry.npmjs.org/`

Für benutzerdefinierte Registries, ersetzen Sie sie mit Ihrer URL (z.B. die private Registry eines Unternehmens). Setzen Sie sie über:
- `npm config set registry https://your_custom_registry.com/`

#### Umgang mit SSL und Verifizierung
Wenn Sie auf SSL-Probleme stoßen, ziehen Sie in Betracht:
- `strict-ssl = false` in `.npmrc`, um SSL-Fehler zu ignorieren, was jedoch weniger sicher ist. Setzen Sie es über:
- `npm config set strict-ssl false`

#### Verwenden und Überprüfen von Konfigurationen
Bearbeiten Sie `.npmrc` direkt mit einem Texteditor oder verwenden Sie `npm config set`-Befehle. Zur Überprüfung:
- Listen Sie alle Einstellungen mit `npm config list` auf.
- Überprüfen Sie eine bestimmte Einstellung mit `npm config get proxy`.
- Debuggen Sie Probleme mit `npm install --verbose` für eine detaillierte Ausgabe.

Eine Beispiel-`.npmrc`-Datei könnte so aussehen:
```
proxy = http://user:password@proxy_server:8080
https_proxy = http://user:password@proxy_server:8080
registry = https://registry.npmjs.org/
strict-ssl = false
```

### Umfrage-Hinweis: Umfassende Anleitung zur Konfiguration von NPM mit `.npmrc`
Dieser Abschnitt bietet eine detaillierte Betrachtung der Konfiguration von NPM, mit Fokus auf die `.npmrc`-Datei für Registry- und Proxy-Einstellungen, und erweitert die direkte Antwort mit zusätzlichem Kontext und technischen Details.

#### Einführung in `.npmrc` und ihre Rolle
Die `.npmrc`-Datei ist eine kritische Konfigurationsdatei für NPM, die die Anpassung des Paketverwaltungsverhaltens ermöglicht. Sie unterstützt ein INI-Format mit Schlüssel-Wert-Paaren, wobei Kommentare mit einem Semikolon (`;`) beginnen. Sie kann sich global oder lokal befinden:
- **Globaler Ort**: Auf Unix-ähnlichen Systemen unter `~./.npmrc`; auf Windows unter `%APPDATA%\npm\npmrc`, typischerweise `C:\Users\<username>\AppData\Roaming\npm\npmrc`.
- **Lokaler Ort**: Im Stammverzeichnis eines Projekts als `./package/.npmrc`. Lokale Einstellungen überschreiben globale.

Diese Hierarchie gewährleistet Flexibilität, da Entwickler Einstellungen sowohl auf Benutzer- als auch auf Projektebene verwalten können, was besonders in Umgebungen mit mehreren Projekten oder gemeinsam genutzten Systemen nützlich ist.

#### Detaillierte Proxy-Konfiguration
Die Arbeit hinter einem Proxy erfordert das Setzen von sowohl `proxy` als auch `https_proxy` in `.npmrc`. Das Format ist:
- `proxy = http://user:password@proxy_server:port`
- `https_proxy = http://user:password@proxy_server:port`

Bemerkenswerterweise verwendet `https_proxy` `http://` als Protokoll, nicht `https://`, da der Proxy-Server die Verbindung handhabt, nicht sie zum Proxy selbst verschlüsselt. Dies ist ein häufiger Verwirrungspunkt, da die Nutzdaten zum Ziel SSL-verschlüsselt bleiben.

Für die Authentifizierung schließen Sie den Benutzernamen und das Passwort ein, aber wenn sie Sonderzeichen enthalten, ist eine URL-Kodierung unerlässlich:
- Backslash (`\`) wird zu `%5C`.
- At-Symbol (`@`) wird zu `%40`.
- Doppelpunkt (`:`) wird zu `%3A`.

Zum Beispiel, wenn der Benutzername `domain\user` und das Passwort `pass@word` ist, wäre es `proxy = http://domain%5Cuser:pass%40word@proxy_server:8080`. Diese Kodierung stellt sicher, dass NPM sie korrekt parst.

Windows-Benutzer, insbesondere in Unternehmensumgebungen mit Active Directory, können Probleme mit Backslashes haben. Einige Berichte deuten darauf hin, dass `domain\username` in `.npmrc` beim Lesen möglicherweise in `domain/username` umgewandelt wird, was zu Authentifizierungsfehlern führen kann. In solchen Fällen können Tools wie NTLM Authorization Proxy Server oder Cntlm helfen, obwohl sie außerhalb der direkten `.npmrc`-Konfiguration liegen.

#### Registry-Konfiguration und SSL-Überlegungen
Die Registry-Einstellung definiert, wo NPM Pakete abruft, standardmäßig `https://registry.npmjs.org/`. Für benutzerdefinierte oder private Registries, setzen Sie:
- `registry = https://your_custom_registry.com/`

Wenn die SSL-Verifizierung fehlschlägt, oft aufgrund von Corporate Proxys mit selbstsignierten Zertifikaten, können Sie striktes SSL deaktivieren:
- `strict-ssl = false`

Dies verringert jedoch die Sicherheit, da die Zertifikatsvalidierung umgangen wird. Alternativ konfigurieren Sie die Zertifizierungsstelle:
- Verwenden Sie `npm config -g set cafile [YOUR_CERTIFICATE_DIR]/[CERTIFICATE_NAME].crt`, um eine vertrauenswürdige CA-Datei anzugeben.

Einige Entwickler entscheiden sich für `registry = http://registry.npmjs.org/`, um SSL ganz zu vermeiden, aber dies ist aus Sicherheitsgründen, besonders in der Produktion, nicht zu empfehlen.

#### Verwenden von `.npmrc`: Manuelle Bearbeitung vs. Befehlszeile
Sie können `.npmrc` direkt mit einem Texteditor bearbeiten, wobei Sie sicherstellen, dass jede Einstellung in einer neuen Zeile mit dem Format `key = value` steht. Kommentare beginnen mit `;`, z.B.:
```
; Proxy-Einstellungen für das Unternehmensnetzwerk
proxy = http://user:password@proxy_server:8080
https_proxy = http://user:password@proxy_server:8080
registry = https://registry.npmjs.org/
strict-ssl = false
```

Alternativ verwenden Sie NPM-Befehle für Bequemlichkeit:
- Proxy setzen: `npm config set proxy http://user:password@proxy_server:port`
- Registry setzen: `npm config set registry https://registry.npmjs.org/`
- Strict-SSL setzen: `npm config set strict-ssl false`

Diese Befehle aktualisieren die entsprechende `.npmrc`-Datei basierend auf dem Kontext (global oder lokal). Um zwischen global und lokal zu wechseln, verwenden Sie `-g` für global, z.B. `npm config set -g proxy ...`.

#### Verifizierung und Fehlerbehebung
Um Konfigurationen zu verifizieren, verwenden Sie:
- `npm config list`, um alle Einstellungen aufzulisten, die sowohl effektive als auch Standardwerte anzeigt.
- `npm config get proxy`, um eine bestimmte Einstellung abzurufen.

Für die Fehlerbehebung, besonders hinter Proxys, führen Sie aus:
- `npm install --verbose`, um detaillierte Protokolle zu sehen, die bei der Identifizierung von Verbindungsproblemen helfen können, wie z.B. `ECONNREFUSED` oder `socket hang up`.

Wenn Einstellungen keine Wirkung zeigen, prüfen Sie auf Umgebungsvariablen (`HTTP_PROXY`, `HTTPS_PROXY`), die `.npmrc` überschreiben könnten. Diese können systemweit gesetzt sein und Vorrang haben, also sorgen Sie für Konsistenz.

#### Best Practices und zusätzliche Überlegungen
- **Sicherheit**: Vermeiden Sie `strict-ssl = false` in der Produktion; konfigurieren Sie stattdessen vertrauenswürdige Zertifikate.
- **Umgebungsvariablen**: Seien Sie sich bewusst, dass `NODE_ENV` und `HTTPS_PROXY` `.npmrc`-Einstellungen überschreiben können, was für CI/CD-Pipelines nützlich, aber lokal potenziell verwirrend ist.
- **Log-Level**: Passen Sie `loglevel` in `.npmrc` an (z.B. `loglevel = http`) für eine detailliertere Ausgabe während des Debuggens, mit Optionen von `silent` bis `silly` (insgesamt 7 Stufen).
- **Corporate Proxys**: Für NTLM-Proxys ziehen Sie Tools wie Cntlm in Betracht, richten einen lokalen Proxy-Server ein und konfigurieren `.npmrc` so, dass sie auf `localhost:3128` zeigt, was die Authentifizierung vereinfacht.

#### Beispielkonfigurationen
Hier ist eine Tabelle, die häufige `.npmrc`-Einstellungen für Proxy und Registry mit Beispielen zusammenfasst:

| **Einstellung** | **Beschreibung**                               | **Beispiel**                                      |
|-----------------|-----------------------------------------------|---------------------------------------------------|
| proxy           | HTTP-Proxy-Server-URL                         | `proxy = http://user:password@proxy:8080`         |
| https_proxy     | HTTPS-Proxy-Server-URL                        | `https_proxy = http://user:password@proxy:8080`   |
| registry        | Paket-Registry-URL                            | `registry = https://registry.npmjs.org/`          |
| strict-ssl      | SSL-Verifizierung aktivieren/deaktivieren     | `strict-ssl = false`                              |
| loglevel        | Konsolenausgabestufe (silent bis silly, 7 Stufen) | `loglevel = http`                                 |

Diese Tabelle hilft als schnelle Referenz, besonders für Entwickler, die neu bei `.npmrc` sind.

#### Unerwartetes Detail: Auswirkungen auf globale vs. lokale Einstellungen
Ein unerwarteter Aspekt ist, wie globale `.npmrc`-Einstellungen alle Projekte beeinflussen, während lokale Einstellungen für bestimmte Projekte überschreiben können. Diese Schichtung kann zu Verwirrung führen, wenn z.B. ein globaler Proxy gesetzt ist, aber ein lokales Projekt eine andere Registry verwendet, was potenziell zu Authentifizierungsproblemen führt. Das Verstehen dieser Hierarchie ist entscheidend für Umgebungen mit mehreren Projekten.

#### Fazit
Die Konfiguration von NPM über `.npmrc` für Proxy- und Registry-Einstellungen ist mit dem richtigen Format und Überlegungen zu Kodierung und SSL unkompliziert. Durch direkte Bearbeitung oder die Verwendung von Befehlen und Verifizierung mit `npm config list` stellen Sie eine reibungslose Paketverwaltung sicher, besonders in Unternehmensnetzwerken mit Proxys. Für weitere Lektüre konsultieren Sie die offizielle Dokumentation unter [NPM CLI Config](https://docs.npmjs.com/cli-config) oder erkunden Sie Best Practices unter [Configuring Your .nmprc](https://nodesource.com/blog/configuring-your-nmprc-for-an-optimal-node-js-environment).

### Wichtige Zitate
- [NPM CLI Config Documentation](https://docs.npmjs.com/cli-config)
- [Configuring Your .nmprc for an Optimal Node.js Environment](https://nodesource.com/blog/configuring-your-nmprc-for-an-optimal-node-js-environment)
- [How to setup npm proxy settings behind proxy on Windows](https://gist.github.com/zillingen/5c4b8da657025c83ead59e1e547c7436)