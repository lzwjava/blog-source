---
audio: false
generated: true
lang: de
layout: post
title: Konfigurieren von NPM
translated: true
---

### Wichtige Punkte
- Es scheint wahrscheinlich, dass die Konfiguration von NPM das Bearbeiten der `.npmrc`-Datei zur Einstellung von Proxy- und Registry-Einstellungen umfasst, was manuell oder über Befehle erfolgen kann.
- Die Forschung deutet darauf hin, dass Proxy-Einstellungen das Format `proxy = http://user:password@proxy_server:port` erfordern, wobei besondere Zeichen URL-kodiert werden müssen.
- Die Beweise sprechen dafür, die Registry standardmäßig auf `registry = https://registry.npmjs.org/` einzustellen, mit der Option, die SSL-Überprüfung bei Bedarf zu deaktivieren.

### Konfiguration von NPM und Arbeit mit `.npmrc`
NPM, oder Node Package Manager, ist ein Werkzeug zur Verwaltung von JavaScript-Abhängigkeiten, und seine Konfiguration umfasst oft die `.npmrc`-Datei für Einstellungen wie Registry und Proxy.

#### Was ist `.npmrc` und wo befindet es sich?
Die `.npmrc`-Datei ist eine Konfigurationsdatei für NPM, die die Anpassung seines Verhaltens ermöglicht. Sie kann sein:
- **Global**: Auf Unix-ähnlichen Systemen unter `~./.npmrc` oder auf Windows unter `%APPDATA%\npm\npmrc` (normalerweise `C:\Users\<username>\AppData\Roaming\npm\npmrc`).
- **Lokal für ein Projekt**: Im Stammverzeichnis des Projekts unter `./package/.npmrc`. Lokale Einstellungen überschreiben globale.

#### Einstellen von Proxy und HTTPS Proxy
Um hinter einem Proxy zu arbeiten, fügen Sie diese Zeilen zur `.npmrc` hinzu:
- `proxy = http://user:password@proxy_server:port`
- `https_proxy = http://user:password@proxy_server:port`

Beachten Sie, dass auch für `https_proxy` das Protokoll `http://` verwendet wird. Wenn Ihr Benutzername oder Passwort besondere Zeichen enthält (z.B. `\`, `@`), müssen diese URL-kodiert werden (z.B. `domain\user` wird zu `domain%5Cuser`). Sie können diese auch über Befehle einstellen:
- `npm config set proxy http://user:password@proxy_server:port`
- `npm config set https_proxy http://user:password@proxy_server:port`

#### Einstellen der Registry
Die Registry ist die URL, die NPM verwendet, um Pakete abzurufen, normalerweise eingestellt auf:
- `registry = https://registry.npmjs.org/`

Für benutzerdefinierte Registries ersetzen Sie diese durch Ihre URL (z.B. eine private Registry eines Unternehmens). Setzen Sie diese über:
- `npm config set registry https://your_custom_registry.com/`

#### SSL und Überprüfung
Wenn Sie SSL-Probleme haben, überlegen Sie:
- `strict-ssl = false` in `.npmrc`, um SSL-Fehler zu ignorieren, obwohl dies weniger sicher ist. Setzen Sie dies über:
- `npm config set strict-ssl false`

#### Verwendung und Überprüfung von Konfigurationen
Bearbeiten Sie `.npmrc` direkt mit einem Texteditor oder verwenden Sie `npm config set`-Befehle. Um zu überprüfen:
- Listen Sie alle Einstellungen mit `npm config list` auf.
- Überprüfen Sie eine bestimmte Einstellung mit `npm config get proxy`.
- Debuggen Sie Probleme mit `npm install --verbose` für detaillierte Ausgabe.

Eine Beispiel-`.npmrc`-Datei könnte so aussehen:
```
proxy = http://user:password@proxy_server:8080
https_proxy = http://user:password@proxy_server:8080
registry = https://registry.npmjs.org/
strict-ssl = false
```

### Umfragehinweis: Umfassender Leitfaden zur Konfiguration von NPM mit `.npmrc`
Dieser Abschnitt bietet eine detaillierte Untersuchung der Konfiguration von NPM, mit Schwerpunkt auf der `.npmrc`-Datei für Registry- und Proxy-Einstellungen, und erweitert die direkte Antwort mit zusätzlichem Kontext und technischen Details.

#### Einführung in `.npmrc` und seine Rolle
Die `.npmrc`-Datei ist eine kritische Konfigurationsdatei für NPM, die die Anpassung des Verhaltens der Paketverwaltung ermöglicht. Sie unterstützt ein INI-Format mit Schlüssel-Wert-Paaren, wobei Kommentare mit einem Semikolon (`;`) beginnen. Sie kann global oder lokal sein:
- **Globale Position**: Auf Unix-ähnlichen Systemen unter `~./.npmrc`; auf Windows unter `%APPDATA%\npm\npmrc`, normalerweise `C:\Users\<username>\AppData\Roaming\npm\npmrc`.
- **Lokale Position**: Im Stammverzeichnis eines Projekts als `./package/.npmrc`. Lokale Einstellungen überschreiben globale, was projektbezogene Konfigurationen ermöglicht.

Diese Hierarchie bietet Flexibilität, sodass Entwickler Einstellungen auf Benutzer- und Projektebene verwalten können, was besonders in Umgebungen mit mehreren Projekten oder gemeinsam genutzten Systemen nützlich ist.

#### Detaillierte Proxy-Konfiguration
Das Arbeiten hinter einem Proxy erfordert das Einstellen von `proxy` und `https_proxy` in `.npmrc`. Das Format lautet:
- `proxy = http://user:password@proxy_server:port`
- `https_proxy = http://user:password@proxy_server:port`

Beachten Sie, dass `https_proxy` das Protokoll `http://` verwendet, nicht `https://`, da der Proxy-Server die Verbindung handelt, nicht die Verschlüsselung zur Proxy selbst. Dies ist ein häufiger Punkt der Verwirrung, da die Nutzlast zur Zieladresse weiterhin SSL-verschlüsselt bleibt.

Für die Authentifizierung fügen Sie den Benutzernamen und das Passwort hinzu, aber wenn diese besondere Zeichen enthalten, ist eine URL-Kodierung notwendig:
- Backslash (`\`) wird zu `%5C`.
- At-Zeichen (`@`) wird zu `%40`.
- Doppelpunkt (`:`) wird zu `%3A`.

Zum Beispiel, wenn der Benutzername `domain\user` und das Passwort `pass@word` ist, würde es `proxy = http://domain%5Cuser:pass%40word@proxy_server:8080` lauten. Diese Kodierung stellt sicher, dass NPM es korrekt parsen kann.

Windows-Benutzer, insbesondere in Unternehmensumgebungen mit Active Directory, könnten Probleme mit Backslashes haben. Einige Berichte deuten darauf hin, dass `domain\username` in `.npmrc` möglicherweise zu `domain/username` konvertiert wird, wenn es gelesen wird, was zu Authentifizierungsfehlern führen kann. In solchen Fällen können Tools wie NTLM Authorization Proxy Server oder Cntlm helfen, obwohl sie außerhalb der direkten `.npmrc`-Konfiguration liegen.

#### Registry-Konfiguration und SSL-Betrachtungen
Die Registry-Einstellung definiert, wo NPM Pakete abruft, standardmäßig auf `https://registry.npmjs.org/`. Für benutzerdefinierte oder private Registries setzen Sie:
- `registry = https://your_custom_registry.com/`

Wenn die SSL-Überprüfung fehlschlägt, oft aufgrund von Unternehmensproxys mit selbstsignierten Zertifikaten, können Sie die strenge SSL deaktivieren:
- `strict-ssl = false`

Allerdings verringert dies die Sicherheit, da es die Zertifikatvalidierung umgeht. Alternativ konfigurieren Sie die Zertifizierungsstelle:
- Verwenden Sie `npm config -g set cafile [YOUR_CERTIFICATE_DIR]/[CERTIFICATE_NAME].crt`, um eine vertrauenswürdige CA-Datei anzugeben.

Einige Entwickler wählen `registry = http://registry.npmjs.org/`, um SSL vollständig zu vermeiden, aber dies wird aus Sicherheitsgründen, insbesondere in der Produktion, nicht empfohlen.

#### Verwendung von `.npmrc`: Manuelle Bearbeitung vs. Befehlszeile
Sie können `.npmrc` direkt mit jedem Texteditor bearbeiten, wobei jede Einstellung auf einer neuen Zeile im Format `key = value` steht. Kommentare beginnen mit `;`, z.B.:
```
; Proxy-Einstellungen für das Unternehmensnetzwerk
proxy = http://user:password@proxy_server:8080
https_proxy = http://user:password@proxy_server:8080
registry = https://registry.npmjs.org/
strict-ssl = false
```

Alternativ verwenden Sie NPM-Befehle für Bequemlichkeit:
- Proxy setzen: `npm config set proxy http://user:password@proxy_server:port`
- Registry setzen: `npm config set registry https://registry.npmjs.org/`
- Strict-ssl setzen: `npm config set strict-ssl false`

Diese Befehle aktualisieren die entsprechende `.npmrc`-Datei basierend auf dem Kontext (global oder lokal). Um zwischen global und lokal zu wechseln, verwenden Sie `-g` für global, z.B. `npm config set -g proxy ...`.

#### Überprüfung und Fehlerbehebung
Um Konfigurationen zu überprüfen, verwenden Sie:
- `npm config list`, um alle Einstellungen aufzulisten, einschließlich effektiver und Standardwerte.
- `npm config get proxy`, um eine bestimmte Einstellung abzurufen.

Für die Fehlerbehebung, insbesondere hinter Proxys, führen Sie:
- `npm install --verbose` aus, um detaillierte Protokolle zu sehen, die helfen können, Verbindungsprobleme wie `ECONNREFUSED` oder `socket hang up` zu identifizieren.

Wenn die Einstellungen nicht wirksam werden, überprüfen Sie Umgebungsvariablen (`HTTP_PROXY`, `HTTPS_PROXY`), die `.npmrc` möglicherweise überschreiben. Diese können systemweit gesetzt werden und haben Vorrang, daher stellen Sie Konsistenz sicher.

#### Best Practices und zusätzliche Überlegungen
- **Sicherheit**: Vermeiden Sie `strict-ssl = false` in der Produktion; konfigurieren Sie stattdessen vertrauenswürdige Zertifikate.
- **Umgebungsvariablen**: Beachten Sie, dass `NODE_ENV` und `HTTPS_PROXY` `.npmrc`-Einstellungen überschreiben können, was für CI/CD-Pipelines nützlich, aber lokal möglicherweise verwirrend ist.
- **Protokollierungsstufen**: Passen Sie `loglevel` in `.npmrc` an (z.B. `loglevel = http`) für detailliertere Ausgabe während der Fehlerbehebung, mit Optionen von `silent` bis `silly` (7 Stufen insgesamt).
- **Unternehmensproxys**: Für NTLM-Proxys überlegen Sie Tools wie Cntlm, richten Sie einen lokalen Proxy-Server ein und konfigurieren Sie `.npmrc`, um auf `localhost:3128` zu verweisen, was die Authentifizierung vereinfacht.

#### Beispielkonfigurationen
Hier ist eine Tabelle, die häufige `.npmrc`-Einstellungen für Proxy und Registry zusammenfasst, mit Beispielen:

| **Einstellung**    | **Beschreibung**                              | **Beispiel**                                      |
|----------------|----------------------------------------------|--------------------------------------------------|
| proxy          | HTTP-Proxy-Server-URL                        | `proxy = http://user:password@proxy:8080`        |
| https_proxy    | HTTPS-Proxy-Server-URL                       | `https_proxy = http://user:password@proxy:8080`  |
| registry       | Paket-Registry-URL                         | `registry = https://registry.npmjs.org/`         |
| strict-ssl     | SSL-Überprüfung aktivieren/deaktivieren              | `strict-ssl = false`                             |
| loglevel       | Konsolenausgabeebene (stumm bis albern, 7 Ebenen) | `loglevel = http`                                |

Diese Tabelle hilft bei der schnellen Referenz, insbesondere für Entwickler, die neu bei `.npmrc` sind.

#### Unerwartetes Detail: Auswirkungen auf globale vs. lokale Einstellungen
Ein unerwarteter Aspekt ist, wie globale `.npmrc`-Einstellungen alle Projekte betreffen, während lokale Einstellungen für bestimmte Projekte überschreiben können. Diese Schichtung kann zu Verwirrung führen, wenn beispielsweise ein globaler Proxy gesetzt ist, aber ein lokales Projekt eine andere Registry verwendet, was möglicherweise zu Authentifizierungsproblemen führt. Das Verständnis dieser Hierarchie ist für Multi-Projekt-Umgebungen entscheidend.

#### Schlussfolgerung
Die Konfiguration von NPM über `.npmrc` für Proxy- und Registry-Einstellungen ist mit dem richtigen Format und Berücksichtigung der Kodierung und SSL einfach. Durch direktes Bearbeiten oder Verwenden von Befehlen und Überprüfen mit `npm config list` stellen Sie eine reibungslose Paketverwaltung sicher, insbesondere in Unternehmensnetzwerken mit Proxys. Für weiterführende Lektüre konsultieren Sie die offizielle Dokumentation unter [NPM CLI Config](https://docs.npmjs.com/cli-config) oder erkunden Sie Best Practices unter [Configuring Your .nmprc](https://nodesource.com/blog/configuring-your-nmprc-for-an-optimal-node-js-environment).

### Wichtige Zitate
- [NPM CLI Config Dokumentation](https://docs.npmjs.com/cli-config)
- [Configuring Your .nmprc for an Optimal Node.js Environment](https://nodesource.com/blog/configuring-your-nmprc-for-an-optimal-node-js-environment)
- [How to setup npm proxy settings behind proxy on Windows](https://gist.github.com/zillingen/5c4b8da657025c83ead59e1e547c7436)