---
audio: true
generated: true
lang: de
layout: post
title: Verwendung von SAX (Simple API for XML)
translated: true
---

Um das Paket `org.xml.sax` in Java zum Parsen von XML-Dokumenten zu verwenden, können Sie einen einfachen Prozess mit dem SAX (Simple API for XML) Parsing-Ansatz befolgen. SAX ist ein ereignisgesteuerter Parser, der ein XML-Dokument sequenziell liest und Rückrufmethoden auslöst, wenn er verschiedene Teile des Dokuments wie Elemente oder Textinhalt trifft. Dies macht es speichereffizient, insbesondere für große XML-Dateien, da es das gesamte Dokument nicht wie DOM in den Speicher lädt. Hier ist eine Schritt-für-Schritt-Anleitung zur Verwendung von `org.xml.sax`.

---

### Schritt 1: Einrichten des SAX Parsers
Um XML mit SAX zu parsen, müssen Sie eine `SAXParser`-Instanz mit der `SAXParserFactory`-Klasse erstellen. Diese Fabrik ermöglicht es Ihnen, das Verhalten des Parsers zu konfigurieren, bevor Sie ihn erstellen.

Hier ist, wie Sie einen `SAXParser` erstellen:

```java
import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;

public class SAXExample {
    public static void main(String[] args) {
        try {
            // Erstellen Sie eine SAXParserFactory-Instanz
            SAXParserFactory factory = SAXParserFactory.newInstance();

            // Optional: Konfigurieren Sie die Fabrik (z. B. Aktivieren Sie die Namensraumbewusstsein)
            factory.setNamespaceAware(true); // Setzen Sie auf true, wenn Ihr XML Namensräume verwendet

            // Erstellen Sie einen SAXParser
            SAXParser parser = factory.newSAXParser();

            // Die nächsten Schritte gehen hier hin
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

- **`SAXParserFactory.newInstance()`**: Erstellt eine neue Fabrikinstanz.
- **`factory.setNamespaceAware(true)`**: Optional. Aktiviert die Namensraumverarbeitung, wenn Ihr XML Namensräume verwendet. Standardmäßig ist es `false`.
- **`factory.newSAXParser()`**: Erstellt einen `SAXParser`. Dies kann `ParserConfigurationException` oder `SAXException` auslösen, wenn der Parser nicht konfiguriert oder initialisiert werden kann.

---

### Schritt 2: Erstellen eines Handlers für XML-Ereignisse
SAX-Parsing basiert auf einem Handler, um die XML-Ereignisse zu verarbeiten, die er trifft, wie den Anfang eines Elements, das Ende eines Elements oder Textinhalt. Die primäre Schnittstelle dafür ist `ContentHandler`, aber aus Gründen der Einfachheit können Sie die Klasse `DefaultHandler` erweitern, die leere Implementierungen von `ContentHandler` und anderen Handler-Schnittstellen (`ErrorHandler`, `DTDHandler` usw.) bereitstellt. Sie müssen nur die Methoden überschreiben, die Sie interessieren.

Hier ist ein Beispiel für einen benutzerdefinierten Handler:

```java
import org.xml.sax.Attributes;
import org.xml.sax.helpers.DefaultHandler;

public class MyHandler extends DefaultHandler {
    // Variable zum Akkumulieren von Textinhalt
    private StringBuilder content = new StringBuilder();

    @Override
    public void startElement(String uri, String localName, String qName, Attributes attributes) {
        // Leeren Sie den Inhaltspuffer für das neue Element
        content.setLength(0);
        System.out.println("Start Element: " + qName);

        // Wenn das Element Attribute hat, verarbeiten Sie sie
        for (int i = 0; i < attributes.getLength(); i++) {
            System.out.println("Attribut: " + attributes.getQName(i) + " = " + attributes.getValue(i));
        }
    }

    @Override
    public void characters(char[] ch, int start, int length) {
        // Akkumulieren Sie den Textinhalt (kann mehrmals pro Element aufgerufen werden)
        content.append(ch, start, length);
    }

    @Override
    public void endElement(String uri, String localName, String qName) {
        // Verarbeiten Sie den akkumulierten Textinhalt
        String text = content.toString().trim();
        if (!text.isEmpty()) {
            System.out.println("Inhalt: " + text);
        }
        System.out.println("End Element: " + qName);
        content.setLength(0); // Zurücksetzen für das nächste Element
    }

    @Override
    public void startDocument() {
        System.out.println("Dokumentparsing gestartet");
    }

    @Override
    public void endDocument() {
        System.out.println("Dokumentparsing abgeschlossen");
    }
}
```

- **`startElement`**: Wird aufgerufen, wenn der Parser den Anfang eines Elements trifft. Parameter enthalten:
  - `uri`: Namensraum-URI (falls namensraumbewusst).
  - `localName`: Lokaler Name des Elements (ohne Präfix, falls namensraumbewusst).
  - `qName`: Qualifizierter Name (enthält Präfix, falls vorhanden).
  - `attributes`: Liste der Attribute des Elements.
- **`characters`**: Wird für Textinhalt innerhalb eines Elements aufgerufen. Beachten Sie, dass dies mehrmals für den Inhalt eines einzelnen Elements aufgerufen werden kann, daher verwenden Sie einen `StringBuilder`, um ihn zu akkumulieren.
- **`endElement`**: Wird aufgerufen, wenn ein Element endet.
- **`startDocument` und `endDocument`**: Wird zu Beginn und am Ende des XML-Dokuments aufgerufen.

---

### Schritt 3: Parsen des XML
Mit dem Parser und dem Handler bereit können Sie eine XML-Quelle (z. B. eine Datei, `InputStream` oder Zeichenkette) parsen, indem Sie die `parse`-Methode auf dem `SAXParser` aufrufen und Ihren Handler übergeben.

Hier ist, wie Sie eine XML-Datei parsen:

```java
import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;
import java.io.File;

public class SAXExample {
    public static void main(String[] args) {
        try {
            // Erstellen Sie den Parser
            SAXParserFactory factory = SAXParserFactory.newInstance();
            SAXParser parser = factory.newSAXParser();

            // Erstellen Sie den Handler
            MyHandler handler = new MyHandler();

            // Parsen Sie eine XML-Datei
            File xmlFile = new File("example.xml");
            parser.parse(xmlFile, handler);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

- **`parser.parse`**: Nimmt eine XML-Quelle (z. B. `File`) und einen `DefaultHandler`. Es kann `IOException` (für Eingabefehler) oder `SAXException` (für Parsingfehler) auslösen.

Für eine XML-Zeichenkette anstelle einer Datei verwenden Sie `InputSource`:

```java
import org.xml.sax.InputSource;
import java.io.StringReader;

// Innerhalb der main-Methode
String xml = "<book><title>XML Parsing</title></book>";
InputSource inputSource = new InputSource(new StringReader(xml));
parser.parse(inputSource, handler);
```

---

### Schritt 4: Ausnahmen behandeln
SAX-Parsing umfasst mehrere Ausnahmen, die Sie behandeln sollten:

- **`ParserConfigurationException`**: Wird von `newSAXParser()` ausgelöst, wenn der Parser nicht konfiguriert werden kann.
- **`SAXException`**: Wird von `newSAXParser()` oder `parse()` für allgemeine Parsingfehler ausgelöst.
- **`IOException`**: Wird von `parse()` ausgelöst, wenn ein Problem beim Lesen der Eingabequelle auftritt.

Umhüllen Sie Ihren Code in einem `try-catch`-Block:

```java
try {
    SAXParserFactory factory = SAXParserFactory.newInstance();
    SAXParser parser = factory.newSAXParser();
    MyHandler handler = new MyHandler();
    parser.parse(new File("example.xml"), handler);
} catch (ParserConfigurationException e) {
    System.err.println("Parser-Konfigurationsfehler: " + e.getMessage());
} catch (SAXException e) {
    System.err.println("SAX-Fehler: " + e.getMessage());
} catch (IOException e) {
    System.err.println("IO-Fehler: " + e.getMessage());
}
```

---

### Schritt 5: Optionale Funktionen
#### Fehlerbehandlung
`DefaultHandler` implementiert auch `ErrorHandler`. Überschreiben Sie dessen Methoden, um Parsingfehler zu behandeln:

```java
public class MyHandler extends DefaultHandler {
    @Override
    public void error(SAXParseException e) {
        System.err.println("Parsing-Fehler: " + e.getMessage());
    }

    @Override
    public void fatalError(SAXParseException e) throws SAXException {
        System.err.println("Schwerwiegender Fehler: " + e.getMessage());
        throw e; // Stoppen Sie das Parsen
    }

    @Override
    public void warning(SAXParseException e) {
        System.out.println("Warnung: " + e.getMessage());
    }
    // Andere Methoden wie oben
}
```

#### Namensraumverarbeitung
Wenn Ihr XML Namensräume verwendet, setzen Sie `factory.setNamespaceAware(true)` und verwenden Sie `uri` und `localName` in Ihren Handler-Methoden anstelle von `qName`, um Elemente korrekt zu identifizieren.

#### Validierung
Um XML gegen eine DTD oder ein Schema zu validieren, setzen Sie `factory.setValidating(true)`. Sie benötigen möglicherweise auch einen `ErrorHandler`, um Validierungsfehler zu verwalten.

---

### Beispiel XML und Ausgabe
Für eine XML-Datei `example.xml`:
```xml
<book id="123">
    <title>XML Parsing</title>
    <author>John Doe</author>
</book>
```

Das Ausführen des obigen Codes könnte die folgende Ausgabe erzeugen:
```
Dokumentparsing gestartet
Start Element: book
Attribut: id = 123
Start Element: title
Inhalt: XML Parsing
End Element: title
Start Element: author
Inhalt: John Doe
End Element: author
End Element: book
Dokumentparsing abgeschlossen
```

---

### Zusammenfassung
Um `org.xml.sax` zu verwenden:
1. Erstellen Sie einen `SAXParser` mit `SAXParserFactory`.
2. Implementieren Sie einen Handler, indem Sie `DefaultHandler` erweitern und Methoden wie `startElement`, `endElement` und `characters` überschreiben.
3. Parsen Sie das XML, indem Sie `parser.parse()` mit Ihrem Handler und der XML-Quelle aufrufen.
4. Behandeln Sie Ausnahmen (`SAXException`, `IOException`, `ParserConfigurationException`).
5. Konfigurieren Sie optional Namensraumbewusstsein, Validierung oder Fehlerbehandlung.

Dieser Ansatz ist ideal zum effizienten Parsen großer XML-Dokumente, wenn Sie nur bestimmte Daten extrahieren möchten, ohne einen Speicherbaum zu erstellen.