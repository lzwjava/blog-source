---
audio: false
generated: true
image: false
lang: hi
layout: post
model: x-ai/grok-4-fast
title: जावा हैंग्स का जेस्टैक से निदान
translated: true
type: note
---

### jstack का उपयोग करके Java एप्लिकेशन हैंग या अटकने का निदान करना

jstack JDK में शामिल एक कमांड-लाइन टूल है जो एक चल रहे Java वर्चुअल मशीन (JVM) के लिए थ्रेड डंप जनरेट करता है। थ्रेड डंप किसी विशेष क्षण में सभी थ्रेड्स की स्थिति को कैप्चर करते हैं, जो हैंग के कारणों, जैसे डेडलॉक, अनंत लूप, ब्लॉक्ड I/O, या CPU-गहन ऑपरेशन्स, की पहचान करने के लिए महत्वपूर्ण है। यह Linux/Unix सिस्टम या क्रॉस-प्लेटफॉर्म वातावरण में विशेष रूप से उपयोगी है।

#### jstack का उपयोग करने के चरण:
1.  **Java प्रोसेस ID (PID) की पहचान करें:**
    - सभी Java प्रोसेस की सूची देखने के लिए `jps` (जो JDK का हिस्सा है) चलाएं:
      ```
      jps -l
      ```
      इसका आउटपुट `12345 MyApp.jar` जैसा कुछ होगा। PID (जैसे, 12345) नोट कर लें।
    - वैकल्पिक रूप से, Linux/macOS पर `ps aux | grep java` जैसे OS कमांड्स का उपयोग करें।

2.  **एक थ्रेड डंप जनरेट करें:**
    - डंप को एक फाइल में आउटपुट करने के लिए PID के साथ jstack चलाएं:
      ```
      jstack <PID> > thread-dump.txt
      ```
      - `<PID>` को अपनी प्रोसेस ID से बदलें।
      - अधिक विस्तृत डंप (लॉक्स सहित) के लिए, `jstack -l <PID> > thread-dump.txt` का उपयोग करें।
      - यदि JVM सिग्नल का जवाब नहीं दे रहा है, तो `jhsdb jstack --pid <PID>` का उपयोग करें (JDK 8+ में उपलब्ध)।

3.  **विश्लेषण के लिए एकाधिक डंप कैप्चर करें:**
    - हैंग के लिए अक्सर समय के साथ तुलना की आवश्यकता होती है। 10-30 सेकंड के अंतराल पर 3-5 डंप लें:
      ```
      jstack <PID> > dump1.txt
      sleep 10
      jstack <PID> > dump2.txt
      sleep 10
      jstack <PID> > dump3.txt
      ```
      - यदि आवश्यक हो तो इसे एक लूप में स्क्रिप्ट करें (जैसे, bash स्क्रिप्ट का उपयोग करके)।

4.  **डंप का विश्लेषण करें:**
    - टेक्स्ट फाइल को किसी एडिटर या IDE में खोलें।
    - इनकी तलाश करें:
      - **थ्रेड स्टेट्स:** `RUNNABLE` (सक्रिय), `BLOCKED` (लॉक की प्रतीक्षा, संभावित डेडलॉक), `WAITING` (निष्क्रिय प्रतीक्षा), या `TIMED_WAITING` में मौजूद थ्रेड्स पर ध्यान दें।
      - **डेडलॉक्स:** "deadlock" की खोज करें या `jstack -l` जैसे टूल्स का उपयोग करें जो उन्हें फ्लैग करते हैं।
      - **स्टैक ट्रेस:** दोहराए जाने वाले पैटर्न या विशिष्ट मेथड्स में अटके हुए थ्रेड्स (जैसे, लूप में अनंत लूप) की पहचान करें।
      - **नेटिव फ्रेम्स:** यदि थ्रेड्स नेटिव कोड में अटके हुए हैं, तो यह JNI इश्यू या OS-लेवल ब्लॉक का संकेत दे सकता है।
    - गहन विश्लेषण के लिए टूल्स: VisualVM, Eclipse MAT, या fastThread.io जैसे ऑनलाइन पार्सर। उदाहरण के लिए, VisualVM में, लॉक्स और स्टेट्स को विज़ुअलाइज़ करने के लिए डंप फाइल को "Thread" टैब के अंतर्गत लोड करें।

यदि JVM प्रतिक्रिया नहीं देता है (जैसे, Unix पर `kill -3 <PID>` से कोई आउटपुट नहीं), तो हैंग OS लेवल पर हो सकता है—`gcore <PID>` के माध्यम से फुल कोर डंप पर विचार करें।

### ProcDump का उपयोग करके प्रोसेस हैंग या अटकने का निदान करना

ProcDump विंडोज के लिए एक मुफ्त Sysinternals टूल है जो प्रोसेस के मेमोरी या CPU डंप बनाता है। यह किसी भी एप्लिकेशन (Java सहित) में हैंग के स्नैपशॉट कैप्चर करने के लिए बहुत अच्छा है, खासकर जब प्रोसेस अनुत्तरदायी हो। WinDbg या Visual Studio जैसे टूल्स के साथ विश्लेषण करने के लिए फुल मेमोरी डंप कैप्चर करने के लिए इसका उपयोग करें।

#### ProcDump का उपयोग करने के चरण:
1.  **डाउनलोड और सेटअप:**
    - Microsoft Sysinternals साइट से ProcDump (procdump.exe) प्राप्त करें।
    - कमांड प्रॉम्प्ट को एडमिनिस्ट्रेटर के रूप में चलाएं।
    - procdump.exe वाले फोल्डर में नेविगेट करें।

2.  **प्रोसेस की पहचान करें:**
    - PID या इमेज नाम (जैसे, `java.exe`) प्राप्त करने के लिए टास्क मैनेजर या `tasklist | findstr <process-name>` का उपयोग करें।

3.  **एक हैंग डंप कैप्चर करें:**
    - तत्काल फुल मेमोरी डंप के लिए (अटके हुए प्रोसेस के लिए उपयोगी):
      ```
      procdump -ma <process-name-or-PID>
      ```
      - `-ma`: फुल मेमोरी डंप (सभी थ्रेड्स और हीप शामिल)।
      - उदाहरण: `procdump -ma java.exe` या `procdump -ma 12345`।

    - ऑटोमैटिक हैंग डिटेक्शन के लिए (अनुत्तरदायित्व पर ट्रिगर होता है):
      ```
      procdump -h <process-name-or-PID> -o
      ```
      - `-h`: हैंग के लिए मॉनिटर करता है (5+ सेकंड के लिए विंडो मैसेज के प्रति प्रोसेस अनुत्तरदायी; बिना विंडो वाली सर्विसेज के लिए, CPU थ्रेशोल्ड जैसे `-h 80` का उपयोग करें)।
      - `-o`: मौजूदा डंप को ओवरराइट करता है।
      - सर्विसेज के लिए: अपवादों के लिए `-e` के साथ संयोजित करें या CPU मॉनिटर करें: `procdump -c 80 -h <service-exe>`।

    - एकाधिक डंप लें: अंतराल पर 3 डंप के लिए `-n 3` जोड़ें (जैसे, 10-सेकंड की देरी के लिए `-t 10`):
      ```
      procdump -ma -n 3 -t 10 <PID>
      ```

4.  **डंप का विश्लेषण करें:**
    - डंप `.dmp` फाइल्स के रूप में करंट डायरेक्टरी में सेव होते हैं।
    - WinDbg (Microsoft से मुफ्त) या Visual Studio Debugger में खोलें।
    - WinDbg में मुख्य कमांड्स:
      - `!threads`: थ्रेड्स और स्टेट्स की सूची दिखाएं (ब्लॉक्ड/वेटिंग की तलाश करें)।
      - `~<thread-id>s`: एक थ्रेड पर स्विच करें और स्टैक ट्रेस के लिए `k` का उपयोग करें।
      - `!analyze -v`: हैंग/डेडलॉक के लिए ऑटो-एनालाइज करें।
    - Java-विशिष्ट विश्लेषण के लिए, डंप को Eclipse MAT में लोड करें या हीप डंप (यदि `-mh` फ्लैग के साथ कैप्चर किया गया हो) पर `jhat` का उपयोग करें।

ProcDump नॉन-इंटरएक्टिव प्रोसेस जैसे सर्विसेज के लिए अच्छा काम करता है; यदि हैंग CPU-बाउंड है, तो हाई CPU पर ट्रिगर करने के लिए `-c` का उपयोग करें।

### दोनों टूल्स के लिए सामान्य सुझाव
- **सुरक्षा:** डंप बड़े हो सकते हैं (फुल मेमोरी के लिए GBs); डिस्क स्पेस सुनिश्चित करें।
- **टूल्स को संयोजित करें:** विंडोज पर Java के लिए, पहले jstack (हल्का) का उपयोग करें, फिर गहन OS-लेवल की जानकारी के लिए ProcDump का उपयोग करें।
- **रोकथाम:** लॉगिंग के लिए `-XX:+PrintGCDetails` जैसे JVM फ्लैग्स सक्षम करें, या प्रोफाइलिंग के लिए JFR जैसे एजेंट्स का उपयोग करें।
- यदि डंप कोई स्पष्ट समस्या नहीं दिखाते हैं, तो `top` या Performance Monitor जैसे टूल्स के साथ सिस्टम रिसोर्सेज (CPU, मेमोरी, I/O) की जांच करें।

[Oracle Java Troubleshooting Guide](https://docs.oracle.com/en/java/javase/17/troubleshoot/troubleshoot-process-hangs-and-loops.html)  
[Taking a Hang Dump with ProcDump](https://www.poppastring.com/blog/taking-a-hang-dump-or-crash-dump-with-procdump)  
[Java Thread Dump Analysis](https://www.baeldung.com/java-analyze-thread-dumps)  
[ProcDump Usage for Hangs](https://learn.microsoft.com/en-us/sysinternals/downloads/procdump)