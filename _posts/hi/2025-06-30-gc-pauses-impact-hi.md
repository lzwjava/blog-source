---
audio: false
generated: true
lang: hi
layout: post
title: 'गो जीसी विराम: क्लाउडफ्लेयर बनाम टीआईडीबी'
translated: true
type: note
---

हाँ, Go के गार्बेज कलेक्टर (GC) के पॉज़ का प्रभाव Cloudflare की सेवाओं और TiDB डेटाबेस दोनों पर पड़ सकता है, क्योंकि दोनों ही अपनी आर्किटेक्चर में Go का भारी मात्रा में उपयोग करते हैं। हालाँकि, इन पॉज़ की प्रकृति, प्रभाव और उन्हें कम करने के तरीके अलग-अलग हैं।

यहाँ एक विस्तृत विवरण दिया गया है:

**Go का GC और इसकी विशेषताएँ:**

* **मार्क-स्वीप GC:** Go एक समवर्ती, त्रि-रंग मार्क-स्वीप गार्बेज कलेक्टर का उपयोग करता है। इसका मतलब है कि GC का अधिकांश कार्य (लाइव ऑब्जेक्ट्स को चिह्नित करना) एप्लिकेशन के निष्पादन के साथ समवर्ती रूप से होता है।
* **स्टॉप-द-वर्ल्ड (STW) पॉज़:** हालाँकि यह समवर्ती है, फिर भी Go के GC को अभी भी संक्षिप्त "स्टॉप-द-वर्ल्ड" (STW) पॉज़ की आवश्यकता होती है। यह पॉज़ विशिष्ट चरणों में होते हैं (जैसे प्रारंभिक "मार्क" सेटअप और अंतिम "मार्क टर्मिनेशन" तथा "स्वीप टर्मिनेशन" चरण) जहाँ मेमोरी स्थिरता सुनिश्चित करने के लिए एप्लिकेशन की गोरूटीन्स रोक दी जाती हैं। Go रनटाइम इंजीनियर्स का लक्ष्य इन STW अवधियों को कम से कम करना है, आमतौर पर उन्हें माइक्रोसेकंड की सीमा में रखना।
* **GC को प्रभावित करने वाले कारक:** GC पॉज़ की आवृत्ति और अवधि इन कारकों से प्रभावित होती है:
    * **एलोकेशन दर:** एप्लिकेशन कितनी तेजी से नई मेमोरी एलोकेट करता है।
    * **हीप साइज़:** Go रनटाइम द्वारा प्रबंधित मेमोरी की कुल मात्रा।
    * **`GOGC`:** एक पैरामीटर जो गार्बेज कलेक्शन लक्ष्य प्रतिशत को नियंत्रित करता है (डिफ़ॉल्ट 100%)। कम `GOGC` का मतलब है अधिक बार GC होना।
    * **`GOMEMLIMIT`:** एक नया पैरामीटर (Go 1.19+) जो लक्ष्य हीप साइज़ की एक ऊपरी सीमा निर्धारित करता है, जो OOMs को रोकने और मेमोरी को अधिक अनुमानित तरीके से प्रबंधित करने में मदद करता है।

**Cloudflare पर प्रभाव:**

Cloudflare अपनी कई महत्वपूर्ण सेवाओं, जिनमें DNS इन्फ्रास्ट्रक्चर, SSL हैंडलिंग, लोड टेस्टिंग आदि शामिल हैं, के लिए Go का व्यापक रूप से उपयोग करता है। Cloudflare जैसी उच्च-प्रदर्शन, कम-विलंबता वाली प्रणाली के लिए, माइक्रोसेकंड के पॉज़ भी महत्वपूर्ण हो सकते हैं।

* **विलंबता-संवेदनशील सेवाएँ:** उच्च अनुरोध दरों को संभालने वाली सेवाएँ (जैसे DNS या प्रॉक्सी करना) विलंबता स्पाइक्स के प्रति बहुत संवेदनशील होती हैं। GC पॉज़, भले ही छोटे हों, इन स्पाइक्स में योगदान दे सकते हैं, जिससे उपयोगकर्ता अनुभव प्रभावित होता है।
* **मेमोरी-गहन एप्लिकेशन्स:** कुछ Cloudflare सेवाएँ मेमोरी-गहन हो सकती हैं, जिससे ठीक से ट्यून न किए जाने पर अधिक बार GC चक्र हो सकते हैं।
* **Cloudflare पर शमन:** Cloudflare के इंजीनियर सक्रिय रूप से इन पर काम करते हैं:
    * **`GOGC` और `GOMEMLIMIT` को ट्यून करना:** वे मेमोरी उपयोग और GC आवृत्ति को संतुलित करने के लिए इन पैरामीटर्स के साथ प्रयोग करते हैं।
    * **प्रोफाइलिंग और कोड ऑप्टिमाइज़ेशन:** उनके Go कोड में अनावश्यक मेमोरी एलोकेशन को पहचानना और कम करना।
    * **प्रोफाइल-गाइडेड ऑप्टिमाइज़ेशन्स (PGO):** Cloudflare ने Go की PGO सुविधा का लाभ उठाकर महत्वपूर्ण CPU बचत (और इस प्रकार संभवतः कम GC दबाव) देखी है।
    * **आर्किटेक्चरल विचार:** सेवाओं को छोटे पॉज़ के प्रति लचीला बनाने के लिए डिज़ाइन करना, संभवतः पर्याप्त रिडंडेंसी रखकर या अनुरोधों को इस तरह से संसाधित करके कि एकल गोरूटीन के पॉज़ का प्रभाव न्यूनतम हो।

**TiDB डेटाबेस पर प्रभाव:**

TiDB, PingCAP द्वारा निर्मित एक वितरित SQL डेटाबेस है, जिसकी SQL लेयर (`tidb-server`) मुख्य रूप से Go में लिखी गई है। एक डेटाबेस के रूप में, इसकी प्रदर्शन विशेषताएँ और आवश्यकताएँ एक प्रॉक्सी सेवा की तुलना में अलग होती हैं।

* **डेटाबेस-विशिष्ट GC:** TiDB के पास MVCC (मल्टी-वर्जन कंकरेंसी कंट्रोल) डेटा (इसके स्टोरेज इंजन TiKV में पुराने डेटा वर्जन को साफ करने) के लिए अपने स्वयं के गार्बेज कलेक्शन तंत्र हैं। यह Go के रनटाइम GC से अलग है, हालाँकि TiDB "कोऑर्डिनेटर" (Go में लिखा गया) इसे आरंभ और प्रबंधित करता है।
* **TiDB में Go रनटाइम GC:** Go GC का TiDB पर प्रभाव पड़ता है क्योंकि `tidb-server` SQL अनुरोधों को संसाधित करता है, क्वेरी प्लान, परिणाम और अन्य रनटाइम डेटा के लिए मेमोरी प्रबंधित करता है।
    * **विलंबता जिटर:** लगातार STW पॉज़ क्वेरी निष्पादन में विलंबता स्पाइक्स का कारण बन सकते हैं, जिससे डेटाबेस की प्रतिक्रियाशीलता प्रभावित होती है।
    * **CPU ओवरहेड:** GC गतिविधि CPU संसाधनों का उपभोग करती है, जिनका उपयोग अन्यथा क्वेरीज़ को संसाधित करने के लिए किया जा सकता था।
    * **अनुकूली GC ट्रिगरिंग:** TiDB सक्रिय रूप से Go GC को ट्रिगर करता है जब मेमोरी उपयोग एक निश्चित सीमा तक पहुँच जाता है (जिसे `tidb_server_memory_limit` और `tidb_server_memory_limit_gc_trigger` के माध्यम से कॉन्फ़िगर किया जा सकता है)। यह अत्यधिक बार-बार GC से बचने के लिए `tidb_server_memory_limit_gc_trigger` के लिए एक अनुकूली रणनीति का भी उपयोग करता है।
* **मॉनिटरिंग और ट्यूनिंग:** PingCAP Go GC व्यवहार (GC आवृत्ति, अवधि, STW विलंबता, GC पर खर्च किया गया CPU समय) को देखने और प्रदर्शन को अनुकूलित करने के लिए `GOGC` और `GOMEMLIMIT` को कॉन्फ़िगर करने की अनुमति देने हेतु व्यापक मॉनिटरिंग टूल (जैसे TiDB रनटाइम डैशबोर्ड) प्रदान करता है।
* **चल रहे प्रयास:** PingCAP के इंजीनियर प्रदर्शन और स्थिरता पर इसके प्रभाव को कम करने के लिए TiDB के Go मेमोरी प्रबंधन और GC व्यवहार को अनुकूलित करने पर लगातार काम कर रहे हैं।

**संक्षेप में:**

Cloudflare और TiDB दोनों, Go पर निर्भर उच्च-प्रदर्शन प्रणालियाँ होने के नाते, Go के GC पॉज़ के प्रभावों के प्रति संवेदनशील हैं। हालाँकि Go का GC छोटी STW अवधियों के लिए अत्यधिक अनुकूलित है, लेकिन बड़े पैमाने पर, ये पॉज़ विलंबता स्पाइक्स और CPU ओवरहेड में योगदान दे सकते हैं। दोनों कंपनियाँ इन प्रभावों को कम करने के लिए Go के रनटाइम पैरामीटर्स और अपने स्वयं के विशिष्ट आर्किटेक्चरल डिजाइनों का लाभ उठाते हुए, अपने Go एप्लिकेशन्स और इन्फ्रास्ट्रक्चर की सक्रिय रूप से निगरानी, ट्यूनिंग और अनुकूलन करती हैं।