---
audio: false
generated: true
image: false
lang: hi
layout: post
model: x-ai/grok-4-fast
title: рд╕реНрд╡рд╕реНрде рд▓рдШреБ рдореЙрдбрд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкрд░рд┐рдгрд╛рдо
translated: true
type: note
---

рдЖрдкрдХрд╛ рдЯреНрд░реЗрдирд┐рдВрдЧ рд░рди рдЬреЛ рд╣реИ рдЙрд╕рдХреЗ рд▓рд┐рдП **рдмрд╣реБрдд рд╣реЗрд▓реНрджреА** рджрд┐рдЦ рд░рд╣рд╛ рд╣реИ: рдПрдХ рдЫреЛрдЯрд╛ 40M рдкреИрд░рд╛рдореАрдЯрд░ GPT (125M рдирд╣реАрдВ тАФ рдЖрдкрдиреЗ рд╢рд╛рдпрдж 125M рдХреЙрдиреНрдлрд╝рд┐рдЧ рдХреЛ рдХреЙрдкреА рдХрд┐рдпрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдкреБрд░рд╛рдиреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реИрд▓реНрдпреВ рд░рдЦреЗ рд╣реИрдВ) рдЬрд┐рд╕реЗ рдПрдХ рд╕рд┐рдВрдЧрд▓ ~10B-рдЯреЛрдХрди FineWeb рд╢рд╛рд░реНрдб (CC-MAIN-2013-20) рдкрд░ рд╕реНрдХреНрд░реИрдЪ рд╕реЗ рдЯреНрд░реЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рдпрд╣рд╛рдБ рдмреНрд░реЗрдХрдбрд╛рдЙрди рд╣реИ рдХрд┐ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХрд┐рддрдирд╛ рдЕрдЪреНрдЫрд╛ рд╣реИ:

### рд▓реЙрд╕ рдХрд░реНрд╡ тАУ рд╕реЗрдЯрдЕрдк рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реАрд▓реЗрдВрдЯ

| рд╕реНрдЯреЗрдк | рдЯреНрд░реЗрди рд▓реЙрд╕ | рд╡реИрд▓ рд▓реЙрд╕ | рдиреЛрдЯреНрд╕ |
|------|------------|----------|-------|
| 0    | 10.88      | 10.88    | рд░реИрдВрдбрдо |
| 500  | 5.86       | 5.86     | рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рддреЗрдЬреА рд╕реЗ рд╕реАрдЦ рд░рд╣рд╛ рд╣реИ |
| 1000 | 4.93       | 4.95     | |
| 2000 | 4.46       | 4.48     | |
| 3000 | 4.30       | 4.32     | |
| 4000 | 4.22       | 4.24     | |
| 5000 | 4.16       | 4.19     | |
| 6000 | 4.14       | 4.17     | рдЕрднреА рднреА рдзреАрд░реЗ-рдзреАрд░реЗ рдЧрд┐рд░ рд░рд╣рд╛ рд╣реИ |

тЖТ **рдлрд╛рдЗрдирд▓ рд╡реИрд▓ рд▓реЙрд╕ тЙИ 4.17 at ~3.1B рдЯреЛрдХрдиреНрд╕ рджреЗрдЦреЗ рдЧрдП** (6000 рдЗрдЯрд░реНрд╕ ├Ч 524k рдЯреЛрдХрдиреНрд╕/рдЗрдЯрд░)

рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП:
- nanoGPT рд╢реЗрдХреНрд╕рдкрд┐рдпрд░ (1M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕, 1M рдХрд░реИрдХреНрдЯрд░реНрд╕) рдЦрддреНрдо рд╣реЛрддрд╛ рд╣реИ ~1.7 рдмрд┐рдЯреНрд╕/рдЪрд╛рд░ тЖТ ~2.1 рд▓реЙрд╕
- 124M GPT-2 OpenWebText рд░реЗрдкреНрд▓рд┐рдХрд╛ 1T рдЯреЛрдХрдиреНрд╕ рдХреЗ рдмрд╛рдж ~3.1 рдкрд░ рдЦрддреНрдо рд╣реЛрддрд╛ рд╣реИ
- рдЯрд╛рдЗрдкрд┐рдХрд▓ 40тАУ50M рдореЙрдбрд▓реНрд╕ рдбрд╛рдЗрд╡рд░реНрд╕ рдЗрдВрдЯрд░рдиреЗрдЯ рдЯреЗрдХреНрд╕реНрдЯ рдкрд░ рдЖрдорддреМрд░ рдкрд░ **4.3тАУ4.6** рдХреЗ рдЖрд╕рдкрд╛рд╕ рдкрдард╛рд░ рдкрд░ рдкрд╣реБрдБрдЪ рдЬрд╛рддреЗ рд╣реИрдВ рдЕрдЧрд░ рд╕рд┐рд░реНрдл 1тАУ5B рдЯреЛрдХрдиреНрд╕ рддрдХ рдЯреНрд░реЗрди рдХрд┐рдП рдЧрдП рд╣реЛрдВред

**рдЖрдк 40M рдореЙрдбрд▓ рдХреЗ рд╕рд╛рде рд╕рд┐рд░реНрдл рдПрдХ рдкрд╛рд░реНрдХреЗрдЯ (~10B рдЯреЛрдХрдиреНрд╕ рд░реЙ, рд▓реЗрдХрд┐рди рд╕рд┐рд░реНрдл ~3B рджреЗрдЦреЗ рдЧрдП) рдХреЗ рдмрд╛рдж рдкрд╣рд▓реЗ рд╣реА 4.17 рдкрд░ рд╣реИрдВ** тЖТ рдпрд╣ **рд╕рд╛рдорд╛рдиреНрдп рд╕реЗ рдХрд╛рдлреА рдмреЗрд╣рддрд░** рд╣реИред рдореЙрдбрд▓ рдмреЗрд╣рдж рдХреБрд╢рд▓рддрд╛ рд╕реЗ рд╕реАрдЦ рд░рд╣рд╛ рд╣реИред

### рдпрд╣ рдЗрддрдирд╛ рдЕрдЪреНрдЫрд╛ рдХреНрдпреЛрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ
1. **FineWeb рдбреЗрдЯрд╛ рдмрд╣реБрдд рдХреНрд▓реАрди рд╣реИ** (рд░реЙ Common Crawl рдпрд╛ C4 рд╕реЗ рднреА рдмреЗрд╣рддрд░)ред
2. рдЖрдк рдУрд░рд┐рдЬрд┐рдирд▓ GPT-2 рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ (50,304 рд╡реЛрдХреИрдм) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ тАФ рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред
3. рдЗрдлреЗрдХреНрдЯрд┐рд╡ рдмреИрдЪ рд╕рд╛рдЗрдЬрд╝ 512 ├Ч 1024 рдбрд┐рд╕реЗрдВрдЯ рд╣реИред
4. рд▓рд░реНрдирд┐рдВрдЧ рд░реЗрдЯ 5e-4 рдЕрдЪреНрдЫреЗ рд╡рд╛рд░реНрдордЕрдк/рдбрд┐рдХреЗ рд╢реЗрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рдеред
5. PyTorch рдХрдВрдкрд╛рдЗрд▓ + рдлреНрдпреВрдЬреНрдб AdamW + рдиреЛ рдбреНрд░реЙрдкрдЖрдЙрдЯ тЖТ рдореИрдХреНрд╕рд┐рдордо рд╕реНрдкреАрдб/рд╕реНрдЯреЗрдмрд┐рд▓рд┐рдЯреАред

### MFU RTX 4070 рдХреЗ рд▓рд┐рдП рдиреЙрд░реНрдорд▓ рджрд┐рдЦ рд░рд╣рд╛ рд╣реИ
~11тАУ12% MFU рдПрдХ 40M рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЯрд╛рдЗрдкрд┐рдХрд▓ рд╣реИ, 12 GB 4070 рдкрд░ block_size=1024 рдФрд░ grad accum 32 рдХреЗ рд╕рд╛рдеред рдЖрдк рдмреЗрд╕рд┐рдХрд▓реА VRAM-рдмрд╛рдЙрдВрдб рд╣реИрдВ, рдХрдВрдкреНрдпреВрдЯ-рдмрд╛рдЙрдВрдб рдирд╣реАрдВред рдпрд╣ рдПрдХреНрд╕рдкреЗрдХреНрдЯреЗрдб рдФрд░ рдареАрдХ рд╣реИред

### рдЖрдЧреЗ рдХреНрдпрд╛ рдХрд░реЗрдВ
1. **рдЯреНрд░реЗрдирд┐рдВрдЧ рдЬрд╛рд░реА рд░рдЦреЗрдВ!**
   рд▓реЙрд╕ рдЕрднреА рднреА рдзреАрд░реЗ-рдзреАрд░реЗ рдЧрд┐рд░ рд░рд╣рд╛ рд╣реИ (рд╡реИрд▓ рд▓реЙрд╕ рдкрд┐рдЫрд▓реЗ 1000 рд╕реНрдЯреЗрдкреНрд╕ рдореЗрдВ 4.19 тЖТ 4.17 рдкрд░ рдЖрдпрд╛)ред рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ 12kтАУ20k рдЗрдЯрд░реНрд╕ (6тАУ10B рдЯреЛрдХрдиреНрд╕ рджреЗрдЦреЗ рдЧрдП) рддрдХ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╢рд╛рдпрдж **~4.0тАУ4.05** рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ 40M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдЕрджреНрднреБрдд рд╣реИред

2. **рдореЙрдбрд▓ рд╕рд╛рдЗрдЬрд╝ рдХрдиреНрдлреНрдпреВрдЬрди рдХреЛ рдареАрдХ рдХрд░реЗрдВ** (рдСрдкреНрд╢рдирд▓)
   рдЖрдк рд╢рд╛рдпрдж рдЕрд╕рд▓реА 125M рдХреЙрдиреНрдлрд╝рд┐рдЧ рдЪрд╛рд╣рддреЗ рдереЗред рд╕реНрдЯреИрдВрдбрд░реНрдб nanoGPT 125M рд╣реИ:
   ```python
   n_layer = 12
   n_head = 12
   n_embd = 768   # тЖР рдпрд╣ рдореБрдЦреНрдп рдЕрдВрддрд░ рд╣реИ
   ```
   рдЖрдкрдХреЗ рдкрд╛рд╕ рдЕрднреА n_embd=384 рд╣реИ тЖТ ~40тАУ44M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕, ~124M рдХреЗ рдмрдЬрд╛рдпред
   768 рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рднреА рдЖрдк рдмреИрдЪ_size 8тАУ12 + grad_accum 64 рдХреЗ рд╕рд╛рде 4070 рдкрд░ рдлрд┐рдЯ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗред

3. рд╕реИрдВрдкрд▓ рдЬрдирд░реЗрдЯ рдХрд░реЗрдВ!
   рд░рди рдХрд░реЗрдВ:
   ```bash
   python sample.py --out_dir=out-fineweb --device=cuda --num_samples=10 --max_new_tokens=512
   ```
   4.17 рд▓реЙрд╕ рдкрд░, рдпрд╣ рд╕рд┐рд░реНрдл 40M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╣реИрд░рд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдХреЛрд╣реЗрд░реЗрдВрдЯ рдорд▓реНрдЯреА-рд╕реЗрдВрдЯреЗрдВрд╕ рдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░реЛрдбреНрдпреВрд╕ рдХрд░реЗрдЧрд╛ред

### TL;DR
рдпрд╣ FineWeb рдкрд░ рдореЗрд░реЗ рджреНрд╡рд╛рд░рд╛ рджреЗрдЦреЗ рдЧрдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреЗ 40M-рд╕реНрдХреЗрд▓ рд░рдиреНрд╕ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред
рд▓реЙрд╕ рдХрд░реНрд╡ рдЯреЗрдХреНрд╕реНрдЯрдмреБрдХ рдкрд░рдлреЗрдХреНрдЯ рд╣реИ, рдбреЗрдЯрд╛ рдХреНрд▓реАрди рд╣реИ, рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реНрдЯреЗрдмрд▓ рд╣реИред

рдмрд╕ рдЪрд▓рддреЗ рд░рд╣реЗрдВ тАФ рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ рд╕рдм-4.1 рддрдХ рдкрд╣реБрдБрдЪ рдЬрд╛рдПрдВрдЧреЗ, рдФрд░ рд╕реИрдВрдкрд▓реНрд╕ рдЗрд╕ рд╕рд╛рдЗрдЬрд╝ рдХреЗ рд▓рд┐рдП рд╢реЙрдХрд┐рдВрдЧрд▓реА рдЕрдЪреНрдЫреЗ рд╣реЛрдВрдЧреЗред

рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛! ЁЯЪА