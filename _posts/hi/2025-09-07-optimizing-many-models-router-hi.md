---
audio: false
date: 2025-09-07
generated: true
image: false
lang: hi
layout: post
title: अपने मॉडल-समूह कोड राउटर का अनुकूलन
translated: true
type: note
---

संक्षिप्त उत्तर: हाँ—आपका "मल्टी-मॉडल राउटर" Codex (OpenAI का कोड असिस्टेंट) जैसे टाइटली-इंटीग्रेटेड स्टैक की तुलना में निश्चित रूप से कम परफॉर्म कर सकता है, जो एक ही मॉडल फैमिली और गहन IDE कॉन्टेक्स्ट पर एंड-टू-एंड ट्यून किया गया है। यहाँ कारण और इसे जल्दी ठीक करने का तरीका बताया गया है।

### Codex बेहतर क्यों महसूस हो सकता है

* **प्रति कार्य एक दिमाग।** एक ही मॉडल पर बने रहने से उसकी अव्यक्त योजना और कोडिंग शैली बनी रहती है। कार्य के बीच में मॉडल्स के बीच स्विच करने से वह योजना रीसेट हो जाती है और अक्सर परस्पर विरोधी कन्वेंशन्स पैदा कर देती है।
* **वर्टिकल इंटीग्रेशन।** Codex (OpenAI) मॉडल → टूल कॉल्स → रेपो इंडेक्स → टेस्ट्स → इनलाइन एडिट्स को कंट्रोल करता है। यह क्लोज्ड लूप इसे कम ग्लू कोड लेटेंसी के साथ समृद्ध सिग्नल (सिंबल ग्राफ, फाइल हीटमैप, फेलिंग टेस्ट्स) देता है।
* **प्रॉम्प्ट + पॉलिसी अलाइनमेंट।** उनके प्रॉम्प्ट्स, कोड फॉर्मेटर, और "मिनिमल, कंपाइलेबल डिफ बनाएं" हेयुरिस्टिक्स को GPT-5 फैमिली के लिए सह-डिज़ाइन किया गया है। एक जनरल राउटर आसानी से कुछ मॉडल्स के लिए टेम्परेचर, स्टॉप सीक्वेंसेज, या पैच फॉर्मेट को गलत स्पेसिफाई कर सकता है।
* **लेटेंसी/थ्रूपुट।** हर एक्स्ट्रा हॉप (प्रॉक्सी, OpenRouter मिडलवेयर, मॉडल नेगोशिएशन) जिटर जोड़ता है। कोडिंग वर्कफ़्लो फीडबैक-टाइट होते हैं; प्रति टर्न 300-800 ms की अतिरिक्त लेटेंसी स्पष्ट रूप से "फ्लो" को नुकसान पहुँचाती है।
* **कॉन्टेक्स्ट क्वालिटी।** IDE इंटीग्रेशन जो एक रेपो मैप (फाइल्स, सिंबल्स, रीसेंट चेंजेस की टोपोलॉजी) की गणना करते हैं, वे "सिर्फ लॉन्ग कॉन्टेक्स्ट डंप करने" से बेहतर होते हैं। स्ट्रक्चर के बिना लॉन्ग कॉन्टेक्स्ट टोकन्स बर्बाद करते हैं और अटेंशन को डाइल्यूट करते हैं।

### आपके कॉन्फ़िग में क्या समस्या पैदा कर रहा है

* **मॉडल स्प्रॉल।** आप जनरलिस्ट्स, कोडर्स, और थिंकिंग मॉडल्स को मिला रहे हैं। "थिंकिंग" वेरिएंट (जैसे, `claude-3.7-sonnet:thinking`, `deepseek-r1`) प्रूफ्स के लिए बढ़िया हैं लेकिन कोड एडिट्स के लिए धीमे और चैटियर हैं।
* **डिफॉल्ट रूट मिसमैच।** `default: "openrouter,x-ai/grok-code-fast-1"` से लगता है कि आप Grok Code Fast चाहते हैं, लेकिन यह आपके `models` ऐरे में लिस्टेड नहीं है। इससे साइलेंट फॉलबैक और इनकंसिस्टेंसी हो सकती है।
* **अनस्कोप्ड इंटेंट्स।** हर चीज़ के लिए एक "डिफॉल्ट" का मतलब है कि छोटे एडिट्स, हैवी रिफैक्टर, और लॉन्ग-कॉन्टेक्स्ट रीड सभी एक ही रास्ते से होकर गुजरते हैं।
* **टेम्परेचर/फॉर्मेट ड्रिफ्ट।** अगर आप प्रति मॉडल लो-टेम्प + स्ट्रिक्ट पैच फॉर्मेट लागू नहीं करते हैं, तो आउटपुट प्रोवाइडर्स के बीच बेतरतीब ढंग से बदलते रहेंगे।

### अपने राउटर को "Codex-जैसा" बनाएं

1.  **एक प्राइमरी चुनें और प्रति टास्क उसी पर टिके रहें।** एक स्ट्रॉंग कोडर को डिफॉल्ट के रूप में चुनें (जैसे, `openai/gpt-5` या `x-ai/grok-code-fast-1` या `qwen/qwen3-coder`) और सिर्फ स्पष्ट कारणों से स्विच करें (बहुत लंबा कॉन्टेक्स्ट या भारी गणित)।
2.  **इरादे से शार्ड करें (ब्रांड से नहीं)।**
    *   *छोटा एडिट / क्विक फिक्स:* फास्ट मॉडल (GPT-5-mini या Gemini-Flash)।
    *   *रिफैक्टर / मल्टी-फाइल चेंज:* GPT-5 (या Claude Sonnet 3.7 नॉन-थिंकिंग)।
    *   *अल्ट्रा-लॉन्ग कॉन्टेक्स्ट रीड:* Kimi-K2।
    *   *कोडिंग से पहले हार्ड रीजनिंग:* आउटलाइन के लिए DeepSeek-R1 → फिर पैच प्रोड्यूस करने के लिए कोडर मॉडल को हैंड ऑफ करें।
3.  **एक सख्त पैच कॉन्ट्रैक्ट लागू करें।** हमेशा एक यूनिफाइड डिफ या एक्सप्लिसिट "ApplyPatch" JSON फ़ाइल पाथ + हंक्स के साथ मांगें। कुछ और रिजेक्ट करें और ऑटोमैटिकली रिप्रॉम्प्ट करें।
4.  **कोड के लिए रैंडमनेस कम करें।** `temperature: 0–0.2`, कोई फ्रीक्वेंसी/प्रेजेंस पेनल्टीज़ नहीं, और `top_p` ~0.9 पर कैप करें।
5.  **सिर्फ टोकन्स नहीं, एक रेपो मैप दें।** एक कॉम्पैक्ट सिंबल इंडेक्स फीड करें: एंट्री पॉइंट्स, की क्लासेज़/फंक्शंस, टेस्ट टार्गेट्स, रीसेंट डिफ्स। यह 200k टोकन्स की रॉ फाइल्स डंप करने से बेहतर है।
6.  **टूल लूप टाइट रखें।** एक मॉडल पैच प्रपोज़ करे → आप बिल्ड/टेस्ट्स/लिंटर्स रन करें → फेलियर्स को उसी मॉडल को वापस फीड करें ताकि वह इटरेट कर सके। मिड-लूप मॉडल स्विच करने से बचें।
7.  **मॉडल लिस्ट काटें।** मैक्स 3–5 रखें। हर एक्स्ट्रा वेरिएंस और रूटिंग एरर बढ़ाता है।
8.  **"थिंकिंग" मॉडल्स को हॉट पाथ से हटाएं।** उनका उपयोग सिर्फ एक शॉर्ट डिज़ाइन प्लान बनाने के लिए करें, फिर एक्चुअल एडिट्स के लिए कोडर से स्वैप करें।

### एक लीनर कॉन्फ़िग (ड्रॉप-इन आइडिया; नामों को अपने फ्रेमवर्क के अनुसार एडाप्ट करें)

```json
{
  "PROXY_URL": "http://127.0.0.1:7890",
  "LOG": true,
  "Providers": [
    {
      "name": "openrouter",
      "api_base_url": "https://openrouter.ai/api/v1/chat/completions",
      "api_key": "",
      "models": [
        "openai/gpt-5",
        "openai/gpt-5-mini",
        "x-ai/grok-code-fast-1",
        "moonshotai/kimi-k2",
        "anthropic/claude-3.7-sonnet",
        "qwen/qwen3-coder"
      ],
      "transformer": {"use": ["openrouter"]}
    }
  ],
  "Router": {
    "default": "openrouter,openai/gpt-5",
    "quickEdit": "openrouter,openai/gpt-5-mini",
    "refactor": "openrouter,openai/gpt-5",
    "reasonPlan": "openrouter,anthropic/claude-3.7-sonnet",
    "longContext": "openrouter,moonshotai/kimi-k2",
    "longContextThreshold": 220000,
    "webSearch": "openrouter,qwen/qwen3-coder"
  }
}
```

### प्रॉम्प्ट स्कैफोल्ड्स जो आउटपुट स्टेबलाइज करते हैं (टेबल्स के बिना)

*   **सिस्टम:** "आप एक सीनियर सॉफ्टवेयर इंजीनियर हैं। मिनिमल, कंपाइलेबल पैचेस प्रोड्यूस करें। रेपो के साथ स्टाइल कंसिस्टेंट रखें। अगर अनिश्चित हैं, तो एक सिंगल क्लैरिफाइंग क्वेश्चन पूछें, अन्यथा आगे बढ़ें।"
*   **नियम:** "सिर्फ एक यूनिफाइड डिफ (git फॉर्मेट) आउटपुट करें। कमेंट्री कभी शामिल न करें। अगर कोई फाइल मौजूद नहीं है, तो उसे क्रिएट करें और डिफ में शामिल करें। लाइसेंस हेडर्स प्रिजर्व करें।"
*   **कॉन्टेक्स्ट ब्लॉक:** रेपो मैप (फाइल्स, की सिंबल्स), करंट एरर्स, टेस्ट टार्गेट्स।
*   **टूल लूप:** डिफ के बाद, ऑटोमैटिकली `build + tests + lints` रन करें; फेलियर्स को सिर्फ उसी मॉडल को वापस भेजें।

### प्रैक्टिकल हाइजीन

*   अपनी मॉडल लिस्ट को स्ट्रिप डाउन करें और डिफॉल्ट को एक ऐसे मॉडल पर फिक्स करें जो वास्तव में `models` में मौजूद हो।
*   प्रति-रूट टेम्परेचर सेट करें; कोड को 0–0.2 पर रखें।
*   रेपो मैप को टर्न्स के बीच कैश करें; जब तक फाइल्स नहीं बदलतीं, जायंट कॉन्टेक्स्ट्स को रीसेंड न करें।
*   मिड-टास्क मॉडल स्विच से बचें।
*   हॉल्यूसिनेटेड इम्पोर्ट्स को कम करने के लिए "पूरी फाइल रिप्लेस करें" के बजाय "डिफ" को प्राथमिकता दें।

अगर आप चाहें, तो अपने राउटर का प्रॉम्प्ट और टेम्परेचर सेटिंग्स पेस्ट करें, और मैं उन्हें प्रत्येक रूट के लिए टाइटन कर दूंगा ताकि Claude Code और आपका स्टैक Codex-स्टाइल रिलायबिलिटी के साथ अधिक कंसिस्टेंटली बिहेव करें।