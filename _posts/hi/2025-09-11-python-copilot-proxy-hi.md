---
audio: false
date: 2025-09-11
generated: true
image: false
lang: hi
layout: post
model: mistralai/mistral-medium-3.1
title: पायथन कोपायलट प्रॉक्सी सर्वर कार्यान्वयन
translated: true
type: note
---

यह Python स्क्रिप्ट एक **लोकल प्रॉक्सी सर्वर** है जो कोड कम्प्लीशन जनरेट करने के लिए **GitHub Copilot** के साथ इंटरैक्ट करती है। यह GitHub Copilot के ऑफिशियल प्लगइन (जैसे, Neovim के लिए) के व्यवहार की नकल करती है, जिसमें ऑथेंटिकेशन को हैंडल करना और Copilot के API को रिक्वेस्ट्स फॉरवर्ड करना शामिल है।

---

### **मुख्य घटक और वर्कफ़्लो**
1. **ऑथेंटिकेशन (`setup()` और `get_token()`)**
   - GitHub के साथ ऑथेंटिकेट करने के लिए **OAuth डिवाइस फ़्लो** का उपयोग करती है।
   - GitHub से एक **डिवाइस कोड** और **यूज़र कोड** रिक्वेस्ट करती है।
   - यूज़र से एक URL (`verification_uri`) पर जाने और `user_code` एंटर करने के लिए कहती है।
   - एक **एक्सेस टोकन** प्राप्त होने तक GitHub को पोल करती रहती है।
   - भविष्य के उपयोग के लिए टोकन को `.copilot_token` में सेव कर देती है।
   - एक्सेस टोकन को **Copilot सत्र टोकन** (API कॉल के लिए आवश्यक) के लिए एक्सचेंज करती है।

2. **टोकन रिफ्रेश (`token_thread()`)**
   - एक बैकग्राउंड थ्रेड में चलती है।
   - **25 मिनट** के बाद Copilot टोकन को रिफ्रेश करती है (क्योंकि टोकन एक्सपायर हो जाते हैं)।

3. **Copilot API इंटरैक्शन (`copilot()`)**
   - Copilot के API को एक **प्रॉम्प्ट** (कोड स्निपेट) भेजती है।
   - जनरेट की गई कम्प्लीशन को **स्ट्रीमिंग मोड** (लाइन-बाय-लाइन) में रिटर्न करती है।
   - एरर्स (जैसे, इनवैलिड/एक्सपायर्ड टोकन) को हैंडल करती है।

4. **HTTP सर्वर (`HTTPRequestHandler`)**
   - **POST रिक्वेस्ट्स** (जैसे, लोकल एडिटर से) के लिए लिसन करती है।
   - रिक्वेस्ट से `prompt` और `language` को एक्सट्रैक्ट करती है।
   - `copilot()` को कॉल करती है और कम्प्लीशन को प्लेन टेक्स्ट के रूप में रिटर्न करती है।

5. **मुख्य फ़ंक्शन (`main()`)**
   - **टोकन रिफ्रेश थ्रेड** को स्टार्ट करती है।
   - एक निर्दिष्ट पोर्ट (डिफ़ॉल्ट: `8080`) पर एक **HTTP सर्वर** लॉन्च करती है।

---

### **यह कैसे काम करती है: चरण-दर-चरण**
1. **पहली बार रन करने पर (कोई टोकन नहीं)**
   - स्क्रिप्ट OAuth के माध्यम से ऑथेंटिकेट करने के लिए `setup()` को कॉल करती है।
   - यूज़र GitHub पर जाता है, एक कोड एंटर करता है, और एक्सेस ग्रांट करता है।
   - स्क्रिप्ट एक्सेस टोकन को `.copilot_token` में सेव कर देती है।

2. **बाद के रन (टोकन मौजूद)**
   - स्क्रिप्ट `.copilot_token` को पढ़ती है और एक Copilot सत्र टोकन फ़ेच करती है।
   - यदि टोकन एक्सपायर हो गया है, तो यह स्वचालित रूप से रिफ्रेश हो जाता है।

3. **रिक्वेस्ट्स को हैंडल करना**
   - एक लोकल एडिटर (जैसे, Neovim) एक कोड स्निपेट के साथ **POST रिक्वेस्ट** भेजता है।
   - स्क्रिप्ट प्रॉम्प्ट को Copilot के API को फॉरवर्ड करती है।
   - कम्प्लीशन एडिटर को वापस भेज दी जाती है।

4. **टोकन मैनेजमेंट**
   - एक बैकग्राउंड थ्रेड एक्सपायरेशन से बचने के लिए हर **25 मिनट** में टोकन को रिफ्रेश करती है।

---

### **यह क्यों बनाई गई है**
- **ऑफिशियल प्लगइन्स को बायपास करना**: कुछ एडिटर्स (जैसे, Neovim) में ऑफिशियल Copilot सपोर्ट नहीं होता। यह स्क्रिप्ट एक ब्रिज के रूप में काम करती है।
- **लोकल प्रॉक्सी**: टोकन को लोकल रूप से मैनेज करके रेट लिमिट से बचती है।
- **कस्टमाइज़ेशन**: इसे अलग-अलग एडिटर्स या APIs के साथ काम करने के लिए मॉडिफाई किया जा सकता है।

---

### **सुरक्षा और नैतिक विचार**
- **हार्डकोडेड क्लाइंट ID**: स्क्रिप्ट GitHub Copilot के ऑफिशियल `client_id` (`Iv1.b507a08c87ecfe98`) का उपयोग करती है, जो GitHub की ToS का उल्लंघन हो सकता है यदि इसे अप्रूव्ड प्लगइन्स के बाहर इस्तेमाल किया जाता है।
- **टोकन स्टोरेज**: एक्सेस टोकन प्लेनटेक्स्ट (`.copilot_token`) में स्टोर रहता है, जो एक सुरक्षा जोखिम है।
- **रेट लिमिट**: लगातार रिक्वेस्ट्स GitHub के अब्यूस डिटेक्शन को ट्रिगर कर सकती हैं।

---
### **उपयोग कैसे करें**
1. स्क्रिप्ट को रन करें:
   ```sh
   python copilot_proxy.py [PORT]
   ```
   (डिफ़ॉल्ट पोर्ट: `8080`)

2. अपने एडिटर को कॉन्फ़िगर करें ताकि वह `http://localhost:8080` पर एक JSON पेलोड के साथ रिक्वेस्ट भेजे, जैसे:
   ```json
   {
     "prompt": "def hello_world():",
     "language": "python"
   }
   ```

3. स्क्रिप्ट Copilot की कम्प्लीशन रिटर्न करेगी।

---
### **संभावित सुधार**
- **बेहतर एरर हैंडलिंग**: फेल्ड रिक्वेस्ट्स को रिट्राई करना, नेटवर्क इश्यूज़ को हैंडल करना।
- **सिक्योर टोकन स्टोरेज**: एन्क्रिप्टेड स्टोरेज या एनवायरनमेंट वेरिएबल्स का उपयोग करना।
- **कॉन्फ़िगरेशन फ़ाइल**: `client_id`, `port`, आदि को कस्टमाइज़ करने की अनुमति देना।
- **लॉगिंग**: ट्रबलशूटिंग के लिए डीबग लॉग्स जोड़ना।

---
### **विकल्प**
- **ऑफिशियल Copilot प्लगइन्स** (VS Code, JetBrains, आदि) का उपयोग करें।
- **ओपन-सोर्स विकल्प** जैसे **Codeium** या **Tabby** आज़माएँ।

यह स्क्रिप्ट एक चतुर वर्कअराउंड है लेकिन संभावित ToS उल्लंघनों के कारण इसे सावधानी से उपयोग करना चाहिए।