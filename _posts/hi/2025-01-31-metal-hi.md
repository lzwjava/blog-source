---
audio: false
lang: hi
layout: post
title: लोहा
translated: true
---

नीचे PyTorch का उपयोग करके Metal (GPU) की प्रदर्शन परीक्षा करने के लिए एक स्क्रिप्ट है।

```python
import torch
import argparse
import time

parser = argparse.ArgumentParser(description="Test torch with MPS or CPU.")
parser.add_argument("--device", type=str, default="mps", choices=["mps", "cpu"], help="Device to use (mps or cpu)")
args = parser.parse_args()

if args.device == "mps":
    if torch.backends.mps.is_available():
        print("Metal उपलब्ध है")
        device = torch.device("mps")
    else:
        print("Metal उपलब्ध नहीं है, CPU का उपयोग किया जा रहा है")
        device = torch.device("cpu")
elif args.device == "cpu":
    device = torch.device("cpu")
    print("CPU का उपयोग किया जा रहा है")
else:
    print("अवैध डिवाइस निर्दिष्ट, CPU का उपयोग किया जा रहा है")
    device = torch.device("cpu")

# एक टेंसर बनायें और इसे निर्दिष्ट डिवाइस पर ले जायें
x = torch.randn(5000, 5000, device=device)
y = torch.randn(5000, 5000, device=device)

# एक अधिक जटिल गणना करें
start_time = time.time()
result = torch.matmul(x, y)
for _ in range(10):
    result = torch.matmul(result, y)
end_time = time.time()

# परिणाम प्रिंट करें
print(result)
print(f"समय लिया गया: {end_time - start_time:.4f} सेकंड")
```

नतिजे दर्शाते हैं कि MPS CPU से काफी तेज़ है। MPS पर निर्वाहन समय CPU समय का केवल लगभग 0.2% है।

```bash
% python scripts/test_metal.py --device cpu
समय लिया गया: 2.8784 सेकंड

% python scripts/test_metal.py --device mps
समय लिया गया: 0.0061 सेकंड
```