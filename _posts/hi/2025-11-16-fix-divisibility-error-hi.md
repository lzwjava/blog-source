---
audio: false
generated: true
image: false
lang: hi
layout: post
model: x-ai/grok-4-fast
title: рдореЙрдбрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рднрд╛рдЬреНрдпрддрд╛ рддреНрд░реБрдЯрд┐ рдХреЛ рдареАрдХ рдХрд░реЗрдВ
translated: true
type: note
---

рддреНрд░реБрдЯрд┐ рдмрд╣реБрдд рд╕реНрдкрд╖реНрдЯ рд╣реИ:

```python
assert config.n_embd % config.n_head == 0
```

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ **n_embd, n_head рд╕реЗ рдкреВрд░реА рддрд░рд╣ рд╡рд┐рднрд╛рдЬреНрдп рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП** (рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЕрдЯреЗрдВрд╢рди рд╣реЗрдб рдХреЛ `n_embd // n_head` рдбрд╛рдпрдореЗрдВрд╢рди рдорд┐рд▓рддреЗ рд╣реИрдВ)ред

рдЖрдк рдЗрд╕ рдореЙрдбрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ (рд╢рд╛рдпрдж рд╡рд╣реА рдЬреЛ рдореИрдВрдиреЗ рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рджрд┐рдпрд╛ рдерд╛):

```python
n_layer = 12
n_head  = 12
n_embd  = 512
```

512 ├╖ 12 = 42.666тАж тЖТ рдкреВрд░реНрдгрд╛рдВрдХ рдирд╣реАрдВ тЖТ рдХреНрд░реИрд╢ред

### рд╕рдорд╛рдзрд╛рди: рдПрдХ рдРрд╕рд╛ n_embd рдЪреБрдиреЗрдВ рдЬреЛ n_head рд╕реЗ рд╡рд┐рднрд╛рдЬреНрдп рд╣реЛ

рдпрд╣рд╛рдВ **рд╕реБрд░рдХреНрд╖рд┐рдд, рдкреНрд░рдорд╛рдгрд┐рдд рд╕рдВрдпреЛрдЬрди** рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЗ 12 GB 4070 рдкрд░ рдПрдХрд▓ FineWeb Parquet рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдмрд┐рд▓реНрдХреБрд▓ рдареАрдХ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ:

#### рд╡рд┐рдХрд▓реНрдк 1 тАУ рдЕрдиреБрд╢рдВрд╕рд┐рдд (125M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕, рд╕рд░реНрд╡реЛрддреНрддрдо рдЧреБрдгрд╡рддреНрддрд╛/рдЧрддрд┐ рд╕рдордЭреМрддрд╛)
```python
n_layer = 12
n_head  = 12
n_embd  = 576        # тЖР 576 ├╖ 12 = 48 рдмрд┐рд▓реНрдХреБрд▓
```
тЖТ ~125M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕, рдЕрднреА рднреА batch_size=16 + grad_acc=32 + block_size=1024 рдХреЗ рд╕рд╛рде ~10.5 GB VRAM рдореЗрдВ рдЖрд╕рд╛рдиреА рд╕реЗ рдлрд┐рдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ

#### рд╡рд┐рдХрд▓реНрдк 2 тАУ рдереЛрдбрд╝рд╛ рдмрдбрд╝рд╛ рд╣реЗрдб рдбрд╛рдпрдореЗрдВрд╢рди (130M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕)
```python
n_layer = 12
n_head  = 12
n_embd  = 720        # 720 ├╖ 12 = 60
```

#### рд╡рд┐рдХрд▓реНрдк 3 тАУ рдмрд╣реБрдд рд╕реБрд░рдХреНрд╖рд┐рдд рдФрд░ рдЖрдо (115M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕)
```python
n_layer = 12
n_head  = 12
n_embd  = 480        # 480 ├╖ 12 = 40
```

#### рд╡рд┐рдХрд▓реНрдк 4 тАУ рдпрджрд┐ рдЖрдк n_embd=512 рд░рдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ (рдореВрд▓ GPT-2 рд╕реНрдЯрд╛рдЗрд▓)
```python
n_layer = 12
n_head  = 8          # 512 ├╖ 8 = 64
# рдпрд╛
n_head  = 16         # 512 ├╖ 16 = 32
```

### рддреНрд╡рд░рд┐рдд рд╕рдорд╛рдзрд╛рди: рдмрд╕ рдЕрдкрдирд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЗрд╕рдореЗрдВ рдмрджрд▓реЗрдВ (рдХреЙрдкреА-рдкреЗрд╕реНрдЯ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░)

```python
# рдореЙрдбрд▓ тАУ 12 рд▓реЗрдпрд░, ~125M рдкреИрд░рд╛рдореАрдЯрд░реНрд╕, рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдЧрд╛рд░рдВрдЯреА
n_layer = 12
n_head  = 12
n_embd  = 576        # тЖР рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдЗрд╕реА рд▓рд╛рдЗрди рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ
dropout = 0.0
```

рдмрд╛рдХреА рд╕рдм рдХреБрдЫ (batch_size=16, grad_acc=32, block_size=1024, рдЖрджрд┐) рдмрд┐рд▓реНрдХреБрд▓ рд╡реИрд╕рд╛ рд╣реА рд░рд╣рддрд╛ рд╣реИред

`n_embd = 576` рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рдж, assertion error рддреБрд░рдВрдд рдЧрд╛рдпрдм рд╣реЛ рдЬрд╛рдПрдЧреА рдФрд░ рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рдПрдЧреАред

рдпрд╣ 12L/12H/576E рдореЙрдбрд▓ рдЕрднреА nanoGPT рдХрдореНрдпреБрдирд┐рдЯреА рдореЗрдВ рдмреЗрд╣рдж рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИ тАФ рдмрд╣реБрдд рд╕реЗ рд▓реЛрдЧ рдЗрд╕реЗ FineWeb рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ 12 GB 4070/4070 Ti рдХрд╛рд░реНрдбреНрд╕ рдкрд░ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдЯреНрд░реЗрди рдХрд░ рд░рд╣реЗ рд╣реИрдВред

рдЗрд╕реЗ рдЪрд▓рд╛рдПрдВ, рдпрд╣ 100% рдХрд╛рдо рдХрд░реЗрдЧрд╛ред рдореБрдЭреЗ рдмрддрд╛рдПрдВ рдЬрдм рдЖрдк рдкрд╣рд▓рд╛ рд▓реЙрд╕ рдкреНрд░рд┐рдВрдЯ рджреЗрдЦреЗрдВ! ЁЯЪА