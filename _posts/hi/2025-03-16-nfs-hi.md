---
audio: false
generated: true
lang: hi
layout: post
title: यूबंटू पर मीडिया साझाकरण के लिए एनएफएस सर्वर स्थापित करना
translated: true
type: note
---

Ubuntu पर मीडिया फ़ाइलों को सर्व करने के लिए NFS (नेटवर्क फ़ाइल सिस्टम) सर्वर सेट करने के लिए, इन विस्तृत चरणों का पालन करें। यह गाइड मानती है कि आप अपने नेटवर्क पर मीडिया फ़ाइलों (जैसे वीडियो, संगीत) वाली एक डायरेक्टरी को सुरक्षित और कुशलता से शेयर करना चाहते हैं।

---

### चरण 1: NFS सर्वर सॉफ़्टवेयर इंस्टॉल करें
सबसे पहले, आपको अपने Ubuntu सिस्टम पर NFS सर्वर पैकेज इंस्टॉल करना होगा।

1. पैकेज सूची को अपडेट करें ताकि आपको नवीनतम वर्ज़न मिल सकें:
   ```bash
   sudo apt update
   ```

2. `nfs-kernel-server` पैकेज इंस्टॉल करें, जो NFS सर्वर की कार्यक्षमता प्रदान करता है:
   ```bash
   sudo apt install nfs-kernel-server
   ```

यह NFS सर्वर चलाने के लिए आवश्यक सॉफ़्टवेयर इंस्टॉल करता है।

---

### चरण 2: मीडिया डायरेक्टरी बनाएँ और कॉन्फ़िगर करें
आपको अपनी मीडिया फ़ाइलों को संग्रहीत करने और उन्हें शेयरिंग के लिए कॉन्फ़िगर करने के लिए एक डायरेक्टरी की आवश्यकता है।

1. अपनी मीडिया फ़ाइलों को रखने के लिए एक डायरेक्टरी बनाएँ (उदाहरण के लिए, `/media/share`):
   ```bash
   sudo mkdir -p /media/share
   ```

2. स्वामित्व को अपने यूज़र अकाउंट में बदलें (यदि आवश्यक हो तो `$USER` को अपने वास्तविक यूज़रनेम से बदलें):
   ```bash
   sudo chown $USER:$USER /media/share
   ```

3. एक्सेस की अनुमति देने के लिए अनुमतियाँ समायोजित करें। यदि क्लाइंट्स के लिए मीडिया फ़ाइलें मुख्य रूप से रीड-ओनली हैं, तो आप सेट कर सकते हैं:
   - डायरेक्टरीज़: `755` (दूसरों के लिए पढ़ने और एक्ज़िक्यूट करने की अनुमति)
   - फ़ाइलें: `644` (दूसरों के लिए पढ़ने की अनुमति)
   हालाँकि, सरलता के लिए, यदि आपको बारीक नियंत्रण की आवश्यकता नहीं है तो `755` को रिकर्सिवली लागू करें:
   ```bash
   sudo chmod -R 755 /media/share
   ```
   - **नोट**: मीडिया फ़ाइलों को एक्ज़िक्यूटेबल होने की आवश्यकता नहीं है, लेकिन फ़ाइलों पर `755` NFS कार्यक्षमता को नुकसान नहीं पहुँचाएगा क्योंकि एक्ज़िक्यूशन क्लाइंट पर स्थानीय रूप से होता है।

4. अपनी मीडिया फ़ाइलों को `/media/share` में रखें (उदाहरण के लिए, वीडियो या संगीत को इस डायरेक्टरी में कॉपी करें)।

---

### चरण 3: NFS एक्सपोर्ट्स कॉन्फ़िगर करें
NFS सर्वर यह परिभाषित करने के लिए `/etc/exports` फ़ाइल का उपयोग करता है कि कौन सी डायरेक्टरी शेयर करनी है और उन्हें कौन एक्सेस कर सकता है।

1. एक टेक्स्ट एडिटर के साथ एक्सपोर्ट्स फ़ाइल खोलें:
   ```bash
   sudo nano /etc/exports
   ```

2. `/media/share` को शेयर करने के लिए एक लाइन जोड़ें। सिंटैक्स है:
   ```
   /path/to/directory client(options)
   ```
   - **उदाहरण 1**: किसी विशिष्ट क्लाइंट IP (जैसे `192.168.1.100`) के साथ रीड-राइट एक्सेस शेयर करें:
     ```
     /media/share 192.168.1.100(rw,sync,no_subtree_check)
     ```
   - **उदाहरण 2**: अपने सबनेट (जैसे `192.168.1.0/24`) पर सभी डिवाइसों के साथ रीड-ओनली एक्सेस शेयर करें:
     ```
     /media/share 192.168.1.0/24(ro,sync,no_subtree_check)
     ```
   - **उदाहरण 3**: किसी भी डिवाइस के साथ शेयर करें (कम सुरक्षित, सावधानी से उपयोग करें):
     ```
     /media/share *(rw,sync,no_subtree_check)
     ```

   **विकल्पों की व्याख्या**:
   - `rw`: रीड-राइट एक्सेस (यदि मीडिया स्ट्रीमिंग के लिए प्राथमिक है तो `ro` का उपयोग करें)।
   - `sync`: सुनिश्चित करता है कि ऑपरेशन्स की पुष्टि करने से पहले डेटा डिस्क पर लिखा जाता है (अधिक सुरक्षित लेकिन धीमा; क्रैश में डेटा लॉस के जोखिम पर परफॉर्मेंस के लिए `async` का उपयोग करें)।
   - `no_subtree_check`: सबट्री चेकिंग को डिसेबल करके परफॉर्मेंस में सुधार करता है (अधिकांश सेटअप के लिए अनुशंसित)।

3. फ़ाइल सेव करें (nano में `Ctrl+O`, फिर `Enter`) और बाहर निकलें (`Ctrl+X`)।

---

### चरण 4: NFS कॉन्फ़िगरेशन लागू करें
एक्सपोर्ट्स फ़ाइल को एडिट करने के बाद, अपने परिवर्तनों को प्रतिबिंबित करने के लिए NFS सर्वर को अपडेट करें।

1. शेयर्स को एक्सपोर्ट करें:
   ```bash
   sudo exportfs -a
   ```

2. कॉन्फ़िगरेशन लागू करने के लिए NFS सर्वर को रीस्टार्ट करें:
   ```bash
   sudo systemctl restart nfs-kernel-server
   ```

3. सत्यापित करें कि सेवा चल रही है:
   ```bash
   sudo systemctl status nfs-kernel-server
   ```
   - आउटपुट में "active (running)" देखें।

4. एक्सपोर्ट की गई डायरेक्टरीज़ की जाँच करें:
   ```bash
   sudo exportfs -v
   ```
   - यह आपके द्वारा निर्दिष्ट विकल्पों के साथ `/media/share` को सूचीबद्ध करना चाहिए।

---

### चरण 5: फ़ायरवॉल कॉन्फ़िगर करें
NFS विशिष्ट पोर्ट्स का उपयोग करता है, और आपको यह सुनिश्चित करने की आवश्यकता है कि आपका फ़ायरवॉल उन पर ट्रैफ़िक की अनुमति देता है। Ubuntu अक्सर UFW (Uncomplicated Firewall) का उपयोग करता है।

1. **डिफ़ॉल्ट NFS पोर्ट्स**:
   - NFS: 2049 (TCP/UDP)
   - RPC: 111 (TCP/UDP)
   - अन्य सेवाएँ (mountd, statd, lockd): डिफ़ॉल्ट रूप से डायनामिक, लेकिन स्टैटिक पोर्ट्स पर सेट की जा सकती हैं।

2. सरलता के लिए, आवश्यक पोर्ट्स को डायनामिक सेटिंग्स के साथ अनुमति दें (यदि आप स्टैटिक पोर्ट्स सेट नहीं करते हैं):
   ```bash
   sudo ufw allow 2049
   sudo ufw allow 111
   ```
   - **नोट**: यदि mountd, statd, या lockd रैंडम पोर्ट्स का उपयोग करते हैं तो यह सभी NFS ट्रैफ़िक को कवर नहीं कर सकता है।

3. **वैकल्पिक: बेहतर नियंत्रण के लिए स्टैटिक पोर्ट्स सेट करें** (सटीक फ़ायरवॉल नियमों के लिए अनुशंसित):
   - `/etc/default/nfs-kernel-server` एडिट करें:
     ```bash
     sudo nano /etc/default/nfs-kernel-server
     ```
     जोड़ें या संशोधित करें:
     ```
     RPCMOUNTDOPTS="-p 4001"
     ```
   - `/etc/default/nfs-common` एडिट करें:
     ```bash
     sudo nano /etc/default/nfs-common
     ```
     जोड़ें या संशोधित करें:
     ```
     STATDOPTS="-p 4002"
     ```
   - lockd के लिए `/etc/modprobe.d/nfs.conf` बनाएँ:
     ```bash
     sudo nano /etc/modprobe.d/nfs.conf
     ```
     जोड़ें:
     ```
     options lockd nlm_udp_port=4003 nlm_tcp_port=4003
     ```
   - NFS सर्वर को रीस्टार्ट करें:
     ```bash
     sudo systemctl restart nfs-kernel-server
     ```

4. UFW में स्टैटिक पोर्ट्स की अनुमति दें:
   ```bash
   sudo ufw allow 2049/tcp
   sudo ufw allow 2049/udp
   sudo ufw allow 111/tcp
   sudo ufw allow 111/udp
   sudo ufw allow 4001/tcp
   sudo ufw allow 4001/udp
   sudo ufw allow 4002/tcp
   sudo ufw allow 4002/udp
   sudo ufw allow 4003/tcp
   sudo ufw allow 4003/udp
   ```

5. UFW को सक्षम करें यदि यह पहले से सक्रिय नहीं है:
   ```bash
   sudo ufw enable
   ```

---

### चरण 6: सेटअप सत्यापित करें
सुनिश्चित करें कि NFS सर्वर सही ढंग से काम कर रहा है।

1. सर्वर से एक्सपोर्ट किए गए शेयर्स की जाँच करें:
   ```bash
   showmount -e localhost
   ```
   - आपको सही क्लाइंट्स/विकल्पों के साथ `/media/share` सूचीबद्ध दिखना चाहिए।

2. लिसनिंग पोर्ट्स सत्यापित करें:
   ```bash
   sudo ss -tuln | grep -E "2049|111|4001|4002|4003"
   ```
   - पुष्टि करें कि ये पोर्ट्स खुले हैं और NFS सेवाओं से बाउंड हैं।

---

### चरण 7: एक क्लाइंट से टेस्ट करें (वैकल्पिक)
एक क्लाइंट मशीन पर (उदाहरण के लिए, कोई अन्य Ubuntu सिस्टम), शेयर को माउंट करने का टेस्ट करें:
```bash
sudo mount -t nfs <server_ip>:/media/share /mnt
```
- `<server_ip>` को अपने NFS सर्वर के IP एड्रेस से बदलें।
- सुनिश्चित करें कि `/mnt` मौजूद है (यदि आवश्यक हो तो `sudo mkdir /mnt`)।
- `/mnt` तक पहुँचें ताकि सत्यापित कर सकें कि आप मीडिया फ़ाइलों को देख और चला सकते हैं।

---

### मीडिया फ़ाइलों के लिए अतिरिक्त नोट्स
- **रीड-ओनली एक्सेस**: यदि क्लाइंट्स को केवल मीडिया स्ट्रीम करने की आवश्यकता है, तो संशोधनों को रोकने के लिए `/etc/exports` में `ro` का उपयोग करें।
- **अनुमतियाँ**: सुनिश्चित करें कि मीडिया फ़ाइलें क्लाइंट्स द्वारा पढ़ने योग्य हैं। सर्वर और क्लाइंट के बीच UID/GID का मिसमैच एक्सेस समस्याएँ पैदा कर सकता है; यदि आवश्यक हो तो फ़ाइल अनुमतियाँ समायोजित करें या NFS विकल्पों जैसे `all_squash` का उपयोग करें (एडवांस्ड)।
- **परफॉर्मेंस**: बड़ी मीडिया फ़ाइलों के लिए, डिफ़ॉल्ट `sync` विकल्प सुरक्षित लेकिन धीमा है। यदि परफॉर्मेंस प्राथमिकता है और डेटा लॉस का जोखिम स्वीकार्य है तो `async` के साथ टेस्ट करें।
- **NFS वर्ज़न**: Ubuntu डिफ़ॉल्ट रूप से NFSv4 का उपयोग करता है, जो मीडिया सर्विंग के लिए उपयुक्त है। पुराने क्लाइंट्स (NFSv3) को सपोर्ट करने के लिए आमतौर पर कोई अतिरिक्त कॉन्फ़िगरेशन आवश्यक नहीं है।

---

### कमांड्स का सारांश
यहाँ बेसिक सेटअप (स्टैटिक पोर्ट्स के बिना) के लिए एक त्वरित संदर्भ दिया गया है:
```bash
sudo apt update
sudo apt install nfs-kernel-server
sudo mkdir -p /media/share
sudo chown $USER:$USER /media/share
sudo chmod -R 755 /media/share
echo "/media/share *(rw,sync,no_subtree_check)" | sudo tee -a /etc/exports
sudo exportfs -a
sudo systemctl restart nfs-kernel-server
sudo ufw allow 2049
sudo ufw allow 111
```

इस सेटअप के साथ, आपका Ubuntu NFS सर्वर नेटवर्क पर मीडिया फ़ाइलों को सर्व करने के लिए तैयार होना चाहिए। अपनी सुरक्षा और नेटवर्क आवश्यकताओं के आधार पर IP एड्रेस, अनुमतियाँ और फ़ायरवॉल नियम समायोजित करें।