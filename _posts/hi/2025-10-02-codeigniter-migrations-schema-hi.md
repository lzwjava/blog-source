---
audio: false
generated: true
image: false
lang: hi
layout: post
model: x-ai/grok-code-fast-1
title: CodeIgniter माइग्रेशन डेटाबेस स्कीमा प्रबंधन
translated: true
type: note
---

### कोडइग्नाइटर माइग्रेशन क्या हैं?

कोडइग्नाइटर (CI) माइग्रेशन एक ऐसी सुविधा है जो डेटाबेस स्कीमा परिवर्तनों को एक वर्जन-नियंत्रित तरीके से प्रबंधित करने में मदद करती है, जो Flyway या Liquibase जैसे टूल्स के समान है। यह आपको PHP स्क्रिप्ट लिखने की अनुमति देती है जो डेटाबेस परिवर्तनों को परिभाषित करती हैं (जैसे, टेबल बनाना, कॉलम जोड़ना, या डेटा संशोधित करना), और फिर विभिन्न वातावरणों में अपनी स्कीमा को अप-टू-डेट रखने के लिए उन्हें क्रम में चलाती हैं। यह मैन्युअल SQL त्रुटियों को रोकता है और रोलबैक का समर्थन करता है।

माइग्रेशन निम्नलिखित तरीके से काम करते हैं:
- माइग्रेशन फाइलों को एक डायरेक्टरी में संग्रहीत करना (डिफ़ॉल्ट: `application/migrations/`)।
- यह ट्रैक करना कि कौन से माइग्रेशन लागू किए गए हैं, इसके लिए एक डेटाबेस टेबल में "संस्करण" संग्रहीत करना।
- आपकी आवश्यकताओं के आधार पर स्क्रिप्ट को आगे (up) या पीछे (down) चलाना।

आपने जो कॉन्फ़िग फाइल साझा की है (`migration.php`) वह नियंत्रित करती है कि माइग्रेशन कैसे व्यवहार करते हैं। यह विकल्पों को सेट करने के लिए PHP arrays का उपयोग करती है। नीचे, मैं उदाहरणों के साथ प्रमुख सेटिंग्स की व्याख्या करूंगा।

### प्रमुख कॉन्फ़िगरेशन सेटिंग्स

| सेटिंग | आपके कोड में मान | व्याख्या | यह कैसे काम करती है |
|---------|---------------------|-------------|-------------|
| `migration_enabled` | `FALSE` | माइग्रेशन को वैश्विक रूप से सक्षम या अक्षम करता है। जब `FALSE` होता है, तो आप माइग्रेशन नहीं चला सकते (सुरक्षा के लिए, क्योंकि वे DB को संशोधित करते हैं)। | CI कोई भी माइग्रेशन कमांड निष्पादित करने से पहले इसकी जांच करता है। विकास के दौरान `TRUE` पर सेट करें, फिर प्रोडक्शन में `FALSE` पर वापस सेट कर दें। उदाहरण: यदि सक्षम है, तो कंट्रोलर में `$this->migration->current()` के माध्यम से चलाएं। |
| `migration_type` | `'timestamp'` | फाइल नामकरण शैली: `'sequential'` (जैसे, `001_add_blog.php`) या `'timestamp'` (जैसे, `20121031104401_add_blog.php`)। बेहतर वर्जन कंट्रोल के लिए टाइमस्टैम्प की सिफारिश की जाती है। | फाइलें कालानुक्रमिक क्रम में लोड होती हैं। टाइमस्टैम्प `YYYYMMDDHHIISS` फॉर्मेट का उपयोग करता है (जैसे, 31 अक्टूबर, 2012, 10:44:01 के लिए `20121031104401`)। |
| `migration_table` | `'migrations'` | उस DB टेबल का नाम जो लागू किए गए माइग्रेशन को ट्रैक करती है। आवश्यक। | यदि यह टेबल मौजूद नहीं है तो CI इसे बनाता है। यह नवीनतम माइग्रेशन वर्जन संग्रहीत करती है। इस टेबल को हटाने या अपडेट करने से माइग्रेशन इतिहास रीसेट हो जाता है। |
| `migration_auto_latest` | `FALSE` | यदि `TRUE` है और `migration_enabled` `TRUE` है, तो माइग्रेशन लाइब्रेरी के लोड होने पर (जैसे, पेज लोड पर) स्वचालित रूप से नवीनतम वर्जन तक माइग्रेशन चलाता है। | डेव वातावरण में स्कीमा को ऑटो-सिंक करने के लिए उपयोगी। नियंत्रण के लिए मैन्युअल रूप से माइग्रेशन चलाने के लिए `FALSE` सेट करें (प्रोड में अधिक सुरक्षित)। |
| `migration_version` | `0` | लक्षित वर्जन/नंबर जिस तक माइग्रेट करना है। फाइलनेम प्रीफिक्स पर सेट करें (जैसे, `20121031104401`)। `0` का मतलब है कि कोई माइग्रेशन लागू नहीं किया गया है। | `$this->migration->version(20121031104401)` चलाने से उस बिंदु तक माइग्रेट हो जाता है। लक्षित रोलबैक के लिए उपयोग किया जाता है—नकारात्मक संख्याएं डाउनग्रेड करती हैं। |
| `migration_path` | `APPPATH.'migrations/'` | वह डायरेक्टरी जहां माइग्रेशन फाइलें संग्रहीत हैं। `APPPATH` एक CI constant है जो `application/` की ओर इशारा करती है। | CI नामकरण परंपरा से मेल खाने वाली PHP फाइलों के लिए इस फोल्डर को स्कैन करता है। वेब सर्वर द्वारा लिखने योग्य होना चाहिए। `BASEPATH.'custom/migrations/'` जैसे कस्टम पथ संभव हैं। |

### माइग्रेशन का उपयोग कैसे करें (चरण-दर-चरण)

1. **माइग्रेशन सक्षम करें**: कॉन्फ़िग फाइल में अस्थायी रूप से `$config['migration_enabled'] = TRUE;` सेट करें।

2. **एक माइग्रेशन फाइल बनाएं**: `application/migrations/` में `20121031104401_add_blog.php` जैसे नाम की एक PHP फाइल जोड़ें। इसके अंदर, CI की Migration class का उपयोग करें:
   ```php
   defined('BASEPATH') OR exit('No direct script access allowed');

   class Migration_Add_blog extends CI_Migration {
       public function up() {
           $this->dbforge->add_field('id');
           $this->dbforge->create_table('blogs');
       }

       public function down() {
           $this->dbforge->drop_table('blogs');
       }
   }
   ```
   - `up()` परिवर्तनों को लागू करता है (जैसे, टेबल बनाना)।
   - `down()` उन्हें पूर्ववत करता है (जैसे, टेबल हटाना)।

3. **माइग्रेशन चलाएं**:
   - लाइब्रेरी लोड करें: `$this->load->library('migration');`
   - नवीनतम तक: `$this->migration->current();`
   - विशिष्ट तक: `$this->migration->version('20121031104401');`
   - कमांड लाइन से (यदि CLI सक्षम है): `php index.php migrate current`

4. **सामान्य कमांड**:
   - `$this->migration->latest()`: `current()` के लिए उपनाम।
   - `$this->migration->find_migratables()`: उपलब्ध फाइलों की सूची बनाता है।
   त्रुटियां CI की लॉग फाइलों में लॉग होती हैं या एक्सेप्शन फेंकती हैं।

5. **सर्वोत्तम अभ्यास**:
   - माइग्रेशन को इडेम्पोटेंट रखें (दोबारा चलाने के लिए सुरक्षित)।
   - पहले डेव में परीक्षण करें; आकस्मिक स्कीमा परिवर्तनों को रोकने के लिए प्रोडक्शन में ऑटो-माइग्रेट सक्षम करने से बचें।
   - यदि आपका DB एटॉमिक परिवर्तनों के लिए ट्रांजैक्शन का समर्थन करता है तो उनका उपयोग करें।
   - उपयोग के बाद अक्षम करें: सुरक्षा के लिए वापस `FALSE` पर सेट करें।

यदि आपको कोई समस्या आती है (जैसे, पथ पर अनुमतियाँ), तो CI की लॉग या [codeigniter.com/user_guide/libraries/migration.html](https://codeigniter.com/user_guide/libraries/migration.html) पर दस्तावेज़ देखें। अधिक अनुरूप सलाह के लिए अपना CI वर्जन निर्दिष्ट करें!