---
audio: false
generated: true
image: false
lang: ja
layout: post
model: x-ai/grok-4-fast
title: WindowsでのVim貼り付け
translated: true
type: note
---

## Windows の Git Bash における Vim の貼り付け

ああ、なるほど—Git Bash（Windows 上で動作）における Vim の `p` コマンドは、システムクリップボードや外部テキストを扱う際に、特に扱いにくくなる場合があります。これはよくある落とし穴です。なぜなら、Git Bash はターミナルエミュレータとして MinTTY を使用しており、Vim のデフォルトの動作が Windows のクリップボードと常にうまく連携するわけではないからです。`p` コマンドは、Vim の*内部*ヤンクバッファ（同じ Vim セッション内で `y` を使ってコピーしたもの）からのみ貼り付けます。Vim の外部からのもの（Notepad やブラウザからのコピーなど）については、ターミナルの貼り付け機能またはクリップボード連携が必要です。

心配ありません—ここでは、あなたの「すべて選択、削除、新しいテキストへの貼り付け」というワークフローに合わせて、段階的に対処方法を説明します。内部的な貼り付け（既に動作するはず）と外部からの貼り付けの両方をカバーします。

### 簡単な確認: あなたの Vim はシステムクリップボードをサポートしていますか？
まず、あなたの Vim が Windows クリップボードに直接アクセスできるか確認してください（これで多くの問題が解決します）：
1.  Git Bash を開きます。
2.  `vim --version | grep clipboard` を実行します（または、`vim` で Vim を開き、`:version` と入力して `+clipboard` を探します）。
    - `+clipboard` と表示されれば問題ありません—Windows クリップボードからの貼り付けに `"+p` を使用できます。
    - `-clipboard` または何も表示されない場合は、サポートされていません（Git Bash にバンドルされている Vim では一般的）。以下のターミナル貼り付け方法に進んでください。

サポートされていない場合は、Windows 用の完全な Vim（例: Chocolatey 経由: `choco install vim`）をインストールするか、より良い統合のために Neovim/WSL を使用することを検討してください。

### 1. 内部的な貼り付け（Vim 内でのヤンク、同じセッション内での貼り付け）
これは、以前の説明が対象としていたもの—Vim の*内部*でコピーし、*同じ*セッション内の新しいファイルに貼り付ける—です。ここでは `p` は問題なく動作するはずで、Git Bash の特殊性は関係ありません：
- `oldfile.txt` 内: `gg`（先頭に移動）、`yG`（すべてヤンク）。
- `:e newfile.txt`（同じ Vim で新しいファイルを開く）。
- `p`（貼り付け）。カーソルの直後に内容が挿入されます。
- `:wq` で保存。

もし `p` がまだ失敗する（何も貼り付けられない、または文字化けする）場合は、ヤンクの問題かもしれません—クリップボードがサポートされている場合は、`yG` の代わりに `"+yG` を試し、その後 `"+p` を実行してください。

### 2. 外部テキストを Vim に貼り付ける（Windows アプリから）
外部からコピーしている場合（例: Notepad ですべて選択、Ctrl+C、その後 Vim に貼り付けたい）：
- **方法 1: Git Bash の組み込み貼り付けを使用する（最も簡単、Vim の変更不要）**
  1.  ファイルを開く: `vim newfile.txt`。
  2.  挿入モードに入る: `i` を押す。
  3.  Git Bash ウィンドウ内で右クリック（これにより、Windows クリップボードからターミナル/Vim に直接貼り付けられます）。
      - 代替ショートカット: `Insert` キー、または Git Bash でクイック編集モードを有効にする（タイトルバーを右クリック > オプション > クイック編集）し、Ctrl+Shift+V を使用。
  4.  `Esc` を押して挿入モードを終了。
  - *プロのヒント:* 複数行のテキストを貼り付けたときに表示がおかしい（余分な改行やインデント）場合は、多くの場合 Windows の改行コード（CRLF 対 LF）が原因です。貼り付け前に Vim で `:set ff=unix` を実行するか、貼り付け後に `:%s/\r$//g` を使用してキャリッジリターンを削除することで修正できます。

- **方法 2: +clipboard がサポートされている場合（Vim 内で直接）**
  1.  外部でテキストをコピー（Ctrl+C）。
  2.  Vim コマンドモードで: `"+p`（システムクリップボードからカーソルの後に貼り付け）または `"+P`（前に貼り付け）。
  3.  あなたのワークフローでは: 古いファイルで削除した後、新しいファイルに切り替えて `"+p`。

### 3. Vim から外部へのコピー（Windows へヤンクして持ち出す）
- 内部的なヤンク（`y`）は Vim 内に留まります—外部へコピーするにはターミナルのコピー機能を使用します。
- Vim でテキストを選択: `v`（ビジュアルモード）、カーソルを移動してすべて選択（`ggVG`）、その後 `y`。
- Windows にコピーするには: 右クリック > 編集 > コピー（またはハイライトして右クリック > コピー）。
- +clipboard がある場合: `y` の代わりに `"+y`、その後他の場所で Ctrl+V。

### 一般的な Git Bash + Vim 貼り付け不具合のトラブルシューティング
- **文字化けしたテキスト（例: 行の一部や余分なスペース）:** Vim で bracketed paste を無効にする（挿入モードに入る前に `:set paste`、その後貼り付け、その後 `:set nopaste`）。または、常時有効にするために `~/.vimrc` に `set paste` を追加（ただし、これは自動インデントなどの一部機能を無効にします）。
- **何も貼り付けられない:** ターミナル貼り付けの場合は挿入モードであることを確認—コマンドモードでの `p` は内部的なもののみです。
- **マウスの干渉:** 右クリックで貼り付けではなく選択が行われる場合は、タイトルバーを右クリック > オプション > マウス > クイック編集 で切り替えてください。
- **貼り付け前の全削除について:** あなたのワークフローでは、ヤンク後、新しいファイルをクリアするために `:%d` を使用し、その後貼り付けます。

これでスムーズに貼り付けできるはずです！もしまだ動作しない場合（例: `p` を試したときに具体的に何が起こるか教えてください）、または特に外部ソース*から*貼り付けている場合は、さらに調整するのでお知らせください。

[How do you copy and paste into Git Bash](https://stackoverflow.com/questions/2304372/how-do-you-copy-and-paste-into-git-bash)
[Copying from Windows clipboard in Vim](https://vi.stackexchange.com/questions/37599/copying-from-windows-clipboard)
[How to copy paste contents in the vi editor](https://askubuntu.com/questions/256782/how-to-copy-paste-contents-in-the-vi-editor)