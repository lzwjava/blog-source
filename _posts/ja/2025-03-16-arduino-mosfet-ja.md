---
audio: false
generated: true
lang: ja
layout: post
title: Arduinoで制御するMOSFETスイッチ
translated: true
type: note
---

ご質問に誤解があるかもしれません。Arduinoを使ってMOSFET（金属酸化膜半導体電界効果トランジスタ）を「作る」ことはできません。なぜならMOSFETは、クリーンルーム環境でのフォトリソグラフィやドーピングといった複雑な工程を経て製造される基本的な半導体素子だからです。おそらく「Arduinoを使ってMOSFETを『使用する』回路の構築方法」や「ArduinoプロジェクトでMOSFETを使用する方法」についてお聞きになりたかったのではないでしょうか。もし私の解釈が間違っていたら、どうぞご指摘ください！

ここでは、ArduinoでMOSFETを制御する実用的な回路（単純なスイッチや増幅器など）の使用方法を説明します。MOSFETはスイッチや増幅回路として多用される汎用性の高い部品で、Arduinoのデジタル出力と相性が良いです。以下では、一般的な応用例であるNチャネルMOSFET（例：IRF540や2N7000）をArduinoで制御する高電力スイッチのステップバイステップガイドを提供します。

---

### **プロジェクト：Arduinoで制御するMOSFETスイッチ**

#### **概要**
- **目的：** Arduinoを使用して、MOSFETを介して高電力負荷（LEDストリップ、モーター、ランプなど）のオン/オフを制御する。
- **なぜMOSFET？** BJTとは異なり、MOSFETは電圧制御で、Arduinoからの電流をほとんど必要とせず、Arduinoのピン（最大40mA、5V）よりも高い電流/電圧を扱える。

#### **必要な部品**
- Arduino（例：Uno）
- NチャネルMOSFET（例：IRF540または2N7000；高電力の場合はIRF540）
- 抵抗：R1 = 10kΩ（プルダウン）、R2 = 220Ω（ゲート保護、オプション）
- 負荷：例：12V LEDストリップ、DCモーター、ランプ（適切な電源とともに）
- ダイオード（例：1N4007、モーターなどの誘導性負荷用）
- ブレッドボード、ジャンパーワイヤ
- 外部電源（例：負荷用12V）

#### **回路図**
```
Arduino Pin 9 ---- R2 (220Ω) ---- Gate (G)
                             |
                             |
V_load (例: 12V) ---- 負荷 ---- Drain (D)
                             | 
                             |
                            Source (S) ---- GND
                             |
                            R1 (10kΩ)
                             |
                            GND
```
- **誘導性負荷（例：モーター）の場合：** 負荷の両端にフライバックダイオード（1N4007）を追加（カソードをV_load側、アノードをDrain側）して、MOSFETを電圧スパイクから保護する。
- **電源：** ArduinoはUSBまたは5Vで給電；負荷は外部電源（例：12V）で給電。すべてのGNDを共通接続する。

#### **動作原理**
- **MOSFETの役割：** ドレインとソース間のスイッチとして動作し、ゲート電圧によって制御される。
- **Arduinoの役割：** ピン9を介してゲートにHIGH（5V）またはLOW（0V）信号を出力する。
- **ロジック：**
  - ゲートがHIGH（5V）→ MOSFETがON → 負荷に電力が供給される。
  - ゲートがLOW（0V）→ MOSFETがOFF → 負荷の電力供給が停止する。
- **R1（プルダウン）：** Arduinoの電源がオフの場合やピンが未接続（フローティング）の場合に、ゲートがLOWになることを保証する。
- **R2（オプション）：** ゲートへの電流を制限する（ロジックレベルMOSFETでは通常不要）。

---

### **ステップ1：回路の構築**

1. **MOSFETの接続：**
   - **ゲート (G)：** R2（220Ω、オプション）を介してArduinoのピン9に接続。
   - **ドレイン (D)：** 負荷の負極側（例：LEDストリップのカソード）に接続。
   - **ソース (S)：** GNDに接続。
2. **負荷と電源：**
   - 負荷の正極側をV_load（例：12V電源）に接続。
   - 12V電源のGNDをArduinoのGNDに接続。
3. **安全性：**
   - ゲートとGNDの間にR1（10kΩ）を追加。
   - モーターの場合は、負荷の両端にダイオードを追加。

---

### **ステップ2：Arduinoコード**

#### **単純なオン/オフスイッチ**
```cpp
const int mosfetPin = 9; // PWM対応ピン

void setup() {
  pinMode(mosfetPin, OUTPUT); // ピンを出力に設定
}

void loop() {
  digitalWrite(mosfetPin, HIGH); // MOSFETをON
  delay(1000);                   // 1秒待機
  digitalWrite(mosfetPin, LOW);  // MOSFETをOFF
  delay(1000);                   // 1秒待機
}
```
- **出力：** 負荷が1秒ごとにオンとオフを繰り返す。

#### **PWM調光（LED/モーター用）**
```cpp
const int mosfetPin = 9;

void setup() {
  pinMode(mosfetPin, OUTPUT);
}

void loop() {
  for (int brightness = 0; brightness <= 255; brightness += 5) {
    analogWrite(mosfetPin, brightness); // 明るさを増加
    delay(50);
  }
  for (int brightness = 255; brightness >= 0; brightness -= 5) {
    analogWrite(mosfetPin, brightness); // 明るさを減少
    delay(50);
  }
}
```
- **出力：** 負荷（例：LED）がフェードイン・フェードアウトする。

---

### **ステップ3：テストと検証**

1. **コードのアップロード：** Arduino IDEを使用していずれかのスケッチをアップロード。
2. **電源投入：** ArduinoをUSBで接続し、負荷に外部電源を接続。
3. **観察：**
   - オン/オフコードの場合、負荷は1秒ごとに切り替わるはず。
   - PWMの場合、負荷は徐々に明るくなり、暗くなるはず。
4. **測定：** マルチメーターを使用して確認：
   - ゲートの電圧（0Vまたは5V）。
   - 負荷両端の電圧（0VまたはV_load）。

---

### **適切なMOSFETの選択**
- **ロジックレベルMOSFET（例：IRL540, 2N7000）：** Arduinoの5Vで完全にオンする。このプロジェクトではこちらが推奨。
- **標準MOSFET（例：IRF540）：** ゲートに約10V必要。5Vでは部分導通する可能性あり—これらを使用する場合は、トランジスタやドライバ（例：BJTやTC4420などのIC）を使用してゲート電圧をブーストする必要がある。
- **仕様：** 負荷に合うV_DS（最大電圧）とI_D（最大電流）を確認（例：IRF540: 100V, 33A）。

---

### **代替案：MOSFET増幅器**
もしMOSFETベースの増幅器（例：共通ソース増幅器）をお考えでしたら、簡単な概要を以下に示します：
- **セットアップ：** CE増幅器と同様だが、MOSFET（例：2N7000）を使用。
- **回路図：** Vcc → RD（ドレイン抵抗）→ Drain；Source → GND；Gate → 入力信号（コンデンサ経由）。
- **Arduinoの役割：** （CE増幅器の例のように）小さなAC信号を生成。
- **利得：** \\( A_v = -g_m \cdot R_D \\)、ここで\\( g_m \\)は相互コンダクタンス。
- **課題：** 正確なバイアス設定が必要；初心者向けとしてはBJT増幅器よりも一般的でない。

こちらに切り替えたい場合はお知らせください！

---

### **ヒントとトラブルシューティング**
- **発熱：** MOSFETが熱くなる場合、完全にオンしていない（ロジックレベル互換性を確認）か、負荷が定格を超えている—ヒートシンクを追加するか電流を下げる。
- **応答なし：** 接続、MOSFETのピン配置（GDS）、電源を確認。
- **ノイズ：** PWMスイッチングはモーターで可聴ノイズとなる可能性あり—必要に応じて周波数を調整（上級者向け調整）。
- **高電圧：** 5V以上の負荷の場合、MOSFETのV_GSしきい値が満たされていることを確認。

このプロジェクトは、実用的な制御のためにMOSFETをArduinoと統合する方法を示しています。これをスケールアップ（例：モーター速度制御）したり、増幅を探求したいですか？お知らせください！