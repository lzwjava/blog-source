---
audio: false
generated: true
lang: ja
layout: post
title: Visual Studio CodeにおけるCline拡張機能の問題
translated: true
type: note
---

VSCodeのCline拡張機能で、新しく作成したファイルを検出できない、あるいは`@mention`機能が認識されない問題が発生しているようですね。ClineはAIを活用したコーディングアシスタントです。これらの問題をトラブルシュートして解決する方法をご紹介します：

---

### 1. Clineが新規作成ファイルを検出できない場合
Clineが新しく作成されたファイルを検出できない原因として、ワークスペースのインデックス作成遅延、権限の問題、拡張機能のファイル監視メカニズムのバグなどが考えられます。

#### トラブルシュート手順：
- **ワークスペースの更新**：新しいファイルを作成した後、VSCodeのワークスペースを手動で更新してClineが検出できるようにします。
  - コマンドパレットを開きます（`Ctrl+Shift+P`、Macでは`Cmd+Shift+P`）。
  - `Reload Window`と入力して選択します。これでVSCodeが再読み込みされ、Clineがワークスペースを再インデックスします。
  
- **ファイル作成方法の確認**：VSCode以外（ターミナルや他のエディタなど）でファイルを作成している場合、VSCodeのファイルウォッチャーがすぐに検出しない可能性があります。
  - VSCode内で直接ファイルを作成（エクスプローラーで右クリック＞新規ファイル）して、Clineが認識するか試してください。
  - 外部ツールを使用する場合は、ファイルがClineが監視しているワークスペースディレクトリに保存されていることを確認してください。

- **権限の確認**：Clineがファイルと対話するには読み書き権限が必要です。
  - VSCodeでClineの設定を開きます（拡張機能サイドバーまたはコマンドパレット：`Cline: Open Settings`）。
  - ファイルの読み書き権限が付与されていることを確認してください。タスク中にプロンプトが表示された場合は、アクションを承認してください。

- **ワークスペーススナップショットの確認**：Clineは変更を追跡するためにワークスペースのスナップショットを取得します。更新されていない場合：
  - Clineで新しいタスクを開始（Clineタブの"+"ボタンをクリック）し、ワークスペースを再分析した後にファイルを検出するか確認してください。
  - あるいは、Clineの`Restore`または`Compare`ボタンを使用してワークスペースの強制更新を行ってください。

- **ClineとVSCodeの更新**：ファイル検出に関連するバグが修正されている可能性があるため、最新バージョンを使用していることを確認してください。
  - VSCodeの更新：`Help > Check for Updates`。
  - Clineの更新：VSCodeの拡張機能に移動し、Clineを検索して、利用可能な場合は更新ボタンをクリックしてください。

- **ログによるデバッグ**：Clineのログでエラーを確認します。
  - VSCodeで出力パネルを開きます（`Ctrl+Shift+U`または`Cmd+Shift+U`）。
  - ドロップダウンから「Cline」を選択してログを表示します。ファイル検出失敗に関するメッセージを探し、特定の問題（パスエラーなど）に対処してください。

#### 考えられる原因：
Clineは変更を検出するためにVSCodeのファイルシステムAPIに依存しています。ファイルがインデックスされていない場合やウォッチャーに遅延がある場合、ワークスペースが更新されるまでClineはファイルを認識しません。

---

### 2. Clineが@mentionを使用できない場合
Clineの`@mention`構文は通常、特定のツールや機能を呼び出すために使用されます（例：`@url`でウェブページを取得、`@problems`でワークスペースのエラーに対処）。機能しない場合、設定ミス、サポートされていないモデル、構文の誤解などが原因として考えられます。

#### トラブルシュート手順：
- **構文の確認**：正しい`@mention`構文を使用していることを確認してください。
  - Clineのドキュメントからの例：
    - `@url`：URLを取得してmarkdownに変換します。
    - `@problems`：Clineが修正するためのワークスペースのエラー/警告を含めます。
  - タスク入力フィールドに`@mention`をドキュメント通り正確に入力してください（大文字小文字を区別）。例えば、`@url`が期待されている場合、`@Url`や`@URL`は機能しない可能性があります。

- **モデルサポートの確認**：ClineがサポートするすべてのAIモデルが`@mention`機能を扱えるわけではありません。Claude 3.5 Sonnet（Cline推奨）はエージェント機能をサポートしていますが、他のモデルではサポートされていない可能性があります。
  - Clineの設定を開き、APIプロバイダーとモデルを確認してください。
  - OpenRouterや他のプロバイダーを使用している場合は、Claude 3.5 Sonnetに切り替えて再テストしてください。

- **簡単なタスクでのテスト**：新しいタスクを開始して基本的な`@mention`を試してください：
  - 例：「@problemsにリストされている問題を修正してください。」
  - 応答がない場合、機能が無効化されているか設定が間違っている可能性があります。

- **ツール拡張機能の有効化**：一部の`@mentions`（例：`@jira`や`@aws`などのカスタムツール）はModel Context Protocol（MCP）サーバーを必要とします。
  - 使用している`@mention`がカスタムツールに対応しているか確認してください。該当する場合：
    - Clineに「ツールを追加」（例：「Jiraチケットを取得するツールを追加」）するよう依頼し、プロンプトに従ってセットアップしてください。
    - ツール追加後、VSCodeを再起動して登録されていることを確認してください。

- **APIキーの確認**：`@mention`が外部リクエストを含む場合（例：`@url`）、APIキーに十分な権限やクレジットがない可能性があります。
  - Clineの設定でAPIキーを確認してください（AnthropicやOpenRouterキーなど）。
  - アカウントに資金や要求された機能へのアクセス権があることを確認してください。

- **バグの報告**：上記の手順で解決しない場合は、バグの可能性があります。
  - ClineのGitHub（github.com/cline/cline）を訪問し、既存のissueを確認してください。
  - 類似のissueがない場合は、新しいissueを詳細とともに提出してください：Clineのバージョン、VSCodeのバージョン、使用モデル、試行した正確な`@mention`。

#### 考えられる原因：
`@mention`機能があなたのセットアップで完全に実装されていないか、モデルの機能と期待される動作の間に不一致がある可能性があります。

---

### 一般的なヒント
- **VSCodeの再起動**：完全な再起動で拡張機能の一時的な不具合が解決することがあります。
- **Clineの再インストール**：問題が解決しない場合、VSCode Marketplaceから拡張機能をアンインストールして再インストールしてください。
- **Clineコミュニティへの参加**：リアルタイムのヘルプが必要な場合は、Discord（GitHubにリンクあり）に参加して#supportまたは#contributorsチャンネルで質問してください。

---

### 修正をテストするためのワークフロー例
1. VSCodeで新しいファイルを作成（例：`test.txt`）。
2. ウィンドウを再読み込み（`Ctrl+Shift+P > Reload Window`）。
3. Clineを開き、新しいタスクを開始して入力：「test.txtの内容を読み、@problemsを使用して問題をリストしてください。」
4. すべての権限を承認し、Clineがファイルを検出して`@mention`を処理するか確認してください。

これらの手順で問題が解決しない場合は、具体的なセットアップ（Clineバージョン、モデル、試みている`@mention`）をお知らせいただければ、さらに詳しく調査いたします！