---
audio: false
generated: true
image: false
lang: ja
layout: post
title: プルーンでリモートブランチをクリーンアップ
translated: true
type: note
---

`git fetch --prune` は、リモートブランチへのローカル参照をクリーンかつ最新の状態に保つ方法です。

### 機能

* **`git fetch`** は通常、自身のローカルブランチには触れずに、リモートのブランチ（`origin/main`、`origin/feature-x` など）のローカルコピーを更新します。
* 時間の経過とともに、リモートリポジトリで一部のブランチが削除または名前変更されることがあります。クリーンアップを行わないと、ローカルリポジトリにはそれらの古いリモート追跡ブランチ（例: `origin/feature-old`）が表示されたままになります。
* **`--prune` を追加する** と、Gitに対して *「リモートにブランチが存在しなくなった場合、対応するリモート追跡参照を削除してください」* と指示します。

したがって、`git fetch --prune` を実行後、ローカルのリモートブランチリストはリモートが現在持っているものと正確に一致します。

### 例

1.  リモートにブランチ `main`、`feature-a` があるとします。
2.  `git fetch` を実行 → ローカルに `origin/main`、`origin/feature-a` が作成されます。
3.  誰かがリモートの `feature-a` を削除します。
4.  `git fetch` を実行しても、ローカルには `origin/feature-a` が（古い参照として）まだ表示されます。
5.  `git fetch --prune` を実行すると、Git は `feature-a` がなくなったことを検知し、ローカルリポジトリから `origin/feature-a` を削除します。

### 利点

*   `git branch -r`（リモートブランチリスト）をクリーンに保ちます。
*   アップストリームに存在しなくなったブランチへの切り替えやマージ時の混乱を避けられます。
*   エイリアス（例: `git fetch -p`）として使用したり、以下の設定でデフォルトに設定したりすることがよくあります。

    ```bash
    git config fetch.prune true
    ```

    これにより、すべての `git fetch` が自動的に古いブランチを削除します。

---

**プルーニングがタグとどのように相互作用するか**（`git fetch --prune` はデフォルトではブランチのみを扱い、タグの挙動は異なりますが）についても説明しましょうか？