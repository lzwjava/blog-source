---
audio: false
generated: true
image: false
lang: ja
layout: post
title: リベースルートコミット基本ガイド
translated: true
type: note
---

`git rebase --root` は、リポジトリの**最初のコミット**を書き換える特別な形式のリベースです。通常、`git rebase` は親コミットを必要としますが、`--root` オプションを使用すると、ルートコミット（親を持たない最初のコミット）もリベースの対象として扱われます。

実際の動作は以下の通りです：

### 1. 標準的なリベースとルートリベースの比較

* **通常の `git rebase`**: 別のブランチやコミットをベースとして、選択したベース以降の履歴を変更しながらコミットを再適用します。
* **`git rebase --root`**: ルート以降から始めるのではなく、ルート自体を書き換えます。ルートコミットを分割したり、後続のコミットと統合（squash）したり、完全に置き換えたりすることができます。

### 2. 典型的な使用例

* **最初のコミットメッセージの編集**
  プロジェクトの最初のコミットメッセージを書き換えたい場合、以下を実行します：

  ```bash
  git rebase --root -i
  ```

  最初のコミットの `pick` を `reword` に変更します。

* **ルートコミットと後続コミットの統合（squash）**
  例えば、最初のコミットが単なる足場コード（`README` など）であった場合、次のコミットに統合して履歴を整理できます。

* **ルートコミットの分割**
  最初のコミットに多くの変更（例：プロジェクト全体のコードの一括追加）が含まれている場合、インタラクティブリベース中に複数の論理的なコミットに分割できます。

### 3. 内部での動作

* Git は、リベース操作を最初から適用できるように、ルートコミットに対して一時的な「仮想」の親コミットを作成します。
* 各コミットは、リポジトリが異なる形で始まったかのように再適用（リベース）されます。
* 実質的に、リポジトリの履歴の基盤を書き換えることになります。

### 4. ワークフローの例

```bash
git rebase --root -i
```

以下のようなエディタが表示されます：

```
pick a1b2c3d Initial commit
pick d4e5f6g Add feature A
pick h7i8j9k Add feature B
```

ここから以下の操作が可能です：

* ルートコミットの `pick` を `reword` に変更 → メッセージを変更
* `pick` を `squash` に変更 → ルートコミットを次のコミットと統合
* 必要に応じて順序変更や分割

### ⚠️ 重要な注意点

`git rebase --root` は**履歴を書き換える**ため、プッシュ/共有されていないブランチでのみ実行するか、実行後は強制プッシュ（force-push）が必要です。共有ブランチでは、共同作業者に混乱や競合を引き起こす可能性があります。

---

`git rebase --root` によってログがどのように変化するかを正確に理解するために、具体的な**変更前後の履歴例**（コミットハッシュ付き）も示しましょうか？