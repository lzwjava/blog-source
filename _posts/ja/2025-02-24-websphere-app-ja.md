---
audio: false
lang: ja
layout: post
title: WebSphere Liberty - ハロー・ワールド・アプリケーション
translated: true
---

ここには、WebSphere Liberty サーバーで "Hello World" アプリケーションを実行するための簡単な例があります。前回の指示に従って `javaee-8.0` フィーチャを有効にして設定したことを前提としています。この例では、基本的な JSP (JavaServer Pages) ファイルを使用し、簡単に `dropins` ディレクトリを使用してデプロイします。

### ステップバイステップガイド

#### 1. アプリケーションディレクトリとファイルの作成
`dropins` ディレクトリに JSP ファイルを配置して小さな Web アプリケーションを作成します。`dropins` ディレクトリは、Liberty がアプリケーションを自動的に検出してデプロイするのを許可します。

- **`dropins` ディレクトリの場所**:
  サーバーのフォルダ内の `dropins` ディレクトリに移動します。Liberty のインストールが `/opt/ibm/wlp` にあり、サーバーの名前が `myServer` の場合、パスは以下の通りです:
  ```
  /opt/ibm/wlp/usr/servers/myServer/dropins
  ```
  `/opt/ibm/wlp` を実際の Liberty インストールディレクトリに、`myServer` をサーバーの名前に置き換えてください。

- **展開された WAR ディレクトリの作成**:
  `dropins` ディレクトリ内に `myApp.war` という名前のディレクトリを作成します。`.war` 拡張子は、Liberty にこれを Web アプリケーションとして扱うように指示します。以下のコマンドを使用します:
  ```bash
  mkdir -p /opt/ibm/wlp/usr/servers/myServer/dropins/myApp.war
  ```

- **`index.jsp` ファイルの作成**:
  `myApp.war` 内に `index.jsp` という名前のファイルを作成し、以下の内容を追加して "Hello World!" を表示します:
  ```jsp
  <html>
  <body>
  <h2>Hello World!</h2>
  </body>
  </html>
  ```
  以下のコマンドを使用して直接作成することもできます:
  ```bash
  echo '<html><body><h2>Hello World!</h2></body></html>' > /opt/ibm/wlp/usr/servers/myServer/dropins/myApp.war/index.jsp
  ```
  または、テキストエディタを使用して `index.jsp` を作成し、その場所に保存することもできます。

#### 2. サーバーの起動（既に実行中でない場合）
サーバーが実行中でない場合は、アプリケーションをデプロイして提供するために起動する必要があります。

- **`bin` ディレクトリへの移動**:
  Liberty インストールの `bin` ディレクトリに移動します:
  ```bash
  cd /opt/ibm/wlp/bin
  ```

- **サーバーの起動**:
  出力を直接表示するためにサーバーをフォアグラウンドモードで実行します:
  ```bash
  ./server run myServer
  ```
  または、バックグラウンドで起動します:
  ```bash
  ./server start myServer
  ```
  サーバーが既に実行中の場合は、このステップをスキップしてください—Liberty は新しいアプリケーションを自動的に検出します。

#### 3. アプリケーションのデプロイの確認
Liberty は `dropins` ディレクトリ内で `myApp.war` アプリケーションを自動的にデプロイします。

- **コンソール出力の確認**:
  フォアグラウンドモードでサーバーを起動した場合、以下のようなメッセージを確認します:
  ```
  [AUDIT   ] CWWKT0016I: Web application available (default_host): http://localhost:9080/myApp/
  ```
  これは、アプリケーションがデプロイされ、利用可能であることを確認します。

- **ログの確認（バックグラウンド実行時）**:
  サーバーがバックグラウンドで実行されている場合、以下のログファイルを確認します:
  ```
  /opt/ibm/wlp/usr/servers/myServer/logs/console.log
  ```
  同じデプロイメッセージを確認します。

#### 4. アプリケーションへのアクセス
アプリケーションがデプロイされたら、Web ブラウザで表示できます。

- **ブラウザの開き**:
  以下の URL に移動します:
  ```
  http://localhost:9080/myApp/
  ```
  コンテキストルート `/myApp` は `myApp.war` ディレクトリ名から来ており、`index.jsp` はデフォルトでウェルカムファイルとして提供されます。

- **期待される結果**:
  大きなテキストで以下を表示するページが表示されます:
  ```
  Hello World!
  ```

### 注意点
- **ポート番号**: この例では、Liberty のデフォルト HTTP ポートであるポート `9080` を使用しています。異なるポートを設定している場合は、URL を適切に調整してください (例: `http://localhost:YOUR_PORT/myApp/`)。
- **権限**: `dropins` ディレクトリへの書き込み権限があることを確認してください。
- **JSP サポート**: `javaee-8.0` フィーチャには JSP サポートが含まれているため、追加の設定は必要ありません。
- **トラブルシューティング**: ページが読み込まれない場合は、エラーを確認するためにサーバーログを確認します `/opt/ibm/wlp/usr/servers/myServer/logs/messages.log` または、サーバーが実行中でファイルが正しい場所にあることを確認してください。

この簡単な例は、`dropins` ディレクトリを使用して "Hello World" アプリケーションをデプロイして実行する方法を示しています。最初の Liberty アプリケーションをお楽しみください!

---

WebSphere Liberty に "Hello World" アプリケーションをデプロイしたときの動作の説明です。

### 1. **Dropins ディレクトリ**
WebSphere Liberty は、アプリケーションを `dropins` ディレクトリを通じてデプロイするための便利な機能を提供します。この特別なフォルダにアプリケーションを配置するだけで (WAR (Web Application Archive) ファイルまたは展開された WAR ディレクトリとして)、Liberty は自動的に検出してデプロイします。伝統的なデプロイ方法とは異なり、`server.xml` ファイルでアプリケーションを手動で設定する必要はありません。Liberty が起動したときや `dropins` フォルダに変化があったとき (新しいアプリケーションを追加するなど) に、デプロイプロセスが自動的に開始されます。

### 2. **展開された WAR ディレクトリの使用**
この例では、単一のパッケージ化された WAR ファイルではなく、展開された WAR ディレクトリとして `myApp.war` という名前のアプリケーションをデプロイします。展開された WAR は、Web アプリケーションのすべてのコンテンツ (HTML、JSP ファイル、その他のリソース) を解凍したフォルダです。Liberty はこのディレクトリを WAR ファイルと同じように扱い、完全に機能する Web アプリケーションとしてデプロイします。この方法は特に開発中に便利です。ファイルを直接編集できます (例: HTML または JSP を調整) ため、すべてを再パッケージ化する必要がありません。

### 3. **JSP ファイル**
この "Hello World" アプリケーションの核心は `index.jsp` という名前のファイルです。これは、スクリーンに "Hello World!" を表示するための基本的な HTML を含む JavaServer Page (JSP) です。必要に応じて Java コードを含めることもできます (ただし、この場合はシンプルに保たれています)。アプリケーションにアクセスすると、Liberty は JSP を動的にサーブレットにコンパイルし、ブラウザに提供します。

### 4. **Java EE フィーチャの有効化**
これらすべてを動作させるために、Liberty は `server.xml` 設定ファイルで特定のフィーチャが有効になっている必要があります。ここでは、`javaee-8.0` フィーチャが有効になっており、JSP、サーブレット、Java Enterprise Edition (EE) 8 プラットフォームの他のコンポーネントなどの技術をサポートします。このフィーチャは、アプリケーションをスムーズに実行するために必要なライブラリと設定がロードされていることを確認します。

### 5. **自動デプロイプロセス**
`myApp.war` ディレクトリを `dropins` フォルダに配置し、Liberty を起動 (または既に実行中の場合) すると、サーバーは自動的にアプリケーションを検出してデプロイします。Liberty の出力にアプリケーションが開始され、特定の URL で利用可能であることを示すログメッセージが表示されます。この手間の少ないデプロイプロセスにより、アプリケーションを迅速かつ簡単に実行してテストできます。

### 6. **アプリケーションへのアクセス: コンテキストルート**
アプリケーションにアクセスするための URL は、その **コンテキストルート** によって決定されます。これは、WAR ファイルまたはディレクトリの名前です。この場合、ディレクトリが `myApp.war` という名前なので、コンテキストルートは `/myApp` となります。デフォルトでは、Liberty はポート `9080` で実行されるため、アプリケーションにアクセスするための完全な URL は `http://localhost:9080/myApp/` です。

### 7. **ウェルカムファイルの提供**
ブラウザで `http://localhost:9080/myApp/` に移動すると、Liberty は何を表示する必要があるかを判断する必要があります。特定のファイルが要求されない場合、デフォルトページとして提供する **ウェルカムファイル** を探します。この場合、`index.jsp` は `myApp.war` ディレクトリのルートにあり、デフォルトでウェルカムファイルとして認識されます。Liberty は `index.jsp` をコンパイルし、スクリーンに "Hello World!" を表示します。

### まとめ
この "Hello World" アプリケーションは、WebSphere Liberty が Web アプリケーションのデプロイを簡素化する方法を示しています。`dropins` ディレクトリを使用して自動デプロイ、展開された WAR をサポートして簡単に編集、`javaee-8.0` フィーチャを使用して Java EE 互換性を確保することで、Liberty はアプリケーションを迅速にデプロイしてテストする軽量で開発者向けの方法を提供します。結果として、`http://localhost:9080/myApp/` で "Hello World!" を表示することができ、学習やプロトタイピングに最適です。