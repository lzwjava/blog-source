---
audio: false
generated: true
lang: ja
layout: post
title: Java Naming and Directory Interface (JNDI) は、Java Naming and Directory Interface
  (JNDI) です。
translated: true
---

### 重要ポイント
- `javax.naming` が Java Naming and Directory Interface (JNDI) によってデータベースなどのサービスで名前付きオブジェクトを検索および管理するために使用される可能性が高いです。
- 研究によると、通常は Java EE アプリケーションサーバーが設定する初期コンテキストが必要です。テストの場合は手動で設定します。
- 証拠は、`InitialContext` を使用してデータソースなどを検索する傾向があります。例えば、「java:comp/env/jdbc/datasource」のような名前です。

### `javax.naming` の使い方
`javax.naming` は JNDI の一部であり、Java アプリケーションが名前付きサービスやディレクトリサービスと相互作用するのを助けます。例えば、データベース接続を検索します。Java EE 環境では、アプリケーションサーバーが通常これを設定し、名前でリソースを簡単に見つけることができます。

### 使用例
Java EE アプリケーションで DataSource を検索する簡単な方法は以下の通りです：
```java
InitialContext ctx = new InitialContext();
DataSource ds = (DataSource) ctx.lookup("java:comp/env/jdbc/datasource");
```
これは、DataSource がサーバーに設定されていることを前提としています。サーバーなしでテストする場合は、Simple-JNDI のような追加ライブラリが必要になるかもしれません。

### 予想外の詳細
スタンドアロンアプリケーションでは、JNDI の設定にはカスタムコンテキストを設定する必要があり、Simple-JNDI のようなツールがないと複雑になることがあります。

---

### 調査ノート: `javax.naming` の使用に関する包括的なガイド

このノートでは、`javax.naming` の使用について詳しく説明します。これは、Java Naming and Directory Interface (JNDI) の一部であり、Java アプリケーションが名前付きサービスやディレクトリサービスと相互作用するのを助けます。JNDI は、特定のサービス実装に依存せず、データベース、LDAP、ファイルシステムなどのさまざまなサービスにアクセスするのを統一的に行うように設計されています。このセクションでは、直接の回答を拡張し、開発者のための設定、例、異なる環境での考慮事項を提供します。

#### `javax.naming` と JNDI の理解
`javax.naming` は、JNDI のコアパッケージであり、Java の標準ライブラリの一部として導入され、名前付きおよびディレクトリ機能を提供します。JNDI 操作の中央に位置する `Context` インターフェースを定義し、名前でオブジェクトを検索、バインド、アンバインド、リネームするメソッドを含みます。また、サブコンテキストを作成および破棄するメソッドも含まれます。`lookup()` メソッドは、名前でオブジェクトを取得するために一般的に使用され、エンタープライズアプリケーションでのリソースアクセスに不可欠です。

JNDI は特に Java EE 環境で有用であり、アプリケーションが特定のサービスの詳細から切り離されるため、移植性と柔軟性が向上します。例えば、データベース接続（DataSources）、JMS プロバイダー、JavaMail サービスなどのリソースにアクセスするために使用されます。これらのリソースはアプリケーションサーバーによって管理されます。

#### JNDI の設定と使用
`javax.naming` を使用するには、まず初期コンテキストを作成します。これは、名前付き操作のエントリーポイントとして機能します。この設定は環境によって異なります。

- **Java EE アプリケーション:** アプリケーションサーバー（例：Tomcat、JBoss、WebSphere）が初期コンテキストを設定します。標準的な JNDI 名前（通常は "java:comp/env/" で始まる）を使用してリソースを検索できます。例えば、DataSource は "java:comp/env/jdbc/datasource" でアクセスできます。
- **スタンドアロンアプリケーション:** アプリケーションサーバーがない場合、初期コンテキストを手動で設定する必要があります。名前付きサービスプロバイダーや URL などのプロパティを指定します。これは複雑で、テスト用の追加ライブラリが必要になることがあります。例えば、Simple-JNDI はメモリ内実装を提供します。

以下は、`javax.naming` の主要クラスとその役割をまとめた表です：

| クラス/インターフェース        | 役割                                                                 |
|-------------------------|----------------------------------------------------------------------|
| `Context`              | 名前付き操作（検索、バインド、アンバインドなど）のコアインターフェース。   |
| `InitialContext`       | JNDI 操作を開始するための初期コンテキストを作成します。             |
| `Name`                 | 一般的な名前を表し、順序付けられたコンポーネントのシーケンスです。         |
| `NamingException`      | 名前付き操作中にスローされる例外のベースクラスです。            |

#### 実践的な例
Java EE とスタンドアロンのシナリオの例を探索します。

##### 例 1: Java EE での DataSource の検索
Java EE アプリケーションでは、設定された DataSource を以下のように検索できます：

```java
import javax.naming.InitialContext;
import javax.sql.DataSource;
import java.sql.*;

public class JNDIExample {
    public static void main(String[] args) throws Exception {
        InitialContext ctx = new InitialContext();
        DataSource ds = (DataSource) ctx.lookup("java:comp/env/jdbc/datasource");
        Connection conn = ds.getConnection();
        // 接続を使用...
        conn.close();
        ctx.close();
    }
}
```

この例では、DataSource がアプリケーションサーバーに設定されていることを前提としています。通常、Tomcat のようなファイル `context.xml` に設定されます。JNDI 名 "java:comp/env/jdbc/datasource" は標準的な慣例ですが、サーバーの設定によって異なることがあります。

##### 例 2: カスタムオブジェクトのバインドと検索
テストまたはスタンドアロン使用の場合、シンプルなメモリ内コンテキストを作成することができます。標準 API にメモリ内コンテキストファクトリは含まれていないため、Simple-JNDI のようなライブラリが役立ちます。以下は、そのような設定を前提とした概念的な例です：

```java
import javax.naming.*;

public class JNDIExample {
    public static void main(String[] args) throws NamingException {
        Context ctx = new InitialContext();
        ctx.rebind("myObject", "Hello, World!");
        String value = (String) ctx.lookup("myObject");
        System.out.println(value);
        ctx.close();
    }
}
```

注意: このスタンドアロン例では、適切なプロパティで初期コンテキストを設定する必要があります。これは、カスタムコンテキストファクトリ（Simple-JNDI が提供するものなど）を `java.naming.factory.initial` に設定することが含まれます。

#### 異なる環境での考慮事項
- **本番環境（Java EE）:** 本番環境では、アプリケーションサーバーが JNDI の設定を管理し、リソースを簡単に検索できます。データベース接続プールなど、サーバーが接続を管理することが一般的です。これにより、スケーラビリティとセキュリティが向上します。例えば、データベース資格情報を変更するには、アプリケーションコードではなくサーバー設定を更新するだけです。
- **テスト（スタンドアロン）:** ユニットテストや統合テストでは、アプリケーションサーバーを使用せずに実行することが一般的です。Simple-JNDI ([Simple-JNDI GitHub](https://github.com/h-thurow/Simple-JNDI)) のようなライブラリを使用して、JNDI 環境をシミュレートできます。これにより、JNDI 検索に依存するコードがサーバーにデプロイせずに動作することを確認できます。
- **セキュリティとベストプラクティス:** JNDI インジェクションに注意し、特に古い Java バージョンでは、リモートコード実行などのセキュリティ脅威につながることがあります。Oracle は多くの問題を解決し、Java 8u191 などの更新で LDAP ベクトルの脅威を閉じました。常に入力を検証し、最新の Java バージョンを使用してセキュリティを確保してください。

#### 予想外の詳細: スタンドアロン設定の複雑さ
アプリケーションサーバーなしで JNDI を設定する際の複雑さを予想しないかもしれません。Java EE はサーバー管理コンテキストでこれを簡単にしますが、スタンドアロン設定ではコンテキストファクトリとプロパティを設定する必要があり、第三者のライブラリが必要になることがあります。これは JNDI に新しい開発者にとって障害となることがありますが、Simple-JNDI のようなツールはメモリベースの実装を提供してこれを軽減します。

#### さらに読むべきリソース
より深い理解を得るために、以下を参照してください:
- [Oracle Java チュートリアル: JNDI の概要](https://docs.oracle.com/en/java/tutorial/jndi/overview/index.html) には、公式のドキュメントが含まれています。
- [Baeldung: Java Naming and Directory Interface Overview](https://www.baeldung.com/jndi) には、実践的な例と現代的な使用法が含まれています。
- [Simple-JNDI GitHub](https://github.com/h-thurow/Simple-JNDI) では、サーバーなしで JNDI をテストする方法が含まれています。

これらのリソースには、コード例、チュートリアル、ベストプラクティスが含まれており、さまざまなシナリオで JNDI を効果的に実装するのを助けます。

#### 主要な引用
- [Oracle Java チュートリアル JNDI Overview](https://docs.oracle.com/en/java/tutorial/jndi/overview/index.html)
- [Baeldung Java Naming and Directory Interface Overview](https://www.baeldung.com/jndi)
- [Simple-JNDI Access property files via JNDI lookups](https://github.com/h-thurow/Simple-JNDI)