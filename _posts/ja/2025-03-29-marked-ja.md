---
audio: false
generated: true
lang: ja
layout: post
title: KramdownからMarkedへの移行
translated: true
type: note
---

JekyllブログでKramdownからMarkedへの切り替えを行うには、Jekyllの設定とセットアップをいくつか変更する必要があります。MarkedはMarkdownの解析とコンパイルを行うJavaScriptライブラリで、MathJaxと組み合わせることで数式レンダリングを改善できます。以下に切り替えの手順を説明します：

### ステップ1: Markedのインストール
まず、MarkedライブラリをJekyllプロジェクトに含める必要があります。レイアウトファイル（例：`default.html`）の`<head>`セクションに追加します。

```html
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
```

### ステップ2: Kramdownの無効化
`_config.yml`ファイルで、`markdown`オプションを`none`に設定するか、Kramdownに設定されている場合は削除してKramdownを無効化します。

```yaml
markdown: none
```

### ステップ3: MathJaxとの連携設定
MarkedをMathJaxと連携させる設定が必要です。Jekyllプロジェクト内にJavaScriptファイル（例：`marked-mathjax.js`）を作成し、以下のコードを追加します：

```javascript
document.addEventListener("DOMContentLoaded", function() {
  // Markedを使用してMarkdownコンテンツをレンダリング
  const elements = document.querySelectorAll('.markdown-content');
  elements.forEach(element => {
    const html = marked(element.textContent);
    element.innerHTML = html;
  });

  // MathJaxのレンダリング
  MathJax.typesetPromise().then(() => {
    console.log('MathJax rendering complete!');
  }).catch((err) => console.log('Typeset failed:', err));
});
```

このスクリプトを、MarkedとMathJaxの読み込み後にレイアウトファイルに追加します：

```html
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="{{ '/assets/js/marked-mathjax.js' | relative_url }}"></script>
```

### ステップ4: Markdownコンテンツの更新
Markdownコンテンツが`markdown-content`クラスを持つコンテナでラップされていることを確認します。これによりJavaScriptがレンダリングの対象を特定できます。

```html
<div class="markdown-content">
  <!-- ここにMarkdownコンテンツを記述 -->
</div>
```

### ステップ5: セットアップのテスト
Jekyllサイトをローカルでビルドしてサービスを起動し、Markedが正しくMarkdownをレンダリングし、MathJaxが数式を適切に表示することを確認します。

```bash
bundle exec jekyll serve
```

### 追加の注意点
- MathJaxの設定がMarkdownコンテンツと互換性があることを確認してください。特定のニーズに基づいて設定を調整する必要があるかもしれません
- 問題が発生した場合は、ブラウザのコンソールでエラーを確認し、JavaScriptコードを適宜調整してください

これらの手順に従うことで、JekyllブログでKramdownからMarkedへの切り替えが完了し、数式表示におけるMathJaxのより優れたサポートを活用できるようになります。