---
audio: false
generated: true
lang: ja
layout: post
title: Arduinoを用いたエミッタ接地増幅回路の構築
translated: true
type: note
---

Arduinoを使用してコモンエミッタ（CE）増幅器を構築するのは興味深いプロジェクトですが、役割を明確にしておきます。Arduino自体は増幅器として機能するわけではなく（デジタルマイクロコントローラです）、バイポーラ接合トランジスタ（BJT）で構築されたCE増幅回路の信号源や測定ツールとして使用できます。CE増幅器は、小さな入力信号を増幅するためにNPNまたはPNPトランジスタを使用する古典的なアナログ回路で、適度な電圧利得と電流利得を提供します。

ここでは、基本的なNPNベースのCE増幅器を設計し、Arduinoを使用して入力信号を生成（PWM経由）し、出力を測定する手順を説明します。このセットアップは、Arduinoの機能を活用しながら増幅を実証します。

---

### **コモンエミッタ増幅器の概要**
- **目的:** 小さなAC信号（オーディオや正弦波など）を増幅します。
- **主な特徴:**
  - トランジスタは活性領域で動作します。
  - 入力信号はベースに印加され、出力はコレクタから取得されます。
  - 電圧利得は抵抗比とトランジスタの特性によって決まります。
- **部品:**
  - NPNトランジスタ（例: 2N3904またはBC547）
  - 抵抗（バイアス用および負荷用）
  - コンデンサ（AC信号の結合用）
  - Arduino（信号源および測定用）

---

### **ステップ1: 回路を設計する**

#### **必要な部品**
- NPNトランジスタ（例: 2N3904）
- 抵抗: R1 = 47kΩ、R2 = 10kΩ（バイアス用）、RC = 1kΩ（コレクタ）、RE = 220Ω（エミッタ）
- コンデンサ: C1 = 10µF（入力結合）、C2 = 10µF（出力結合）、CE = 100µF（エミッタバイパス、高利得化のためオプション）
- Arduino（例: Uno）
- ブレッドボード、ジャンパワイヤ
- 電源（Arduinoの5Vピンまたは外部9V、必要に応じて調整）

#### **回路図**
```
Vcc (5V) ---- R1 ----+---- RC ---- Collector (C)
             47kΩ     |     1kΩ          |
                      |                  |
Base (B) --- C1 -----+                  |
            10µF     |                  |
Arduino PWM (Pin 9)  R2                 |
                     10kΩ              Output --- C2 ---- To Arduino A0
                      |                  |         10µF
                      |                  |
                      +---- RE ---- Emitter (E) --- CE (optional) --- GND
                           220Ω                   100µF
                      |
                     GND
```
- **バイアス（R1、R2）:** トランジスタの動作点を設定します。
- **RC:** 出力信号用のコレクタ抵抗です。
- **RE:** 安定化のためのエミッタ抵抗です。
- **C1、C2:** DCを遮断し、AC信号を通します。
- **CE（オプション）:** AC利得を高めるためにREをバイパスします。

#### **動作点**
- 目標: トランジスタを活性領域でバイアスします（例: 5V電源でVCE ≈ 2.5V）。
- 電圧 divider（R1、R2）: \\( V_B = V_{CC} \cdot \frac{R2}{R1 + R2} = 5 \cdot \frac{10k}{47k + 10k} \approx 0.88V \\)。
- \\( V_E = V_B - V_{BE} \approx 0.88 - 0.7 = 0.18V \\)。
- \\( I_E = \frac{V_E}{RE} = \frac{0.18}{220} \approx 0.82 \, \text{mA} \\)。
- \\( V_C = V_{CC} - I_C \cdot RC \approx 5 - 0.82 \cdot 1k \approx 4.18V \\)。
- \\( V_{CE} = V_C - V_E \approx 4.18 - 0.18 = 4V \\)（5V電源に対して良好）。

---

### **ステップ2: 信号源としてArduinoを使用する**

#### **Arduinoの役割**
- ピン9（PWMをサポート）のようなピンでPWM（パルス幅変調）を使用して小さなAC信号を生成します。
- 単純なRCローパスフィルタを使用してPWMをフィルタ処理し、正弦波に近似させます（オプション）。

#### **信号を生成するコード**
```cpp
const int pwmPin = 9; // PWM出力ピン

void setup() {
  pinMode(pwmPin, OUTPUT);
  // PWM周波数を設定（オプション、デフォルトは約490 Hz）
}

void loop() {
  // PWMで正弦波をシミュレート（0-255の範囲）
  for (int i = 0; i < 360; i += 10) {
    float sineValue = sin(radians(i)); // -1から1の正弦波
    int pwmValue = 127 + 127 * sineValue; // 0-255にスケーリング
    analogWrite(pwmPin, pwmValue);
    delay(10); // 周波数を調整（例: ここでは約100 Hz）
  }
}
```
- **出力:** 約0–5VのPWM信号、2.5Vを中心とし、約2.5Vのピークtoピークです。
- **C1:** DCオフセットを除去し、AC成分のみ（約1.25Vピーク）をベースに通過させます。

#### **オプションのフィルタ**
ピン9からGNDへ1kΩ抵抗と0.1µFコンデンサを直列に追加し、C1の前で信号をタップして、PWMを大まかな正弦波に平滑化します。

---

### **ステップ3: 出力を測定する**

#### **Arduinoでの測定**
- 増幅器の出力（C2の後）をA0に接続します。
- Arduinoを使用して増幅された信号を読み取り、シリアルモニタ経由で表示します。

#### **測定して表示するコード**
```cpp
const int inputPin = A0; // 出力をここで測定

void setup() {
  Serial.begin(9600);
}

void loop() {
  int sensorValue = analogRead(inputPin); // 0-1023は0-5Vにマッピング
  float voltage = sensorValue * (5.0 / 1023.0);
  Serial.print("出力電圧 (V): ");
  Serial.println(voltage);
  delay(100); // サンプリングレートを調整
}
```

#### **期待される利得**
- 電圧利得 \\( A_v = -\frac{RC}{RE} = -\frac{1k}{220} \approx -4.5 \\)（位相反転のため負）。
- 入力: 約1.25Vピーク（結合後）。
- 出力: 約4.5 × 1.25 = 5.625Vピーク（ただし、電源制限により5Vでクリップ）。

---

### **ステップ4: 構築してテストする**

#### **組み立て**
1. 回路図に従ってブレッドボード上に配線します。
2. 信号生成コードをArduinoにアップロードし、ピン9をC1に接続します。
3. Arduinoの5V（または調整された抵抗で9Vを使用）を介して回路に電源を供給します。
4. 測定コードをアップロードし、シリアルモニタ（9600ボー）を開きます。

#### **検証**
- **入力信号:** C1後に約1–2Vピークtoピーク（可能であればマルチメータまたはオシロスコープを使用）。
- **出力信号:** より大きく（例: 4–5Vピークtoピーク）、反転しているはずです。
- マルチメータでVCE（約2–4V）をチェックし、活性領域動作を確認します。

---

### **ヒントとトラブルシューティング**
- **利得が低すぎる:** REを跨いでCE（100µF）を追加し、AC利得を向上させます（REの退化を除去）。
- **クリッピング:** 出力が5Vを超える場合、入力振幅を減らす（PWM範囲を調整）かVccを増加させます（例: 9V外部電源）。
- **ノイズ:** PWMは矩形波的です。より良い正弦波（外部発振器またはフィルタ経由）で結果が改善します。
- **トランジスタ仕様:** 2N3904が電流を扱えることを確認します（Ic < 200mA、ここでは安全）。

このセットアップは、CE増幅器の核心的な動作（電圧増幅）を実証し、信号生成と解析のためにArduinoを統合しています。利得を調整したり、オーディオ用にスピーカーを追加したり、信号を改良したいですか？お知らせください！