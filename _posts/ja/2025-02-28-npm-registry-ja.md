---
audio: false
generated: true
lang: ja
layout: post
title: テスト用NPMレジストリ
translated: true
type: note
---

NPMレジストリが正しく動作するかテストするには、特にユーザー名とパスワードが必要な場合、接続性、認証、パッケージ提供機能を検証するためのいくつかの簡単な手順があります。認証情報が必要なことからプライベートレジストリであると推測されるため、パッケージインストールをテストする前に認証が正しく設定されていることを確認する必要があります。以下はレジストリをテストするための完全なガイドと、試しにインストールできるおすすめのNPMパッケージです。

---

### レジストリテスト手順

1. **認証の設定**
   - レジストリがユーザー名とパスワードを要求するため、NPMクライアントを認証するためにログインする必要があります。
   - ターミナルで以下のコマンドを実行し、`<registry-url>`を実際のレジストリURLに置き換えてください:
     ```
     npm login --registry=<registry-url>
     ```
   - ユーザー名とパスワード（およびレジストリによってはメールアドレス）の入力を求められます。完了すると、認証トークンが`.npmrc`ファイルに保存され、レジストリへのアクセスが可能になります。

2. **レジストリ接続の確認**
   - `npm ping`コマンドを使用してレジストリに到達可能か確認します:
     ```
     npm ping --registry=<registry-url>
     ```
   - 成功した場合、このコマンドはレジストリサーバーが起動して応答していることを確認します。通常「Ping success: <registry-url>」のような出力が表示されます。失敗した場合は、接続の問題やURLが間違っている可能性があります。

3. **認証の確認**
   - ユーザー名とパスワードが正しく設定されていることを確認するには、`npm whoami`コマンドを使用します:
     ```
     npm whoami --registry=<registry-url>
     ```
   - 認証が成功した場合、ユーザー名が返されます。失敗したりエラー（例: "not authenticated"）が返された場合は、認証情報またはログイン手順を再確認してください。

4. **パッケージインストールのテスト**
   - レジストリがパッケージを提供できることを確認するために、パッケージのインストールを試みます。プライベートレジストリの場合、そのレジストリ上に存在することが分かっているパッケージをインストールする必要があります。ただし、レジストリが公開NPMレジストリをプロキシしている場合（Verdaccioのようなプライベートレジストリで一般的な設定）、人気のある公開パッケージでテストできます。
   - 例:
     ```
     npm install <package-name> --registry=<registry-url>
     ```
   - `<package-name>`をレジストリで利用可能なパッケージに置き換えてください（パッケージの提案については後述）。

---

### 試用可能なNPMパッケージ

これはプライベートレジストリであるため、利用可能なパッケージを正確に把握することはできません。ただし、一般的なシナリオに基づいていくつかの提案を示します:

- **レジストリが公開NPMレジストリをプロキシしている場合:**
  - 多くのプライベートレジストリは公開レジストリをミラーリングするように設定されており、認証後に公開パッケージへのアクセスを許可します。この場合、よく知られた公開パッケージでテストできます:
    - `lodash`: 人気のあるユーティリティライブラリ
      ```
      npm install lodash --registry=<registry-url>
      ```
    - `express`: Node.jsで広く使用されているWebフレームワーク
      ```
      npm install express --registry=<registry-url>
      ```
    - `react`: ユーザーインターフェース構築のための人気ライブラリ
      ```
      npm install react --registry=<registry-url>
      ```
  - これらが正常にインストールされれば、レジストリが正常に動作しパッケージを提供できることが確認されます。

- **レジストリがプライベートパッケージのみをホストしている場合:**
  - プライベートレジストリ上に存在することが分かっているパッケージをインストールする必要があります。チームやレジストリのドキュメント/Webインターフェース（利用可能な場合）でパッケージ名を確認してください。例:
    - `my-org-utils`というパッケージがある場合:
      ```
      npm install my-org-utils --registry=<registry-url>
      ```
  - 特定のパッケージ名がないため、正確なプライベートパッケージを列挙することはできません。組織に関連するパッケージを使用してください。

---

### 注意点とトラブルシューティング

- **成功の指標**: `npm ping`が動作し、`npm whoami`がユーザー名を返し、パッケージがエラーなくインストールされれば、レジストリは正しく機能しています。
- **一般的な問題**:
  - **認証エラー**: `npm whoami`が失敗した場合は`npm login`を再実行してください。
  - **パッケージが見つからない**: パッケージがレジストリ上に存在することを確認してください。公開パッケージを使用して失敗した場合、レジストリが公開レジストリをプロキシしていない可能性があります。
  - **接続問題**: `npm ping`が失敗した場合は`<registry-url>`とネットワーク設定を再確認してください。
- **グローバル変更の回避**: グローバルなNPM設定に影響を与えないようにするため、新しいディレクトリでローカルな`.npmrc`ファイルを使用してテストできますが、上記の`--registry`フラグ付きコマンドでテストするだけで十分です。

これらの手順に従い、提案されたパッケージを試すことで、レジストリが動作しており、認証とパッケージ取得を適切に処理していることを確認できます。レジストリから特定のパッケージ名がある場合は、ここで提供した公開例の代わりにそれらを使用してください。