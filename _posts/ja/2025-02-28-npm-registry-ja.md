---
audio: false
generated: true
lang: ja
layout: post
title: NPM レジストリのテスト
translated: true
---

NPMレジストリが動作するかどうかをテストするには、特にユーザー名とパスワードが必要であることを考慮すると、接続性、認証、パッケージの提供能力を確認するためのいくつかの簡単な手順に従うことができます。これは、認証情報（ユーザー名とパスワード）が必要であるため、プライベートレジストリであることを前提としています。テストする前に、認証が正しく設定されていることを確認する必要があります。以下は、レジストリをテストするための完全なガイドと、インストールを試してみるためのいくつかの推奨NPMパッケージです。

---

### レジストリをテストする手順

1. **認証の設定**
   - レジストリにはユーザー名とパスワードが必要ですので、NPMクライアントにログインして認証する必要があります。
   - ターミナルで次のコマンドを実行し、`<registry-url>`を実際のレジストリのURLに置き換えます：
     ```
     npm login --registry=<registry-url>
     ```
   - ユーザー名とパスワード（レジストリによってはメールアドレスも）を入力するように求められます。完了すると、認証トークンが`.npmrc`ファイルに保存され、レジストリへのアクセスが許可されます。

2. **レジストリ接続の確認**
   - `npm ping`コマンドを使用して、レジストリが到達可能かどうかを確認します：
     ```
     npm ping --registry=<registry-url>
     ```
   - 成功すると、このコマンドはレジストリサーバーが動作して応答していることを確認します。通常、出力は「Ping success: <registry-url>」のようなものです。失敗すると、接続問題があるか、URLが間違っている可能性があります。

3. **認証の確認**
   - ユーザー名とパスワードが正しく設定されていることを確認するには、`npm whoami`コマンドを使用します：
     ```
     npm whoami --registry=<registry-url>
     ```
   - 認証が成功すると、ユーザー名が返されます。失敗した場合やエラーが返された場合（例：「認証されていません」）、資格情報やログイン手順を再確認してください。

4. **パッケージのインストールをテスト**
   - レジストリがパッケージを提供できることを確認するために、パッケージをインストールしてみてください。プライベートレジストリであるため、レジストリに存在することを知っているパッケージをインストールする必要があります。ただし、レジストリが公共NPMレジストリをプロキシする場合（Verdaccioなどのプライベートレジストリの一般的な設定）は、人気のある公共パッケージでテストすることができます。
   - 例のコマンド：
     ```
     npm install <package-name> --registry=<registry-url>
     ```
   - `<package-name>`をレジストリに存在するパッケージ（以下のパッケージの提案については後述）に置き換えます。

---

### テストに試すNPMパッケージ

これはプライベートレジストリであるため、どのパッケージが利用可能かは知りません。しかし、一般的なシナリオに基づいていくつかの提案をします：

- **レジストリが公共NPMレジストリをプロキシする場合:**
  - 多くのプライベートレジストリは、認証後に公共パッケージへのアクセスを許可するように設定されています。この場合、人気のある公共パッケージをインストールしてみてください：
    - `lodash`：人気のあるユーティリティライブラリ。
      ```
      npm install lodash --registry=<registry-url>
      ```
    - `express`：Node.js用の広く使用されているWebフレームワーク。
      ```
      npm install express --registry=<registry-url>
      ```
    - `react`：ユーザーインターフェースを構築するための人気のあるライブラリ。
      ```
      npm install react --registry=<registry-url>
      ```
  - これらが成功してインストールされると、レジストリが動作してパッケージを提供できることを確認できます。

- **レジストリがプライベートパッケージのみをホストする場合:**
  - レジストリに存在することを知っているパッケージをインストールする必要があります。チームやレジストリのドキュメント/ウェブインターフェース（利用可能な場合）でパッケージ名を確認してください。例えば：
    - `my-org-utils`というパッケージがある場合、試してみてください：
      ```
      npm install my-org-utils --registry=<registry-url>
      ```
  - 特定のパッケージ名がないため、組織に関連するものを使用してください。

---

### 注意点とトラブルシューティング

- **成功の指標**：`npm ping`が動作し、`npm whoami`がユーザー名を返し、パッケージがエラーなくインストールされると、レジストリが正しく動作しています。
- **一般的な問題**：
  - **認証エラー**：`npm whoami`が失敗した場合は、`npm login`を再実行してください。
  - **パッケージが見つからない**：パッケージがレジストリに存在することを確認してください。公共パッケージを使用して失敗した場合、レジストリが公共レジストリをプロキシしていない可能性があります。
  - **接続問題**：`npm ping`が失敗した場合は、`<registry-url>`とネットワーク設定を再確認してください。
- **グローバル変更を避ける**：グローバルNPM設定を影響させないように、新しいディレクトリでローカルの`.npmrc`ファイルを使用してテストすることもできますが、上記のコマンドと`--registry`フラグはテストに十分です。

これらの手順に従い、推奨されるパッケージを試してみることで、レジストリが動作し、認証とパッケージの取得を適切に処理していることを確認できます。レジストリから特定のパッケージ名がある場合は、公共の例ではなくそれらを使用してください。