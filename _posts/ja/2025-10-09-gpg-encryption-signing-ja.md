---
audio: false
generated: true
image: false
lang: ja
layout: post
model: x-ai/grok-4-fast
title: GPG暗号化と署名の解説
translated: true
type: note
---

### GPGの基本：暗号化と署名

ここではいくつかの概念が混ざっていますが、GPG（GNU Privacy Guard）は**暗号化**（ファイル内容の保護）と**署名**（身元と完全性の検証）という別々の機能を持っています。標準的なGPGの使用方法（2025年現在でも大きく変わっていません）に基づいて、順を追って説明し、ポイントを確認し、重複や相違点を明確にします。

#### 1. **鍵の生成と個人情報（名前/メールアドレス）**
   - GPGを初めて設定するとき、**鍵ペア**を生成します：秘密鍵（秘密に保持）と公開鍵（他の人と共有）。
   - 生成過程中に、鍵の「ユーザーID」の一部として**名前とメールアドレス**を提供します（例：`gpg --gen-key`）。これにより、鍵があなたの身元に関連付けられます。
   - また、秘密鍵を保護するための**パスフレーズ**を設定します。このパスフレーズはファイルの暗号化には使用**されません**。必要なときに秘密鍵のロックを解除するためだけのものです。
   - コマンド例：
     ```
     gpg --gen-key
     ```
     RSA/RSA、鍵サイズ、有効期限、名前/メールアドレスのプロンプトに従います。

#### 2. **ファイルの暗号化**
   - **パスワードを使用する場合（対称暗号）**：これは鍵やあなたの身元に関与せず、ファイルを安全に共有するための迅速な方法です。GPGはパスフレーズを使用して暗号化用の単一鍵を作成します。
     - コマンド：`gpg -c filename.txt`（パスフレーズを要求し、`filename.txt.gpg`を出力）。
     - パスフレーズを知っている誰でも復号できます：`gpg -d filename.txt.gpg`。
     - ここでは公開鍵/秘密鍵は使用されず、身元確認もありません。
   - **公開鍵を使用する場合（非対称暗号）**：特定の相手のために暗号化するには、その相手の公開鍵を使用します。あなたの名前/メールアドレスは暗号化出力に直接関与しません。
     - コマンド：`gpg -e -r recipient@example.com filename.txt`（`filename.txt.gpg`を出力）。
     - 受信者の秘密鍵でのみ復号できます。
   - 暗号化の出力は`.gpg`ファイルですが、それは**署名ではありません**。単に暗号化されたデータです。暗号化だけでは「GPG署名」は生成されません。

#### 3. **ファイルへの署名（あなたが説明している内容）**
   - 署名は、ファイル（またはそのハッシュ）に**デジタル署名**を添付して、それがあなたから来たものであり、改ざんされていないことを証明します。ここであなたの**秘密鍵**と身元が関わってきます。
   - **はい、署名を生成するにはあなたの秘密鍵を使用しなければなりません。** GPGはあなたのパスフレーズでそれを解除します。
     - 分離署名のコマンド：`gpg --detach-sign filename.txt`（`filename.txt.sig`を出力）。
     - またはインライン署名（署名と暗号化を同時に行う）：`gpg -s filename.txt`（署名が埋め込まれた`filename.txt.gpg`を出力）。
   - 署名は、あなたの鍵IDとユーザーID（名前/メールアドレス）を含む、暗号的な「値」（あなたの秘密鍵で署名されたハッシュのようなもの）です。
   - **他の人はあなたの公開鍵で検証します**：彼らはあなたの公開鍵をインポートし（例：鍵サーバーから：`gpg --keyserver keys.openpgp.org --recv-keys YOUR_KEY_ID`）、その後 `gpg --verify filename.txt.sig filename.txt` を実行します。
     - 一致すると、「'Your Name <email>' からの良い署名」のようなメッセージが表示されます。
   - **はい、これは身元を一致させ、信頼を構築します**：
     - 署名は、ファイルが鍵の所有者（あなた）からのものであることを証明します。
     - あなたが信頼できるチャネル（例：あなたのウェブサイト）で公開鍵を共有し、その鍵があなたが信頼する他の人によって署名されている場合、その信頼の連鎖を「信頼」できます。
     - これはファイルを暗号化しません。単に検証するだけです。完全なセキュリティのためには暗号化と組み合わせます（署名してから暗号化）。

#### 主な相違点とあなたの質問

| 機能 | 暗号化 (パスワード) | 暗号化 (公開鍵) | 署名 |
|------|-------------------|------------------|------|
| **パスフレーズを使用？** | はい (対称鍵用) | いいえ (受信者の公開鍵を使用) | はい (あなたの秘密鍵の解除用) |
| **名前/メールアドレスが関与？** | いいえ | 間接的 (復号応答のためのあなたの鍵経由) | はい (署名に埋め込まれる) |
| **出力** | `.gpg` ファイル (暗号化データ) | `.gpg` ファイル (暗号化データ) | `.sig` または `.gpg` に埋め込み (署名値) |
| **秘密鍵が必要？** | いいえ | いいえ (他者への暗号化時) | はい (生成時) |
| **検証** | 復号用パスフレーズ | 受信者の秘密鍵 | あなたの公開鍵を持つ誰でも |
| **目的** | 内容の秘匿 | 安全な共有 | 身元/完全性の証明 |

- **秘密鍵について正しい**: はい、署名するにはあなたの**秘密鍵**（パスフレーズで解除）を**使用しなければなりません**。決して共有しないでください！
- **信頼について正しい**: その通りです。署名があなたの公開鍵に対して検証され、かつ（名前/メールアドレスと信頼のウェブ経由で）その鍵が主張される作者に属していると信頼するなら、ファイルが真正で改ざんされていないと信頼できます。デジタルの公証人のようなものです。

#### ヒント
- 常に鍵をバックアップしてください：`gpg --export-secret-keys --armor > private.asc`（安全に保管）。
- パスワードのみの場合（鍵なし）、`age` や `openssl` のようなツールがより簡単な代替手段ですが、GPGは身元連携が必要なものには優れています。
- よくある落とし穴：公開鍵のエクスポート/共有を忘れると、他の人は検証できません。

特定のコマンドやシナリオ（例：暗号化*と*署名の両方）を意図していた場合は、詳細を共有してください！

**参考文献**  
[GPG ドキュメント：暗号化と署名](https://www.gnupg.org/documentation/manuals/gnupg/)  
[GPG クイックスタートガイド](https://www.gnupg.org/documentation/manuals/gnupg/GnuPG-basics.html)