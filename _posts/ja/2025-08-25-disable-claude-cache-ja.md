---
audio: false
generated: true
image: false
lang: ja
layout: post
title: Claude Codeでのキャッシュ無効化
translated: true
type: note
---

**Claude Code** では、このスニペット

```json
"cache_control": {
  "type": "ephemeral"
}
```

は、モデルによって生成されたレスポンス（またはアーティファクト）が**再利用のためにキャッシュされない**ことを意味します。

### 存在する理由

通常、Claude Code（および他の Anthropic SDK）は、同じプロンプトを再度送信した場合に処理を高速化するためにレスポンスをキャッシュすることがあります。しかし、`"cache_control": { "type": "ephemeral" }` を設定すると、API に対して以下を指示しています：

* この結果をキャッシュに**保存しない**
* 後で同じリクエストが来ても**再利用しない**
* レスポンスを**短命**なものとして扱う—この呼び出しのみのものとする

### 使用する場面

これは以下の場合に有用です：

* リクエストにキャッシュしたくない**機密または個人データ**が含まれている場合
* 再利用の恩恵を受けない**一回限りのクエリ**を送信している場合
* リクエストテキストが同じであっても、毎回**新しい出力**を求めたい場合

要約すると、`"ephemeral"` は Claude の出力を*一時的*なものにします—このやりとりだけのプライベートなもので、呼び出し間でのキャッシュは行われません。

Claude Code でのデフォルトの `cache_control` の動作（例：`type: "default"`、`"none"`、`"ephemeral"` の違い）についても説明しましょうか？