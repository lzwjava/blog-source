---
audio: false
generated: true
image: false
lang: ja
layout: post
title: ツール利用と関数呼び出しの解説
translated: true
type: note
---

LLM APIにおける**ツール利用**と**関数呼び出し**の違いを分解してみましょう：

---

## 1. ツール利用

* **概念**: ツール利用は、LLMが外部機能で拡張される広範な概念です。単にテキストを生成するだけでなく、情報を取得したり、コードを実行したり、データベースをクエリしたり、画像を生成するために「ツールを使用」できます。
* **実装**: 実際には、「ツール」はLLMランタイムに登録された外部APIやシステムです（例：検索API、Python実行環境、カレンダーAPI）。
* **LLMの役割**: モデルは、いつツールを呼び出すか、どのような引数で呼び出すかを決定し、結果を会話に統合します。
* **例**:

  * ユーザー: 「広州の天気はどうですか？」
  * LLM: `weather`ツールを`{city: "Guangzhou"}`で呼び出す → `28°C, sunny`を取得
  * LLM: 「気温は28°Cで晴れです」と返信

**ツール利用**は、LLMが単に言葉で答えるだけでなく、外部システムとの連携を調整する一般的なオーケストレーションの枠組みと考えてください。

---

## 2. 関数呼び出し

* **概念**: 関数呼び出しは、一部のLLM API（OpenAI、Anthropicなど）が提供する*構造化された*メカニズムで、関数（名前、パラメータ、スキーマを含む）を定義し、LLMがそれらを呼び出すためのJSON引数を返すことができます。
* **実装**: 関数を記述したJSONスキーマをモデルに提供します。モデルの出力は、テキストまたは構造化された関数呼び出しオブジェクトのいずれかになります。
* **LLMの役割**: API使用を「幻覚」する代わりに、モデルは事前定義された関数に対する有効な構造化引数を出力します。
* **例**:

  * 関数を定義:

    ```json
    {
      "name": "getWeather",
      "description": "Get current weather",
      "parameters": {
        "type": "object",
        "properties": {
          "city": {"type": "string"}
        },
        "required": ["city"]
      }
    }
    ```
  * ユーザー: 「広州の天気はどうですか？」
  * LLM: 出力 → `{ "name": "getWeather", "arguments": {"city": "Guangzhou"} }`
  * システムが関数を実行し、結果を返す

これにより、**関数呼び出し**は**ツール利用**を行うための具体的で安全なスキーマ駆動の方法となります。

---

## 3. 主な違い

* **範囲**:

  * ツール利用 = 一般的な概念（外部システムで拡張されたLLM）
  * 関数呼び出し = 構造化された呼び出しのための標準化されたAPI設計の1つ
* **制御**:

  * ツール利用はより自由形式かもしれません（LLMが決定しフォーマットする）
  * 関数呼び出しは厳密なスキーマを強制し、曖昧さと幻覚を減らします
* **相互運用性**:

  * ツール利用は多くの外部システム（検索、コード実行、画像生成）を含むことができます
  * 関数呼び出しは、正確な構造化された引数（APIやデータベースクエリなど）が必要な場合に最適です

---

## 4. メンタルモデル

* 関数呼び出しはツール利用の**サブセット**です
* ツール利用が*一般的な戦略*であるなら、関数呼び出しはほとんどのAPIが公開する*安全で構造化された方法*です

---

**並列ワークフローの例**（ユーザープロンプト → LLM出力 → 実行）も示して、違いをより具体的に説明しましょうか？