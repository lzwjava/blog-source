---
audio: false
generated: true
image: false
lang: ja
layout: post
model: x-ai/grok-4-fast:free
title: ピボタルクラウドファウンドリー概要
translated: true
type: note
---

### Pivotal Cloud Foundry (PCF) の概要
Pivotal Cloud Foundry (PCF) は、VMwareによるPivotalの2019年買収後、現在はVMware Tanzuの一部となっている、オープンソースのCloud Foundryプラットフォームの商用ディストリビューションです。これは、クラウドネイティブアプリケーションのデプロイ、スケーリング、管理を簡素化するために設計された、Platform as a Service (PaaS) です。PCFは基盤となるインフラストラクチャ (IaaS) の複雑さを抽象化し、開発者がサーバー、ネットワーク、オーケストレーションではなくコードに集中できるようにします。セキュリティ、コンプライアンス、移植性を重視しているため、銀行などの規制産業で特に人気があります。

PCFは、AWS、Azure、GCPのようなスタンドアロンのクラウドプロバイダーではありません。それらのIaaSプロバイダー、オンプレミスのデータセンター、またはプライベートクラウドの*上で*動作するレイヤーです。これにより、アプリケーションにとっての「クラウドオペレーティングシステム」となります。

### PCF/Cloud Foundry の設計とアーキテクチャ
Cloud Foundryの設計はモジュール式で、特定の思想に基づいており、スケーラブルで保守性の高いソフトウェアのための「12-factor app」原則を中心に構築されています。以下に高レベルの内訳を示します：

#### コアコンポーネントとフロー
1.  **Diego (ランタイムエンジン)**: PCFの心臓部。従来のGardenコンテナシステムを、コンテナ（Linuxコンテナまたは後の隔離のためのGarden/Linuxに基づく）を使用するモダンなオーケストレーション層で置き換えます。Diegoは「セル」（仮想マシンまたはベアメタルサーバー）全体でアプリケーションインスタンスを管理します。ステージング（ソースコードから実行可能なdropletへのアプリケーションのビルド）、トラフィックのルーティング、オートスケーリンググループによるスケーリングを処理します。

2.  **ルーティングとロードバランシング**: Gorouter（高性能リバースプロキシ）は、受信リクエストをルート（例: `app.example.com`）に基づいて適切なアプリインスタンスに転送します。スティッキーセッションとヘルスチェックをサポートします。

3.  **サービス マーケットプレイス**: PCFは、マネージドサービス（MySQL/PostgreSQLなどのデータベース、RabbitMQなどのメッセージキュー、またはサードパーティ統合）がカタログ化された「サービスブローカー」モデルを提供します。アプリはこれらのサービスに「バインド」して、資格情報と接続詳細をハードコーディングせずに自動的に取得します。

4.  **セキュリティとアイデンティティ**:
    -   UAA (User Account and Authentication): OAuth2ベースの認証、シングルサインオン (SSO)、ロールベースのアクセス制御 (RBAC) を処理します。
    -   LDAP、SAML、またはエンタープライズアイデンティティプロバイダーと統合され、銀行にとって重要です。

5.  **ビルドパックとランタイム**: PCFは「ビルドパック」（事前設定されたスクリプト）を使用して、Java、Node.js、Python、Go、.NETなどの言語でアプリを検出しパッケージ化します。単一プラットフォーム内での多言語環境をサポートします。

6.  **BOSH (デプロイメントオーケストレーター)**: PCFをインストールおよび管理するための基盤ツール。YAMLマニフェストを使用して、コンポーネントを冪等的に（一貫した状態を保証しながら）デプロイおよび更新します。BOSHはVMのプロビジョニング、アップグレード、監視を処理します。

7.  **モニタリングとロギング**: Loggregator（構造化ログ用）やFirehose（メトリクスストリーミング用）などの統合ツールは、ELK StackやSplunkなどのツールにデータを供給します。Ops Metricsは組み込みの観測可能性を提供します。

#### 主要な設計原則
-   **セルフサービスと開発者中心**: 開発者は `cf push` CLIを介してアプリをプッシュし、プラットフォームが残り（スケーリング、ヘルスチェック、ダウンタイムゼロのデプロイ）を処理します。
-   **マルチテナンシー**: 複数のチームまたは組織が、「スペース」とクォータを介してプラットフォームを安全に共有できます。
-   **水平スケーリング**: アプリはセル全体でインスタンスを複製することによりスケールアウトし、組み込みのフォールトトレランス（例：セルが故障した場合、Diegoがタスクを再スケジュール）を備えています。
-   **API駆動**: すべてがRESTful API (Cloud Controller) を介して公開され、Concourse CI/CDなどのツールによる自動化が可能になります。
-   **拡張性**: コンテナオーケストレーションのためのKubernetes統合（PKS経由、現在はTanzu Kubernetes Grid）、およびIstioなどのサービスメッシュをサポートします。

このアーキテクチャは水平方向にスケーラブルで、vSphere、AWS、Azure、GCP、OpenStackなどのIaaS上で動作します。典型的なデプロイメントでは、本番環境セットアップに10〜20台のVMが関与し、ネットワークポリシーと暗号化（TLS everywhere）による分離が行われます。

設計上の課題には、そのJava中心の遺産（リソースを大量に消費する可能性がある）と、運用チームに対する学習曲線が含まれますが、2011年から実戦でテストされています。

### 一部の銀行がPCFを選択する理由
銀行（例：HSBC、Barclays、Capital One、BBVA）は、金融サービスのニーズとの整合性から、しばしばPCFを選択します。その理由は以下の通りです：

1.  **規制コンプライアンスとセキュリティ**:
    -   PCFは、PCI-DSS、FIPS 140-2、GDPR、SOC 2などの標準をサポートします。暗号化されたetcdストレージ、監査ログ、きめ細かいアクセス制御などの機能を提供します。
    -   銀行は機密データを扱います。PCFの分離（例：マルチテナント設定でのカーネルの共有なし）と脆弱性スキャンは、生のIaaSと比較してリスクを軽減します。

2.  **ハイブリッドおよびマルチクラウド戦略**:
    -   多くの銀行にはレガシーなオンプレミスシステム（メインフレームなど）があり、完全なクラウド移行なしで近代化を望んでいます。PCFは「リフトアンドシフト」またはクラウドへの段階的なリファクタリングを可能にし、プライベート/パブリッククラウド全体で一貫して動作します。
    -   高セキュリティ環境向けに、エアギャップ（接続断）デプロイメントをサポートします。

3.  **開発者の生産性と標準化**:
    -   PCFは開発者への「黄金の道」を提供します：バックエンドのインフラに関係なく、1つのCLI、1つのワークフロー。これは、マイクロサービスの採用、CI/CDパイプライン、ブルーグリーンデプロイメントを加速します—低レイテンシーの取引や不正検出アプリにとって重要です。
    -   グローバルチームを持つ銀行はその移植性の恩恵を受けます。例えば、米国で開発されたアプリを再作業なしでEUのデータセンターにデプロイできます。

4.  **ベンダーエコシステムとサポート**:
    -   Pivotal/VMwareは、24/7のSLAと認証を含むエンタープライズサポートを提供します。銀行はマネージドサービス（例：PCF for PCF、現在はTanzu Application Service）を好みます。
    -   オープンソースルーツであるため、完全なベンダーロックインはありませんが、安定性のための商業的バックアップがあります。

事例研究：Capital Oneは2015年に「クラウドファースト」戦略のためにPCFを開拓し、市場投入までの時間の短縮（例：数週間から数分でのアプリデプロイ）を挙げました。BBVAはコアバンキングアプリのコンテナ化に使用し、コストを50％削減しました。

すべての銀行がPCFを使用するわけではありません—フィンテックスタートアップよりも、複雑で規制されたワークロードを持つエンタープライズで一般的です。

### Azure、AWS、GCPを直接選択しない理由
銀行はAzure/AWS/GCPを広範に*使用します*が、PCFはしばしば置き換えられるのではなく、その上に重ねられます。ネイティブのパブリッククラウドPaaS（例：AWS Elastic Beanstalk、Azure App Service、Google App Engine）は単純なアプリには優れていますが、PCFが好まれる、または併用される理由は以下の通りです：

1.  **ベンダーロックインの回避**:
    -   ネイティブサービスは単一のプロバイダーに縛ります（例：AWS LambdaはAWS専用）。PCFは3つすべてで（各クラウド用のタイル/ステムを介して）動作するため、銀行はプロバイダーを切り替えたり、リスクを分散できます（例：データ主権により米国はAWS、欧州はAzure）。
    -   銀行が1つのクラウドの価格や機能に見合わなくなった場合、PCFアプリは最小限の変更で移行できます—独自フォーマットとは異なります。

2.  **環境間の一貫性**:
    -   パブリッククラウドには断片化されたサービスがあります（例：コンテナ用のAWS ECS対Azure AKS）。PCFはPaaSレイヤーを標準化し、統一された開発者エクスペリエンスを提供します。これは、分散チームや買収を持つ銀行にとって極めて重要です。
    -   ハイブリッド設定：銀行の70％がハイブリッドクラウドを実行している（Gartner調べ）。PCFはオンプレミスのVMware/vSphereとパブリッククラウドをシームレスに橋渡しします。

3.  **高度なエンタープライズ機能**:
    -   ネイティブPaaSは、複数のサービス（例：AWS API Gateway + ECS + RDS）を組み合わせる必要がある場合があり、運用オーバーヘッドにつながります。PCFはこれらをバンドルします（例：RDS相当へのブローカー用のマーケットプレイス経由）。
    -   レガシー移行に優れる：銀行にはCOBOL/Javaモノリスがあります。PCFのビルドパックは、完全な書き換えなしでそれらをサポートします。
    -   コスト：パブリッククラウドはバースト性の高いワークロードには安価ですが、PCFは（クォータ強制などを通じて）リソース使用を最適化し、銀行はエンタープライズ契約を交渉します。

4.  **ネイティブが勝る場合**:
    -   純粋なサーバーレス？ネイティブを選択（例：イベント駆動型アプリ用のGCP Cloud Run）。
    -   銀行が1つのクラウドに全てを委ねている場合（例：SageMaker経由のML用のAWS）、深い統合を活用するためにPCFをスキップする可能性があります。
    -   PCFの欠点：初期コストが高い（ライセンスで10万ドル以上）、セットアップがより困難、Heroku（現在はSalesforce）のような完全ホステッドPaaSよりも「管理」度が低い。

実際には、多くの銀行が混合を使用します：コアアプリ用にAWS上のPCF、分析用にネイティブサービス（例：Azure Synapse）。

### なぜPCFを「中間」に置くのか？
PCFは、アプリケーション（上部）とIaaS（下部）の間の抽象化レイヤー（PaaS）として機能します。クラウドスタックを考えてみてください：

-   **IaaS (基盤)**: AWS EC2、Azure VMs、GCP Compute Engine—生のコンピュート/ストレージ/ネットワーキングを提供。
-   **PaaS (中間)**: PCFはここに位置し、IaaS上のアプリケーションライフサイクルを管理します。オーケストレーション、サービスディスカバリー、スケーリングを処理するため、VMを直接管理する必要はありません。
-   **アプリ (上部)**: マイクロサービス、API、UI。

**中間者の利点**:
-   **単純化**: 開発者はクラウド固有のAPIを学ぶ必要がありません。コードを一度プッシュすれば、どこでも実行できます。
-   **移植性**: アプリを変更せずにAWSからGCPに移動—ロックインを恐れる銀行や地理的冗長性を必要とする銀行にとって重要。
-   **運用効率**: クラウド全体でガバナンス（セキュリティポリシー、コスト管理など）を集中化。
-   **進化**: オンプレミスPaaSとして始まり、モダンワークロード向けにKubernetesと統合。

要するに、PCFはAWS/Azure/GCPと競合しているのではなく、エンタープライズの信頼性のためにそれらを強化しています。銀行向けに評価している場合は、プルーフオブコンセプトを検討してください。VMwareはTanzu経由でトライアルを提供しています。

より深く掘り下げるには、VMwareのドキュメントまたはCloud Foundryのオープンソースリポジトリを確認してください。具体的な内容（例：ユースケース）があれば、これを改良できます！