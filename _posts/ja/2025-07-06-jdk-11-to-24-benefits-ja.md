---
audio: false
generated: true
lang: ja
layout: post
title: JDK 24アップグレードのメリット解説
translated: true
type: note
---

JDK 11からJDK 24へのアップグレードは、パフォーマンス、新機能、セキュリティなど様々な面で大きなメリットがあります。以下に詳細を示します：

**1. パフォーマンスの向上:**

* **仮想スレッド（Project Loom）:** JDK 21で導入されましたが、JDK 24では仮想スレッドがさらに改良されています（JEP 491: Synchronize Virtual Threads Without Pinning）。これは高同時実行性アプリケーションにおいてゲームチェンジャーとなり、従来のプラットフォームスレッドのオーバーヘッドなしに数百万の軽量スレッドを可能にします。これにより、特にサーバーサイドアプリケーションのスケーラビリティと応答性が劇的に向上します。
* **高速な起動:** JDK 24には「事前クラスローディングとリンキング」（JEP 483）が含まれており、JVM起動時にアプリケーションクラスを即座に利用可能にし、起動時間を短縮します。これは、高速な起動が重要となるマイクロサービスやクラウドネイティブアプリケーションに特に有益です。
* **コンパクトオブジェクトヘッダー（実験的）:** JEP 450は、64ビットアーキテクチャにおけるオブジェクトヘッダーのサイズ削減を目指しており、多くの小さなオブジェクトを持つアプリケーションでは、大幅なメモリ節約（10〜20%）とキャッシュ局所性の向上につながる可能性があります。
* **ZGC 世代別モード（デフォルト）:** Z Garbage Collector (ZGC) は現在、世代別モード（JEP 490）をデフォルトとし、短命オブジェクトのガベージコレクションを最適化します。これにより、大規模なヒープでの停止時間の短縮とメモリ効率の向上が期待できます。
* **Stream Gatherers（JEP 485）:** この新しいAPIにより、Streamパイプライン内でのカスタム中間操作が可能になり、より柔軟で、場合によってはより効率的なデータ変換を提供します。
* **最適化されたForeign Function & Memory API バルク操作:** バルクメモリ操作がネイティブメソッドの代わりにJavaコードを使用するようになり、特定のアーキテクチャ（例: Linux x64/AArch64）では、特に小さなデータサイズにおいてパフォーマンスが向上します。
* **文字列連結の起動高速化:** 文字列連結に対する内部最適化により、起動の高速化とコード生成のオーバーヘッド削減が実現されています。

**2. 新しい言語機能とAPI:**

* **パターンマッチングの拡張（JEP 488）:** パターンマッチングがさらに改善され、パターン内でのプリミティブ型の使用が可能になり、`instanceof` と `switch` がすべてのプリミティブ型で動作するようになります。これにより、コードがより簡潔で読みやすくなります。
* **Scoped Values（JEP 487）:** プレビューAPIで、スレッド内および子スレッドとの間で不変データを共有する、より安全で効率的な方法を提供します。仮想スレッドと組み合わせることで特に有益です。
* **構造化並行性（JEP 499）:** プレビューAPIで、関連するタスクのグループを単一の単位として扱うことで、並行プログラミングを簡素化し、エラー処理、キャンセル、可観測性を向上させます。
* **Class-File API（JEP 484）:** Javaクラスファイルの解析、生成、変換のための標準APIです。
* **Vector API（JEP 489）:** （まだインキュベーター段階）このAPIは、サポートされているCPU上で最適なベクトル命令にコンパイルされるベクトル計算を表現することを可能にし、特定の数値演算において優れたパフォーマンスをもたらします。
* **鍵導出関数API（JEP 478）:** 秘密鍵から追加の鍵を導出するために使用される暗号アルゴリズムのためのプレビューAPIです。

**3. セキュリティの強化:**

* **耐量子暗号:** JDK 24は、耐量子のModule-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)（JEP 496）とModule-Lattice-Based Digital Signature Algorithm (ML-DSA)（JEP 497）の実装を導入し、Javaを将来の暗号学的課題に備えさせます。
* **TLSの改善:** TLSv1.3の設定可能な新規セッションチケット数や、パターンマッチングによるTLS暗号スイートの無効化メカニズムなどの機能強化が行われました。前方秘匿性を高めるため、TLS_RSA暗号スイートはデフォルトで無効化されています。
* **セキュリティマネージャーの削除（JEP 486）:** レガシー機能であるセキュリティマネージャーは恒久的に無効化されました。これによりJVMのセキュリティモデルが簡素化され、コンテナベースのサンドボックス化のような現代的なセキュリティプラクティスの使用が促進されます。
* **`sun.misc.Unsafe` への警告:** JDK 24では、`sun.misc.Unsafe` のメモリアクセスメソッドが使用された際に実行時警告が発せられ、VarHandle APIやForeign Function & Memory APIのようなより安全な代替手段への移行が促されます。

**4. 非推奨と削除:**

* これらはコード変更を必要とする可能性がありますが、よりクリーンで安全かつ保守性の高いプラットフォームへの貢献となります。セキュリティマネージャーの恒久的な無効化や `sun.misc.Unsafe` への警告はその例です。

**5. 長期サポート（LTS）の考慮事項:**

* JDK 11はLTSリリースであり、Oracleによる延長サポートは2032年1月まで利用可能です。
* JDK 24は*LTSリリースでは*ありません。JDK 21以降の次のLTSリリースは、2025年9月のJDK 25になる予定です。
* これは、JDK 24にアップグレードする場合、長期にわたる継続的なサポートとセキュリティアップデートを確保するために、比較的短期間でJDK 25（またはそれ以降のLTS）へのさらなるアップグレードを計画する必要があることを意味します。

**まとめ:**

JDK 11からJDK 24へのアップグレードは、豊富な新機能、仮想スレッドや高速起動による著しいパフォーマンス向上、そして重要なセキュリティ強化をもたらします。しかし、JDK 24が非LTSリリースであるため、長期の安定性とサポートのためには、その後のJDK 25（次のLTS）へのアップグレードが必要となる点を考慮することが重要です。