---
audio: false
generated: true
lang: ja
layout: post
title: Cloudflare入門
translated: true
type: note
---

Cloudflareは、Webサイトのパフォーマンス、セキュリティ、信頼性を向上させるさまざまなツールを提供する人気のサービスです。小規模なブログから大規模なeコマースサイトまで、CloudflareのDNS管理、コンテンツ配信ネットワーク（CDN）、セキュリティ保護などの機能は、大きな違いをもたらします。このブログ記事では、DNSの設定、Aレコードの管理、IP地域のブロックという3つの重要なタスクについて順を追って説明します。これらはCloudflareを最大限に活用するために不可欠であり、思っているよりも簡単に設定できます！

### **Cloudflareを利用する理由**

ハウツーに入る前に、Cloudflareの価値を簡単に確認しましょう：
- **DNS管理**: Cloudflareは高速で信頼性の高いDNSサービスを提供し、Webサイトが常にアクセス可能であることを保証します。
- **CDN**: 訪問者に近い場所でコンテンツをキャッシュすることで、サイトを高速化します。
- **セキュリティ**: CloudflareはDDoS保護、SSL/TLS暗号化、悪意のあるトラフィックをブロックするツールを提供します。
- **使いやすさ**: さらに良いことに、Cloudflareには小規模なWebサイトやブログに最適な無料プランがあります。

それでは、詳細を見ていきましょう。

---

### **ステップ1: CloudflareでのDNS設定**

DNS（ドメインネームシステム）は、インターネットの電話帳のようなものです。あなたのドメイン名（例: `example.com`）をサーバーが理解できるIPアドレスに変換します。Cloudflareを使用する場合、追加の速度とセキュリティを提供する彼らのプラットフォームを通じてDNSレコードを管理することになります。

#### **Cloudflare DNSの設定方法:**
1.  **Cloudflareにサインアップする**: まだアカウントをお持ちでない場合は、[CloudflareのWebサイト](https://www.cloudflare.com/)にアクセスして無料アカウントにサインアップしてください。
2.  **ドメインを追加する**: ログイン後、「サイトを追加」をクリックし、ドメイン名（例: `example.com`）を入力します。Cloudflareが既存のDNSレコードをスキャンします。
3.  **DNSレコードを確認する**: スキャン後、Cloudflareは現在のDNSレコードのリストを表示します。すべて正しく見えるか確認してください。
4.  **ネームサーバーを変更する**: CloudflareのDNSを使用するには、ドメインレジストラ（例: GoDaddy, Namecheap）でドメインのネームサーバーを更新する必要があります。Cloudflareは2つのネームサーバー（例: `ns1.cloudflare.com` と `ns2.cloudflare.com`）を提供します。レジストラのダッシュボードにログインし、ドメインのネームサーバー設定を見つけて、既存のネームサーバーをCloudflareのものに置き換えてください。
5.  **伝播を待つ**: DNSの変更が完全に伝播するまでに最大24時間かかる場合がありますが、通常はもっと高速です。完了すると、あなたのドメインはCloudflareのDNSを使用するようになります。

**重要な注意点**: Cloudflareから提供されたネームサーバーを正確にコピーしてください。誤ったネームサーバーはサイトをオフラインにする原因となります。

---

### **ステップ2: CloudflareでのAレコード管理**

Aレコードは、あなたのドメイン（またはサブドメイン）をIPv4アドレスにマッピングする一種のDNSレコードです。例えば、`example.com` が `192.0.2.1` を指すべきであることをインターネットに伝えます。Cloudflareでは、Aレコードの追加、編集、削除が簡単に行えます。

#### **Aレコードの管理方法:**
1.  **Cloudflareにログインする**: Cloudflareダッシュボードに移動し、管理したいドメインを選択します。
2.  **DNSに移動する**: 上部メニューの「DNS」タブをクリックします。
3.  **Aレコードを追加する**:
    - 「レコードを追加」をクリックします。
    - タイプのドロップダウンから「A」を選択します。
    - 名前を入力します（例: `www` は `www.example.com` 用、ルートドメインの場合は空白のままにします）。
    - ポイント先のIPv4アドレスを入力します。
    - レコードをCloudflare経由でプロキシするかどうかを選択します（詳細は後述）。
    - TTL（Time to Live）を設定します。プロキシされたレコードの場合、デフォルトは300秒です。
    - 「保存」をクリックします。
4.  **Aレコードを編集する**: リスト内の既存のAレコードを見つけ、「編集」をクリックし、変更を加えて「保存」をクリックします。
5.  **Aレコードを削除する**: レコードの横にある「編集」をクリックし、次に「削除」をクリックします。削除を確認します。

**プロキシ済み vs. DNSのみ**:
-   **プロキシ済み (オレンジの雲)**: トラフィックはCloudflareを経由し、CDN、セキュリティ、パフォーマンス機能が有効になります。
-   **DNSのみ (グレーの雲)**: トラフィックはあなたのサーバーに直接送信され、Cloudflareの保護をバイパスします。Cloudflareの機能を必要としないレコード（例: メールサーバー）にこれを使用します。

**クイックヒント**: CloudflareはIPv6アドレス用のAAAAレコードもサポートしています。それらの管理プロセスはAレコードと同じです。

---

### **ステップ3: CloudflareでのIP地域のブロック**

Cloudflareでは、特定の国や地域からのトラフィックをブロックすることができ、スパム、ボット、悪意のある攻撃の削減に役立ちます。この機能は、特定の地域からの望ましくないトラフィックに気付いた場合に特に便利です。

#### **IP地域をブロックする方法:**
1.  **Cloudflareにログインする**: Cloudflareダッシュボードに移動し、ドメインを選択します。
2.  **セキュリティに移動する**: 「セキュリティ」タブをクリックし、次に「WAF」（Webアプリケーションファイアウォール）を選択します。
3.  **ルールを作成する**:
    - 「ファイアウォールルールを作成」をクリックします。
    - ルールに名前を付けます（例: 「特定の国をブロック」）。
    - 訪問者の国に基づいてトラフィックをブロックするようにルールを設定します。例:
        - フィールド: 「国」
        - 演算子: 「が次の中にある」
        - 値: ブロックしたい国を選択します。
    - アクションを選択します: 「ブロック」。
    - 「デプロイ」をクリックします。
4.  **ブロックされたトラフィックを監視する**: 「セキュリティ」タブの「イベント」でブロックされたリクエストを表示できます。

**重要な注意点**: この機能は注意して使用してください。地域全体をブロックすると、意図せず正当なユーザーがサイトにアクセスできなくなる可能性があります。トラフィックを監視し、必要であると確信した場合にのみ地域をブロックするのが最善です。

---

### **追加のヒントとベストプラクティス**

-   **Cloudflareの無料プランを利用する**: 小規模なWebサイトに最適で、DNS管理、CDN、基本的なセキュリティなどの必須機能が含まれています。
-   **レコードをプロキシする**: 最適なパフォーマンスとセキュリティのために、可能な限りAレコードとAAAAレコードをCloudflare経由でプロキシしてください。
-   **SSL/TLSを設定する**: Cloudflareは、訪問者とサイト間のトラフィックを暗号化する無料のSSL証明書を提供します。これは「SSL/TLS」タブで有効にできます。
-   **キャッシングを試す**: Cloudflareのキャッシングはサイトを大幅に高速化できます。「キャッシング」タブをチェックして設定してください。
-   **サイトを監視する**: Cloudflareの分析を使用して、トラフィック、脅威、パフォーマンスを確認しましょう。

---

### **まとめ**

Cloudflareは、Webサイトの速度、セキュリティ、信頼性を強化する強力なツールです。このガイドの手順に従うことで、DNSの設定、Aレコードの管理、IP地域のブロックを簡単に行い、サイトを保護できます。以下の点を忘れないでください：
-   **DNS設定**: ダウンタイムを避けるために、ネームサーバーを正しく更新してください。
-   **Aレコード**: ドメインをサーバーのIPアドレスにマッピングするために使用し、追加の利点のためにプロキシを検討してください。
-   **IP地域ブロック**: 正当なユーザーをブロックするのを避けるために、この機能は控えめに使用してください。

Cloudflareは、SSL/TLS暗号化、キャッシング、高度なセキュリティツールなど、さらに多くの機能を提供しています。基本を理解したら、これらのオプションを探求して、プラットフォームからさらに多くの利益を得てください。