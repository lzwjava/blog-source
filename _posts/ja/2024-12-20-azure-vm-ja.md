---
audio: false
generated: false
image: false
lang: ja
layout: post
title: Azureサーバーのセットアップ
translated: true
type: post
---

Microsoft Azure上にサーバーをセットアップし、特定のポートを開くように設定することは、ホスティングサービスやプロキシなど、さまざまなアプリケーションにとって重要です。このガイドでは、Azure仮想マシン（VM）を作成し、ファイアウォールを設定してポート1080を開く手順を説明します。

## 目次

1. [前提条件](#prerequisites)
2. [Azure仮想マシンの作成](#creating-an-azure-virtual-machine)
3. [ポート1080を開くためのファイアウォールの設定](#configuring-the-firewall-to-open-port-1080)
4. [設定のテスト](#testing-the-configuration)
5. [結論](#conclusion)

## 前提条件

始める前に、以下のものを用意してください：

- アクティブな [Microsoft Azure](https://azure.microsoft.com/) アカウント。
- Azure Portal の基本的な使用知識。
- VM にアクセスするための SSH クライアント（macOS/Linux の Terminal や Windows の PuTTY など）。

## Azure仮想マシンの作成

1. Azure Portalにログインする:
   [Azure Portal](https://portal.azure.com/)にアクセスし、資格情報を使用してサインインします。

2. 新しい仮想マシンの作成:
   - 左上隅の「リソースの作成」をクリックします。
   - 利用可能なリソースのリストから「仮想マシン」を選択します。

3. VMの基本設定:
   - サブスクリプション: 使用するAzureサブスクリプションを選択します。
   - リソースグループ: 新しいリソースグループを作成するか、既存のものを選択します。
   - 仮想マシン名: VMの名前を入力します（例: `AzureServer`）。
   - リージョン: ターゲットユーザーに最も近いリージョンを選択します。
   - イメージ: OSイメージを選択します（例: Ubuntu 22.04 LTS）。
   - サイズ: パフォーマンス要件に基づいてVMサイズを選択します。
   - 認証: セキュアなアクセスのためにSSH公開鍵を選択します。公開SSH鍵をアップロードします。

4. ネットワーキングの設定:
   - VMが適切な仮想ネットワークとサブネットに配置されていることを確認します。
   - 外部アクセスを許可するために、パブリックIPを有効のままにしておきます。

5. 確認と作成:
   - 設定を確認します。
   - 「作成」をクリックしてVMをデプロイします。デプロイには数分かかる場合があります。

## ポート1080を開くためのファイアウォール設定

VMが起動して実行されたら、Azureのネットワークセキュリティグループ（NSG）を設定して、ポート1080のトラフィックを許可する必要があります。

1. VMのネットワーク設定に移動します：
   - Azureポータルで「Virtual Machines」に進みます。
   - 対象のVM（`AzureServer`）を選択します。
   - 左側のサイドバーで「Networking」をクリックします。

2. ネットワークセキュリティグループ（NSG）を特定する：
   - 「ネットワークインターフェース」の下で、関連するNSGを見つけます。
   - NSGをクリックして、そのルールを管理します。

3. インバウンドセキュリティルールを追加:
   - NSG設定で、「インバウンドセキュリティルール」に移動します。
   - 「追加」をクリックして新しいルールを作成します。

4. ルールを設定する:
   - 送信元: 任意（またはセキュリティを強化するために範囲を指定）。
   - 送信元ポート範囲: `*`
   - 宛先: 任意
   - 宛先ポート範囲: `1080`
   - プロトコル: TCP
   - アクション: 許可
   - 優先度: `1000`（既存のルールと競合しないようにする）。
   - 名前: `Allow-1080-TCP`

5. ルールを保存する：
   - 「追加」をクリックして新しいルールを適用します。

## 設定のテスト

ファイアウォールの設定が完了したら、ポート1080が開いてアクセス可能であることを確認することが重要です。

1. Telnetを使用してポートのアクセス可能性を確認する:
   ローカルマシンから、次のコマンドを実行します:

```bash
telnet <あなたのVMのIP> 1080
```

   - `<YOUR_VM_IP>` をあなたのVMのパブリックIPアドレスに置き換えてください。
   - 接続が成功した場合、そのポートは開いており、アクセス可能です。

2. 代替のポートチェックツール:
   - Netcat (`nc`):
     ```bash
     nc -zv <あなたのVMのIP> 1080
     ```
   - オンラインポートチェッカー:
     [canyouseeme.org](https://canyouseeme.org/) のようなオンラインサービスを使用して、ポート1080が開いているかどうかを確認します。

3. トラブルシューティング:
   - 接続の問題: NSGルールが正しく設定されていること、およびVM上のローカルファイアウォールがポート1080でのトラフィックを許可するように設定されていることを確認してください。
   - 誤ったIP: VMの正しいパブリックIPアドレスを使用していることを確認してください。

## 結論

このガイドに従うことで、Azure仮想マシンのセットアップと、ポート1080を開くためのファイアウォールの設定が無事に完了しました。このセットアップは、特定のポートアクセスを必要とするさまざまなアプリケーションやサービスの展開の基盤となります。

さらに詳しい設定、例えばポート1080でのプロキシサービスの設定やその他のアプリケーションの設定については、専用の記事「[V2Rayプロキシ設定](#)」および「[カスタムvmess URLの生成](#)」を参照してください。