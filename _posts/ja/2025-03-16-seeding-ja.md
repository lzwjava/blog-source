---
audio: false
generated: true
lang: ja
layout: post
title: シーディングと自動ファイル管理のためのqBittorrent設定
translated: true
type: note
---

qBittorrentでトレントのシーディングを継続しつつ、完了した`.mkv`ファイルを自動的に`/var/www/movies`に移動してサーバーで配信したいようですね。以下では、`/var/www/movies`が有効なディレクトリであるシステム（例：ApacheやNginxを搭載したLinuxサーバー）でqBittorrentを使用していることを想定して、設定方法を案内します。

---

### ステップバイステップガイド

#### 1. **qBittorrentのファイル管理を理解する**
   - qBittorrentは、組み込みの「場所の設定」または「移動」機能を適切に使用すれば、ダウンロード完了後もファイルを自動的に移動させながらシーディングを継続できます。qBittorrentの外部で手動でファイルを移動すると（例：ファイルエクスプローラー経由）、新しい場所をqBittorrentに再設定しない限りシーディングが中断されます。

#### 2. **qBittorrentの設定を構成する**
   - qBittorrentを開きます。
   - **ツール > オプション**（または`Alt + O`）に移動します。

   ##### a) **デフォルトのダウンロード場所を設定**
   - **ダウンロード**タブで：
     - **デフォルトの保存先**を、ファイルが最初にダウンロードされる一時ディレクトリに設定します（例：`/home/user/downloads`または空き領域がある場所）。ここでqBittorrentは、ファイルが移動されるまでダウンロードとシーディング中にファイルを保存します。
     - 必要に応じて、**未完了のファイルを保存する場所**を同じディレクトリまたは別のディレクトリに設定します（任意）。

   ##### b) **自動ファイル移動を有効化**
   - **トレントの完了時**までスクロールします：
     - **完了したダウンロードを自動的に移動**のチェックボックスをオンにします。
     - パスを`/var/www/movies`に設定します。これにより、ダウンロードが完了するとqBittorrentは`.mkv`ファイルを`/var/www/movies`に移動します。
   - 重要：qBittorrentは移動後も新しい場所（`/var/www/movies`）からシーディングを継続するため、シーディング機能が失われる心配はありません。

   ##### c) **オプション: .mkvファイルをフィルタリング**
   - `.mkv`ファイルのみを`/var/www/movies`に移動させたい場合（他のファイルタイプ如き`.txt`や`.nfo`は移動させない）、自動移動オプションの代わりにqBittorrentの**外部プログラムの実行**機能を使用できます（下記のステップ3参照）。

   ##### d) **シーディング制限**
   - **BitTorrent**タブまたは**ダウンロード**タブで：
     - 必要に応じてシーディング制限を設定します（例：特定の比率または時間に達するまでシード）。無制限のシーディングの場合、**比率**と**時間**を`0`に設定するか、制限のチェックを外します。
     - これにより、qBittorrentは`/var/www/movies`からシードを無期限にアップロードし続けます。

   - **適用**と**OK**をクリックして設定を保存します。

#### 3. **代替案: より細かい制御のために「外部プログラムの実行」を使用**
   - よりカスタマイズが必要な場合（例：`.mkv`ファイルのみを移動し、他のファイルは元の場所からシーディングを継続）、以下を使用します：
     - **オプション > ダウンロード**で、**外部プログラムの実行**までスクロールします。
     - **トレント完了時に外部プログラムを実行**のチェックボックスをオンにします。
     - 以下のようなコマンドを入力します：
       ```
       mv "%F"/*.mkv /var/www/movies/
       ```
       - `%F`は、コンテンツフォルダのパスを表すqBittorrentのプレースホルダーです。このコマンドは`.mkv`ファイルのみを`/var/www/movies`に移動します。
     - 注意：qBittorrentは移動後も`.mkv`ファイルを`/var/www/movies`からシーディングしますが、他のファイル（例：`.torrent`、`.nfo`）は元の場所に残り、さらに調整しない限りそこからシーディングを継続します。

#### 4. **権限を確認する**
   - qBittorrentが`/var/www/movies`への書き込み権限を持っていることを確認します：
     - Linuxでは、以下を実行します：
       ```
       sudo chown -R <qbittorrent-user>:<qbittorrent-group> /var/www/movies
       sudo chmod -R 775 /var/www/movies
       ```
       `<qbittorrent-user>`と`<qbittorrent-group>`を、qBittorrentが実行されているユーザーとグループに置き換えます（例：あなたのユーザー名、またはサービスとして実行されている場合は`qbittorrent`）。
   - 適切な権限がない場合、qBittorrentはこのディレクトリにファイルを移動できません。

#### 5. **設定をテストする**
   - qBittorrentに`.mkv`ファイルを含むトレントを追加します。
   - ダウンロードが完了するのを待ちます。
   - 以下を確認します：
     - `.mkv`ファイルが`/var/www/movies`に移動していること。
     - qBittorrent内のトレントのステータスが**シーディング**に変わり、アップロード速度がファイルを共有中であることを示していること。
   - `http://<サーバーIP>/movies`のように、`/var/www/movies`にファイルが存在しアクセス可能であることを確認します（例：ウェブサーバー経由）。

#### 6. **既存のファイルを手動で移動（必要に応じて）**
   - 既にダウンロード済みのトレントをシーディングを中断せずに`/var/www/movies`に移動したい場合：
     - qBittorrentで、トレントを右クリックします。
     - **場所の設定**を選択します。
     - `/var/www/movies`を選択し、qBittorrentにファイルを移動させます。
     - 移動後、qBittorrentは新しい場所からシーディングを再開します。

#### 7. **アップロード設定を最適化する**
   - シーディングを最大化するには：
     - **オプション > 速度**に移動します：
       - **アップロード**を`0`（無制限）または高い値に設定します（例：最大アップロード速度の80%）。
     - **オプション > 接続**に移動します：
       - **UPnP / NAT-PMP ポート転送を有効にする**がチェックされていることを確認します（ルーターがサポートしている場合）、または接続性向上のために手動でポートを転送します。
       - **グローバル最大アップロードスロット数**を増やします（例：50や100）して、より多くのピアが接続できるようにします。

---

### 主な注意点
- **シーディングの継続性**: qBittorrentにファイル移動を処理させれば（自動移動または「場所の設定」経由）、内部の追跡情報が更新され、`/var/www/movies`からシーディングを継続します。
- **ウェブサーバーアクセス**: ウェブサーバー（例：Apache/Nginx）が`/var/www/movies`からファイルを配信するように設定されていることを確認します。これはqBittorrentの範囲外ですが、サーバー目標にとって重要です。
- **ストレージ**: `/var/www/movies`にファイルを保存する十分な空き容量があることを確認します。

問題が発生した場合（例：ファイルが移動しない、シーディングが停止する）、設定の詳細（OS、qBittorrentバージョンなど）をお知らせいただければ、解決策を調整します！