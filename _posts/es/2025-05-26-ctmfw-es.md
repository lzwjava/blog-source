---
audio: false
generated: true
lang: es
layout: post
title: El Comando ctmfw En Control-M
translated: true
type: note
---

El comando `ctmfw` en Control-M es parte de la utilidad File Watcher, utilizada para monitorear archivos en busca de eventos como creación, eliminación o finalización de transferencia. El comando específico `ctmfw %%FILENAME CREATE 0 60 10 3 1410` puede desglosarse según los parámetros definidos en la documentación de Control-M. Esto es lo que significa cada parte:

- **`ctmfw`**: La utilidad Control-M File Watcher, que detecta eventos relacionados con archivos y activa acciones basadas en condiciones, como iniciar un job o ejecutar un comando.

- **`%%FILENAME`**: Una variable que representa el nombre o la ruta del archivo a monitorear (por ejemplo, `datafile.txt` o un patrón como `*.csv`). El nombre real del archivo se resuelve en tiempo de ejecución, típicamente definido en el job o entorno de Control-M.

- **`CREATE`**: El modo de operación, que indica que la utilidad está vigilando la **creación** del archivo especificado. Otros modos posibles incluyen `DELETE` para monitorear la eliminación de archivos.

- **`0`**: El tamaño mínimo de archivo (en bytes) requerido para que el archivo se considere válido. Un valor de `0` significa que se acepta cualquier tamaño de archivo, por lo que la utilidad detectará el archivo independientemente de su tamaño.

- **`60`**: El intervalo (en segundos) entre intentos sucesivos para verificar la existencia del archivo. La utilidad verifica cada 60 segundos si el archivo ha sido creado.

- **`10`**: El intervalo (en segundos) entre los intentos de monitorear el tamaño del archivo después de que se detecta el archivo. Esto asegura que el tamaño del archivo sea estable (que no se esté escribiendo aún). La utilidad verifica el tamaño del archivo cada 10 segundos.

- **`3`**: El número de iteraciones durante las cuales el tamaño del archivo debe permanecer estático (sin cambios) para confirmar que el archivo está completamente creado. La utilidad verifica el tamaño del archivo 3 veces (en intervalos de 10 segundos, totalizando 30 segundos) para asegurarse de que sea estable.

- **`1410`**: El tiempo máximo (en minutos) que la utilidad se ejecutará mientras espera a que el archivo sea creado y cumpla con los criterios de tamaño. 1410 minutos equivalen aproximadamente a 23.5 horas. Si el archivo no se detecta o no se estabiliza dentro de este tiempo, la utilidad agota el tiempo de espera y puede ejecutar una acción `DO_NOTOK` (por ejemplo, informar "FILE WAS NOT CREATED").

### Cómo Funciona
Este comando monitorea la creación de un archivo especificado por `%%FILENAME`. Verifica cada 60 segundos la existencia del archivo. Una vez detectado, verifica que el tamaño del archivo permanezca sin cambios durante 3 iteraciones de 10 segundos cada una (30 segundos en total). El proceso continuará hasta por 1410 minutos (23.5 horas) o hasta que el archivo sea detectado y estable. Si el archivo se crea y cumple los criterios, se ejecuta una acción `DO_OK` (por ejemplo, activar un job o comando). Si no, se realiza una acción `DO_NOTOK`.

### Escenario Ejemplo
Si `%%FILENAME` está configurado como `/home/controlm/datafile.txt`, la utilidad:
- Verifica cada 60 segundos la existencia de `datafile.txt`.
- Una vez encontrado, asegura que su tamaño sea estable durante 30 segundos (3 verificaciones en intervalos de 10 segundos).
- Se ejecuta hasta por 23.5 horas o hasta que el archivo sea estable.
- Si tiene éxito, podría activar un job (por ejemplo, mover el archivo a otro directorio). Si se agota el tiempo, podría registrar "FILE WAS NOT CREATED".

### Notas
- La variable `%%FILENAME` debe estar definida en el job o entorno de Control-M, o el comando fallará.
- La utilidad ignora archivos con un tiempo de modificación mayor a 50 años.
- Si se utilizan comodines en `%%FILENAME` (por ejemplo, `*.csv`), pueden ser necesarios parámetros adicionales como `MONITOR_FILE_SIZE` para manejar múltiples archivos.
- Para el monitoreo cíclico (verificaciones repetidas después de la detección), se requeriría un parámetro `CYCLIC_INTERVAL`, pero no se especifica aquí.

Esta explicación se basa en la documentación de Control-M File Watcher de fuentes como la documentación oficial de BMC y discusiones de la comunidad.[](https://documents.bmc.com/supportu/controlm-saas/en-US/Documentation/ctmfw.htm)[](https://documents.bmc.com/supportu/9.0.21/en-US/Documentation/ctmfw.htm)[](https://pdfslide.net/documents/file-watcher-for-control-m.html)