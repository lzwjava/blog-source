---
audio: false
lang: es
layout: post
title: Escáner de IP LAN
translated: true
---

Este script de Python escanea una red local en busca de direcciones IP activas. Utiliza el comando `ping` para comprobar si un host es accesible y emplea multithreading para acelerar el proceso de escaneo. Un semáforo limita el número de hilos concurrentes para evitar sobrecargar el sistema. El script toma una dirección de red (por ejemplo, "192.168.1.0/24") como entrada e imprime si cada dirección IP de la red está activa o inactiva.


```python
import subprocess
import ipaddress
import threading
import os

MAX_THREADS = 255  # Número máximo de hilos a utilizar

def is_host_up(host):
    """
    Comprueba si un host está activo usando ping.
    Devuelve True si el host está activo, False en caso contrario.
    """
    try:
        # -c 1: Enviar solo 1 paquete
        # -W 1: Esperar 1 segundo una respuesta
        subprocess.check_output(["ping", "-c", "1", "-W", "1", host], timeout=1)
        return True
    except subprocess.CalledProcessError:
        return False
    except subprocess.TimeoutExpired:
        return False

def scan_ip(ip_str):
    """
    Escanea una sola dirección IP e imprime su estado.
    """
    if is_host_up(ip_str):
        print(f"{ip_str} está activa")
    else:
        print(f"{ip_str} está inactiva")

def scan_network(network):
    """
    Escanea una red en busca de hosts activos usando hilos, limitando el número de hilos concurrentes.
    """
    print(f"Escaneando red: {network}")
    threads = []
    semaphore = threading.Semaphore(MAX_THREADS)  # Limita el número de hilos concurrentes

    def scan_ip_with_semaphore(ip_str):
        semaphore.acquire()
        try:
            scan_ip(ip_str)
        finally:
            semaphore.release()

    for ip in ipaddress.IPv4Network(network):
        ip_str = str(ip)
        thread = threading.Thread(target=scan_ip_with_semaphore, args=(ip_str,))
        threads.append(thread)
        thread.start()

    for thread in threads:
        thread.join()

if __name__ == "__main__":
    network_to_scan = "192.168.1.0/24"  # Cambia esto a tu red
    scan_network(network_to_scan)

```
