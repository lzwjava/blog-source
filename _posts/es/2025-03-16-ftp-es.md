---
audio: false
generated: true
lang: es
layout: post
title: Servidor FTP
translated: true
type: note
---

Para configurar un servidor FTP en Ubuntu y poder acceder a tus archivos (como esos archivos `.mkv` en `/var/www/movies/`) desde tu iPad u otros dispositivos, puedes usar **vsftpd** (Very Secure FTP Daemon), una opción ligera y segura. Aquí tienes una guía paso a paso adaptada a tu configuración:

### Prerrequisitos
- Estás en Ubuntu (por ejemplo, 22.04 o 24.04 al 15 de marzo de 2025).
- Tienes privilegios de sudo.
- Tu servidor Nginx está en `192.168.1.27`, y los archivos están en `/var/www/movies/`.

### Paso 1: Instalar vsftpd
1. **Actualizar la Lista de Paquetes**:
   ```bash
   sudo apt update
   ```
2. **Instalar vsftpd**:
   ```bash
   sudo apt install vsftpd -y
   ```
3. **Verificar la Instalación**:
   ```bash
   sudo systemctl status vsftpd
   ```
   - Debería decir `active (running)`. Si no, inícialo:
     ```bash
     sudo systemctl start vsftpd
     sudo systemctl enable vsftpd  # Iniciar al arrancar
     ```

### Paso 2: Configurar vsftpd
El archivo de configuración por defecto es `/etc/vsftpd.conf`. Lo modificaremos para acceso básico.

1. **Hacer una Copia de Seguridad de la Configuración Original**:
   ```bash
   sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.bak
   ```

2. **Editar la Configuración**:
   ```bash
   sudo nano /etc/vsftpd.conf
   ```
   Realiza estos cambios:
   - Habilitar usuarios locales:
     ```bash
     local_enable=YES
     ```
   - Permitir subida de archivos (opcional, si quieres subir archivos):
     ```bash
     write_enable=YES
     ```
   - Restringir usuarios a sus directorios personales (opcional, para seguridad):
     ```bash
     chroot_local_user=YES
     ```
   - Apuntar a tu directorio de películas (opcional, ver Paso 3 para la configuración de usuario):
     - Por defecto, los usuarios acceden a sus directorios personales. Ajustaremos esto más tarde.

   Guarda (`Ctrl + O`, Enter, `Ctrl + X`).

3. **Reiniciar vsftpd**:
   ```bash
   sudo systemctl restart vsftpd
   ```

### Paso 3: Configurar un Usuario FTP
Puedes usar un usuario existente o crear uno nuevo para acceder a `/var/www/movies/`.

#### Opción 1: Usar un Usuario Existente
Si quieres usar tu usuario actual de Ubuntu (por ejemplo, `user`):
1. **Verificar tu Nombre de Usuario**:
   ```bash
   whoami
   ```
2. **Establecer Contraseña (si es necesario)**:
   ```bash
   sudo passwd user  # Reemplaza "user" con tu nombre de usuario
   ```
3. **Enlazar al Directorio de Películas**:
   - Por defecto, el directorio personal de este usuario (por ejemplo, `/home/user/`) es la raíz FTP. Para acceder a `/var/www/movies/`, crea un enlace simbólico:
     ```bash
     ln -s /var/www/movies/ /home/user/movies
     ```
   - O, ajusta los permisos (menos seguro):
     ```bash
     sudo chown -R user:user /var/www/movies
     ```

#### Opción 2: Crear un Usuario FTP Dedicado
Para mayor seguridad:
1. **Añadir Usuario**:
   ```bash
   sudo adduser ftpuser
   ```
   - Sigue las indicaciones para establecer una contraseña y detalles.
2. **Establecer el Directorio Personal como Movies**:
   ```bash
   sudo usermod -d /var/www/movies ftpuser
   sudo chown -R ftpuser:ftpuser /var/www/movies
   ```

3. **Restringir Acceso** (si `chroot_local_user=YES`):
   - Asegúrate de que `/var/www/movies` sea escribible por `ftpuser`:
     ```bash
     sudo chmod -R 755 /var/www/movies
     ```

### Paso 4: Abrir Puertos del Firewall
FTP usa los puertos 20 y 21 por defecto.
1. **Permitir FTP en UFW**:
   ```bash
   sudo ufw allow 21/tcp
   sudo ufw allow 20/tcp
   sudo ufw status
   ```
   - Debería mostrar `20/tcp ALLOW` y `21/tcp ALLOW`.

2. **Reiniciar vsftpd**:
   ```bash
   sudo systemctl restart vsftpd
   ```

### Paso 5: Probar FTP desde el iPad
Necesitarás una aplicación cliente FTP en tu iPad.

#### Aplicación Recomendada para iPad: FileZilla o FE File Explorer
- **FileZilla** (Gratis):
  1. Instálala desde la App Store (busca "FileZilla").
  2. Abre FileZilla.
  3. Toca **New Site** o **Connect**.
  4. Introduce:
     - Host: `192.168.1.27`
     - Usuario: `ftpuser` (o tu nombre de usuario)
     - Contraseña: [tu contraseña]
     - Puerto: 21 (por defecto)
  5. Toca **Connect**.
- **FE File Explorer** (Gratis con compras dentro de la app):
  1. Instálala desde la App Store.
  2. Toca **+** > **FTP**.
  3. Introduce los mismos detalles de arriba.
  4. Conecta.

#### Transmisión desde FTP
- La mayoría de las aplicaciones FTP te permiten navegar por los archivos. Para transmitir archivos `.mkv`:
  - Toca el archivo `.mkv` en la aplicación.
  - Si no se reproduce directamente, descarga una aplicación de transmisión como **VLC for Mobile** (ver respuesta anterior), luego usa su opción **Network Stream** con una URL FTP:
    ```
    ftp://ftpuser:contraseña@192.168.1.27/tuarchivo.mkv
    ```

### Paso 6: Verificar el Acceso
- Desde tu iPad, conéctate a `192.168.1.27` a través de la aplicación FTP.
- Deberías ver el contenido de `/var/www/movies/` (por ejemplo, `tuarchivo.mkv`).
- Toca para previsualizar o transmitir (dependiendo de la aplicación).

### Resolución de Problemas
- **Conexión Rechazada**: Verifica `sudo ufw status` y asegúrate de que los puertos 20/21 estén abiertos. Verifica que vsftpd esté ejecutándose (`sudo systemctl status vsftpd`).
- **Permiso Denegado**: Confirma que el usuario sea propietario o pueda leer `/var/www/movies/` (`ls -l /var/www/movies/`).
- **404 o Sin Archivos**: Asegúrate de que la ruta del directorio coincida con la configuración del directorio personal o del enlace simbólico.

### Notas Finales
- **Seguridad**: Para una red local, esta configuración es adecuada. Para acceso externo, considera FTPS (FTP encriptado) habilitando SSL en `vsftpd.conf`.
- **Nginx vs. FTP**: Ya estás transmitiendo vía HTTP con Nginx—FTP añade gestión de archivos. Usa VLC en tu iPad para transmisión HTTP si la configuración de FTP te parece redundante.

¡Ahora tu iPad tiene la "magia" FTP para acceder a los archivos de tu servidor Ubuntu! Avísame si tienes algún problema.