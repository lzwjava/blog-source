---
audio: false
generated: true
lang: es
layout: post
title: Configuración de un Servidor SMB para Compartir Medios en Ubuntu
translated: true
type: note
---

Aquí tienes una guía paso a paso para configurar un servidor SMB (Server Message Block) en Ubuntu para servir archivos multimedia. SMB es un protocolo que te permite compartir archivos a través de una red, haciéndolo ideal para servir contenido multimedia a dispositivos como computadoras, televisores o dispositivos móviles. Usaremos Samba, el software que proporciona la funcionalidad SMB en Linux, y lo configuraremos para compartir un directorio que contenga tus archivos multimedia.

---

### Paso 1: Instalar Samba
Primero, necesitas instalar Samba en tu sistema Ubuntu. Abre una terminal y ejecuta los siguientes comandos:

```bash
sudo apt update
sudo apt install samba
```

- `sudo apt update` actualiza la lista de paquetes para asegurarte de obtener la última versión.
- `sudo apt install samba` instala el paquete Samba, que incluye las herramientas y servicios necesarios.

---

### Paso 2: Hacer una copia de seguridad del archivo de configuración de Samba
Antes de realizar cambios, es una buena práctica hacer una copia de seguridad del archivo de configuración predeterminado de Samba. Ejecuta:

```bash
sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.backup
```

Esto crea una copia del archivo original (`smb.conf.backup`) por si necesitas revertir los cambios más tarde.

---

### Paso 3: Configurar el recurso compartido multimedia
El archivo de configuración de Samba se encuentra en `/etc/samba/smb.conf`. Editarás este archivo para definir un recurso compartido para tus archivos multimedia. Para este ejemplo, asume que tus archivos multimedia están almacenados en `/home/usuario/media` (reemplaza `usuario` con tu nombre de usuario real).

1.  Abre el archivo de configuración en un editor de texto, como `nano`:
    ```bash
    sudo nano /etc/samba/smb.conf
    ```

2.  Desplázate hasta el final del archivo y añade la siguiente sección:
    ```ini
    [media]
        path = /home/usuario/media
        browseable = yes
        read only = yes
        guest ok = yes
    ```

3.  Guarda y sal:
    - En `nano`, presiona `Ctrl+O`, luego `Enter` para guardar, y `Ctrl+X` para salir.

#### Explicación de la configuración:
- `[media]`: El nombre del recurso compartido, visible para los usuarios que navegan por la red.
- `path = /home/usuario/media`: El directorio que quieres compartir (ajusta esto para que coincida con la ubicación de tu carpeta multimedia).
- `browseable = yes`: Hace que el recurso compartido sea visible al navegar por la red.
- `read only = yes`: Evita que los usuarios modifiquen o eliminen archivos (ideal para servir medios).
- `guest ok = yes`: Permite el acceso sin nombre de usuario ni contraseña, manteniéndolo simple para el acceso a medios.

---

### Paso 4: Verificar la configuración
Para asegurarte de que no hay errores de sintaxis en tu configuración, ejecuta:

```bash
testparm
```

Este comando verifica el archivo `smb.conf` y muestra los servicios cargados. Si no hay errores, puedes proceder.

---

### Paso 5: Reiniciar los servicios de Samba
Samba ejecuta dos servicios: `smbd` (maneja el intercambio de archivos) y `nmbd` (maneja el descubrimiento de red). Reinícialos para aplicar tus cambios:

```bash
sudo systemctl restart smbd
sudo systemctl restart nmbd
```

Para asegurarte de que estos servicios se inicien automáticamente al arrancar (generalmente están habilitados por defecto), puedes ejecutar:

```bash
sudo systemctl enable smbd
sudo systemctl enable nmbd
```

---

### Paso 6: Ajustar los permisos de archivos
Para que el acceso de invitado funcione, el directorio multimedia y sus archivos deben ser legibles para todos. Establece los permisos apropiados con:

```bash
sudo chmod -R 755 /home/usuario/media
```

- `755` significa que el propietario tiene permisos completos (lectura, escritura, ejecución), mientras que otros tienen permisos de lectura y ejecución (necesarios para acceder y listar archivos).
- `-R` aplica el cambio recursivamente a todos los archivos y subdirectorios.

---

### Paso 7: Configurar el firewall
Si el firewall de Ubuntu (UFW) está activo, necesitas permitir el tráfico SMB. Primero, verifica el estado del firewall:

```bash
sudo ufw status
```

Si está activo, abre los puertos necesarios:

```bash
sudo ufw allow 139/tcp
sudo ufw allow 445/tcp
sudo ufw allow 137/udp
sudo ufw allow 138/udp
```

- Los puertos 139 y 445 (TCP) se utilizan para el intercambio de archivos SMB.
- Los puertos 137 y 138 (UDP) son utilizados por `nmbd` para el descubrimiento de red.

Recarga el firewall para aplicar los cambios:

```bash
sudo ufw reload
```

Si el firewall está inactivo, puedes omitir este paso.

---

### Paso 8: Probar el recurso compartido SMB
Tu servidor SMB debería estar ahora en funcionamiento. Para probarlo:

1.  Encuentra la dirección IP de tu máquina Ubuntu:
    ```bash
    ip addr show
    ```
    Busca la dirección IP (por ejemplo, `192.168.1.100`) bajo tu interfaz de red (como `eth0` o `wlan0`).

2.  Desde otro dispositivo en la red (por ejemplo, un PC con Windows):
    - Abre el Explorador de archivos e ingresa: `\\<dirección-ip-ubuntu>\media` (por ejemplo, `\\192.168.1.100\media`).
    - Deberías ver tus archivos multimedia. Dado que el acceso de invitado está habilitado, no se requiere inicio de sesión.

---

### Consejos para la resolución de problemas
Si encuentras problemas:
- **Revisa los registros de Samba**: Los registros se encuentran en `/var/log/samba/` (por ejemplo, `log.smbd` o `log.nmbd`). Usa `cat` o `tail` para verlos:
  ```bash
  sudo tail -f /var/log/samba/log.smbd
  ```
- **Prueba localmente**: Usa `smbclient` para listar los recursos compartidos en tu máquina Ubuntu:
  ```bash
  smbclient -L localhost
  ```
  O conéctate al recurso compartido:
  ```bash
  smbclient //localhost/media -N
  ```
  (`-N` omite la solicitud de contraseña para el acceso de invitado).

---

### Resumen de comandos
Aquí tienes la secuencia completa:

```bash
sudo apt update
sudo apt install samba
sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.backup
sudo nano /etc/samba/smb.conf  # Añade la sección [media]
testparm
sudo systemctl restart smbd
sudo systemctl restart nmbd
sudo chmod -R 755 /home/usuario/media
sudo ufw allow 139/tcp
sudo ufw allow 445/tcp
sudo ufw allow 137/udp
sudo ufw allow 138/udp
sudo ufw reload
```

¡Tu servidor SMB está ahora configurado para servir archivos multimedia desde `/home/usuario/media`! Accede a él desde cualquier dispositivo en tu red usando la dirección IP y el nombre del recurso compartido (`\\<dirección-ip>\media`).