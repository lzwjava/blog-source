---
audio: false
generated: true
lang: es
layout: post
title: Usando Jetty para incrustar un servidor web
translated: true
---

Para usar `org.eclipse.jetty` en un proyecto de Java, generalmente quieres aprovechar las bibliotecas de Jetty para incrustar un servidor web ligero o un contenedor de servlets dentro de tu aplicación. Jetty, mantenido bajo la Fundación Eclipse, es un proyecto de código abierto que te permite servir contenido web, manejar solicitudes HTTP y soportar características como servlets y aplicaciones web. A continuación se presenta una guía paso a paso para comenzar a usar `org.eclipse.jetty` para configurar un servidor web básico en una aplicación de Java utilizando Maven como herramienta de construcción.

---

### **Paso 1: Agregar Dependencias de Jetty a tu Proyecto**
Para usar Jetty, necesitas incluir sus bibliotecas en tu proyecto. Si estás usando Maven, agrega las dependencias necesarias a tu archivo `pom.xml`. Para una configuración básica de servidor web con soporte para servlets, incluye `jetty-server` y `jetty-servlet`. Aquí tienes un ejemplo:

```xml
<project>
    <dependencies>
        <!-- Jetty Server -->
        <dependency>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-server</artifactId>
            <version>9.4.31.v20200723</version>
        </dependency>
        <!-- Jetty Servlet Support -->
        <dependency>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-servlet</artifactId>
            <version>9.4.31.v20200723</version>
        </dependency>
        <!-- Servlet API (opcional, a menudo incluido transitivamente) -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>3.1.0</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>
</project>
```

- **`jetty-server`**: Proporciona la funcionalidad del servidor principal para manejar solicitudes HTTP.
- **`jetty-servlet`**: Agrega soporte para servlets, permitiéndote usar la API de Java Servlet.
- **`javax.servlet-api`**: Define las interfaces de servlet; se incluye explícitamente aquí para claridad, aunque a menudo se trae transitivamente por `jetty-servlet`.

**Nota**: Consulta el [Repositorio Central de Maven](https://mvnrepository.com/artifact/org.eclipse.jetty) para la última versión de Jetty y actualiza la etiqueta `<version>` en consecuencia.

---

### **Paso 2: Crear un Servidor Jetty Simple**
Puedes usar Jetty de manera programática creando una instancia de la clase `Server` del paquete `org.eclipse.jetty.server`. A continuación se presentan dos enfoques comunes: usar un controlador básico para respuestas estáticas o usar un servlet para contenido dinámico.

#### **Opción 1: Usando un Controlador Básico**
Este ejemplo configura un servidor que responde con "¡Hola, Mundo!" a todas las solicitudes.

```java
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.Request;
import org.eclipse.jetty.server.handler.AbstractHandler;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

public class SimpleJettyServer {
    public static void main(String[] args) throws Exception {
        // Crear una instancia del servidor escuchando en el puerto 8080
        Server server = new Server(8080);

        // Establecer un controlador para procesar solicitudes
        server.setHandler(new AbstractHandler() {
            @Override
            public void handle(String target, Request baseRequest, HttpServletRequest request, HttpServletResponse response)
                    throws IOException {
                // Establecer propiedades de respuesta
                response.setContentType("text/plain");
                response.setStatus(HttpServletResponse.SC_OK);
                response.getWriter().println("¡Hola, Mundo!");

                // Marcar la solicitud como manejada
                baseRequest.setHandled(true);
            }
        });

        // Iniciar el servidor
        server.start();
        server.join(); // Mantiene el servidor en ejecución hasta que se detenga
    }
}
```

- **`Server server = new Server(8080)`**: Crea un servidor Jetty en el puerto 8080.
- **`AbstractHandler`**: Un controlador simple donde defines cómo procesar solicitudes en el método `handle`.
- **`baseRequest.setHandled(true)`**: Indica que este controlador ha procesado la solicitud, evitando un procesamiento adicional.

Ejecuta este código, luego abre un navegador y navega a `http://localhost:8080/` para ver "¡Hola, Mundo!".

#### **Opción 2: Usando un Servlet**
Para aplicaciones más complejas, puedes usar servlets con un `ServletContextHandler`.

```java
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.ServletContextHandler;
import org.eclipse.jetty.servlet.ServletHolder;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

public class ServletJettyServer {
    public static void main(String[] args) throws Exception {
        // Crear una instancia del servidor en el puerto 8080
        Server server = new Server(8080);

        // Crear un controlador de contexto de servlet
        ServletContextHandler context = new ServletContextHandler();
        context.setContextPath("/"); // Ruta de contexto raíz

        // Establecer el controlador para el servidor
        server.setHandler(context);

        // Agregar un servlet para manejar solicitudes
        context.addServlet(new ServletHolder(new HelloServlet()), "/*");

        // Iniciar el servidor
        server.start();
        server.join();
    }
}

// Definir un servlet simple
class HelloServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws IOException {
        response.setContentType("text/plain");
        response.setStatus(HttpServletResponse.SC_OK);
        response.getWriter().println("¡Hola desde el Servlet de Jetty!");
    }
}
```

- **`ServletContextHandler`**: Administra contextos y mappers de servlets.
- **`context.addServlet`**: Registra el `HelloServlet` para manejar todas las solicitudes (`/*`).
- **`doGet`**: Define el comportamiento del servlet para solicitudes GET.

Ejecuta este código y visita `http://localhost:8080/` para ver "¡Hola desde el Servlet de Jetty!".

---

### **Paso 3: Compilar y Ejecutar**
1. Asegúrate de que tu proyecto esté configurado con Maven (por ejemplo, ejecuta `mvn compile` para descargar dependencias).
2. Compila y ejecuta la clase Java (por ejemplo, `java SimpleJettyServer` o usa la característica de ejecución de tu IDE).
3. Prueba el servidor accediendo a `http://localhost:8080/` en un navegador o usando una herramienta como `curl`.

---

### **Casos de Uso Adicionales**
- **Desplegar un Archivo WAR**: Usa `WebAppContext` para desplegar un archivo de archivo de aplicación web (WAR) o directorio:
  ```java
  import org.eclipse.jetty.server.Server;
  import org.eclipse.jetty.webapp.WebAppContext;

  public class WarJettyServer {
      public static void main(String[] args) throws Exception {
          Server server = new Server(8080);
          WebAppContext webapp = new WebAppContext();
          webapp.setContextPath("/");
          webapp.setWar("ruta/a/tu.war"); // Ruta a tu archivo WAR
          server.setHandler(webapp);
          server.start();
          server.join();
      }
  }
  ```
  Agrega la dependencia `jetty-webapp` a tu `pom.xml` para esta característica.

- **Configurar Jetty**: Ajusta configuraciones como el puerto, grupos de hilos o HTTPS de manera programática o mediante archivos de configuración XML (consulta la documentación de Jetty para configuraciones avanzadas).

---

### **Puntos Clave**
- **Importaciones**: Usa clases de `org.eclipse.jetty.server`, `org.eclipse.jetty.servlet`, etc., importándolas según sea necesario.
- **Flexibilidad**: Jetty puede servir contenido estático, manejar servlets, desplegar archivos WAR o incluso soportar WebSockets y HTTP/2 con módulos adicionales.
- **Documentación**: Para más detalles, consulta la [documentación oficial de Jetty](https://www.eclipse.org/jetty/documentation/).

Siguiendo estos pasos, puedes usar `org.eclipse.jetty` para incrustar un servidor web en tu aplicación de Java, adaptado a tus necesidades específicas.