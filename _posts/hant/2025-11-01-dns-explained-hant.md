---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-4-fast
title: DNS 簡易解說
translated: true
type: note
---

### DNS 是什麼？

DNS 代表**網域名稱系統**。它本質上是互聯網（和本地網絡）的「電話簿」。它將人類可讀的網域名稱（如 `www.example.com` 或 `google.com`）轉換為機器可讀的 IP 地址（如 `192.0.2.1` 或 `8.8.8.8`）。若沒有 DNS，你就必須記住並輸入原始 IP 地址來訪問網站，這將非常不切實際。

DNS 以層級方式運作：你的裝置會查詢 DNS 伺服器（一種專門處理這些查詢的伺服器），該伺服器要么知道答案，要么將查詢向上轉發給權威伺服器，直到將名稱解析為 IP 地址。

### 在 macOS 或 Windows 上配置 DNS

當你在 macOS（在「系統設定」>「網絡」）或 Windows（在「設定」>「網絡和互聯網」>「乙太網絡/Wi-Fi」>「內容」）中配置網絡設定時，**DNS** 部分允許你手動指定 DNS 伺服器或使用網絡提供的預設值。常見的預設值包括：
- 你的 ISP 的 DNS 伺服器。
- 公共 DNS 伺服器，例如 Google 的 `8.8.8.8` 和 `8.8.4.4`，或 Cloudflare 的 `1.1.1.1`。

如果你將其設為「自動」（通常是通過 DHCP，如你所提及），則你的路由器或網絡會為你提供這些 DNS 伺服器。

你列出的其他詳細資訊：
- **192.168.1.1**：這通常是你的路由器的本地 IP 地址（「預設閘道」）。它是你家網絡通往外部互聯網的大門。
- **IPv4 使用 DHCP**：DHCP（動態主機設定協定）是一項服務，能自動為你網絡上的裝置分配 IP 地址和其他網絡資訊。「使用 DHCP」意味著你的電腦不會選擇靜態 IP；相反，它會向 DHCP 伺服器（通常是你的路由器）動態請求一個 IP 地址。

### 你的電腦如何連接到網絡並處理 IP/主機查詢

讓我們逐步分解當你的電腦「訪問網絡」（即連接到 Wi-Fi 或乙太網絡）時的過程：

1. **初始連接和 DHCP 握手**：
   - 當你連接時，你的電腦會廣播一個 DHCP「發現」請求：「嘿，有人能給我一個可用的 IP 地址嗎？」
   - 你的**路由器**（作為 DHCP 伺服器）會回應一個「提供」：「當然，這是給你的 IP（例如 192.168.1.100），還有你的子網絡遮罩（例如 255.255.255.0）、預設閘道（192.168.1.1）和 DNS 伺服器 IP（例如 8.8.8.8）。」
   - 你的電腦接受（「請求」）並確認（「確認」）。現在它擁有在本地網絡上通信所需的一切。
   - 這還不涉及 DNS——它只是為了你的裝置自身的 IP 和基本路由。你的「主機」（主機名，例如你的電腦名稱）可能是在你的裝置上本地設定，或向路由器註冊用於本地名稱解析，但那是分開的。

2. **解析主機（DNS 介入的地方）**：
   - 一旦連接，如果你嘗試訪問 `www.google.com`，你的電腦還不知道 IP 地址。它會向 DHCP 提供的 DNS 伺服器（可能是路由器的 IP 或外部 DNS 伺服器）發送一個 **DNS 查詢**。
   - **它會發送到路由器嗎？** 通常是，間接地：
     - 如果你的路由器配置為 DNS 代理/轉發器（常見於家用路由器，如 TP-Link、Netgear 或 Apple Airport），你的電腦會首先查詢路由器（例如，通過 192.168.1.1 作為 DNS 伺服器）。
     - 路由器檢查其本地快取（為了速度）。如果它有答案（來自先前的查詢），它會直接回應。如果沒有，它會將查詢轉發給上游 DNS 伺服器（如你的 ISP 的或你設定的公共 DNS 伺服器）。
   - 上游 DNS 伺服器解析它（例如 `www.google.com` → `142.250.190.14`）並將 IP 地址通過鏈路傳回給你的電腦。
   - 你的電腦然後使用該 IP 地址連接到網站。

3. **路由器如何處理這些查詢**：
   - **DHCP 查詢**：路由器維護一個可用 IP 地址池（例如 192.168.1.50 到 192.168.1.150）。當你請求一個 IP 時，它會租給你一段設定的時間（例如 24 小時），在其表格中追蹤它，並在需要時續租。如果你設定了主機名，它也會處理你的主機名（例如用於本地訪問，如 `ping mylaptop.local`）。
   - **DNS 查詢**：路由器並不「擁有」DNS 記錄——它是一個中間人。它：
     - 快取回應以避免重複的上游查詢（提高速度並減少頻寬使用）。
     - 將未解析的查詢轉發給配置的上游伺服器。
     - 可能應用家長監控、廣告攔截（通過自訂 DNS，如 Pi-hole）或記錄日誌。
     - 如果查詢是針對本地裝置（例如你網絡上的另一台電腦），它可能會通過其本地 hosts 檔案或 mDNS（多播 DNS，被 macOS/Apple 裝置上的 Bonjour 使用）來解析它。
   - 錯誤？如果 DNS 失敗（例如錯誤的伺服器 IP），你將無法解析名稱——網站將無法加載，但直接 ping IP 地址可能有效。

簡而言之：DHCP 從路由器獲取你的電腦的「地址和方向」。然後 DNS 使用這些方向來詢問「這個網站在哪裡？」——通常通過路由器路由到外部解析器。

如果你正在對特定設定進行故障排除，請分享更多詳細資訊，例如你的路由器型號或確切的錯誤訊息！