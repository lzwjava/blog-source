---
lang: hant
layout: post
title: 好的！以下是一个简单的 Rust 程序示例，它将打印 "Hello, World!" 到控制台：
---

Rust 是近年来备受瞩目的编程语言。2006年，Mozilla的一名员工启动了一个个人项目，随后获得了公司的支持，并在2010年正式发布了这一项目。这个项目便是Rust。

接下来，让我们运行第一个Rust程序吧。打开官网，查看如何启动并运行程序。

官网提供了一个脚本：

```shell
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

在 Mac 上也可以使用 Mac 系统的包管理工具 Homebrew 来安装。可运行命令：

```shell
brew install rust
```

我这里使用Homebrew来安装Rust。在安装的过程中，让我们继续浏览官网。

接下来，我们注意到官网上出现了Cargo这个工具，它是Rust语言的构建系统和包管理器。

官方网站上写道：

- 使用 `cargo build` 构建你的项目
- 使用 `cargo run` 运行你的项目
- 使用 `cargo test` 测试你的项目

告诉我们如何构建、运行和测试Cargo程序。

運行：

```shell
brew install rust
```

輸出：

```shell
==> 正在下載 https://homebrew.bintray.com/bottles/rust-1.49.0_1.big_sur.bottle.tar.gz
==> 從 https://d29vzk4ow07wi7.cloudfront.net/5a238d58c3fa775fed4e12ad74109deff54a82a06cb6a3a4f51b5d37587fb319?response-content-disposition=a 下載
######################################################################## 100.0%
==> 正在解壓 rust-1.49.0_1.big_sur.bottle.tar.gz
==> 注意事項
Bash 自動補全功能已安裝至：
  /usr/local/etc/bash_completion.d
==> 總結
🍺  /usr/local/Cellar/rust/1.49.0_1: 15,736 個文件，共 606.2MB
```

這便安裝成功了。

當在終端運行`cargo`時，輸出如下：

```shell
Rust 的包管理器
```

用法：
    cargo [选项] [子命令]

選項：
    -V, --version           顯示版本信息並退出
        --list              列出已安裝的命令
        --explain <代碼>    執行 `rustc --explain 代碼`
    -v, --verbose           使用詳細輸出（-vv 非常詳細/構建.rs 輸出）
    -q, --quiet             不向標準輸出打印信息
        --color <何時>      著色：自動，總是，永不
        --frozen            要求 Cargo.lock 和緩存是最新的
        --locked            要求 Cargo.lock 是最新的
        --offline           運行時不訪問網絡
    -Z <標誌>...            不穩定（僅限夜間版）的 Cargo 標誌，詳見 'cargo -Z help'
    -h, --help              打印幫助信息

一些常用的 Cargo 命令包括（使用 --list 查看所有命令）：
    build, b    编译当前包
    check, c    分析当前包并报告错误，但不构建目标文件
    clean       删除目标目录
    doc         构建当前包及其依赖项的文档
    new         创建一个新的 Cargo 包
    init        在现有目录中创建一个新的 Cargo 包
    run, r      运行本地包的二进制文件或示例
    test, t     运行测试
    bench       运行基准测试
    update      更新 Cargo.lock 中列出的依赖项
    search      在注册表中搜索 crate
    publish     打包并上传此包到注册表
    install     安装 Rust 二进制文件。默认位置是 $HOME/.cargo/bin
    uninstall   卸载 Rust 二进制文件

要获取特定命令的更多信息，请参阅 'cargo help <命令>'。
```

无需精通所有命令。只需掌握常用命令即可。其中，`build` 和 `run` 命令尤为重要。

继续查阅官方文档：

```c
讓我們用新的 Rust 開發環境來寫一個小應用程式。首先，我們會使用 Cargo 來為我們建立一個新專案。在你選擇的終端機中執行：
```

cargo new hello-rust 的命令将创建一个名为 `hello-rust` 的新 Rust 项目。这个命令会生成一个包含基本项目结构的目录，其中包括 `Cargo.toml` 文件（用于管理项目的依赖和配置）和一个 `src` 目录（其中包含一个简单的 `main.rs` 文件，作为项目的入口点）。

执行这个命令后，你会看到一个类似如下的目录结构：

```
hello-rust/
├── Cargo.toml
└── src
    └── main.rs
```

在 `main.rs` 文件中，通常会有一个简单的 "Hello, world!" 程序：

```rust
fn main() {
    println!("Hello, world!");
}
```

你可以通过运行 `cargo run` 来编译并运行这个程序。

这将生成一个名为 `hello-rust` 的新目录，其中包含以下文件：

hello-rust
|- Cargo.toml
|- src
  |- main.rs
Cargo.toml 是 Rust 项目的清单文件。在这里，你可以维护项目的元数据以及依赖项。

`src/main.rs` 是我們編寫應用程序代碼的地方。
```
這講述了如何創建項目。接下來便創建。
```

```shell
$ cargo new hello-rust
```

已创建二进制（应用程序）`hello-rust` 包
```

我們用VSCode來打開項目。

主程式.rs

```rust
fn main() {
    println!("你好，世界！");
}
```

接下来，很自然地会想到要构建（build）并运行（run）程序。

```shell
$ cargo build
```

錯誤：無法在 `/Users/lzw/ideas/curious-courses/program/run/rust` 或其任何父目錄中找到 `Cargo.toml`
```

出錯了。為什麼？這表明cargo只能在項目下的目錄運行。接下來進入子目錄，執行了`cd hello-rust`。

这时，如果直接运行，会发生什么情况呢？

```shell
$ cargo run
   
   正在編譯 hello-rust v0.1.0 (/Users/lzw/ideas/curious-courses/program/run/rust/hello-rust)
    編譯完成，開發模式 [未優化 + 調試信息] 目標(s) 於 4.43 秒
     正在運行 `target/debug/hello-rust`
你好，世界！
```

好了，成功了。輸出了字符串，程序開始工作啦。

尝试修改程序。

```rust
fn main() {
    println!("{}", 2 + 3);
}
```

在Rust中，`println!`宏需要一個格式化字符串來指定輸出的格式。因此，我們需要在字符串中使用`{}`作為佔位符，並將表達式`2 + 3`作為參數傳遞給`println!`宏。這樣，程序才能正確地計算並輸出結果`5`。

`cargo run` 之后，出现了：

```shell
   正在編譯 hello-rust v0.1.0 (/Users/lzw/ideas/curious-courses/program/run/rust/hello-rust)
錯誤：格式參數必須是字符串字面量
 --> src/main.rs:2:14
  |
2 |     println!(2+3);
  |              ^^^
  |
幫助：你可能缺少一個用於格式化的字符串字面量
  |
2 |     println!("{}", 2+3);
  |              ^^^^^
```

错误：由于先前的错误而中止

错误：无法编译 `hello-rust`

要了解更多信息，请使用 --verbose 选项重新运行该命令。
```

还没有学习任何Rust语法。凭着我们的直觉来改动代码出错了。这个出错提示很好，已经告诉我们怎么改了。

```rust
fn main() {
    println!("{}", 2+3);
}
```

這段 Rust 程式碼的功能是計算 `2 + 3` 並將結果輸出到終端機。執行後，它會顯示 `5`。

這次改對了，果然輸出了5。

对了，build会怎么样呢？

```shell
$ cargo build
    已完成開發 [未優化 + 除錯信息] 目標文件於 0.00 秒
```

为什么需要构建（build）呢？因为有时候我们可能仅仅希望生成可执行程序，而不打算立即执行它。对于某些庞大的程序而言，执行过程可能相当耗时。此外，我们可能计划在本地完成构建后，再将生成的可执行文件传输到远程服务器上执行。

我们已经成功运行了Rust程序。接下来，我们将深入了解Rust语言的更多语法，以便在Rust中找到与我们在「解谜计算机科学」中讨论的变量、函数、函数调用和表达式等概念相对应的符号表示。

***

##### 小练习

* 试着像上面一样，学生在自己的电脑上试用Rust编程。
* 练习完后，可提交一百字以内的总结或对本文的补充。

***