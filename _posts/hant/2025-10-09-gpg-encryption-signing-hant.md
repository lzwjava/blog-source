---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-4-fast
title: GPG 加密與簽署詳解
translated: true
type: note
---

### GPG 基礎：加密與簽署

你這裡混雜了幾個概念——GPG（GNU Privacy Guard）可以進行**加密**（保護檔案內容）和**簽署**（驗證身份與完整性）——但這兩者是獨立功能。我將逐步拆解說明，確認你的觀點，並釐清哪些部分重疊或差異。這基於標準的 GPG 使用方式（截至 2025 年變化不大）。

#### 1. **產生金鑰與你的資訊（姓名/電郵）**
   - 初次設定 GPG 時，你會產生一組**金鑰對**：一把私密金鑰（保密存放）和一把公開金鑰（與他人分享）。
   - 在產生過程中，你需提供**姓名與電郵**作為金鑰「使用者 ID」的一部分（例如 `gpg --gen-key`）。這將金鑰與你的身份綁定。
   - 你還需設定一組**密語**來保護你的私密金鑰。此密語**並非**用於加密檔案——僅在需要時用來解鎖你的私密金鑰。
   - 指令範例：
     ```
     gpg --gen-key
     ```
     依提示輸入 RSA/RSA、金鑰長度、到期日及你的姓名/電郵。

#### 2. **加密檔案**
   - **使用密碼（對稱加密）**：此方式不涉及金鑰或你的身份——適用於快速安全分享檔案。GPG 使用密語產生單一金鑰進行加密。
     - 指令：`gpg -c filename.txt`（提示輸入密語，輸出 `filename.txt.gpg`）。
     - 任何持有密語者皆可解密：`gpg -d filename.txt.gpg`。
     - 此處無公開/私密金鑰；無身份驗證。
   - **使用公開金鑰（非對稱加密）**：若要為特定對象加密，需使用其公開金鑰。你的姓名/電郵不直接參與加密輸出。
     - 指令：`gpg -e -r recipient@example.com filename.txt`（輸出 `filename.txt.gpg`）。
     - 僅有收件者的私密金鑰可解密。
   - 加密輸出為 `.gpg` 檔案，但這**並非簽章**——僅是加密資料。僅靠加密不會產生「GPG 簽章」。

#### 3. **簽署檔案（你所描述的功能）**
   - 簽署會為檔案（或其雜湊值）附加**數位簽章**，以證明檔案來源於你且未被篡改。此處才涉及你的**私密金鑰**與身份。
   - **沒錯，你必須使用私密金鑰來產生簽章。** GPG 會用你的密語解鎖私密金鑰。
     - 分離式簽章指令：`gpg --detach-sign filename.txt`（輸出 `filename.txt.sig`）。
     - 或內嵌式簽章（同時簽署與加密）：`gpg -s filename.txt`（輸出內含簽章的 `filename.txt.gpg`）。
   - 簽章是一種密碼學「數值」（如同用私密金鑰簽署的雜湊值），其中包含你的金鑰 ID 和使用者 ID（姓名/電郵）。
   - **他人用你的公開金鑰驗證**：他們匯入你的公開金鑰（例如從金鑰伺服器：`gpg --keyserver keys.openpgp.org --recv-keys YOUR_KEY_ID`），然後執行 `gpg --verify filename.txt.sig filename.txt`。
     - 若匹配，會顯示類似「來自『你的姓名 <電郵>』的良好簽章」。
   - **沒錯，這符合身份驗證並建立信任**：
     - 簽章證明檔案來自金鑰持有者（你）。
     - 若你透過可信渠道（例如你的網站）分享公開金鑰，且該金鑰受你信任者簽署，你便可「信任」此信任鏈。
     - 此舉不會加密檔案——僅進行驗證。可結合加密以實現完整安全性（先簽署後加密）。

#### 關鍵差異與你的疑問

| 功能 | 加密（密碼） | 加密（公開金鑰） | 簽署 |
|------|-------------|------------------|------|
| **使用密語？** | 是，用於對稱金鑰 | 否（使用收件者公開金鑰） | 是，用於解鎖你的私密金鑰 |
| **涉及姓名/電郵？** | 否 | 間接（透過你的金鑰進行解密回應） | 是，內嵌於簽章中 |
| **輸出** | `.gpg` 檔案（加密資料） | `.gpg` 檔案（加密資料） | `.sig` 或內嵌於 `.gpg`（簽章數值） |
| **需私密金鑰？** | 否 | 否（為他人加密時） | 是，用於產生簽章 |
| **驗證方式** | 密語解密 | 收件者私密金鑰 | 任何持有你公開金鑰者 |
| **目的** | 隱藏內容 | 安全分享 | 證明身份/完整性 |

- **關於私密金鑰正確**：沒錯，你**必須**使用私密金鑰（以密語解鎖）來簽署。切勿分享它！
- **關於信任正確**：正是如此——若簽章透過你的公開金鑰驗證成功，且你信任該金鑰屬於聲稱的作者（透過姓名/電郵與信任網），你便可信任檔案真實無篡改。這如同數位公證。

#### 實用提示
- 務必備份金鑰：`gpg --export-secret-keys --armor > private.asc`（安全儲存）。
- 若僅需密碼功能（無金鑰），可選用 `age` 或 `openssl` 等更簡便工具，但 GPG 擅長處理身份關聯事務。
- 常見陷阱：忘記匯出/分享公開金鑰會導致他人無法驗證。

若你指特定指令或情境（例如同時加密*與*簽署），請提供更多細節！

**參考資料**  
[GPG 文件：加密與簽署](https://www.gnupg.org/documentation/manuals/gnupg/)  
[GPG 快速入門指南](https://www.gnupg.org/documentation/manuals/gnupg/GnuPG-basics.html)