---
audio: false
generated: true
lang: hant
layout: post
title: HTTPS 運作原理
translated: true
type: note
---

讓我逐步清晰地解釋 HTTPS 的工作原理，包括 SSL、憑證、加密過程，以及 TLS 1.2 與 TLS 1.3 之間的差異。

---

### **什麼是 HTTPS？**
HTTPS 代表 **超文本傳輸安全協定**。它是 HTTP 的安全版本，HTTP 是用於在瀏覽器與網站之間傳輸資料的協定。「安全」部分來自於添加了加密和身份驗證層，由 **SSL（安全通訊端層）** 或其現代替代方案 **TLS（傳輸層安全性）** 提供。因此，HTTPS 本質上是運行在 TLS（或歷史上的 SSL）之上的 HTTP，以保護您的資料安全。

---

### **HTTPS 如何運作？TLS 握手過程**
當您造訪使用 HTTPS 的網站（例如 `https://example.com`）時，您的瀏覽器與網站伺服器在交換任何資料之前，會先建立安全連線。這個過程稱為 **TLS 握手**。以下是簡單的步驟說明：

1. **客戶端 Hello**：
   - 您的瀏覽器向伺服器發送一條訊息，內容是：「你好！這是我支援的 TLS 版本（例如 TLS 1.3）、我能使用的加密演算法（加密套件），以及一個隨機位元組字串（客戶端隨機值）。」

2. **伺服器 Hello**：
   - 伺服器回覆：「你好！我將使用你清單中的這個 TLS 版本和這個加密套件。這是我的隨機字串（伺服器隨機值）。」

3. **憑證**：
   - 伺服器發送其 **SSL 憑證**，該憑證包含其 **公開金鑰**，並由受信任的 **憑證授權機構 (CA)** 簽署。此憑證用於證明伺服器的身份。

4. **客戶端金鑰交換**：
   - 您的瀏覽器檢查憑證以確保其有效且由受信任的 CA 簽署。如果檢查通過，瀏覽器會產生一個 **預主密鑰**，使用伺服器的公開金鑰加密後傳送給伺服器。

5. **工作階段金鑰**：
   - 瀏覽器和伺服器使用客戶端隨機值、伺服器隨機值和預主密鑰，獨立產生相同的 **工作階段金鑰**。此金鑰用於在工作階段期間加密和解密所有資料。

6. **完成**：
   - 雙方發送一條使用工作階段金鑰加密的「完成」訊息，以確認安全連線已準備就緒。

握手完成後，所有資料（如網頁、表單或檔案）都會使用工作階段金鑰進行加密，使得任何可能攔截資料的人都無法讀取。

---

### **什麼是 SSL 憑證及其運作方式？**
**SSL 憑證** 是一種數位文件，用於證明網站的身份並啟用加密功能。以下是您需要了解的內容：

- **內容**：憑證包含網站的網域名稱、其公開金鑰以及 **憑證授權機構 (CA)** 的數位簽章。
- **目的**：它確保伺服器是合法的（例如，您確實連接到 `example.com`，而不是假冒網站），並提供用於加密的公開金鑰。
- **驗證**：您的瀏覽器會檢查：
  1. 憑證是否有效（未過期或未被撤銷）？
  2. 是否由受信任的 CA 簽署？（瀏覽器內建受信任的 CA 清單，例如 DigiCert 或 Let’s Encrypt。）
- 如果檢查通過，瀏覽器便信任該伺服器並繼續進行握手。

CA 就像一個受信任的第三方，為網站提供擔保。沒有這個機制，攻擊者可以冒充任何網站並竊取您的資料。

---

### **加密演算法**
HTTPS 中的加密依賴於 **非對稱** 和 **對稱密碼學** 的結合：

1. **非對稱密碼學**（在握手期間使用）：
   - 使用 **公開金鑰**（公開共享）和 **私密金鑰**（由伺服器保密）。
   - 瀏覽器使用伺服器的公開金鑰加密預主密鑰。只有擁有私密金鑰的伺服器才能解密它。
   - 範例演算法：RSA 或橢圓曲線密碼學 (ECC)。

2. **對稱密碼學**（用於工作階段）：
   - 一旦工作階段金鑰建立，雙方都使用它來加密和解密資料。
   - 這種方式比非對稱加密更快，適合大量資料傳輸。
   - 範例演算法：AES（進階加密標準）。

握手過程使用非對稱加密來安全地共享工作階段金鑰，然後為了效率切換到對稱加密。

---

### **TLS 1.2 與 TLS 1.3 的差異**
**TLS 1.2** 和 **TLS 1.3** 是 TLS 協定的版本，其中 TLS 1.3 是更新、改進的版本。以下是主要差異：

| **功能特性**          | **TLS 1.2**                              | **TLS 1.3**                              |
|-----------------------|------------------------------------------|------------------------------------------|
| **握手速度**          | 客戶端與伺服器之間需要多次往返，增加延遲。 | 更少的往返次數，通常只需一次，連線更快。重新連線時可立即發送資料（「0-RTT」）。 |
| **加密套件**          | 支援較舊、安全性較低的加密演算法（例如 SHA-1）。 | 移除過時的加密套件，僅使用現代、安全的演算法（例如 AES-GCM）。 |
| **隱私性**            | 部分握手資料（如憑證）以明文傳送。 | 幾乎整個握手過程都加密，對竊聽者隱藏更多細節。 |
| **0-RTT 恢復**        | 不可用。 | 允許在重新連線時立即發送資料，但如果未妥善保護，存在重放攻擊風險。 |
| **安全性**            | 由於舊有功能，易受某些攻擊影響。 | 設計上更安全，移除了弱點選項。 |

總之，TLS 1.3 比 TLS 1.2 **更快**、**更安全**，且**隱私性更高**，使其成為現代 HTTPS 的標準。

---

### **整體總結**
HTTPS 通過以下方式保護網路通訊：
1. 使用 **TLS 握手** 建立加密連線。
2. 依賴來自受信任 CA 的 **SSL 憑證** 來驗證伺服器身份。
3. 結合 **非對稱密碼學**（用於握手）和 **對稱密碼學**（用於資料傳輸）來保護您的資料。
4. 隨著像 **TLS 1.3** 這樣的協定演進，在速度、安全性和隱私性方面都比 TLS 1.2 有所提升。

這就是 HTTPS 保護您瀏覽安全的核心原理！如果您想深入了解任何部分，請告訴我。