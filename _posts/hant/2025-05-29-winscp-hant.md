---
audio: false
generated: true
lang: hant
layout: post
title: 使用 WinSCP 作為檔案管理器
translated: true
type: note
---

WinSCP 是一款廣受歡迎的開源檔案傳輸客戶端，主要用於在本地電腦與遠端伺服器之間安全地傳輸檔案。它支援 SFTP、FTP、FTPS、SCP、WebDAV 及 Amazon S3 等多種通訊協定，使其成為管理遠端系統檔案的多元工具。以下將提供使用 WinSCP 作為檔案管理器的完整指南，涵蓋其功能特色、設定步驟、使用方式及進階功能。

---

## **目錄**
1. [WinSCP 概覽](#overview-of-winscp)
2. [主要功能特色](#key-features)
3. [系統需求](#system-requirements)
4. [安裝步驟](#installation)
5. [快速入門](#getting-started)
   - [下載與安裝 WinSCP](#downloading-and-installing-winscp)
   - [初始設定與配置](#initial-setup-and-configuration)
6. [使用 WinSCP 作為檔案管理器](#using-winscp-as-a-file-manager)
   - [介面概覽](#interface-overview)
   - [連接至遠端伺服器](#connecting-to-a-remote-server)
   - [瀏覽與管理檔案](#navigating-and-managing-files)
   - [傳輸檔案](#transferring-files)
   - [同步檔案](#synchronizing-files)
7. [進階功能](#advanced-features)
   - [自動化與腳本編寫](#automation-and-scripting)
   - [自訂指令](#custom-commands)
   - [與 PuTTY 整合](#integration-with-putty)
   - [加密與安全性](#encryption-and-security)
8. [技巧與最佳實踐](#tips-and-best-practices)
9. [常見問題排解](#troubleshooting-common-issues)
10. [WinSCP 替代方案](#alternatives-to-winscp)
11. [總結](#conclusion)

---

## **WinSCP 概覽**
WinSCP（Windows Secure Copy）是一款專為 Windows 設計的免費開源檔案傳輸客戶端。它允許使用者在本地 Windows 電腦與遠端伺服器之間，或兩台遠端伺服器之間安全地傳輸檔案。其圖形化使用者介面（GUI）對新手十分友善，而腳本與自動化功能則能滿足進階使用者的需求。此軟體廣泛用於管理網站伺服器、雲端儲存或其他遠端系統上的檔案。

---

## **主要功能特色**
- **通訊協定支援**：SFTP、FTP、FTPS、SCP、WebDAV 及 Amazon S3。
- **圖形化使用者介面**：雙面板檔案管理器，支援拖放操作。
- **安全性**：支援 SSH 金鑰驗證、加密及安全檔案傳輸。
- **自動化**：提供腳本與命令列介面，支援批次檔案傳輸。
- **同步功能**：自動同步本地與遠端目錄。
- **整合性**：可與 PuTTY 無縫整合，實現 SSH 終端存取。
- **自訂選項**：提供傳輸設定、檔案權限等豐富配置選項。
- **便携模式**：無需安裝即可從 USB 隨身碟執行。
- **多語言支援**：支援多國語言，方便全球使用者使用。

---

## **系統需求**
- **作業系統**：Windows XP 或更新版本（建議使用 Windows 10/11）。
- **磁碟空間**：約需 20 MB 安裝空間。
- **相依元件**：基本功能無需額外部件；建議安裝 PuTTY 以管理 SSH 金鑰。
- **網路連線**：需連接網際網路以連結遠端伺服器。

---

## **安裝步驟**

### **下載與安裝 WinSCP**
1. **下載 WinSCP**：
   - 前往官方網站：[https://winscp.net/](https://winscp.net/)。
   - 下載最新版本（例如截至 2025 年 5 月為 WinSCP 6.3.4）。
   - 選擇 **安裝版**（建議多數使用者使用）或 **便携版**（適用 USB 隨身碟）。

2. **執行安裝程式**：
   - 雙擊下載的 `.exe` 檔案。
   - 遵循安裝精靈指示：
     - 選擇語言（預設為英文）。
     - 選擇安裝類型：**標準**（安裝至 Program Files）或 **便携**（不修改登錄檔）。
     - 選擇介面風格：**Commander**（雙面板，類似 Norton Commander）或 **Explorer**（類似 Windows 檔案總管）。
   - 完成安裝程序。

3. **驗證安裝**：
   - 從開始功能表或桌面捷徑啟動 WinSCP。
   - 確認應用程式可正常開啟且無錯誤訊息。

---

## **快速入門**

### **初始設定與配置**
1. **啟動 WinSCP**：
   - 開啟 WinSCP 後會顯示 **登入** 對話框。

2. **配置新連線工作階段**：
   - **檔案通訊協定**：選擇 SFTP（最安全）、FTP 或其他通訊協定。
   - **主機名稱**：輸入伺服器 IP 位址或網域名稱（例如 `example.com`）。
   - **通訊埠**：SFTP/SCP 預設為 22，FTP 預設為 21。
   - **使用者名稱**：輸入伺服器使用者名稱。
   - **密碼**：輸入密碼，若使用金鑰驗證可留空。
   - **儲存工作階段**：點擊「儲存」以儲存連線資訊供往後使用。

3. **進階設定**（選填）：
   - 在登入對話框中點擊 **進階** 以配置：
     - **SSH 金鑰**：匯入私密金鑰以進行安全驗證。
     - **傳輸設定**：設定預設傳輸模式（二進位、文字或自動）。
     - **目錄設定**：指定預設本地與遠端目錄。

4. **連線**：
   - 點擊 **登入** 以連接至伺服器。
   - 若出現提示，請接受伺服器主機金鑰（若不確定，請向伺服器管理員確認）。

---

## **使用 WinSCP 作為檔案管理器**

### **介面概覽**
WinSCP 提供兩種介面風格：
- **Commander 介面**：雙面板視圖，左側顯示本地檔案，右側顯示遠端檔案，適合進階使用者。
- **Explorer 介面**：單面板視圖，僅顯示遠端伺服器內容，類似 Windows 檔案總管。

**主要介面元素**：
- **工具列**：快速存取常用功能（連線、中斷連線、新增工作階段）。
- **檔案面板**：顯示本地與遠端目錄。
- **狀態列**：顯示連線狀態、傳輸進度及錯誤訊息。
- **右鍵選單**：對檔案/資料夾右鍵可選擇上傳、下載、刪除或重新命名等選項。

### **連接至遠端伺服器**
1. 開啟 WinSCP，選擇已儲存的工作階段或建立新連線。
2. 輸入憑證或選擇 SSH 金鑰。
3. 點擊 **登入** 以建立連線。
4. 連線成功後，遠端伺服器的檔案系統將顯示於介面中。

### **瀏覽與管理檔案**
- **瀏覽操作**：
  - 使用檔案面板瀏覽本地與遠端目錄。
  - 雙擊資料夾即可開啟。
  - 使用 **上一頁** 與 **下一頁** 按鈕或麵包屑導覽列。
- **檔案操作**：
  - **複製/移動**：在面板間拖放檔案，或使用右鍵選單選項。
  - **刪除**：右鍵選擇 **刪除** 或按下 `Delete` 鍵。
  - **重新命名**：右鍵選擇 **重新命名** 或按下 `F2` 鍵。
  - **建立資料夾**：右鍵選擇 **新增 > 目錄**。
  - **權限設定**：右鍵選擇 **內容** 以變更檔案權限（例如 Linux 伺服器上目錄設為 755，檔案設為 644）。
- **搜尋功能**：使用 `Ctrl+F` 在當前目錄中尋找檔案。

### **傳輸檔案**
1. **上傳**：
   - 將檔案從本地面板拖放至遠端面板。
   - 或對檔案右鍵選擇 **上傳**。
   - 選擇傳輸模式：
     - **二進位**：適用圖片、執行檔或壓縮檔。
     - **文字**：適用文字檔案以處理行尾字元轉換。
     - **自動**：由 WinSCP 根據檔案類型自動判斷。
2. **下載**：
   - 將檔案從遠端面板拖放至本地面板。
   - 或右鍵選擇 **下載**。
3. **傳輸設定**：
   - 於 **偏好設定 > 傳輸** 中配置：
     - 設定傳輸速度限制。
     - 啟用續傳功能以處理中斷的傳輸。
     - 保留時間戳記或權限設定。

### **同步檔案**
WinSCP 的同步功能可保持本地與遠端目錄內容一致。
1. 前往 **指令 > 同步**。
2. 選擇同步方向：
   - **本地**：更新本地目錄以符合遠端內容。
   - **遠端**：更新遠端目錄以符合本地內容。
   - **鏡像**：保持兩端目錄完全一致。
3. 選擇要比較的目錄。
4. 預覽變更內容後確認執行同步。

---

## **進階功能**

### **自動化與腳本編寫**
WinSCP 支援自動化處理重複性任務：
- **批次腳本**：
  - 使用 WinSCP 命令列介面（例如 `winscp.com`）編寫腳本。
  - 範例：自動執行夜間備份。
    ```bash
    open sftp://user:password@host
    get /remote/path/* C:\local\path\
    exit
    ```
  - 儲存為 `.txt` 檔案後，透過 `winscp.com /script=script.txt` 執行。
- **.NET 組件**：
  - 使用 WinSCP 的 .NET 組件與 PowerShell 或 C# 整合。
  - 範例：在 PowerShell 腳本中自動化檔案傳輸。

### **自訂指令**
- 為重複性任務建立自訂指令（例如在伺服器上壓縮檔案）。
- 前往 **指令 > 自訂指令 > 新增**。
- 範例：執行 `tar -czf archive.tar.gz !` 以壓縮所選檔案。

### **與 PuTTY 整合**
- 將 WinSCP 與 PuTTY 連結以實現 SSH 終端存取：
  - 於 **偏好設定 > 整合** 中指定 `putty.exe` 的路徑。
  - 從工具列點擊 **在 PuTTY 中開啟** 即可使用相同憑證啟動終端工作階段。

### **加密與安全性**
- **SSH 金鑰**：
  - 使用 PuTTYgen 產生金鑰或匯入現有金鑰。
  - 於 **進階 > SSH > 驗證** 中配置。
- **加密功能**：使用 WinSCP 內建加密在傳輸前加密檔案。
- **主密碼**：於 **偏好設定 > 安全性** 中保護已儲存的工作階段密碼。

---

## **技巧與最佳實踐**
- **儲存工作階段**：儲存常用連線設定以節省時間。
- **使用二進位模式**：傳輸非文字檔案時避免資料損毀。
- **刪除前備份**：在伺服器上刪除檔案前務必確認內容。
- **檢查權限**：確保網頁伺服器檔案權限正確（例如檔案設為 644，目錄設為 755）。
- **定期更新**：保持 WinSCP 為最新版本以獲取安全性修補與新功能。
- **使用過濾器**：傳輸時排除不必要的檔案（例如 `.git` 目錄）。

---

## **常見問題排解**
1. **連線被拒絕**：
   - 確認主機、通訊埠及憑證是否正確。
   - 檢查伺服器防火牆是否允許連線。
2. **驗證失敗**：
   - 確認使用者名稱/密碼或 SSH 金鑰是否正確。
   - 檢查金鑰格式（WinSCP 支援 PuTTY 的 `.ppk` 格式）。
3. **傳輸速度緩慢**：
   - 檢查網路連線穩定性。
   - 調整傳輸設定（例如停用壓縮以加速傳輸）。
4. **權限不足**：
   - 確認使用者在伺服器上的權限設定。
   - 使用 **內容** 調整檔案/資料夾權限。
5. **主機金鑰驗證**：
   - 僅在信任伺服器時接受主機金鑰。
   - 聯繫伺服器管理員以驗證金鑰指紋。

---

## **WinSCP 替代方案**
- **FileZilla**：開源 FTP/SFTP 客戶端，提供相似介面。
- **Cyberduck**：支援多種通訊協定與雲端儲存（適用 macOS/Windows）。
- **PuTTY PSCP**：命令列 SCP 工具，適合基本傳輸需求。
- **MobaXterm**：整合檔案傳輸與終端功能的全能工具。

---

## **總結**
WinSCP 是一款強大且靈活的檔案傳輸客戶端，同時也是管理遠端伺服器檔案的高效工具。其友善的使用者介面、穩固的安全性功能及自動化能力，使其同時適合新手與進階使用者。透過熟練掌握各項功能，您將能有效率地管理檔案、自動化任務並確保傳輸安全。如需更多詳細資訊，請參閱官方文件：[https://winscp.net/eng/docs/](https://winscp.net/eng/docs/)。

若您對 WinSCP 有特定疑問或需要某項功能的協助，歡迎隨時提出！