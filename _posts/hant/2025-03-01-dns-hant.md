---
audio: false
generated: true
lang: hant
layout: post
title: DNS 全面分析
translated: true
type: note
---

### 重點摘要
- DNS（網域名稱系統）能將像 google.com 這樣的網域名稱轉譯為 142.251.46.238 這類 IP 位址，使網路更便於使用。
- 它透過根域名伺服器、頂級域名伺服器和權威域名伺服器的階層式結構運作，確保查詢效率。
- DNS 查詢過程通常耗時 20-120 毫秒，並依序向這些伺服器進行查詢。
- 常見的 DNS 記錄包括 A、AAAA、CNAME、MX、NS 和 PTR，每種記錄各有特定功能，例如電郵路由或 IP 位址映射。

### 什麼是 DNS？
DNS（網域名稱系統）就像是網際網路的電話簿。它能將易於記憶的網域名稱（例如 google.com）轉譯為電腦用來定位伺服器的數字 IP 位址（例如 142.251.46.238）。這套系統讓使用者無需記憶複雜的數字即可瀏覽網頁，至關重要。

### DNS 如何運作？
DNS 透過階層式結構運作：
- **根域名伺服器**：全球共有 13 台邏輯根伺服器，每台均由多部實體伺服器支援，儲存關於頂級域名（TLD）伺服器的資訊。
- **頂級域名（TLD）伺服器**：這些伺服器管理像 .com 或 .org 這類網域尾碼，儲存關於權威域名伺服器的資料。
- **權威域名伺服器**：這些伺服器提供特定網域的實際 IP 位址，由像 GoDaddy 或 Namecheap 這樣的註冊商維護。

當你輸入網域名稱時，你的瀏覽器會向 DNS 解析器發送請求。如果解析器沒有快取該 IP 位址，它會向根伺服器查詢，然後是 TLD 伺服器，最後向權威伺服器取得 IP 位址，此過程通常耗時 20-120 毫秒。

### DNS 記錄類型
DNS 使用多種記錄來達成不同目的：
- **A 記錄**：將網域映射到 IPv4 位址。
- **AAAA 記錄**：將網域映射到 IPv6 位址。
- **CNAME 記錄**：將一個網域別名指向另一個網域，對子網域很有用。
- **MX 記錄**：將電郵導向郵件伺服器。
- **NS 記錄**：指定權威域名伺服器。
- **PTR 記錄**：將 IP 位址映射回網域名稱，用於反向查詢。

---

### 調查筆記：DNS 全面分析

本節詳細探討網域名稱系統（DNS），擴展上述重點摘要和流程。旨在為有興趣深入了解網際網路導航技術基礎的讀者提供全面理解，內容參考權威來源並為求清晰而結構化。

#### DNS 簡介
網域名稱系統（DNS）是網際網路的關鍵組成部分，作為一個分散式、階層式的資料庫，能將人類可讀的網域名稱（例如 google.com）轉譯為機器可讀的 IP 位址（例如 142.251.46.238）。這種轉譯對於讓使用者無需記憶數字位址即可存取網站至關重要，考慮到網際網路的規模，記憶數字位址是不切實際的。DNS 作為應用層服務在網路邊緣運作，確保無縫連接和可擴展性。

#### 歷史背景與重要性
DNS 的發展是為了解決早期系統的局限性，當時的主機檔案需要手動更新，隨著網際網路發展變得難以為繼。如今，它不僅支援網頁瀏覽，還支援電郵路由、負載平衡等，使其成為現代數位基礎設施不可或缺的一部分。其設計著重於分散和階層結構，確保能夠每日處理數十億次查詢，這證明了其穩健性。

#### DNS 階層與結構
DNS 系統以分層結構組織，以有效管理大量的網域名稱：

| **層級**                  | **描述**                                                                                     | **範例**                     |
|----------------------------|-----------------------------------------------------------------------------------------------------|-----------------------------------|
| 根域名伺服器          | 儲存 TLD 域名伺服器的 IP 位址；全球有 13 台邏輯伺服器，每台均有多個實體實例以實現冗余。 | 由像 ICANN 這樣的組織管理。 |
| 頂級域名（TLD）伺服器 | 管理像 .com、.edu、.net、.org 這樣的網域尾碼；儲存關於權威域名伺服器的資訊。 | .com、.org、.us、.test。          |
| 權威域名伺服器 | 持有特定網域的實際 DNS 記錄，在回應查詢時提供 IP 位址。         | 由像 Cloudflare、Namecheap、GoDaddy 這樣的供應商維護。 |
| 遞歸 DNS 伺服器（解析器） | 作為中介，透過與更高層級伺服器通訊來處理查詢。       | 通常由 ISP 或像 Google Public DNS 這樣的公共服務提供。 |

這種階層結構確保查詢被有效路由，每個層級透過委派責任來減少更高層級的負載。

#### DNS 查詢過程：逐步解析
DNS 解析過程是一系列的查詢和回應，最終將 IP 位址傳遞給客戶端。以下是詳細分解：

1. **初始請求**：當使用者輸入網域名稱（例如 google.com）時，瀏覽器會將其發送到設定的 DNS 解析器。
2. **快取檢查**：解析器首先檢查其快取中是否有該 IP 位址。如果找到，則立即返回，加速過程。
3. **根伺服器查詢**：如果未快取，解析器會查詢根域名伺服器，根伺服器識別 TLD（例如 .com）並回應相應 TLD 伺服器的 IP 位址。
4. **TLD 伺服器查詢**：解析器接著查詢 TLD 伺服器，該伺服器提供 google.com 的權威域名伺服器的 IP 位址。
5. **權威伺服器查詢**：解析器查詢權威域名伺服器，該伺服器返回 IP 位址，例如 142.251.46.238。
6. **回應客戶端**：解析器快取此資訊以供將來使用，並將 IP 位址發送回瀏覽器，瀏覽器隨後連接到網頁伺服器。

這個過程稱為迭代查詢解析，根據網頁效能工具 YSlow 的資料，通常耗時 20-120 毫秒。另一種遞歸解析涉及解析器處理所有步驟，但迭代解析更為常見以追求效率。

#### DNS 記錄類型及其功能
DNS 記錄是 DNS 資料庫中的條目，定義了網域名稱的解析方式。下表詳細說明了最常用的類型，基於近期的見解：

| **記錄類型** | **功能**                                                                                     | **範例用例**                     |
|-----------------|-------------------------------------------------------------------------------------------------|------------------------------------------|
| A（位址）     | 將網域名稱映射到 IPv4 位址，對基本網頁存取至關重要。                          | www.example.com → 192.0.2.1              |
| AAAA            | 將網域名稱映射到 IPv6 位址，支援現代網際網路通訊協定。                    | www.example.com → 2001:db8::1            |
| CNAME（正式名稱） | 將一個網域名稱別名指向另一個網域名稱，對子網域隱藏實際網域。                   | web.example.com → example.com            |
| MX（郵件交換器） | 將電郵流量導向正確的郵件伺服器，對電郵遞送至關重要。                   | @sales.example.com → mail.example.com    |
| NS（名稱伺服器） | 指定網域的權威名稱伺服器，有助於查詢路由。                     | ns1.example.com, ns2.example.com         |
| PTR（指標）   | 提供反向 DNS 查詢，將 IP 位址映射回網域名稱以進行驗證。         | 192.0.2.1 → www.example.com             |

這些記錄實現了從網頁託管到電郵管理的多樣功能，對系統管理員和開發人員至關重要。

#### 效能與可擴展性
DNS 專為可擴展性而設計，各層級的快取減少了查詢時間。遞歸伺服器快取回應，瀏覽器可能會快取 DNS 結果一段時間，提高了頻繁訪問的速度。分散式特性，加上全球數千台伺服器，確保了高可用性和容錯能力，這是近期系統設計討論中強調的功能。

#### 實際影響與用例
理解 DNS 對網頁開發人員、網路管理員甚至一般使用者都至關重要。例如，配置 MX 記錄對於設定電郵服務至關重要，而 CNAME 記錄簡化了子網域管理。像 DNS 劫持或解析緩慢等問題可能中斷服務，這凸顯了穩健 DNS 配置的重要性，正如近期 ByteByteGo 貼文中所討論的。

#### 結論
DNS 是網際網路的骨幹，透過其階層結構和高效的解析過程實現無縫導航。其處理多樣記錄類型並擴展以滿足全球需求的能力，使其成為現代數位基礎設施的基石。如需進一步閱讀，請參閱詳細分析：[網域名稱系統（DNS）查詢如何運作？](https://blog.bytebytego.com/p/how-does-the-domain-name-system-dns) 和 [DNS 速成課程](https://blog.bytebytego.com/p/a-crash-course-in-dns-domain-name)。

本筆記基於 ByteByteGo YouTube 影片《關於 DNS 你需要知道的一切：系統設計速成課程 #4》及其相關部落格貼文的內容，確保為讀者提供全面的概述。

### 主要引用文獻
- [網域名稱系統（DNS）查詢如何運作？部落格貼文](https://blog.bytebytego.com/p/how-does-the-domain-name-system-dns)
- [DNS 網域名稱系統速成課程部落格貼文](https://blog.bytebytego.com/p/a-crash-course-in-dns-domain-name)
- [EP143 你應該知道的 DNS 記錄類型部落格貼文](https://blog.bytebytego.com/p/ep143-dns-record-types-you-should)