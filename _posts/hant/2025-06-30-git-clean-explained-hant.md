---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-code-fast-1
title: Git Clean 指令詳解
translated: true
type: note
---

### 指令功能
`git clean -f -d`（假設「clean clean」是筆誤，您實際想指的是 `git clean`）會從 Git 工作目錄中移除未追蹤的檔案和目錄。參數說明如下：
- `-f`（強制）：必須使用此參數才能實際刪除檔案，因為 Git 預設不會移除檔案，以避免意外資料損失。
- `-d`（目錄）：將清理範圍擴展至未追蹤的目錄，不僅限於檔案。

您輸入的 `-fd -f` 相當於 `-f -d -f` 的組合。由於 `-f` 重複出現，雖然冗餘但無妨——參數重複並不會造成問題。若您有其他意圖，請進一步說明！

### 運作原理
Git clean 作用於工作樹（您的本地檔案），而非儲存庫本身。以下是其行為的逐步解析：

1. **掃描工作目錄**：識別「未追蹤」項目——不在 Git 索引中或未被任何提交追蹤的檔案/目錄。例如：暫存檔如 `*.log`、建置產物，或來自已移除分支的空目錄。

2. **應用選項**：
   - 未使用 `-f` 時，僅顯示將被刪除的內容（預覽模式）。使用 `-f` 則會實際執行刪除。
   - 未使用 `-d` 時，會跳過目錄。使用 `-d` 則會移除包含未追蹤檔案的空白目錄或遞迴空白目錄。
   - 預設遵循 `.gitignore` 檔案：被忽略的檔案不會被處理，除非添加 `-x`（排除忽略規則）或 `-X`（僅清理被忽略的檔案）。

3. **安全措施**：若未使用 `-f`，Git 會發出警告。除非明確指示，否則不會移除被忽略目錄中的檔案。建議先執行 `git clean --dry-run -f -d` 預覽變更。

4. **使用範例**：
   - 互動式清理：`git clean -i`（逐項確認）。
   - 典型工作流程：在 `git reset` 後使用此指令，使工作目錄完全符合最後一次提交的狀態。

### 注意事項與驗證
- **風險**：刪除檔案後若無備份或 `git reflog` 記錄將無法還原。請務必先提交重要工作。
- **Git 文件佐證**：官方 Git 文件（如 `man git-clean` 或 git-scm.com 說明文件）確認此功能：`-f` 強制移除，`-d` 包含目錄。其使用檔案系統操作如 `unlink` 和 `rmdir`，但僅針對未追蹤項目，以避免損壞已追蹤資料。
- **測試技巧**：在模擬儲存庫中建立未追蹤的檔案和目錄，然後執行指令——觀察輸出結果與檔案系統的變化。

若此說明不符合您的需求，請提供更多背景資訊！