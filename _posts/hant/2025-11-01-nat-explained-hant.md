---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-4-fast
title: 網絡地址轉換簡介
translated: true
type: note
---

### 什麼是 NAT（網絡地址轉換）？

NAT 是一種網絡技術，用於在數據包通過路由器或防火牆時修改其標頭中的 IP 地址（有時也包括端口號）。其主要目的是讓私有（本地）網絡上的多個設備在連接互聯網時共享一個公共 IP 地址。這有助於節省公共 IP 地址，通過隱藏內部網絡細節來提升安全性，並使私有網絡能夠與公共互聯網通信。

常見的 NAT 類型有幾種：
- **源 NAT（SNAT）**：轉換外出數據包的源 IP（例如從私有 IP 轉為公共 IP）。
- **目標 NAT（DNAT）**：轉換進入數據包的目標 IP（例如將流量轉發到特定的內部伺服器）。
- **端口地址轉換（PAT）**：SNAT 的一種變體，同時重新映射端口，允許多個私有設備共享一個公共 IP。

NAT 通常於路由器、防火牆或網關上實現。

### NAT 是否會將本地地址（例如 192.168.0.x）轉換到另一個子網？

是的，正是如此——這是其核心功能之一。私有 IP 範圍如 192.168.0.x（或 10.0.0.x、172.16-31.x.x）在公共互聯網上是不可路由的（根據 RFC 1918）。當您家庭/辦公室 LAN 上的設備（例如 192.168.0.10）發送外出流量時：

1. NAT 設備（如您的路由器）將源 IP 從私有地址（192.168.0.10）更改為其自身的公共 IP（例如，類似 203.0.113.5 的不同子網地址）。
2. 它還會追蹤原始 IP/端口組合，以便正確重寫進入的回應。
3. 這種「轉換」對於外出流量是動態發生的，使得所有您的設備看起來都來自同一個公共地址。

對於進入流量（例如託管伺服器），您需要額外的設置，如端口轉發（一種 DNAT 形式），將公共 IP 映射回特定的私有 IP。

### Windows XP 中的 NAT

您說得對——Windows XP 通過 **互聯網連接共享（ICS）** 內建了 NAT 支援。這讓您可以將互聯網連接從一台 PC（作為網關）共享給本地網絡上的其他設備。ICS 使用 NAT 將私有 IP（例如來自共享網絡的 IP）轉換為主機 PC 的公共 IP。在消費級路由器普及之前，這是設置小型家庭網絡的簡單方法。您可以在網絡連接設置中啟用它，它甚至會自動分配 DHCP IP，如 192.168.0.x。

### 中國的「花生殼」程式（暴露本地伺服器）

我相信您指的是 **花生壳 (Huāshēngké)**，通常稱為 **Peanut Shell**——這是在中國（及全球）流行的動態 DNS（DDNS）服務。它本身不是 NAT，但它與 NAT 協同工作，解決您提到的「將本地電腦暴露為伺服器」的問題。

- 在 NAT 後面（例如在家庭路由器上），您的本地伺服器（假設是 192.168.0.50:80 上的網頁伺服器）由於使用私有 IP，無法直接從互聯網訪問。
- 花生殼提供一個域名（例如 yourserver.peanuthull.com），該域名會動態更新以指向您的公共 IP。結合路由器上的端口轉發，它可以「穿透」NAT，使您的本地機器能夠作為公共伺服器（用於網站、遊戲、文件共享等）。
- 這在公共 IP 動態變化或 NAT 設置嚴格的地區尤其有用，並且它自 2000 年代初就已存在，類似於 No-IP 或 DynDNS 等服務。

如果這不是您指的具體程式，請隨時澄清！

### AWS 中的 NAT

AWS 在雲端網絡中廣泛使用 NAT：
- **NAT 網關**：公共子網中的一項託管服務，允許私有子網中的實例（例如具有 10.0.1.x 等私有 IP）發起出站互聯網訪問（例如用於軟件更新），而無需直接暴露它們。它將私有源 IP 轉換為網關的公共 Elastic IP。
- **NAT 實例**：使用 EC2 實例作為 NAT 路由器的 DIY 替代方案（現在較少使用）。
- 這使得您的私有資源保持安全，同時啟用單向出站流量——非常適合 VPC（虛擬私有雲）。

總之，NAT 在現代網絡中無處不在，以高效地橋接私有和公共世界。如果您有特定的設置或場景（例如故障排除），我可以深入探討！