---
audio: false
generated: true
lang: hant
layout: post
title: AlphaFold 的運作原理
translated: true
type: note
---

讓我們深入探討由DeepMind開發的**AlphaFold**如何運作——這是一個突破性的人工智慧系統，能以驚人準確度預測蛋白質結構。我將分解其核心概念、解決的問題、架構，以及從蛋白質胺基酸序列到3D結構的步驟。這將是全面且易於理解的，提供足夠細節滿足好奇心，又不會淹沒在專業術語中。

---

### 問題所在：蛋白質摺疊

蛋白質是生命的勞工，由胺基酸鏈組成，摺疊成特定3D形狀以執行其功能（例如酵素、抗體）。**蛋白質摺疊問題**在於弄清楚胺基酸序列（例如「AGHKL...」）如何透過物理和化學相互作用，摺疊成其獨特的3D結構。傳統上，這透過實驗方法（例如X射線晶體學）解決，但速度慢且成本高，或透過計算方法解決，但對複雜蛋白質不準確。AlphaFold透過僅從序列預測結構改變了這一現狀，其準確度可與實驗方法媲美。

---

### AlphaFold的演進

- **AlphaFold 1（2018年）**：在CASP13（結構預測關鍵評估）首次亮相，結合機器學習和基於物理的建模。表現良好但有限制。
- **AlphaFold 2（2020年）**：在CASP14取得飛躍，達到接近實驗的精確度（中位數GDT_TS分數約90）。它放棄了大部分基於物理的方法，轉向完全由AI驅動的系統。
- **AlphaFold 3（2024年）**：擴展到預測蛋白質-配體相互作用和其他生物分子，但我們將重點關注AlphaFold 2，因為它是文件最齊全且最基礎的版本。

---

### AlphaFold（第2代）如何運作：整體概覽

AlphaFold 2透過以下步驟，輸入胺基酸序列並輸出3D結構：
1. 利用**演化數據**來理解序列與結構的關係。
2. 使用**深度學習架構**來建模空間關係。
3. 迭代優化預測以改進結構。

它圍繞兩個主要組件構建：**Evoformer**（處理序列和演化數據）和**結構模組**（建立3D模型）。讓我們逐步分解。

---

### 步驟1：輸入數據

AlphaFold從以下開始：
- **胺基酸序列**：蛋白質的一級結構（例如，一串100個胺基酸）。
- **多重序列比對（MSA）**：來自演化資料庫（例如UniProt）的相關蛋白質序列集合。這顯示了蛋白質序列在不同物種中的變化，暗示了對其結構至關重要的保守區域。
- **模板結構**：相似蛋白質的已知3D結構（可選，來自PDB），儘管AlphaFold 2對這些的依賴比其前身少。

MSA是關鍵——它揭示了**共同演化模式**。如果兩個胺基酸總是一起突變，它們在摺疊結構中很可能很接近，即使在序列中相距甚遠。

---

### 步驟2：Evoformer

Evoformer是一個基於transformer的神經網絡，處理MSA和序列數據，以建立蛋白質的豐富表徵。以下是它的功能：

1. **配對表徵**：
   - 建立一個編碼每對胺基酸之間關係的矩陣（例如距離、相互作用可能性）。
   - 從MSA數據初始化：相關突變暗示空間接近性。

2. **序列表徵**：
   - 追蹤每個胺基酸的特徵（例如化學性質、在鏈中的位置）。

3. **注意力機制**：
   - 使用transformer風格的注意力迭代優化這些表徵。
   - MSA的「行」（演化序列）和「列」（蛋白質中的位置）透過注意力進行通信，捕捉長程依賴關係。
   - 可以將其視為AI在問：「哪些胺基酸相互影響，以及如何影響？」

4. **輸出**：
   - 一個完善的**配對表徵**（可能空間關係的映射）和一個更新的序列表徵，準備好進行3D建模。

Evoformer的巧妙之處在於將混亂的演化數據提煉成反映物理約束的形式，而無需明確模擬物理學。

---

### 步驟3：結構模組

結構模組接收Evoformer的輸出並構建3D結構。它是一個幾何深度學習系統，預測原子位置（專注於蛋白質主鏈：Cα、N、C原子）。以下是其運作方式：

1. **初始猜測**：
   - 從蛋白質的粗略3D框架開始，通常是隨機的或基於Evoformer的提示。

2. **不變點注意力（IPA）**：
   - 一種新穎的注意力機制，尊重3D幾何（旋轉和平移不會搞亂它）。
   - 透過考慮來自Evoformer的配對關係來更新原子位置，確保物理合理性（例如鍵角、距離）。

3. **迭代優化**：
   - 在多個循環中反覆調整結構。
   - 每個循環在配對表徵和幾何約束的指導下優化座標。

4. **輸出**：
   - 一組蛋白質主鏈中所有原子的3D座標，隨後添加側鏈。

結構模組本質上是將抽象關係「雕刻」成具體形狀。

---

### 步驟4：置信度評分與優化

AlphaFold不僅預測結構——還告訴您它的置信度：
- **pLDDT（預測局部距離差異測試）**：每個殘基的置信度分數（0-100）。高分（例如>90）表示可靠的預測。
- **回收**：模型將其輸出循環回Evoformer 3-5次，每次通過優化預測。
- **最後修飾**：使用更簡單的幾何方法添加側鏈，因為主鏈決定了它們的位置。

---

### 步驟5：訓練與損失函數

AlphaFold 2的訓練數據包括：
- **PDB數據**：約170,000個已知蛋白質結構。
- **MSA資料庫**：數十億個蛋白質序列。

訓練損失結合了：
- **FAPE（框架對齊點誤差）**：以物理意義上衡量預測原子位置與真實結構的匹配程度。
- **輔助損失**：強制執行如現實鍵長和避免碰撞的約束。
- **距離圖損失**：確保預測的配對距離與現實一致（源自AlphaFold 1的遺產）。

這種端到端的訓練讓AlphaFold隱式地學習演化模式和結構規則。

---

### 關鍵創新

1. **端到端學習**：與AlphaFold 1預測距離然後優化不同，AlphaFold 2直接預測結構。
2. **Transformer與幾何學**：Evoformer的注意力和IPA將序列分析與3D推理相結合。
3. **無物理引擎**：它從數據中學習物理規則，避免緩慢的模擬。

---

### 它的準確度如何？

在CASP14中，AlphaFold 2達到了中位數GDT_TS分數92.4（滿分100），其中>90被認為是實驗品質。對於許多蛋白質，它匹配X射線或冷凍電子顯微鏡結果，但在缺乏演化數據的無序區域或新穎摺疊上仍有困難。

---

### 優勢

- **速度**：在幾小時內預測結構，而不是數月。
- **準確度**：對於大多數蛋白質，可與實驗方法媲美。
- **可擴展性**：處理不同大小的蛋白質（儘管較大的需要更多計算資源）。

---

### 限制

- **無序區域**：在處理靈活、非結構化的蛋白質片段時有困難。
- **新穎蛋白質**：如果MSA中沒有相似序列，準確度較低。
- **靜態結構**：預測一種構象，而非動態行為。
- **計算密集型**：訓練和大型預測需要大量資源（例如TPU）。

---

### 應用

- **藥物發現**：預測目標蛋白質結構以設計藥物。
- **生物學研究**：加速對蛋白質功能的理解。
- **合成生物學**：透過預測可摺疊設計來指導蛋白質工程。

---

### AlphaFold 3（簡要說明）

於2024年宣布，AlphaFold 3擴展到蛋白質-配體結合和其他分子（例如DNA、RNA）。它使用擴散模型來優化預測，但詳細機制較少公開。其核心建立在AlphaFold 2的基礎上。

---

### 結論

AlphaFold 2是AI的傑作，結合了演化見解、transformer的魔力與幾何技巧，解決了一個50年的生物學難題。它不像自然界那樣逐步模擬摺疊過程——而是從數據中逆向工程最終結果。可以將其視為一位超級聰明的製圖師，從分散的線索中繪製蛋白質的3D景觀。

如果您願意，我可以更深入地探討Evoformer的注意力機制、IPA背後的數學，甚至如何使用AlphaFold的開源代碼（可在GitHub上獲得）。您的下一個問題是什麼？