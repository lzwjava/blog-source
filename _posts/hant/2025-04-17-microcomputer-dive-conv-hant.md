---
audio: false
lang: hant
layout: post
title: 微型電腦潛航－對話
translated: true
type: note
---

A：我最近重溫了微電腦架構。我們可以先比較馮·諾依曼架構和哈佛架構嗎？

B：當然！馮·諾依曼使用單一匯流排處理數據和指令，可能導致瓶頸。哈佛架構則將兩者分離，實現並行讀取——常見於DSP和微控制器。你更關注哪種應用場景？

A：其實是嵌入式系統。哈佛架構在那裡似乎佔主導地位。但現代混合架構如改良式哈佛架構如何彌合差距？

B：好問題！混合架構使用分離快取（L1指令/數據）但維持統一記憶體空間。以ARM Cortex-M為例：它類似哈佛架構以提升速度，但簡化了編程。這其中有什麼取捨？

A：確實是取捨。統一記憶體方便開發但犧牲了吞吐量。你認為RISC-V的靈活性會顛覆這個領域嗎？

B：有可能！RISC-V的模組化ISA讓設計師能按應用添加哈佛架構特性。對物聯網邊緣設備來說，這將改變遊戲規則。但ARM的生態系統根深蒂固。你怎麼看？

A：生態系統具有黏著度，但RISC-V的開源模式可能加速特定場景的優化。換個話題——DMA在現代微控制器中有多關鍵？

B：至關重要！卸載數據傳輸（例如從ADC到記憶體）能節省CPU週期。STM32的DMA甚至能處理外設到外設的傳輸。用過環形DMA緩衝區嗎？

A：用過，用於音訊處理。但配置突發模式很棘手。當多個外設競爭時，DMA如何優先處理請求？

B：優先級通常可透過硬體配置。NXP的MCU使用加權輪詢，而某些TI元件允許動態重新優先級排序。中斷延遲也是因素——實際測量過嗎？

A：只有經驗值。說到中斷，像FreeRTOS這樣的RTOS與裸機在處理嵌套ISR時有何不同？

B：RTOS會增加層級：上下文保存、ISR後的調度器調用。FreeRTOS的「FromISR」API能安全管理這些。但裸機ISR更精簡——這是複雜度與控制力之間的取捨。

A：有道理。對硬實時系統，你會推薦超級迴圈而非RTOS嗎？

B：僅適用於簡單系統！超級迴圈難以處理多速率任務。配備優先級繼承的適當調校RTOS能避免優先級反轉。Zephyr近期的改進值得關注。

A：Zephyr的設備樹模型很有趣。它在嵌入式應用中與Linux的相比如何？

B：Linux的設備樹對微控制器過於沉重。Zephyr的Kconfig + devicetree取得平衡——靜態配置降低了運行時開銷。有在兩者間移植過驅動程式嗎？

A：還沒有，但我注意到Zephyr的GPIO API能很好地抽象硬體差異。你對微控制器的記憶體映射I/O與端口映射I/O有何看法？

B：記憶體映射現今佔主導——統一尋址簡化了編譯器設計。x86的傳統端口I/O因向後兼容而保留。ARM的MMIO甚至能處理位元帶操作以實現原子存取！

A：位元帶操作是共享變數的救星！但新興的非揮發性記憶體如MRAM呢？會顛覆記憶體階層嗎？

B：MRAM的持久性+速度很有潛力，但成本/耐用性落後。目前仍屬小眾——例如太空船日誌記錄。NVDIMM可能更早應用於微控制器。對比過FRAM與Flash的效能嗎？

A：測試過——FRAM的寫入速度遠勝Flash，但密度是問題。切換到介面話題：SPI在感測器樞紐中是否正被I3C取代？

B：I3C的多點連接和帶內中斷很吸引人，但SPI的簡潔性使其保持生命力。MEMS感測器仍預設使用SPI。試過I3C的動態定址功能嗎？

A：還沒——我當前項目使用QSPI連接外部NOR Flash。談到儲存，工業級溫度下eMMC與SD卡相比如何？

B：eMMC的焊接式可靠性在振動環境中勝過SD的連接器。但SD可拆卸便於現場更新。SLC NAND在壽命方面仍是首選。遇到過損耗均衡的錯誤嗎？

A：遇到過一次——壞的FTL實現導致記錄器變磚。來談談安全性：微控制器如何應對Spectre/Meltdown漏洞緩解？

B：Cortex-M33的TrustZone有幫助，但時序攻擊仍困擾快取記憶體。晶片供應商正在添加推測執行屏障。Rust的借用檢查器可預防某些漏洞——你在採用嗎？

A：實驗性地使用——學習曲線很陡峭。回到硬體：對RISC-V向量擴展在DSP工作負載的表現有何看法？

B：RVV的模組化設計非常出色！類似ARM NEON但具可擴展性。對tinyML而言，可能取代專用DSP核心。看過與Cadence Tensilica的基準測試嗎？

A：還沒有，但我正關注帶RVV的RISC-V MCU用於馬達控制。這讓我想到PWM外設——硬體死區時間插入有多關鍵？

B：對H橋至關重要！軟體計時器無法匹配專用模組的納秒級精度。不過ST的HRTIM對多數應用是大材小用。用過CPLD實現自定義PWM嗎？

A：用過一次——為LED矩陣同步16個通道。但像RP2040的PIO等現代MCU正在侵佔這個領域。可編程性的界限在哪？

B：PIO是革命性的！但除錯狀態機很棘手。XMOS的xCORE在硬實時多核領域仍佔優勢。你如何劃分MCU和FPGA的界線？

A：當延遲要求亞微秒級確定性時，FPGA佔優。但Lattice的iCE40 + RISC-V軟核模糊了界線。試過用Chisel進行硬體/軟體協同設計嗎？

B：Chisel的生產力提升驚人——用Scala生成Verilog節省數月時間。但工具鏈仍在成熟中。談到趨勢，小晶片架構的微控制器將如何發展？

A：小晶片架構可讓我們混搭RISC-V核心與模擬小晶片。但中介層成本必須下降。台積電的3D fabric技術很有前景。會出現開源小晶片嗎？

B：Google的OpenMPW暗示了可能性！但EDA工具仍是障礙。同時模擬技術仍是門藝術——你們團隊如何處理混合信號驗證？

A：大量使用SPICE + Python協同模擬。回到數位領域：對基於憶阻器的神經形態計算微控制器有何看法？

B：仍處於實驗室階段——元件變異性影響良率。但對邊緣AI而言，模擬記憶體內計算陣列（如Mythic的技術）更接近量產。對比過它們與量化神經網路加速器的效能嗎？

A：還沒有，但我對模擬計算的精度持懷疑態度。轉到功耗話題：次閾值CMOS設計實際能降到多低？

B：Ambiq的Apollo4達到約6µA/MHz！但低於28nm時漏電流將成主導。能量採集是下個前沿領域——用過像BQ25504這樣的PMIC嗎？

A：用過——為氣象站搭配太陽能+超級電容。但MPPT演算法需要調校。最後一個問題：量子協處理器會與微控制器整合嗎？

B：實用化還需數十年。但低溫CMOS介面正在研究中！目前我對微伺服器中的光子互連更感興趣。感謝這次深入交流！