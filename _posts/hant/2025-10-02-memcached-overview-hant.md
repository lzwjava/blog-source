---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-code-fast-1
title: Memcached 記憶體快取系統概覽
translated: true
type: note
---

### 什麼是 Memcached？

Memcached 是一個開源、高效能、分散式記憶體物件快取系統。它主要用於加速動態網頁應用程式（例如使用 PHP 框架如 CodeIgniter 構建的應用程式），透過將資料庫查詢結果、API 回應或其他計算成本高的資料快取在 RAM 中來實現。這減輕了資料庫的負載並提升了應用程式的回應速度。它並非一個完整的資料庫，而是一個設計用於臨時資料儲存的簡單鍵值儲存系統。

### Memcached 如何運作？

Memcached 作為一個守護行程（後台進程）運行在一台或多台伺服器上，通常透過像 `memcached -p 11211 -m 64`（指定連接埠和記憶體限制）這樣的命令啟動。以下是一個簡化的概述：

1. **記憶體內儲存**：它將資料以鍵值對的形式完全儲存在 RAM 中，以實現快速存取。每個值最大可達 1 MB，鍵為最多 250 個字元的字串。資料是易失性的——如果伺服器重啟，快取資料將會遺失。

2. **客戶端-伺服器模型**：應用程式（客戶端）透過 TCP 或 UDP 協定連接到 Memcached。提供的 CodeIgniter 配置片段展示了一個 PHP 設定連接到本地 Memcached 實例：
   - **主機名稱**：'127.0.0.1'（本地主機，意指與您的應用程式同一台伺服器）。
   - **連接埠**：'11211'（Memcached 的預設連接埠）。
   - **權重**：'1'（定義叢集中伺服器的優先級；數值越高表示承載更多負載）。

3. **操作**：
   - Set：儲存一個鍵值對，可選包含過期時間（例如，透過 telnet 執行 `set app_name 0 3600 13\n"cached_data"`）。
   - Get：透過鍵來擷取值。
   - Delete：透過鍵來刪除。
   它使用簡單的雜湊演算法在叢集設定中將鍵分佈到多台伺服器上（例如，一致性雜湊以處理伺服器的增減）。

4. **驅逐與擴展**：如果記憶體已滿，它會使用 LRU（最近最少使用）策略來驅逐舊資料。擴展涉及多個伺服器實例，通常透過像 moxi 這樣的工具或外部分片來自動發現。

效能峰值可達每秒數百萬次操作，但它針對讀取密集型工作負載進行了優化。監控工具如 memcached-top 可以追蹤使用情況。

### 與 Redis 的比較

雖然 Memcached 和 Redis 都是記憶體內、鍵值資料儲存，用於快取和高速資料存取，但它們在功能、架構和用例上有所不同：

| 面向          | Memcached                              | Redis                                                  |
|---------------|----------------------------------------|--------------------------------------------------------|
| **資料類型** | 簡單字串（僅鍵/值）。     | 支援字串、雜湊、列表、集合、有序集合、點陣圖、基數估計等。允許複雜的資料結構（例如 JSON 物件或計數器）。 |
| **持久性**| 無——資料純粹在 RAM 中；重啟後遺失。| 可選的持久性（AOF 或 RDB 快照）到磁碟，實現資料恢復。 |
| **驅逐**   | 僅 LRU。                             | LRU、LFU（最不常使用）或基於揮發性 TTL 的驅逐。 |
| **操作** | 基本的 set/get/delete/multiget。         | 數千個命令（例如，pub/sub、事務、Lua 腳本、地理空間查詢）。支援原子操作如 increment。 |
| **效能**| 對於簡單讀寫稍快（multigets 有幫助）。 | 整體表現優秀，但對於複雜結構略有開銷。基準測試顯示在低複雜度情境下，Memcached 在純快取方面略勝一籌。 |
| **擴展與叢集** | 透過一致性雜湊內建；無原生叢集（使用外部分區）。 | 支援原生叢集、複製（主從）和 Redis Cluster 以實現自動分區。 |
| **用例** | 適用於網頁應用程式快取（例如，工作階段或查詢快取），如 CodeIgniter 設定中的使用。簡單且輕量。 | 更廣泛：快取、工作階段儲存、訊息佇列、即時分析，甚至可作為完整資料庫的替代方案。 |
| **記憶體效率** | 對於固定大小資料效率高；無壓縮。 | 對於大型資料集更佳，並提供壓縮選項（Redis 5+）。 |
| **協定**   | 自訂二進位/文字協定。         | RESP（Redis 序列化協定），具有更好的錯誤處理。 |
| **授權與生態系統** | 開源（BSD），廣泛用於 LAMP 堆疊中。 | 開源（BSD），擁有更大的社群和工具如 RedisInsight。 |

總而言之，對於基本快取（如您的 CodeIgniter 配置所示）的簡單性和速度，請選擇 Memcached。如果您需要持久性、進階資料類型或如 pub/sub 訊息傳遞等功能，請選擇 Redis。如果從 Memcached 遷移，像 redis-memcached 這樣的專案提供了相容層，但 Redis 由於其多功能性通常取代 Memcached。對於 CodeIgniter 而言，配置允許在驅動程式之間無縫切換。