---
audio: false
generated: true
lang: hant
layout: post
title: 使用 Arduino 驗證網目分析法
translated: true
type: note
---

使用 Arduino 驗證網目分析需要構建一個包含多個迴路的電路，先透過理論上的網目分析預測電流值，再使用 Arduino 量測電阻兩端的電壓以計算實際電流進行比對。網目分析是電路理論中的一種方法，透過為每個獨立迴路指定迴路電流，並利用克希荷夫電壓定律（KVL）建立方程式。Arduino 可協助量測實際電路行為來驗證計算結果。

以下將引導您設計一個簡單的雙網目電路，手動執行網目分析，並使用 Arduino 透過量測電壓推算電流（由於 Arduino 無法直接量測電流，我們將使用歐姆定律：\\( I = V/R \\)）。

---

### **步驟 1：設計雙網目電路**

#### **電路描述**
- **元件：**
  - Arduino（例如 Uno 型號）
  - 3 個電阻（例如 R1 = 330Ω、R2 = 470Ω、R3 = 680Ω）
  - 麵包板和跳線
  - 電源（Arduino 的 5V 引腳）
- **接線：**
  - 將 5V 連接到節點 A。
  - 從節點 A 連接 R1 到節點 B。
  - 從節點 B 連接 R2 到節點 C（GND）。
  - 從節點 A 連接 R3 到節點 C（GND）。
- **拓撲結構：**
  - 網目 1：5V → R1 → R2 → GND（左側迴路）。
  - 網目 2：5V → R3 → GND（右側迴路）。
  - R1 僅位於網目 1，R3 僅位於網目 2，R2 則由兩個網目共享。
- **量測點：**
  - A0：R1 兩端電壓（節點 A 到節點 B）。
  - A1：R2 兩端電壓（節點 B 到節點 C）。
  - A2：R3 兩端電壓（節點 A 到節點 C）。

#### **電路示意圖**
```
5V ---- 節點 A ---- R1 ---- 節點 B ---- R2 ---- 節點 C (GND)
       |                        |
       +--------- R3 -----------+
```

---

### **步驟 2：理論網目分析**

#### **定義網目電流**
- \\( I_1 \\)：網目 1 的電流（順時針流經 5V、R1、R2、GND）。
- \\( I_2 \\)：網目 2 的電流（順時針流經 5V、R3、GND）。

#### **對每個網目應用 KVL**
1. **網目 1（5V → R1 → R2 → GND）：**
   - 電壓源：+5V（沿迴路方向從 GND 到 5V）。
   - R1 的電壓降：\\( -R1 \cdot I_1 \\)。
   - R2 的電壓降：\\( -R2 \cdot (I_1 - I_2) \\)（流經 R2 的電流為 \\( I_1 - I_2 \\)）。
   - 方程式：\\( 5 - R1 \cdot I_1 - R2 \cdot (I_1 - I_2) = 0 \\)。

2. **網目 2（5V → R3 → GND）：**
   - 電壓源：+5V。
   - R3 的電壓降：\\( -R3 \cdot I_2 \\)。
   - R2 的電壓降（反向）：\\( +R2 \cdot (I_1 - I_2) \\)（流經 R2 的電流為 \\( I_1 - I_2 \\)）。
   - 方程式：\\( 5 - R3 \cdot I_2 + R2 \cdot (I_1 - I_2) = 0 \\)。

#### **代入數值**
- R1 = 330Ω、R2 = 470Ω、R3 = 680Ω。
- 網目 1：\\( 5 - 330 I_1 - 470 (I_1 - I_2) = 0 \\)
  - 簡化：\\( 5 - 330 I_1 - 470 I_1 + 470 I_2 = 0 \\)
  - \\( 5 - 800 I_1 + 470 I_2 = 0 \\) → (1)
- 網目 2：\\( 5 - 680 I_2 + 470 (I_1 - I_2) = 0 \\)
  - 簡化：\\( 5 + 470 I_1 - 680 I_2 - 470 I_2 = 0 \\)
  - \\( 5 + 470 I_1 - 1150 I_2 = 0 \\) → (2)

#### **求解方程式**
- 由 (1)：\\( 5 = 800 I_1 - 470 I_2 \\) → \\( I_1 = \frac{5 + 470 I_2}{800} \\)。
- 代入 (2)：\\( 5 + 470 \left( \frac{5 + 470 I_2}{800} \right) - 1150 I_2 = 0 \\)。
- 乘以 800 消除分數：
  - \\( 4000 + 470 (5 + 470 I_2) - 1150 \cdot 800 I_2 = 0 \\)
  - \\( 4000 + 2350 + 220900 I_2 - 920000 I_2 = 0 \\)
  - \\( 6350 - 699100 I_2 = 0 \\)
  - \\( I_2 = \frac{6350}{699100} \approx 0.00908 \, \text{A} = 9.08 \, \text{mA} \\)。
- 回代：\\( I_1 = \frac{5 + 470 \cdot 0.00908}{800} = \frac{5 + 4.2676}{800} \approx 0.01158 \, \text{A} = 11.58 \, \text{mA} \\)。

#### **計算電壓**
- \\( V_{R1} = R1 \cdot I_1 = 330 \cdot 0.01158 \approx 3.82 \, \text{V} \\)。
- \\( V_{R2} = R2 \cdot (I_1 - I_2) = 470 \cdot (0.01158 - 0.00908) \approx 1.18 \, \text{V} \\)。
- \\( V_{R3} = R3 \cdot I_2 = 680 \cdot 0.00908 \approx 6.17 \, \text{V} \\)（但因電源限制，最高為 5V）。

---

### **步驟 3：使用 Arduino 驗證**

#### **Arduino 程式碼**
```cpp
void setup() {
  Serial.begin(9600); // 啟動序列通訊
}

void loop() {
  // 讀取電壓值（0-1023 對應 0-5V）
  int sensorValueR1 = analogRead(A0); // R1 兩端
  int sensorValueR2 = analogRead(A1); // R2 兩端
  int sensorValueR3 = analogRead(A2); // R3 兩端

  // 轉換為電壓值
  float VR1 = sensorValueR1 * (5.0 / 1023.0);
  float VR2 = sensorValueR2 * (5.0 / 1023.0);
  float VR3 = sensorValueR3 * (5.0 / 1023.0);

  // 電阻值
  float R1 = 330.0;
  float R2 = 470.0;
  float R3 = 680.0;

  // 計算電流（I = V/R）
  float I1 = VR1 / R1;              // 流經 R1 的網目 1 電流
  float I2 = VR3 / R3;              // 流經 R3 的網目 2 電流
  float IR2 = VR2 / R2;             // 流經 R2 的電流（I1 - I2）

  // 輸出結果
  Serial.println("量測值：");
  Serial.print("VR1 (V): "); Serial.println(VR1);
  Serial.print("VR2 (V): "); Serial.println(VR2);
  Serial.print("VR3 (V): "); Serial.println(VR3);
  Serial.print("I1 (mA): "); Serial.println(I1 * 1000);
  Serial.print("I2 (mA): "); Serial.println(I2 * 1000);
  Serial.print("I1 - I2 (mA): "); Serial.println((I1 - I2) * 1000);
  Serial.println("---");

  delay(2000); // 等待 2 秒
}
```

#### **接線注意事項**
- 連接 A0 到節點 A（5V）和節點 B 之間。
- 連接 A1 到節點 B 和節點 C（GND）之間。
- 連接 A2 到節點 A（5V）和節點 C（GND）之間。
- 確保所有接地點均與 Arduino GND 共地。

---

### **步驟 4：比對結果**

#### **預期值與量測值**
- **理論值（來自網目分析）：**
  - \\( I_1 \approx 11.58 \, \text{mA} \\)
  - \\( I_2 \approx 9.08 \, \text{mA} \\)
  - \\( I_1 - I_2 \approx 2.50 \, \text{mA} \\)
  - \\( V_{R1} \approx 3.82 \, \text{V} \\)、\\( V_{R2} \approx 1.18 \, \text{V} \\)、\\( V_{R3} \approx 5 \, \text{V} \\)（受限於電源）。
- **量測值：** 開啟序列監視器（9600 baud），比對 Arduino 輸出與這些數值。

#### **驗證**
- 檢查是否 \\( V_{R1} + V_{R2} \approx 5V \\)（網目 1 迴路）。
- 檢查是否 \\( V_{R3} \approx 5V \\)（網目 2 迴路）。
- 確認 \\( I_1 - I_2 \\) 符合流經 R2 的電流。

---

### **技巧與疑難排解**
- **精確度：** Arduino 的 ADC 解析度約為 4.9mV，且電阻容差可能導致輕微偏差。可使用三用電表進行精確驗證。
- **調整：** 若電壓超過 5V（本電路中不太可能），可使用分壓電路降低量測範圍。
- **擴展：** 可增加更多網目或元件以提升複雜度，但需注意引腳限制（A0–A5）。

此設定透過理論電流與量測值的比對來驗證網目分析。若需協助調整電路、除錯或增加更多網目，請隨時告知！