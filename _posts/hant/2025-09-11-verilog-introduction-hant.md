---
audio: false
date: 2025-09-11
generated: true
image: false
lang: hant
layout: post
model: google/gemini-2.5-flash
title: Verilog：硬件描述語言入門
translated: true
type: note
---

Verilog，通常稱為 **Verilog HDL（硬體描述語言）**，是一種功能強大且廣泛使用的語言，用於描述、設計、模擬和合成數位電子電路與系統。它是現代電子設計自動化（EDA）的基礎工具。

以下是對 Verilog 的全面介紹：

---

### 1. 什麼是 Verilog？

從本質上講，Verilog 是一種 **硬體描述語言（HDL）**。與傳統的軟體程式語言（如 C++ 或 Python）在處理器上順序執行不同，Verilog 專門設計用於描述 **硬體電路的結構和行為**。這意味著它可以建模：

*   **並發性：** 硬體組件並行運作。Verilog 原生支援此概念。
*   **時間：** 延遲、時鐘週期和時序關係是硬體的基礎，Verilog 可以明確地對這些進行建模。
*   **層次結構：** 複雜的電路由較小、互連的子電路建構而成。Verilog 允許模組化和層次化設計。

### 2. 為什麼使用 Verilog？（它解決的問題）

在 HDL 出現之前，數位電路主要使用 **原理圖擷取（手動繪製邏輯閘和連線）** 或編寫極低階的網表來設計。對於複雜的設計，這種方法變得難以管理，原因在於：

*   **複雜性：** 現代晶片包含數十億個電晶體。手動設計容易出錯且耗時。
*   **抽象化：** 設計師需要更高層次的抽象化，以便在投入實體佈局之前概念化和驗證功能。
*   **可重用性：** 原理圖組件難以修改和跨專案重用。
*   **驗證：** 測試大型原理圖設計的功能性極其困難。

Verilog 通過提供 **基於文字的高層次抽象** 來應對這些挑戰，使工程師能夠：

*   **高效描述複雜邏輯：** 無需繪製邏輯閘，而是編寫程式碼。
*   **模擬行為：** 在製造前驗證設計的正確性。
*   **合成硬體：** 自動將高層次描述轉換為實體閘級網表。
*   **管理複雜性：** 使用模組化和層次結構。
*   **促進可重用性：** 設計區塊可以輕鬆實例化和重用。

### 3. 主要特性與概念

#### a. 並發性質
這是與軟體程式設計最關鍵的區別。所有 Verilog 的 `always` 區塊和 `assign` 語句（描述硬體行為）在概念上 **並行執行**。執行流程由事件（例如，時鐘邊緣、輸入信號的變化）驅動，而不是由自上而下的順序程式計數器驅動。

#### b. 抽象層次

Verilog 支援各種抽象層次，允許設計師從高層次功能描述轉向閘級實現：

*   **行為層次：** 使用演算法、順序語句和資料流來描述電路的功能。它側重於電路 *做什麼*，而不一定詳細說明其確切的實體結構。
    *   *範例：* 描述計數器增量邏輯或有限狀態機狀態轉換的 `always` 區塊。
*   **暫存器轉換層次（RTL）：** 數位設計中最常用的層次。它描述資料在暫存器之間的流動以及組合邏輯如何轉換該資料。它暗示了特定的硬體組件（暫存器、多工器、加法器），但未指定其確切的閘級實現。
    *   *範例：* `always @(posedge clk) begin if (reset) count <= 0; else count <= count + 1; end`
*   **結構層次：** 將電路描述為邏輯閘和/或先前定義的模組的互連。就像通過連接預製組件來建構電路。
    *   *範例：* 實例化一個 AND 閘並連接其輸入和輸出。
*   **閘級：** 最低層次，使用 Verilog 提供的原始邏輯閘（AND, OR, NOT, XOR, NAND, NOR, XNOR）來描述電路。通常在合成後用於技術映射。
    *   *範例：* `and (out, in1, in2);`

#### c. 模組

Verilog 中的基本建構區塊。一個模組封裝了一部分硬體，定義了其輸入、輸出和內部邏輯。複雜的設計通過實例化和連接多個模組來創建。

*   **埠：** 模組與外部世界通訊的輸入、輸出和雙向埠。

#### d. 資料類型

Verilog 具有特定的資料類型來表示硬體信號：

*   **線網（`wire`, `tri`）：** 表示組件之間的實體連接。它們不儲存值；它們的值由某物（`assign` 語句、模組輸出）持續驅動。主要用於組合邏輯。
*   **暫存器（`reg`）：** 表示資料儲存元素。它們可以保存一個值，直到明確更改為止。在 `initial` 和 `always` 區塊內使用。注意：`reg` 在合成後不一定意味著一個實體暫存器；它僅表示在模擬中它保存一個值。當 `reg` 在時鐘邊緣同步更新時，會推斷出一個實體暫存器（正反器）。
*   **參數：** 用於配置的常數（例如，位元寬度、記憶體大小）。

#### e. 賦值語句

*   **連續賦值（`assign`）：** 用於組合邏輯。每當任何輸入發生變化時，輸出會持續更新，就像實體連線一樣。
    *   *範例：* `assign sum = a ^ b ^ carry_in;`
*   **程序式賦值：** 發生在 `initial` 或 `always` 區塊內。
    *   **阻塞賦值（`=`）：** 行為類似傳統軟體賦值；立即評估並賦值。如果在 `always` 區塊中不小心使用，可能導致競爭條件。
    *   **非阻塞賦值（`<=`）：** 所有右側表達式在時間步長的開始時評估，並在結束時進行賦值。對於建模同步（時鐘控制）硬體（如正反器）至關重要，因為它避免了競爭條件並準確反映了並行資料傳輸。

#### f. 程序區塊

*   **`always` 區塊：** 描述隨時間重複或在特定事件上觸發的行為。用於組合邏輯（對所有輸入敏感）和順序邏輯（對時鐘邊緣、重置敏感）。
*   **`initial` 區塊：** 僅在模擬開始時執行一次。主要用於測試平台（施加激勵）或初始化記憶體/暫存器。

### 4. 設計流程整合

Verilog 在典型的數位 IC/FPGA 設計流程中扮演著關鍵角色：

1.  **規格制定：** 定義電路的需求。
2.  **設計（RTL 編碼）：** 編寫 Verilog 程式碼，在暫存器轉換層次描述電路的行為和結構。
3.  **模擬與驗證：** 使用 Verilog 測試平台（提供輸入並檢查輸出的獨立模組）和 EDA 模擬器來驗證 RTL 設計是否正確運作。這是一個迭代過程。
4.  **合成：** 將行為/RTL Verilog 程式碼轉換為針對目標技術（例如，FPGA 或 ASIC 庫）的閘級網表（使用原始邏輯閘及其互連的電路描述）。
5.  **佈局與繞線：** 在晶片上實體排列邏輯閘並用連線連接它們。
6.  **佈局後模擬/時序分析：** 使用實際的實體延遲重新驗證設計。
7.  **製造（適用於 ASIC）/ 燒錄（適用於 FPGA）。**

### 5. 應用

Verilog 廣泛應用於以下設計：

*   **FPGA（現場可程式化邏輯閘陣列）：** 用於快速原型製作、中低量產和可重構計算。
*   **ASIC（特殊應用積體電路）：** 用於高量產、最高效能和低功耗。
*   **微處理器和微控制器**
*   **數位信號處理器（DSP）**
*   **通訊系統（網路、無線）**
*   **圖形處理器**
*   **嵌入式系統**

### 6. Verilog 的優勢

*   **業界標準：** 由 IEEE（IEEE 1364）標準化，確保了不同 EDA 工具和供應商之間的互通性。
*   **抽象化：** 允許設計師在更高層次上工作，管理複雜性。
*   **並發建模：** 原生支援硬體的並行性質。
*   **時間建模：** 能夠準確模擬時序行為。
*   **工具支援：** 幾乎所有主要的 EDA 工具都支援，用於模擬、合成、形式驗證等。
*   **可讀性與可維護性：** 基於文字的程式碼比複雜的原理圖更容易閱讀、修改和記錄。
*   **可重用性：** 設計區塊可以在未來的專案中輕鬆重用。
*   **廣泛採用：** 擁有龐大的社群和豐富的資源。

### 7. 演進：SystemVerilog

雖然 Verilog 非常強大，但其處理複雜驗證任務的能力有限。這導致了 **SystemVerilog** 的發展，它是 Verilog HDL 的擴展和超集。SystemVerilog 包含了：

*   **進階資料類型：** 枚舉類型、結構、聯合、類別（用於驗證）。
*   **增強的的行為建模：** 斷言、介面、新的程序結構。
*   **物件導向程式設計（OOP）結構：** 專門用於建構強大且可重用的測試平台（通常與 UVM - 通用驗證方法學一起使用）。
*   **功能覆蓋率和隨機化：** 對現代驗證至關重要。

SystemVerilog 現已成為業界設計和驗證的主導 HDL，儘管普通的 Verilog 仍然被廣泛使用，特別是在遺留程式碼和較簡單的設計中。

---

總而言之，Verilog 不僅僅是一種程式語言；它是一種設計範式，橋接了抽象概念與實體電子電路之間的差距，使得創建當今極其複雜的數位系統成為可能。