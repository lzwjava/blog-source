---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-4-fast
title: Azure 虛擬網絡基礎
translated: true
type: note
---

### Azure 虛擬網絡基礎

Azure 透過其**虛擬網絡（VNet）**服務提供可擴展且安全的網絡環境，這是與 AWS VPC 對等的核心服務。它會在 Azure 雲端中為您的資源（例如 VM、App Services 或 Kubernetes 叢集）建立私人隔離空間。以下我將以類似結構說明關鍵組件（虛擬網絡、閘道、子網等）與 AWS 的異同，方便對照。

#### 虛擬網絡（VNet）
- **定義**：Azure 中的基礎隔離網絡，橫跨整個區域，允許資源進行私人通訊。您可以使用 CIDR 區塊（例如 10.0.0.0/16）定義其地址空間。
- **主要特性**：
  - 資源預設具備輸出網際網路存取（不同於 AWS 需選擇啟用）。
  - 支援 IPv4 和 IPv6；預設為隔離狀態。
  - VNet 本身免費，僅需支付附加資源（如閘道）的費用。
- **類似 AWS VPC**：兩者皆為資源隔離、擴展和連線的私有雲。Azure VNet 自動橫跨可用區域（AZ）；AWS VPC 需明確設定 AZ。
- **使用時機**：安全的資源間通訊、網際網路存取及本地連線。每個 Azure 訂閱皆可使用，但需建立自訂 VNet 以獲得控制權。
- **範例**：如同 AWS VPC，它是您在雲端的「私人莊園」—您設定邊界，但 Azure 會處理部分預設值（如輸出網際網路）。

#### 子網
- **定義**：VNet 地址空間的劃分，資源會部署於其中。每個子網均隸屬於 VNet，並可橫跨區域內所有 AZ。
- **類型**：
  - **公共子網**：資源可擁有公共 IP，用於輸入/輸出網際網路（透過 Azure Load Balancer 或公共端點）。
  - **私有子網**：無直接公共存取；適合資料庫或內部應用程式。
- **主要特性**：
  - 以 CIDR 定義（例如 10.0.1.0/24）。
  - 每個 VNet 可設多個子網以進行區隔；子網間流量可過濾。
- **類似 AWS 子網**：兩者皆為安全性和組織性而分割網絡。Azure 自動橫跨 AZ 簡化高可用性；AWS 將子網綁定至特定 AZ。
- **使用時機**：隔離工作負載—例如前端置於公共子網，後端置於私有子網。
- **範例**：子網如同您 VNet 城市中的「區域」：公共區具街道存取（網際網路），私有區隱於牆後。

#### 閘道
Azure 中的閘道處理外部連線，但部分預設值與 AWS 不同。

- **網際網路閘道對應**：
  - **定義**：無直接 IGW；VNet 資源預設啟用輸出網際網路。輸入存取需公共 IP 或 Load Balancer。
  - **運作方式**：流量透過 Azure 系統路由（0.0.0.0/0 指向網際網路）。使用公共 IP 以實現雙向存取。
  - **類似 AWS IGW**：兩者皆啟用公共網際網路，但 Azure 的輸出更偏向「常啟」模式；AWS 需明確附加和設定路由。
  - **使用時機**：簡單公開暴露 Web 應用程式。基礎路由免費。

- **NAT 閘道**：
  - **定義**：位於公共子網的託管服務，用於私有子網的僅輸出網際網路（例如 VM 更新）。
  - **運作方式**：共享一個 Elastic IP 進行轉譯；跨 AZ 高可用性。
  - **類似 AWS NAT Gateway**：兩者皆提供安全輸出且無輸入暴露。Azure 版本預設更整合且可擴展。
  - **使用時機**：保護私有資源同時允許單向存取。費用約每小時 0.045 美元 + 資料傳輸費。

- **其他閘道**：
  - **VPN 閘道**：用於站對站或點對站 VPN 連至本地（類似 AWS VGW）。
  - **ExpressRoute 閘道**：私有高頻寬連線至本地（類似 AWS Direct Connect）。

#### 其他相關組件（「等等」）
- **路由表**：控制子網流量流向（例如至網際網路或對等互連 VNet）。系統有預設路由；自訂路由可覆蓋特定路徑。類似 AWS 路由表，但 Azure 會動態傳播來自本地的 BGP 路由。
- **網絡安全群組（NSG）**：用於子網或資源的狀態防火牆，規則基於 IP/連接埠/通訊協定。類似 AWS Security Groups（執行個體層級，狀態性）和 NACLs（子網層級，但 Azure 為狀態性）的組合。可使用 Application Security Groups 進行邏輯標記。
- **VNet 對等互連**：連接 VNet（相同/不同區域/帳戶）以進行私人流量傳輸，類似 AWS VPC 對等互連。
- **服務端點/Private Link**：安全私有存取 Azure 服務（例如 Storage），無需網際網路，類似 AWS VPC Endpoints。
- **網絡虛擬設備**：VNet 中基於 VM 的防火牆或路由器，類似 AWS Network Firewall。

#### 整體運作流程
1. 使用 CIDR 建立 VNet。
2. 新增橫跨 AZ 的子網（公共/私有）。
3. 資源獲得預設輸出網際網路；新增公共 IP/Load Balancers 以實現輸入存取。
4. 使用 NAT 閘道處理私有輸出。
5. 應用路由表和 NSG 以控制流量。
6. 對等互連 VNet 或新增閘道以實現混合設定。

Azure 模式強調預設值（例如輸出網際網路）以加速設定，而 AWS 提供更細緻的選擇啟用。兩者皆優先考慮安全性和韌性。

若需實作，可嘗試 Azure 入口網站的 VNet 精靈。

[Azure 虛擬網絡概覽](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview)