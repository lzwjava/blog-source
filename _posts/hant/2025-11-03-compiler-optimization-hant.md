---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-4-fast
title: 編譯器優化技巧：資深程式設計師指南
translated: true
type: note
---

### 編譯器優化

在 Kent Dybvig 的編譯器課程中，他曾告訴我們，許多編譯器課程過度強調「優化」，但這些優化大多其實是為了應付粗心的程式設計師。例如常見的子表達式消除（CSE）——將重複且耗費資源的表達式提取出來。一位訓練有素的程式設計師本應在最初就透過定義變數來重用結果，避免寫出冗餘的計算。然而編譯器卻將此視為己任，彷彿這是什麼了不起的事情。其實不然。

真正重要的是編譯器本身的速度。許多編譯器堆砌了這類無意義的「優化」，試圖將糟糕的程式碼轉化為高效程式碼，結果反而拖慢了編譯速度。建置專案耗時漫長，從程式碼修改到看到結果的周期被拉長，嚴重打擊開發者的生產力。

這就是為什麼 Chez Scheme 跳過了大多數這類基礎優化——它假設程式設計師具備基本能力，能自行避免冗餘且耗費資源的表達式。Chez 的優化主要專注於編譯器自身產生的程式碼，例如閉包優化，以盡可能縮小閉包的記憶體佔用。這些是程式設計師無法直接控制的領域，因此編譯器應在此追求最佳結果。但即便如此，這些優化也有其限制：若追求優化會導致編譯速度急遽下降，卻僅能微幅提升最終程式效能，那便不值得。Chez Scheme 在編譯速度與生成程式碼的效能之間取得了平衡。

在後來的工程實踐中，我多次體會到這一洞見的關鍵性。