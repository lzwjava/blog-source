---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-4-fast
title: 紅黑樹概覽
translated: true
type: note
---

### 什麼是紅黑樹？

**紅黑樹**是一種自平衡二元搜尋樹（BST），在電腦科學中用於高效儲存和檢索資料。它通過在插入和刪除操作後保持樹結構大致平衡，確保搜尋、插入和刪除操作的時間複雜度為 O(log n)，其中 n 為節點數量。

#### 關鍵特性
紅黑樹通過強制執行五條規則來保持平衡：
1. **節點顏色**：每個節點只能是紅色或黑色。
2. **根節點**：根節點必須是黑色。
3. **葉節點**：所有 NIL（空）葉節點均為黑色。
4. **紅節點規則**：紅色節點不能擁有紅色子節點（禁止連續紅色節點）。
5. **黑高度規則**：從任意節點到其所有後代葉節點的路徑上，黑色節點數量必須相同（確保平衡性）。

這些規則可防止樹結構退化成鏈狀（如鏈結串列），從而避免效能惡化至 O(n)。

#### 運作原理
- **插入操作**：先執行標準 BST 插入。若新節點違反規則（例如出現紅-紅父子節點），則進行「旋轉」（透過左右旋轉重構樹結構）與「重新着色」來修復，從而維持對數高度。
- **刪除操作**：較插入更複雜，需尋找替代節點並透過顏色調整與旋轉來維持特性。
- **搜尋操作**：與 BST 完全相同——根據鍵值比較進行左右遍歷。

旋轉屬於局部操作，能在維持 BST 特性的同時修正平衡性。

#### 視覺化範例
以下是以 Markdown 呈現的紅黑樹平衡結構（鍵值 10, 20, 30, 40, 50；R=紅, B=黑）：

```
       B(30)
      /     \
   B(20)    B(40)
  /   \       \
R(10) R(25)  R(50)
```

#### 優勢
- **相較於 AVL 樹**：紅黑樹允許輕微不平衡以減少插入/刪除時的旋轉次數，在動態資料處理中實際速度更快（例如 Java 的 TreeMap 與 Linux 核心均採用）。
- **取捨**：樹高略大於完全平衡樹，但實作更簡潔。

若需深入探索，可參考 Python（透過 sortedcontainers 套件）或 C++（std::set）的實作。如需程式碼範例或具體說明，歡迎提出！