---
audio: false
generated: true
lang: hant
layout: post
title: Prolog：基於邏輯的聲明式編程
translated: true
type: note
---

Prolog，全名「Programming in Logic」，是一種**宣告式程式語言**，與 Python、Java 或 C++ 等指令式語言形成鮮明對比。它不要求你逐步告訴電腦*如何*解決問題，而是描述問題*是什麽*，然後由 Prolog 使用其內建的推理引擎來尋找解決方案。

它特別適合處理涉及**邏輯、符號推理和知識表示**的問題，因此成為人工智慧（AI）、自然語言處理和專家系統領域的基石。

### Prolog 的核心概念：

1.  **事實：**
    事實是你提供給 Prolog 的關於世界的基本真相。它們代表無條件的斷言。

      * **語法：** `謂詞(引數1, 引數2, ...).`
      * **範例：**
          * `男人(約翰).`（約翰是男人）
          * `女人(瑪麗).`（瑪麗是女人）
          * `父母(約翰, 瑪麗).`（約翰是瑪麗的父母）
          * `首都(法國, 巴黎).`（巴黎是法國的首都）

2.  **規則：**
    規則定義了事實之間的關係。它們陳述某個事實若在一個或多個其他事實（或條件）為真時，則該事實也為真。

      * **語法：** `頭部 :- 主體.`（讀作「若主體為真，則頭部為真」）
          * `頭部` 是單一謂詞。
          * `主體` 是一個或多個謂詞的合取，以逗號（`,`）分隔，表示「且」。
      * **範例：**
          * `快樂(X) :- 喜歡(X, 披薩).`（若 X 喜歡披薩，則 X 快樂）
          * `父親(X, Y) :- 父母(X, Y), 男性(X).`（若 X 是 Y 的父母且 X 是男性，則 X 是 Y 的父親）
          * `祖父母(G, C) :- 父母(G, P), 父母(P, C).`（若 G 是 P 的父母且 P 是 C 的父母，則 G 是 C 的祖父母）

3.  **查詢：**
    一旦你定義了事實和規則（你的「知識庫」），你就可以向 Prolog 提出問題，稱為查詢，以檢索資訊或驗證關係。

      * **語法：** `?- 查詢.`
      * Prolog 嘗試根據已建立的事實和規則，尋找能使查詢為真的變數來滿足查詢。如果存在多個解決方案，通常可以透過輸入分號（`;`）來要求 Prolog 提供更多結果。
      * **範例：**
          * `?- 男人(約翰).`（約翰是男人嗎？）
          * `?- 父母(約翰, X).`（約翰是誰的父母？ - `X` 是變數）
          * `?- 祖父母(伊莉莎白, 威廉).`（伊莉莎白是威廉的祖父母嗎？）

4.  **變數：**
    Prolog 中的變數用於表示未知值。它們總是以大寫字母或底線（`_`）開頭。與指令式語言中的變數不同，它們不是可以重新賦值的記憶體位置；而是 Prolog 為了滿足查詢而嘗試與值統一的佔位符。

5.  **統一：**
    這是 Prolog 的核心機制。統一是一種模式匹配過程，它嘗試透過為變數賦值來使兩個項變得相同。如果找到匹配，變數就會「綁定」到這些值。如果無法匹配，則統一失敗。

6.  **回溯：**
    當 Prolog 嘗試滿足查詢時，它會以深度優先的方式處理事實和規則。如果某條路徑導致死胡同（目標無法滿足），Prolog 會「回溯」到先前的選擇點並嘗試替代路徑。這種系統性的搜索使其能夠找到查詢的所有可能解決方案。

### Prolog 的運作方式（簡化版）：

1.  你將 Prolog 程式（一系列事實和規則）載入直譯器。
2.  你提出一個查詢。
3.  Prolog 嘗試透過將查詢與其事實和規則的頭部進行匹配來證明該查詢。
4.  如果規則的頭部匹配，Prolog 則嘗試證明規則主體中的條件（這些成為子目標）。
5.  這個過程會遞迴地持續，直到所有子目標都被事實或已成功證明的規則所滿足。
6.  如果找到解決方案，Prolog 會呈現變數綁定。如果存在多個解決方案，它可以回溯以找到它們。

### Prolog 的優點：

  * **宣告式特性：** 專注於*解決什麼*，而不是*如何解決*。對於某些問題，這可以帶來更簡潔和易讀的程式碼。
  * **內建邏輯與推理：** 提供強大的邏輯推理和搜索機制。
  * **非常適合符號 AI：** 是專家系統、自然語言處理、知識表示和定理證明的理想選擇。
  * **模式匹配與統一：** 簡化了複雜的資料操作。
  * **回溯：** 自動化搜索解決方案的過程，這在其他語言中需要手動編程。

### Prolog 的缺點：

  * **學習曲線：** 對於習慣指令式編程的人來說，宣告式範式可能具有挑戰性。
  * **效能：** 在數值計算或 I/O 密集型任務方面，可能比指令式語言效率低。
  * **有限的 I/O 和圖形功能：** 並非為複雜的使用者介面或圖形應用程式而設計。
  * **除錯：** 由於回溯，追蹤 Prolog 的執行流程有時可能很棘手。

-----

### Prolog 程式碼範例：

要運行這些範例，你需要一個 Prolog 直譯器（例如免費且廣泛使用的 SWI-Prolog）。你通常將程式碼儲存在副檔名為 `.pl` 的檔案中（例如 `family.pl`），然後將其載入直譯器。

**範例 1：家庭關係**

讓我們定義一些基本的家庭關係。

**`family.pl`：**

```prolog
% 事實：定義基本關係
男性(約翰).
男性(吉姆).
男性(喬治).
女性(瑪麗).
女性(麗莎).
女性(蘇珊).

父母(約翰, 麗莎).   % 約翰是麗莎的父母
父母(約翰, 吉姆).    % 約翰是吉姆的父母
父母(瑪麗, 麗莎).   % 瑪麗是麗莎的父母
父母(瑪麗, 吉姆).    % 瑪麗是吉姆的父母
父母(麗莎, 喬治). % 麗莎是喬治的父母
父母(吉姆, 蘇珊).   % 吉姆是蘇珊的父母

% 規則：定義衍生關係
父親(X, Y) :- 父母(X, Y), 男性(X).         % 若 X 是 Y 的父母且 X 是男性，則 X 是 Y 的父親。
母親(X, Y) :- 父母(X, Y), 女性(X).        % 若 X 是 Y 的父母且 X 是女性，則 X 是 Y 的母親。
孩子(X, Y) :- 父母(Y, X).                    % 若 Y 是 X 的父母，則 X 是 Y 的孩子。
祖父母(G, C) :- 父母(G, P), 父母(P, C). % 若 G 是 P 的父母且 P 是 C 的父母，則 G 是 C 的祖父母。
兄弟姊妹(X, Y) :- 父母(P, X), 父母(P, Y), X \= Y. % 若 X 和 Y 有共同的父母 P，且 X 與 Y 不同，則 X 和 Y 是兄弟姊妹。
```

**在 Prolog 直譯器中運行（例如 SWI-Prolog）：**

```prolog
?- consult('family.pl').
% family.pl compiled 0.00 sec, 7 clauses
true.

% 查詢：

?- 男性(約翰).
true.

?- 女性(吉姆).
false.

?- 父母(約翰, 麗莎).
true.

?- 父母(X, 吉姆). % 誰是吉姆的父母？
X = 約翰 ;           % 輸入 ';' 以獲取更多解決方案
X = 瑪麗.
false.

?- 父親(約翰, 麗莎).
true.

?- 母親(瑪麗, 吉姆).
true.

?- 祖父母(約翰, 喬治).
true.

?- 祖父母(X, 蘇珊). % 誰是蘇珊的祖父母？
X = 約翰 ;
X = 瑪麗.
false.

?- 兄弟姊妹(麗莎, 吉姆).
true.

?- 兄弟姊妹(麗莎, 喬治).
false. % 因為他們並非共享*所有*父母
```

**範例 2：簡單知識庫（動物）**

**`animals.pl`：**

```prolog
% 關於動物及其屬性的事實
動物(狗).
動物(貓).
動物(鳥).
動物(魚).

有毛皮(狗).
有毛皮(貓).
會飛(鳥).
會游泳(魚).

吃(狗, 骨頭).
吃(貓, 魚).
吃(鳥, 種子).
吃(魚, 浮游生物).

% 規則
是哺乳類(X) :- 動物(X), 有毛皮(X). % 哺乳類是有毛皮的動物。
會飛(X) :- 動物(X), 會飛(X).     % 若某物是動物且會飛，則它會飛。
```

**在 Prolog 直譯器中運行：**

```prolog
?- consult('animals.pl').
% animals.pl compiled 0.00 sec, 10 clauses
true.

% 查詢：

?- 動物(貓).
true.

?- 有毛皮(狗).
true.

?- 吃(貓, X). % 貓吃什麼？
X = 魚.

?- 是哺乳類(狗).
true.

?- 是哺乳類(鳥).
false.

?- 會飛(X). % 哪些動物會飛？
X = 鳥.
false.
```

這些範例說明了 Prolog 的宣告式特性，你定義關係和屬性，系統則推斷出你的查詢的答案。