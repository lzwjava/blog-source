---
audio: false
generated: true
lang: hant
layout: post
title: 理解數據庫中的完整 ACID 合規性
translated: true
type: note
---

ACID 合規性是確保資料庫可靠性和資料完整性的基本框架之一，特別是在交易處理系統中。讓我們深入探討 ACID 的含義及其重要性。

## 什麼是 ACID？

ACID 是一個縮寫，代表：

- **原子性**
- **一致性**
- **隔離性**
- **持久性**

這四個屬性共同保證資料庫交易能夠可靠地處理，即使在面對錯誤、電源故障和其他問題時也是如此。讓我們詳細檢視每個屬性。

## 原子性

原子性確保交易被視為單一、不可分割的工作單位。這意味著：

- 要麼交易內的所有操作都成功完成（提交）
- 要麼所有操作都不生效（回滾）

### 深入探討：
當交易涉及多個操作（例如從一個帳戶扣款並向另一個帳戶存款）時，原子性保證要麼兩個操作都成功，要麼都不成功。資料庫透過預寫日誌和回滾段等機制來維護此屬性，這些機制記錄變更前的狀態，以便系統可以撤銷部分交易。

## 一致性

一致性確保交易將資料庫從一個有效狀態轉變為另一個有效狀態，維護所有預先定義的規則、約束和觸發器。

### 深入探討：
一致性在多個層面上起作用：
- **資料庫一致性**：強制執行資料完整性約束、外來鍵、唯一約束和檢查約束
- **應用程式一致性**：確保業務規則得到維護
- **交易一致性**：保證在交易執行前後不變量得以保持

一致性交易能維護資料庫的語義完整性——它不能違反任何已定義的規則。例如，如果規則規定帳戶餘額不能為負，則一致性交易不能導致負餘額。

## 隔離性

隔離性確保並行執行的交易能使資料庫處於與這些交易順序執行時相同的狀態。

### 深入探討：
隔離性防止以下問題：
- **髒讀**：讀取另一個交易未提交的資料
- **不可重複讀**：在同一交易中兩次讀取相同資料時得到不同結果
- **幻讀**：由於另一個交易的插入操作，導致在範圍掃描中出現新列

資料庫透過以下技術實現各種隔離級別：
- **悲觀並行控制**：鎖定資源以防止衝突
- **樂觀並行控制**：允許並行存取但在提交前進行驗證
- **多版本並行控制**：維護資料的多個版本以允許並行讀取而不阻塞

## 持久性

持久性保證一旦交易被提交，即使在系統故障的情況下，它也會保持已提交狀態。

### 深入探討：
持久性通常透過以下方式實現：
- **預寫日誌**：變更首先記錄在日誌中，然後再應用到實際資料
- **冗余儲存**：在多個不同位置儲存資料的多個副本
- **檢查點機制**：確保變更定期從記憶體刷新到持久儲存

實際上，這意味著已提交的交易在電源故障、系統崩潰或硬體故障後仍然存在，因為它們已被永久儲存在非揮發性記憶體中。

## 實作挑戰與考量

實現完整的 ACID 合規性涉及顯著的權衡：

1. **效能影響**：嚴格的 ACID 屬性可能會降低吞吐量並增加延遲
2. **可擴展性限制**：在分散式系統中，某些 ACID 保證變得難以維護
3. **實作複雜性**：維護這些屬性需要複雜的演算法和機制
4. **資源利用率**：可能需要額外的儲存空間和記憶體來處理日誌、鎖定表和多重資料版本

## 實際應用

不同的資料庫系統提供不同級別的 ACID 合規性：

- **傳統關聯式資料庫管理系統**（Oracle、SQL Server、PostgreSQL、使用 InnoDB 的 MySQL）：完全 ACID 合規
- **NoSQL 資料庫**：通常為了可擴展性和效能而犧牲某些 ACID 屬性（通常遵循 BASE 原則）
- **NewSQL 資料庫**：試圖同時提供可擴展性和 ACID 屬性

## 超越 ACID：現代發展

雖然 ACID 仍然是基礎，但分散式系統引入了額外的概念：

- **CAP 定理**：指出分散式系統只能提供一致性、可用性和分區容錯性這三個保證中的兩個
- **BASE**（基本可用、軟狀態、最終一致性）：適用於分散式系統的替代方法
- **Saga 模式**：一系列本地交易，在分散式系統中維護最終一致性

完整的 ACID 合規性對於資料完整性至關重要的應用程式仍然至關重要，例如金融系統、醫療保健應用程式和關鍵記錄保存系統。