---
audio: false
generated: true
lang: hant
layout: post
title: 現場可編程閘陣列
translated: true
type: note
---

現場可編程閘陣列（FPGA）是一種多功能半導體裝置，可在製造後由設計人員進行配置。與專為特定用途定制且製造後無法更改的專用積體電路（ASIC）不同，FPGA具有實現幾乎任何數位電路或系統的靈活性。這種可重配置特性使其在廣泛應用領域中展現強大效能。

以下是理解FPGA的完整指南：

**1. 什麼是FPGA？**

* **可編程邏輯：** FPGA核心是由可編程互連連接的可編程邏輯區塊陣列。這允許設計人員以無數方式「連接」內部元件來實現自訂硬體功能。
* **可重配置性：** FPGA的關鍵區別在於其能夠多次重新編程，即使在現場部署後亦然。這使得無需更換實體硬體即可進行錯誤修復、功能更新甚至完整重新設計。
* **並行處理：** FPGA擅長並行處理。與通常順序執行指令的CPU不同，FPGA可同時執行多個操作，使其成為計算密集型任務的理想選擇。
* **硬體實現：** 當您對FPGA進行編程時，本質上是在設計自訂硬體。這提供了對時序和資源的細粒度控制，對於特定應用而言，可能實現比軟體解決方案更高的效能和更低的功耗。

**2. FPGA核心架構：**

典型FPGA架構包含三種主要可編程元件：

* **可配置邏輯區塊（CLB）：** 這些是實現邏輯功能的基本建構區塊。CLB通常包含：
    * **查找表（LUT）：** 這些小型記憶體陣列可被編程以實現特定輸入數量的任何布林函數（例如常見的4輸入或6輸入LUT）。
    * **正反器（FF）：** 這些用於儲存邏輯狀態的記憶體元件，對於實現順序電路至關重要。
    * **多工器（MUX）：** 用於在不同訊號之間進行選擇，允許在CLB內進行靈活的佈線和功能選擇。
* **可編程互連：** 這是連接FPGA上CLB和其他資源的電線和可編程開關網絡。互連允許設計人員在不同邏輯區塊之間路由訊號以創建複雜電路。關鍵組件包括：
    * **開關盒：** 包含允許水平和垂直路由通道之間連接的可編程開關。
    * **連接盒：** 將路由通道連接到CLB的輸入和輸出引腳。
    * **路由通道：** 這些是在FPGA上傳輸訊號的實際電線。
* **輸入/輸出（I/O）區塊：** 提供FPGA內部邏輯與外部世界之間的介面。它們可配置以支援各種信號標準（例如LVCMOS、LVDS），並可包含以下功能：
    * **可編程驅動強度：** 調整輸出電流。
    * **轉換率控制：** 控制電壓變化速率。
    * **上拉/下拉電阻：** 設定預設邏輯位準。

**核心之外：** 現代FPGA通常包含額外的專用區塊：

* **區塊RAM（BRAM）：** 提供高速資料儲存的片上記憶體區塊。
* **數位信號處理（DSP）切片：** 針對常見DSP操作（如乘法和累加）優化的專用硬體區塊。
* **高速串列收發器：** 用於高頻寬通訊介面，如PCIe、乙太網路和SerDes。
* **嵌入式處理器：** 一些FPGA整合硬核或軟核處理器（例如ARM核心）以創建系統單晶片（SoC）解決方案。
* **模數轉換器（ADC）和數模轉換器（DAC）：** 用於與模擬信號介面。
* **時鐘管理單元（CMT）：** 用於在整個FPGA中產生和分配時鐘信號。

**3. FPGA如何編程？**

FPGA通常使用硬體描述語言（HDL）進行編程，例如：

* **Verilog：** 一種廣泛使用的HDL，語法類似C語言。
* **VHDL（超高速積體電路硬體描述語言）：** 另一種流行的HDL，常在航空航天和國防應用中受到青睞。

典型的FPGA設計流程包括以下步驟：

1.  **規格制定：** 定義數位電路或系統的所需功能。
2.  **設計輸入：** 編寫描述電路行為和結構的HDL程式碼。這也可能涉及使用圖形化設計工具。
3.  **綜合：** 將HDL程式碼轉換為網表，即用基本邏輯閘及其連接來描述電路。
4.  **實現：** 此階段涉及幾個子步驟：
    * **佈局：** 將網表中的邏輯元素分配給FPGA上的特定物理位置。
    * **佈線：** 確定互連電線的路徑以連接已佈局的邏輯元素。
    * **位元流生成：** 創建配置檔案（位元流），其中包含編程FPGA內部開關和邏輯所需的資訊。
5.  **驗證：** 通過模擬和在FPGA上進行硬體測試來驗證設計，確保其符合規格。
6.  **配置：** 將生成的位元流載入到FPGA上。這會配置內部邏輯和互連，從而有效地「編程」設備以執行所需功能。

FPGA供應商（如Xilinx和Intel）提供自動化這些步驟的完整軟體工具鏈。這些工具包括：

* **文字編輯器：** 用於編寫HDL程式碼。
* **模擬器：** 用於在實現前驗證設計行為。
* **綜合工具：** 用於將HDL轉換為網表。
* **實現工具：** 用於佈局、佈線和位元流生成。
* **除錯工具：** 用於在FPGA硬體上分析和除錯設計。

**4. FPGA的主要特點和優勢：**

* **可重配置性：** 允許在部署後進行設計變更和更新。
* **並行性：** 對可並行化的任務實現高效能處理。
* **靈活性：** 可實現廣泛的數位電路和系統。
* **上市時間：** 與ASIC相比，使用FPGA進行開發通常更快，特別是對於較低產量。
* **成本效益（對於特定產量）：** 對於中等生產量，可能比ASIC更具成本效益，因為沒有與光罩製作相關的高額非重複性工程（NRE）成本。
* **自訂硬體加速：** 允許為特定演算法或任務創建自訂硬體加速器，從而顯著提高效能。
* **快速原型製作：** 在承諾進行ASIC實現之前，非常適合對複雜數位設計進行原型製作和測試。

**5. FPGA的應用：**

FPGA廣泛應用於各個行業的眾多領域，包括：

* **電信：** 無線通訊系統、網路基礎設施、高速資料處理。
* **資料中心：** 用於機器學習、資料分析和網路處理的硬體加速。
* **航空航天與國防：** 雷達系統、信號處理、嵌入式計算、電子戰。
* **汽車：** 先進駕駛輔助系統（ADAS）、資訊娛樂系統、車內網路。
* **工業自動化：** 馬達控制、機器人技術、機器視覺。
* **醫療影像：** 影像處理、診斷設備。
* **消費電子：** 數位相機、視訊處理、遊戲主機。
* **高效能運算（HPC）：** 用於科學模擬的自訂加速器。
* **金融交易：** 低延遲交易平台。

**6. FPGA開發流程詳解：**

讓我們更深入地探討典型的FPGA開發流程：

* **概念化與規格制定：** 理解專案需求。定義輸入、輸出、功能、效能目標和約束（例如功耗、成本）。
* **架構設計：** 確定系統的整體架構。將設計分解為較小的模組，並定義它們之間的介面。
* **HDL編碼（設計輸入）：** 為每個模組編寫Verilog或VHDL程式碼。專注於電路的行為和結構。考慮時序、資源利用率和可測試性等因素。
* **功能模擬：** 使用模擬工具驗證HDL程式碼的正確性。創建測試平台，為設計提供輸入並根據預期值檢查輸出。這有助於在設計過程早期識別和修復邏輯錯誤。
* **綜合：** 使用綜合工具將HDL程式碼轉換為網表。該工具根據目標FPGA架構和指定約束對設計進行優化。
* **實現（佈局與佈線）：** 實現工具獲取網表並將其映射到FPGA的物理資源上。佈局涉及將邏輯元素分配給特定位置，佈線涉及為互連電線尋找路徑。這是一個複雜的優化過程，旨在滿足時序約束並最小化資源使用。
* **時序分析：** 在佈局佈線後，執行靜態時序分析以確保設計滿足所需的時鐘頻率和時序餘量。這涉及分析通過邏輯和互連路徑的延遲。
* **硬體模擬（可選）：** 執行更詳細的模擬，考慮從實現階段提取的時序資訊。這能更準確地預測設計在實際硬體上的行為。
* **位元流生成：** 一旦實現成功且時序約束得到滿足，工具會生成位元流檔案。該檔案包含FPGA的配置資料。
* **硬體測試與除錯：** 將位元流載入FPGA，並在實際硬體環境中測試設計。使用除錯工具（如邏輯分析儀）觀察內部信號並識別任何問題。可能需要迭代回到早期階段（HDL編碼、綜合、實現）以修復錯誤。

**7. 選擇FPGA：**

為特定應用選擇合適的FPGA至關重要。考慮以下因素：

* **邏輯容量：** 實現設計所需的CLB數量或等效邏輯資源。
* **記憶體資源：** 資料儲存所需的片上區塊RAM數量。
* **DSP能力：** 信號處理任務所需的DSP切片數量。
* **I/O數量與速度：** 輸入/輸出引腳數量及其支援的信號標準和速度。
* **高速串列收發器：** 對高頻寬通訊介面的需求。
* **嵌入式處理器核心：** 是否需要整合處理器。
* **功耗：** 應用的功耗預算。
* **封裝與引腳排列：** 實體外形尺寸和特定I/O引腳的可用性。
* **成本：** FPGA元件的價格。
* **開發工具與生態系統：** 供應商軟體工具、IP核心和支援資源的可用性和易用性。
* **生命週期與供貨情況：** FPGA的預期壽命及其從供應商的可用性。

主要FPGA供應商包括：

* **Xilinx（現屬AMD）：** 以其Virtex、Kintex、Artix和Zynq系列聞名。
* **Intel（前身為Altera）：** 以其Stratix、Arria、Cyclone和MAX系列聞名。
* **Lattice Semiconductor：** 以其低功耗和小外形FPGA聞名。
* **Microchip（前身為Atmel）：** 提供專注於安全性和低功耗的FPGA。

**8. 進階FPGA主題（簡要概述）：**

* **系統單晶片（SoC）FPGA：** 在可編程邏輯旁邊整合一個或多個嵌入式處理器（例如ARM Cortex-A或Cortex-R系列）。這允許軟體可編程性和硬體加速的結合。
* **部分重配置：** 在設備其餘部分繼續運行的同時，重新配置FPGA一部分的能力。這對於動態硬體更新和在同一設備上實現多種功能非常有用。
* **高階綜合（HLS）：** 允許設計人員使用C/C++等高階語言編寫硬體描述，並自動生成相應HDL程式碼的工具。這可以顯著加快設計過程。
* **片上網路（NoC）：** 用於複雜FPGA中的片上通訊架構，以在不同處理元件之間高效路由資料。
* **3D FPGA：** 先進的封裝技術，可垂直堆疊多個FPGA晶粒以增加邏輯密度和效能。

**9. FPGA學習資源：**

* **供應商文件：** Xilinx和Intel在其網站上提供廣泛的文件、教程和應用筆記。
* **線上課程：** Coursera、edX和Udemy等平台提供有關FPGA設計和編程的課程。
* **大學課程：** 許多大學提供數位設計和基於FPGA的系統課程。
* **書籍：** 有大量關於Verilog、VHDL和FPGA設計方法的書籍。
* **線上社群和論壇：** Reddit（如r/FPGA）、Stack Overflow和供應商論壇等網站提供了提問和分享知識的平台。
* **開發板：** FPGA供應商和第三方的開發板提供了動手學習和實驗FPGA的方式。

**10. 結論：**

FPGA是強大且多功能的設備，提供了硬體靈活性和軟體可編程性的獨特組合。它們的可重配置特性使其成為從快速原型製作到高效能運算等廣泛應用的理想選擇。理解核心架構、編程方法和開發流程對於任何希望在其專案中利用FPGA能力的人來說至關重要。雖然初始學習曲線可能較陡峭，但在效能、靈活性和上市時間方面的潛在優勢使FPGA成為現代數位設計中不可或缺的工具。