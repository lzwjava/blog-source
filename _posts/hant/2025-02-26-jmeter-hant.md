---
audio: false
generated: false
lang: hant
layout: post
title: 掌握JMeter：性能測試
translated: true
---

Apache JMeter 是一個強大的開源工具，主要用於性能測試，但也可以用於功能測試。它廣泛用於測試網頁應用程序、API、數據庫和其他服務的性能，通過模擬多個用戶並測量系統在負載下的響應情況。以下是如何有效使用 JMeter 的分步指南，從安裝到運行基本測試並分析結果。

---

## 第一步：安裝 JMeter
在使用 JMeter 之前，您需要在您的機器上安裝它。以下是如何操作：

1. **先決條件**：
   JMeter 是一個基於 Java 的應用程序，因此您必須安裝 Java Development Kit (JDK) 或 Java Runtime Environment (JRE)。建議使用版本 8 或更高版本。您可以通過在終端或命令提示符中運行 `java -version` 來驗證這一點。如果沒有安裝 Java，請從 [官方 Java 網站](https://www.java.com) 下載並安裝。

2. **下載 JMeter**：
   訪問 [Apache JMeter 網站](https://jmeter.apache.org/download_jmeter.cgi) 並下載最新的二進制版本（通常是 `.zip` 或 `.tgz` 文件）。

3. **解壓縮文件**：
   將下載的文件解壓縮到您選擇的目錄（例如，Windows 上的 `C:\JMeter` 或 Unix 系統上的 `~/JMeter`）。解壓縮後的文件夾包含運行 JMeter 所需的所有文件。

4. **啟動 JMeter**：
   - 導航到解壓縮目錄中的 `bin` 文件夾（例如，`C:\JMeter\apache-jmeter-5.x\bin`）。
   - 運行相應的可執行文件：
     - 在 **Windows** 上：雙擊 `jmeter.bat` 或通過命令提示符運行。
     - 在 **Unix/Linux/macOS** 上：在終端中執行 `./jmeter.sh`。
   - 這將打開 JMeter 圖形用戶界面 (GUI)，您將在這裡創建和管理您的測試計劃。

---

## 第二步：創建測試計劃
**測試計劃** 在 JMeter 中定義了您要測試的內容及其方式。它是性能測試的藍圖。以下是如何設置基本測試計劃：

### 添加線程組
1. 在 JMeter GUI 中，右鍵點擊左側面板中的 **測試計劃** 节點，然後選擇 **添加 > 線程 (用戶) > 線程組**。
2. 配置線程組：
   - **線程數 (用戶)**：要模擬的虛擬用戶數（例如，10）。
   - **上升期 (秒)**：JMeter 開始所有線程所需的時間（例如，10 秒表示每秒開始 1 個線程，共 10 個線程）。
   - **循環次數**：每個線程重複測試的次數（例如，1 表示單次運行，或選擇 "永遠" 以進行連續循環）。

線程組模擬用戶流量。例如，10 個線程、10 秒上升期和 1 次循環表示 10 個用戶將在 10 秒內訪問應用程序，每個用戶執行一次測試。

### 添加取樣器
取樣器定義 JMeter 發送到目標系統的請求。對於網頁測試，最常見的是 HTTP 取樣器：
1. 右鍵點擊線程組，然後選擇 **添加 > 取樣器 > HTTP 取樣器**。
2. 配置 HTTP 取樣器：
   - **協議**：`http` 或 `https`。
   - **伺服器名稱或 IP**：目標系統的域名或 IP（例如，`example.com`）。
   - **端口號**：通常是 HTTP 的 `80` 或 HTTPS 的 `443`（如果是標準端口則留空）。
   - **方法**：`GET`、`POST` 等，取決於請求類型。
   - **路徑**：具體的端點或頁面（例如，`/` 表示首頁）。
   - 如果需要，添加參數或請求主體（例如，對於 POST 請求）。

這個取樣器告訴 JMeter 每個虛擬用戶應該執行的操作。

### 添加監聽器
監聽器收集並顯示測試結果：
1. 右鍵點擊線程組，然後選擇 **添加 > 監聽器 > 查看結果樹**（或其他監聽器，如 **摘要報告**）。
2. **查看結果樹** 顯示每個請求的詳細結果，包括響應時間、狀態碼和響應數據。

監聽器對於分析應用程序在測試期間的性能至關重要。

### 保存測試計劃
點擊 **文件 > 另存為測試計劃**，然後保存您的 `.jmx` 文件（例如，`mytest.jmx`）。這樣可以在以後重用或修改它。

---

## 第三步：運行測試
要執行您的測試：
1. 在 JMeter GUI 中，點擊工具欄上的綠色 **播放** 按鈕（▶），或選擇 **運行 > 開始**。
2. JMeter 將模擬線程組中定義的用戶，發送配置的 HTTP 請求。
3. 觀察結果在監聽器（例如，查看結果樹）中填充，隨著測試的進行。

對於小型測試，通過 GUI 運行是可以的。對於大型測試，請參見下面的 “高級使用” 部分，了解非 GUI 模式。

---

## 第四步：分析結果
測試完成後，使用監聽器查看結果：
- **查看結果樹**：顯示每個請求的成功/失敗、響應時間和響應數據。
- **摘要報告**：提供聚合指標，如平均響應時間、吞吐量（每秒請求數）和錯誤率。

這些指標幫助您評估應用程序的性能（例如，在負載下的響應速度或在特定用戶數下的失敗情況）。

---

## 示例：測試簡單網頁
讓我們測試 `example.com` 使用 10 個用戶：
1. 啟動 JMeter。
2. 添加線程組：
   - 線程：10
   - 上升期：10 秒
   - 循環次數：1
3. 添加 HTTP 取樣器：
   - 協議：`http`
   - 伺服器名稱：`example.com`
   - 方法：`GET`
   - 路徑：`/`
4. 添加查看結果樹監聽器。
5. 保存並運行測試。
6. 在查看結果樹中檢查結果，查看響應時間和狀態碼（例如，200 OK）。

這個簡單的測試測量了 `example.com` 在 10 個同時用戶下的性能。

---

## 高級使用
對於更複雜的情況，JMeter 提供了額外的功能：

### 參數化
使用 **CSV 數據集配置** 從 CSV 文件中將不同的數據（例如，用戶名、密碼）輸入到您的測試中：
1. 將 **配置元素 > CSV 數據集配置** 添加到線程組。
2. 指定文件路徑和變量名稱（例如，`${username}`），然後在 HTTP 請求中使用這些變量。

### 關聯
處理動態值（例如，會話 ID、令牌）：
1. 在請求後添加 **後處理器 > 正則表達式提取器** 或 **JSON 提取器**。
2. 將值（例如，令牌）提取到變量（例如，`${token}`）。
3. 在後續請求中使用 `${token}`（例如，在標頭或參數中）。

### 斷言
驗證響應：
1. 將 **斷言 > 响應斷言** 添加到取樣器。
2. 檢查特定文本、響應碼（例如，200）或使用 JSONPath 進行 API 測試。

### 非 GUI 模式
對於大型測試或自動化：
- 從命令行運行 JMeter：
  ```
  jmeter -n -t mytest.jmx -l results.jtl
  ```
  - `-n`：非 GUI 模式。
  - `-t`：測試計劃文件。
  - `-l`：結果日誌文件（例如，`.jtl`）。
- 生成 HTML 報告：
  ```
  jmeter -n -t mytest.jmx -l results.jtl -e -o report_folder
  ```
  - `-e`：生成報告。
  - `-o`：HTML 報告的輸出文件夾。

### 分佈測試
對於高負載：
1. 在不同的機器上設置多個 JMeter 實例。
2. 配置主機的 `jmeter.properties` 文件以包含從屬 IP。
3. 從主機運行測試以協調負載生成。

---

## 額外提示
- **支持的協議**：除了 HTTP，JMeter 還支持 FTP、JDBC、JMS 等，使其適用於各種系統。
- **伺服器監控**：將 JMeter 與伺服器端工具（例如，PerfMon）配對，以在測試期間監控 CPU、內存和數據庫性能。
- **真實模擬**：添加 **HTTP Cookie Manager**、**HTTP Cache Manager** 或 **計時器** 以模擬瀏覽器行為或用戶思考時間。
- **功能測試**：使用斷言來驗證響應的正確性，而不僅僅是性能。

---

## 結論
使用 JMeter：
1. 使用 Java 安裝並啟動 GUI。
2. 創建一個包含線程組、取樣器和監聽器的測試計劃。
3. 配置測試元素（用戶、請求等）。
4. 運行測試並分析結果。

對於簡單的開始，測試像 `example.com` 這樣的網頁，如上所示。隨著經驗的增加，探索高級功能，如參數化、關聯和分佈測試，以處理複雜的、現實世界的情況。JMeter 的靈活性和豐富的文檔使其成為初學者和高級測試人員的有價值工具。