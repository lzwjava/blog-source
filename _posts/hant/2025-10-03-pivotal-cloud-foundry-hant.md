---
audio: false
generated: true
image: false
lang: hant
layout: post
model: x-ai/grok-4-fast:free
title: 關鍵雲端鑄造平台概覽
translated: true
type: note
---

### Pivotal Cloud Foundry (PCF) 概述
Pivotal Cloud Foundry (PCF) 是開源 Cloud Foundry 平台的商業發行版，在 VMware 於 2019 年收購 Pivotal 後，現已成為 VMware Tanzu 的一部分。它是一種平台即服務 (PaaS)，旨在簡化雲原生應用的部署、擴展和管理。PCF 抽象化了底層基礎設施 (IaaS) 的複雜性，讓開發者能專注於程式碼，而無需處理伺服器、網路或編排問題。由於其對安全性、合規性和可移植性的重視，PCF 在銀行等受監管行業中特別受歡迎。

PCF 並非像 AWS、Azure 或 GCP 那樣的獨立雲端供應商——它是一個可以在這些 IaaS 供應商之上運行的層級，也可以在本地數據中心或私有雲中運行。這使其成為應用的「雲端操作系統」。

### PCF/Cloud Foundry 設計與架構
Cloud Foundry 的設計採用模組化結構，遵循「12-factor app」原則，旨在建立可擴展、可維護的軟體。以下是高層次解析：

#### 核心組件與流程
1. **Diego (運行時引擎)**：PCF 的核心。它取代了舊版的 Garden 容器系統，採用基於 Linux 容器（或後來的 Garden/Linux 用於隔離）的現代編排層。Diego 在「單元」（虛擬機器或實體伺服器）之間管理應用實例。它負責 staging（將原始碼構建為可運行的 droplets）、路由流量，並通過自動擴展組進行擴展。

2. **路由與負載均衡**：Gorouter（高效能反向代理）根據路由（例如 `app.example.com`）將傳入請求導向正確的應用實例。它支援黏性工作階段和健康檢查。

3. **服務市場**：PCF 提供「服務代理」模型，其中託管服務（如 MySQL/PostgreSQL 等資料庫、RabbitMQ 等消息隊列，或第三方整合）被編錄。應用「綁定」到這些服務以自動獲取憑證和連接詳情，無需硬編碼。

4. **安全性與身份管理**：
   - UAA（用戶帳戶與身份驗證）：處理基於 OAuth2 的身份驗證、單一登入 (SSO) 和基於角色的存取控制 (RBAC)。
   - 它與 LDAP、SAML 或企業身份供應商整合，這對銀行至關重要。

5. **Buildpacks 與運行環境**：PCF 使用「buildpacks」（預配置腳本）來檢測和打包 Java、Node.js、Python、Go 或 .NET 等語言的應用。它支援單一平台中的多語言環境。

6. **BOSH（部署編排工具）**：用於安裝和管理 PCF 的底層工具。它使用 YAML 清單來以冪等方式部署和更新組件（確保狀態一致性）。BOSH 處理 VM 配置、升級和監控。

7. **監控與日誌記錄**：整合工具如 Loggregator（用於結構化日誌）和 Firehose（用於流式指標）可接入 ELK Stack 或 Splunk 等工具。Ops Metrics 提供內建的可觀測性。

#### 關鍵設計原則
- **自助服務與開發者中心**：開發者通過 `cf push` CLI 推送應用，平台處理其餘事務（擴展、健康檢查、零停機部署）。
- **多租戶**：多個團隊或組織可以通過「空間」和配額安全地共享平台。
- **水平擴展**：應用通過在單元間複製實例進行擴展，具備內建容錯能力（例如，如果單元故障，Diego 會重新調度任務）。
- **API 驅動**：所有功能都通過 RESTful API（Cloud Controller）暴露，支持與 Concourse CI/CD 等工具的自動化。
- **可擴展性**：支援 Kubernetes 整合（通過 PKS，現為 Tanzu Kubernetes Grid）進行容器編排，以及 Istio 等服務網格。

該架構是水平可擴展的，可在 vSphere、AWS、Azure、GCP 或 OpenStack 等 IaaS 上運行。典型的生產部署可能涉及 10-20 個 VM，並通過網路策略和加密（全程 TLS）進行隔離。

設計中的挑戰包括其 Java 重型傳統（可能資源密集）和運維團隊的學習曲線，但自 2011 年以來已歷經實戰考驗。

### 為何有些銀行選擇 PCF？
銀行（例如 HSBC、Barclays、Capital One 或 BBVA）通常選擇 PCF，因為它符合金融服務的需求。原因如下：

1. **法規合規與安全性**：
   - PCF 支援 PCI-DSS、FIPS 140-2、GDPR 和 SOC 2 等標準。它提供加密的 etcd 儲存、審計日誌記錄和細粒度存取控制等功能。
   - 銀行處理敏感數據；PCF 的隔離（例如，多租戶設置中無共享內核）和漏洞掃描降低了與原始 IaaS 相比的風險。

2. **混合與多雲策略**：
   - 許多銀行擁有傳統的本地系統（例如大型主機），並希望在無需完全遷移到雲端的情況下進行現代化。PCF 支援「直接遷移」或逐步重構到雲端，在私有/公有雲之間一致運行。
   - 它支援氣隙（斷開連接）部署，適用於高安全性環境。

3. **開發者生產力與標準化**：
   - PCF 為開發者提供「黃金路徑」：一個 CLI、一個工作流程，無論後端基礎設施如何。這加速了微服務採用、CI/CD 流水線和藍綠部署——對低延遲交易或欺詐檢測應用至關重要。
   - 擁有全球團隊的銀行受益於其可移植性；例如，在美國開發的應用可以部署到歐盟數據中心而無需重新修改。

4. **供應商生態系統與支援**：
   - Pivotal/VMware 提供企業支援，包括 24/7 SLA 和認證。銀行喜歡其託管服務（例如 PCF for PCF，現為 Tanzu Application Service）。
   - 其開源根源意味著沒有完全的供應商鎖定，但具有商業支援以確保穩定性。

案例研究：Capital One 在 2015 年率先採用 PCF 實施其「雲端優先」策略， citing 更快的上市時間（例如，在幾分鐘內部署應用，而非數週）。BBVA 使用它來容器化核心銀行應用，將成本降低了 50%。

並非所有銀行都使用 PCF——它在具有複雜、受監管工作負載的企業中更為常見，而非金融科技初創公司。

### 為何不直接選擇 Azure、AWS 或 GCP？
銀行確實廣泛使用 Azure/AWS/GCP，但 PCF 通常被疊加在上層而非被取代。原生公有雲 PaaS（例如 AWS Elastic Beanstalk、Azure App Service、Google App Engine）非常適合簡單應用，但以下是 PCF 可能被偏好或並用的原因：

1. **避免供應商鎖定**：
   - 原生服務將您綁定到單一供應商（例如，AWS Lambda 僅限於 AWS）。PCF 可在所有三者上運行（通過每個雲端的 tiles/stems），允許銀行切換供應商或對沖風險（例如，因數據主權而使用 AWS 於美國，Azure 於歐洲）。
   - 如果銀行因某雲端的定價或功能而需要更換，PCF 應用可以以最小變更進行遷移——與專有格式不同。

2. **跨環境一致性**：
   - 公有雲的服務零散（例如，AWS ECS 與 Azure AKS 用於容器）。PCF 標準化了 PaaS 層，提供統一的開發者體驗。這對擁有分佈式團隊或進行收購的銀行至關重要。
   - 混合設置：根據 Gartner，70% 的銀行運行混合雲；PCF 無縫橋接本地 VMware/vSphere 與公有雲。

3. **高級企業功能**：
   - 原生 PaaS 可能需要拼接多個服務（例如 AWS API Gateway + ECS + RDS），導致運維開銷。PCF 將這些捆綁在一起（例如，通過 Marketplace 代理到 RDS 等效服務）。
   - 更適合傳統遷移：銀行擁有 COBOL/Java 單體應用；PCF 的 buildpacks 支援它們而無需完全重寫。
   - 成本：雖然公有雲對於突發工作負載更便宜，但 PCF 通過配額執行等方式優化資源使用，且銀行可以談判企業協議。

4. **何時選擇原生服務**：
   - 純無伺服器？選擇原生（例如，GCP Cloud Run 用於事件驅動應用）。
   - 如果銀行完全投入某一個雲端（例如，通過 SageMaker 使用 AWS 進行 ML），他們可能會跳過 PCF 以利用深度整合。
   - PCF 的缺點：較高的前期成本（許可證約 10 萬美元以上）、設置更複雜，且與 Heroku（現為 Salesforce）等完全託管的 PaaS 相比，其「託管」程度較低。

實際上，許多銀行混合使用：核心應用使用 PCF on AWS，分析使用原生服務（例如 Azure Synapse）。

### 為何需要 PCF 作為「中間層」？
PCF 作為應用（頂層）和 IaaS（底層）之間的抽象層（PaaS）。考慮雲端堆疊：

- **IaaS（基礎）**：AWS EC2、Azure VM、GCP Compute Engine——提供原始計算/儲存/網路。
- **PaaS（中間層）**：PCF 位於此處，在 IaaS 上管理應用生命週期。它處理編排、服務發現和擴展，因此您無需直接管理 VM。
- **應用（頂層）**：您的微服務、API、UI。

**中間層的好處**：
- **簡化**：開發者無需學習雲端特定 API；一次推送程式碼，隨處運行。
- **可移植性**：從 AWS 遷移到 GCP 而無需更改應用——對擔心鎖定或需要地理冗餘的銀行至關重要。
- **運維效率**：跨雲端集中治理（例如，安全策略、成本控制）。
- **演進**：始於本地 PaaS；現與 Kubernetes 整合以處理現代工作負載。

總之，PCF 並非與 AWS/Azure/GCP 競爭——而是為企業可靠性增強它們。如果您為銀行進行評估，考慮進行概念驗證；VMware 通過 Tanzu 提供試用。

如需深入了解，請查閱 VMware 的文檔或 Cloud Foundry 的開源存儲庫。如果您有具體需求（例如使用案例），我可以進一步細化！