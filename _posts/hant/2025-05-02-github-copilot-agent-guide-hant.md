---
audio: false
generated: true
image: false
lang: hant
layout: post
model: deepseek/deepseek-v3.2-exp
title: GitHub Copilot 代理模式指南
translated: true
type: note
---

當然。這是一份關於 GitHub Copilot Agent 模式的綜合指南，涵蓋了它的定義、運作原理、使用方法和最佳實踐。

---

### **GitHub Copilot Agent 模式綜合指南**

#### **1. 什麼是 Agent 模式？一個簡單的比喻**

將 GitHub Copilot 視為有兩種截然不同的模式：

*   **標準 Copilot（副駕駛）：** 你的**結對程式設計師**。它坐在你旁邊，提供逐行或逐函式的建議。你仍然掌握著方向盤，主導整體方向、架構和邏輯。你可以根據自己的判斷接受、拒絕或編輯它的建議。
*   **Agent 模式（自動駕駛）：** 你的**見習程式設計師**。你給它一個高階任務（一個"提示"），它就會接手。它自主地計劃、編寫、編輯和測試程式碼以完成任務，通常會在不同檔案中進行多次更改，而無需你對每個步驟進行干預。

**本質上，Agent 模式是一項先進的、以目標為導向的功能，允許 Copilot 基於單一的自然語言指令來執行複雜的多步驟編碼任務。**

---

#### **2. Agent 模式如何運作？底層機制**

Agent 模式不僅僅是更聰明的自動完成；它是 Copilot 與你的程式碼庫互動方式的轉變。以下是該過程的細分：

**步驟 1：使用者發起任務**
你呼叫 Agent 模式，通常是透過在程式碼註解中使用特定的斜線命令。最常見的是用於修復 Copilot 識別出的問題的 `/fix`，但更強大的命令通常是像 `/explain` 或專用的按鍵綁定來開啟代理聊天。

**步驟 2：任務分析與規劃**
代理不會直接開始輸入。它首先分析你的提示和你的程式碼庫。
*   **它讀取你當前的檔案和相關檔案**以理解上下文。
*   **它制定一個計劃。** 在內部，它將你的高階請求（"新增使用者驗證"）分解為較小的、可管理的子任務（"1. 檢查現有的驗證庫。2. 建立一個 `login` 函式。3. 建立一個 `verifyToken` 中介軟體。4. 更新主路由。"）。

**步驟 3：迭代執行與"思考"**
這是 Agent 模式的核心。代理進入一個循環：
*   **程式碼生成：** 它編寫程式碼以完成第一個子任務。
*   **程式碼執行（模擬）：** 它不會在你的環境中*實際*執行程式碼，而是使用其龐大的訓練資料和內部模型來*模擬*程式碼會做什麼，檢查語法錯誤、明顯的邏輯錯誤和型別不匹配。
*   **自我審查與修正：** 它審查自己生成的程式碼。如果它"認為"某處有誤，它會重寫該部分。你通常可以在使用者介面中看到此過程，顯示為"思考中..."或"規劃中..."的指示器。
*   **重複：** 它繼續處理下一個子任務，並利用剛剛編寫的程式碼的上下文。

**步驟 4：呈現與核准**
一旦代理完成其計劃的一系列操作，它會向你呈現更改的摘要。
*   它顯示所有它修改過的檔案的差異（經典的綠色新增/紅色刪除）。
*   它提供一個自然語言的解釋，說明它做了什麼以及為什麼這樣做。
*   你可以選擇**接受**、**拒絕**，或有時**重新生成**解決方案。

**實現此功能的關鍵技術：**
*   **大型語言模型：** 一個更強大、專門化的 GPT 模型版本，能夠理解程式碼和規劃。
*   **工作區感知：** Agent 模式擁有更廣泛的"權限"來讀取和分析你專案中的多個檔案，而不僅僅是你當前正在編輯的檔案。
*   **推理與規劃架構：** 先進的技術，如思維鏈或思維樹，允許模型邏輯地分解問題。

---

#### **3. 使用方法：如何及何時使用 Agent 模式**

**如何啟動它：**
具體方法可能因你的 IDE（VS Code、JetBrains 等）和 Copilot 方案（Pro、Business）而異。常見方法包括：
*   在註解中使用**斜線命令**（例如，`/fix`、`/tests`）。
*   在專用的 **Copilot Chat** 面板中輸入自然語言請求，並指示其以代理身份操作。
*   特定的按鍵綁定來觸發代理任務輸入。

**Agent 模式的理想使用情境：**

1.  **複雜重構：**
    *   **提示：** "`/refactor the `calculatePrice` function to use the strategy pattern. Create separate classes for `RegularPricing`, `MemberPricing`, and `SalePricing`."`
    *   *為何有效：* 這是一個多步驟任務，涉及建立新檔案/類別、修改現有函式簽章以及更新函式呼叫。

2.  **實現定義明確的功能：**
    *   **提示：** "`Add a new API endpoint `POST /api/v1/books` that accepts a JSON body with `title`, `author`, and `isbn`, validates the input, and saves it to the `books` table in the database.`"
    *   *為何有效：* 該功能具有清晰的結構（REST API、驗證、資料庫互動），代理可以將其分解。

3.  **編寫全面的測試：**
    *   **提示：** "`/tests Generate unit tests for the `UserService` class, covering all public methods and edge cases like invalid email formats and duplicate users."`
    *   *為何有效：* 代理可以分析 `UserService` 類別，了解每個方法的作用，並系統地為成功和失敗路徑建立測試案例。

4.  **除錯與修復複雜問題：**
    *   **提示：** "`/fix I'm getting a 'NullPointerException' on line 47 of `PaymentProcessor.java` when the `user.getProfile()` method returns null.`"
    *   *為何有效：* 代理可以追蹤程式碼流程，找出根本原因（缺乏空值檢查），並提出穩健的修復方案，可能還會對程式碼的其他相關部分加入空值安全處理。

5.  **生成樣板程式碼：**
    *   **提示：** "`Scaffold a new React component called `ProductCard` that takes `product` props (with `name`, `imageUrl`, `price`) and displays them in a card with a button."`
    *   *為何有效：* 雖然標準 Copilot 也能做到，但代理可以確保與你專案現有的元件模式和結構保持一致。

**應避免（或謹慎使用）Agent 模式的情況：**

*   **模糊或範圍不明確的任務：** "讓應用程式更好。" 如果沒有清晰、可操作的目標，代理將會失敗。
*   **需要深入業務邏輯的任務：** "實施 EMEA 地區的季度稅務計算規則。" 除非此邏輯在你的程式碼中有文件記錄，否則代理很可能會發明錯誤的規則。
*   **架構決策：** "我們應該使用微服務還是單體架構？" 這是一個需要人類判斷的戰略決策。
*   **關鍵的、安全性敏感的程式碼：** 絕不要在不經過徹底的、由人主導的安全性審查的情況下，盲目接受與身份驗證、加密或支付相關的程式碼。

---

#### **4. 有效使用的最佳實踐**

1.  **編寫詳細、具體的提示：** 輸出的質量與輸入的質量直接相關。包含上下文、約束條件和期望的結果。
    *   **不佳：** "新增一個按鈕。"
    *   **良好：** "在 `UserProfile.jsx` 元件中，於右上角新增一個紅色的「刪除帳戶」按鈕。點擊時，它應呼叫 `userService` 中現有的 `deleteUserAccount` 函式，並傳入當前的 `userId`。"

2.  **仔細審查所有更改：** **你仍然對程式碼負責。** 將代理的輸出視為初稿。檢查：
    *   邏輯錯誤。
    *   安全性漏洞。
    *   效能效率低下。
    *   是否符合團隊的編碼標準。

3.  **用它完成"前 80%"的工作：** Agent 模式非常適合快速完成重複性或易理解任務的大部分工作。期望自己打磨最後的 20%。

4.  **對解決方案進行迭代：** 如果第一次結果不完美，不要只是拒絕它。使用聊天提供回饋："做得不錯，但現在請為你建立的 API 端點新增錯誤處理。"

5.  **保持程式碼庫整潔：** 當你的專案結構良好、程式碼整潔時，代理的工作效果會更好。混亂的程式碼庫可能會混淆它，導致結果不佳。

### **總結：標準 Copilot 與 Agent 模式**

| 功能 | 標準 Copilot（副駕駛） | Agent 模式（自動駕駛） |
| :--- | :--- | :--- |
| **角色** | 結對程式設計師 | 見習程式設計師 |
| **互動方式** | 逐行、內嵌建議 | 以目標為導向、聊天驅動的命令 |
| **範圍** | 單一檔案、當前上下文 | 多檔案、整個工作區 |
| **控制權** | 你對每個建議擁有細粒度控制 | 你委派任務並審查最終結果 |
| **最適合** | 日常編碼、快速片段、完成思路 | 複雜功能、重構、編寫測試套件、錯誤修復 |

Agent 模式代表了向更自主的軟體開發邁出的重要一步。通過理解其運作機制並戰略性地使用它，你可以將繁瑣複雜的編碼任務委派出去，從而讓自己能夠專注於更高層次的設計、問題解決和創新。