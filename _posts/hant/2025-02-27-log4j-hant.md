---
audio: false
generated: true
lang: hant
layout: post
title: 使用 Log4j 進行日誌記錄
translated: true
type: note
---

看來您是想了解如何在 Java 應用程式中使用 Log4j 進行日誌記錄。我猜您指的是「Log4j 日誌記錄」——讓我為您介紹如何設定並有效使用它的基礎知識。

Log4j 是一個流行的 Java 日誌記錄框架，允許您將不同級別（如 DEBUG、INFO、WARN、ERROR）的訊息輸出到多種目標（控制台、檔案等）。以下是入門的逐步說明：

### 1. 將 Log4j 加入專案
若使用 Maven，請在 `pom.xml` 中加入以下依賴項：
```xml
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-core</artifactId>
    <version>2.23.1</version> <!-- 請檢查最新版本 -->
</dependency>
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-api</artifactId>
    <version>2.23.1</version>
</dependency>
```
若使用 Gradle，請加入：
```gradle
implementation 'org.apache.logging.log4j:log4j-core:2.23.1'
implementation 'org.apache.logging.log4j:log4j-api:2.23.1'
```

### 2. 設定 Log4j
您需要一個設定檔案來告訴 Log4j 如何處理日誌。在 `src/main/resources` 目錄中建立名為 `log4j2.xml`（或 `log4j2.properties`）的檔案。以下是一個簡單的 `log4j2.xml` 範例：
```xml
<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">
    <Appenders>
        <!-- 控制台輸出 -->
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n" />
        </Console>
        <!-- 檔案輸出 -->
        <File name="File" fileName="logs/app.log">
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n" />
        </File>
    </Appenders>
    <Loggers>
        <Root level="info">
            <AppenderRef ref="Console" />
            <AppenderRef ref="File" />
        </Root>
    </Loggers>
</Configuration>
```
此設定會將日誌同時輸出到控制台和檔案（`logs/app.log`），內容包含時間戳記、日誌級別、類別名稱、行號及訊息。

### 3. 在 Java 程式碼中使用 Log4j
在您的 Java 類別中，導入 Log4j 並建立記錄器實例。以下為範例：
```java
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

public class MyApp {
    private static final Logger logger = LogManager.getLogger(MyApp.class);

    public static void main(String[] args) {
        logger.debug("這是除錯訊息");
        logger.info("應用程式已成功啟動");
        logger.warn("這是警告訊息");
        logger.error("發生錯誤", new Exception("範例例外"));
    }
}
```

### 4. 執行應用程式
當您執行此程式碼時，將在控制台和 `logs/app.log` 檔案（若目錄存在）中看到輸出。日誌級別會根據設定中的 `level="info"` 過濾顯示內容——除非您將級別改為 `level="debug"`，否則 DEBUG 訊息不會顯示。

### 關鍵提示
- **日誌級別**：使用 `debug` 進行詳細疑難排解，`info` 用於一般更新，`warn` 用於潛在問題，`error` 用於失敗情況。
- **設定靈活性**：您可以自訂版面配置、加入滾動檔案附加器或將日誌傳送至遠端系統——詳情請查閱 Log4j 文件。
- **效能表現**：Log4j 2 比 Log4j 1.x 更快，建議使用最新版本。

若您正在處理特定設定（例如網頁應用程式或其他語言環境），請告訴我，我可以進一步調整說明！還有其他想深入探討的內容嗎？