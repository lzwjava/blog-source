---
audio: false
generated: true
lang: hant
layout: post
title: Avaloq API 錯誤疑難排解指南
translated: true
type: note
---

## Avaloq API 錯誤綜合指南

### 常見系統層級錯誤

**1. Avaloq 代理執行錯誤**
在 Avaloq 系統或 Oracle 上執行 Avaloq 代理程式碼時發生錯誤。如果 Avaloq 系統上執行的作業以錯誤結束，則可能發生這些錯誤。

**故障排除：**
- 檢查 Oracle 資料庫連線
- 驗證 Avaloq 代理配置
- 檢查系統日誌中的資料庫相關問題
- 確保執行使用者具有適當權限

**2. 作業取消錯誤**
日誌中的以下行表示由於 Avaloq 系統上的內部錯誤，作業已被取消。該作業的最終狀態對 Avaloq 代理有效：YYYY-MM-DD hh:mm:ss Job 642 Execute: Job did complete with failures.

**故障排除：**
- 檢查作業日誌以了解具體失敗原因
- 檢查系統資源可用性
- 驗證作業參數和依賴項
- 監控執行期間的系統性能

### 銀行環境中的標準 HTTP API 錯誤

**1. 400 Bad Request**
Avaloq 環境中的常見原因：
- 無效的帳號或客戶 ID
- 交易金額格式錯誤
- 交易訂單中缺少必填欄位
- 無效的日期格式或範圍

**故障排除：**
- 檢查 URL 以確保發送有效的資料參數並使用正確的標頭
- 根據 Avaloq 的架構要求驗證所有輸入參數
- 檢查貨幣代碼和格式
- 驗證帳戶狀態和權限

**2. 401 Unauthorized**
銀行特定原因：
- 無效的 API 憑證
- 過期的驗證令牌
- 使用者對特定操作的權限不足
- 客戶關係限制

**故障排除：**
- 驗證 API 金鑰和密鑰的有效性
- 檢查令牌過期時間
- 確認使用者具有適當的銀行權限
- 檢查客戶-顧問關係映射

**3. 403 Forbidden**
財富管理情境：
- 對特定客戶帳戶的存取被拒絕
- 操作上的監管限制
- 合規規則違規
- 基於司法管轄區的限制

**故障排除：**
- 檢查使用者存取權限和角色
- 檢查合規規則和限制
- 驗證監管權限
- 確認跨境交易許可

**4. 404 Not Found**
銀行特定情境：
- 不存在的帳號
- 無效的投資組合 ID
- 缺少交易參考
- 已刪除或歸檔的客戶記錄

**故障排除：**
- 仔細檢查端點並確保拼寫正確
- 驗證帳戶存在性和狀態
- 檢查已歸檔或非活動帳戶
- 確認正確的 URL 結構

**5. 500 Internal Server Error**
系統層級問題：
- 資料庫連線問題
- 核心銀行系統故障
- 整合服務中斷
- 記憶體或性能問題

**故障排除：**
- 檢查系統健康儀表板
- 檢查資料庫連線池
- 監控系統資源利用率
- 驗證依賴服務可用性

### Avaloq 特定錯誤類別

**1. 業務單位錯誤**
可以執行引用 Avaloq 系統上不存在的業務單位的 RA Avaloq 作業

**常見問題：**
- 無效的業務單位引用
- 非活動或已刪除的業務單位
- 不正確的組織層級映射

**2. 整合錯誤**
基於 Avaloq 的整合能力：
- API 版本不匹配
- 架構驗證失敗
- 訊息格式不相容
- 與外部系統的逾時問題

**3. 合規與監管錯誤**
- 交易前檢查失敗
- AML/KYC 驗證錯誤
- 監管報告問題
- 跨境交易限制

### 錯誤處理最佳實踐

**1. 日誌記錄與監控**
- 為所有 API 呼叫實施全面的日誌記錄
- 為關鍵錯誤模式設置警報
- 監控 API 回應時間和成功率
- 追蹤業務特定錯誤模式

**2. 錯誤回應結構**
典型的 Avaloq 錯誤回應應包括：
- 錯誤代碼和類別
- 人類可讀的錯誤訊息
- 時間戳和請求 ID
- 建議的修復步驟

**3. 重試邏輯**
- 對暫時性錯誤實施指數退避
- 避免在驗證失敗時重試
- 設置最大重試限制
- 對系統故障使用斷路器模式

**4. 測試與驗證**
Avaloq 已奠定良好基礎，透過利用由 AWS 提供支援的 Avaloq 沙盒解決方案來管理各個階段的複雜性，幫助企業簡化測試和整合新解決方案的過程。

**推薦測試方法：**
- 使用 Avaloq 的沙盒環境進行測試
- 系統性地測試錯誤情境
- 驗證不同使用者角色的錯誤處理
- 測試與外部系統的整合點

### 錯誤預防策略

**1. 輸入驗證**
- 在 API 呼叫前驗證所有輸入參數
- 使用適當的資料類型和格式
- 在適當的地方實施客戶端驗證
- 在提交前檢查業務規則

**2. 連線管理**
- 實施適當的連線池
- 優雅處理逾時
- 對依賴服務使用健康檢查
- 監控 API 速率限制

**3. 安全考量**
- 實施適當的驗證處理
- 使用安全通訊通道
- 適當記錄安全相關錯誤
- 小心處理錯誤訊息中的敏感資料

如需特定錯誤代碼和詳細的故障排除程序，請查閱您的 Avaloq 系統文件或直接聯繫 Avaloq 支援，因為許多錯誤細節特定於您的實施和配置。