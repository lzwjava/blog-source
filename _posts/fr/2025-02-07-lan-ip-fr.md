---
audio: true
lang: fr
layout: post
title: Analyseur d'IP LAN
translated: true
---

## Scanner d'IP LAN

Ce script Python scanne un réseau local pour les adresses IP actives. Il utilise la commande `ping` pour vérifier si un hôte est joignable et utilise le multithreading pour accélérer le processus de scan. Un sémaphore limite le nombre de threads concurrents pour éviter de surcharger le système. Le script prend une adresse réseau (par exemple, "192.168.1.0/24") en entrée et affiche si chaque adresse IP du réseau est active ou inactive.

Ce script permet d'identifier les appareils sur le réseau, tels qu'un routeur maillé TP-LINK fonctionnant en mode pont filaire, en scannant les adresses IP actives.


```python
import subprocess
import ipaddress
import threading
import os

MAX_THREADS = 50  # Nombre maximal de threads à utiliser

def is_host_up(host):
    """
    Vérifie si un hôte est actif en utilisant ping.
    Retourne True si l'hôte est actif, False sinon.
    """
    try:
        # -c 1: Envoyer seulement 1 paquet
        # -W 1: Attendre 1 seconde une réponse
        subprocess.check_output(["ping", "-c", "1", "-W", "1", host], timeout=1)
        return True
    except subprocess.CalledProcessError:
        return False
    except subprocess.TimeoutExpired:
        return False

def scan_ip(ip_str):
    """
    Scanne une seule adresse IP et affiche son statut.
    """
    if is_host_up(ip_str):
        print(f"{ip_str} est active")
    else:
        print(f"{ip_str} est inactive")

def scan_network(network):
    """
    Scanne un réseau pour les hôtes actifs en utilisant des threads, limitant le nombre de threads concurrents.
    """
    print(f"Scan du réseau : {network}")
    threads = []
    semaphore = threading.Semaphore(MAX_THREADS)  # Limite le nombre de threads concurrents

    def scan_ip_with_semaphore(ip_str):
        semaphore.acquire()
        try:
            scan_ip(ip_str)
        finally:
            semaphore.release()

    for ip in ipaddress.IPv4Network(network):
        ip_str = str(ip)
        thread = threading.Thread(target=scan_ip_with_semaphore, args=(ip_str,))
        threads.append(thread)
        thread.start()

    for thread in threads:
        thread.join()

if __name__ == "__main__":
    network_to_scan = "192.168.1.0/24"  # Changer ceci pour votre réseau
    scan_network(network_to_scan)

```

## Contournement des IP locales

Le script identifie les adresses IP actives. Pour assurer une communication réseau appropriée, vérifiez que les paramètres proxy sont configurés pour contourner ces IP locales.

```bash
192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,127.0.0.1,localhost,*.local,timestamp.apple.com,sequoia.apple.com,seed-sequoia.siri.apple.com, 192.168.1.0/16
```
