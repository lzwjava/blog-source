---
audio: false
generated: true
lang: fr
layout: post
title: Bibliothèque JavaScript pour la lecture HLS
translated: true
type: note
---

Il semble que vous demandiez comment utiliser la bibliothèque `hls.js`, spécifiquement la version `^0.7.6`, qui est une bibliothèque JavaScript pour lire les flux vidéo HLS (HTTP Live Streaming) dans les navigateurs. Je vais fournir un guide concis sur la façon de la configurer et de l'utiliser, basé sur une connaissance générale de la bibliothèque. Notez que la version `0.7.6` est assez ancienne (publiée vers 2017), donc certaines fonctionnalités ou API peuvent différer des versions plus récentes. Si vous avez besoin de détails spécifiques à cette version exacte, faites-le-moi savoir et je peux affiner la réponse !

### Étapes pour utiliser `hls.js` (v0.7.6)

#### 1. **Installer ou inclure la bibliothèque**
Vous pouvez inclure `hls.js` dans votre projet de l'une de ces manières :

- **Via npm** (si vous utilisez un outil de build comme Webpack) :
  ```bash
  npm install hls.js@^0.7.6
  ```
  Puis importez-la dans votre JavaScript :
  ```javascript
  var Hls = require('hls.js');
  ```

- **Via CDN** (si vous l'ajoutez directement à un fichier HTML) :
  ```html
  <script src="https://cdn.jsdelivr.net/npm/hls.js@0.7.6"></script>
  ```
  Cela rend `Hls` disponible en tant que variable globale.

#### 2. **Configurer votre HTML**
Vous avez besoin d'un élément `<video>` dans votre HTML pour y attacher le flux HLS :
```html
<video id="video" controls></video>
```

#### 3. **Initialiser `hls.js`**
Voici un exemple basique de la façon d'utiliser `hls.js` pour charger et lire un flux HLS (par exemple, un fichier `.m3u8`) :

```javascript
// Vérifier si le navigateur prend nativement en charge HLS (par exemple, Safari)
// Sinon, utiliser hls.js
var video = document.getElementById('video');
var videoSrc = 'https://example.com/playlist.m3u8'; // Remplacer par votre URL HLS

if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource(videoSrc);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, function () {
        video.play();
    });
} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    // Pour les navigateurs avec support natif HLS (par exemple, Safari)
    video.src = videoSrc;
    video.addEventListener('loadedmetadata', function () {
        video.play();
    });
}
```

#### 4. **Concepts clés**
- **`Hls.isSupported()`** : Vérifie si le navigateur a besoin de `hls.js` (retourne `true` si les Media Source Extensions sont prises en charge).
- **`loadSource(url)`** : Charge le manifeste HLS (fichier `.m3u8`).
- **`attachMedia(video)`** : Attache l'élément vidéo à l'instance `hls.js`.
- **`Hls.Events.MANIFEST_PARSED`** : Événement déclenché lorsque le manifeste est chargé, indiquant que le flux est prêt à être lu.

#### 5. **Exemple avec gestion des erreurs**
Pour le rendre plus robuste :
```javascript
var video = document.getElementById('video');
var videoSrc = 'https://example.com/playlist.m3u8';

if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource(videoSrc);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, function () {
        video.play();
    });
    hls.on(Hls.Events.ERROR, function (event, data) {
        console.error('Erreur HLS :', data);
        if (data.fatal) {
            switch (data.type) {
                case Hls.ErrorTypes.NETWORK_ERROR:
                    console.log('Erreur réseau, nouvelle tentative...');
                    hls.startLoad();
                    break;
                case Hls.ErrorTypes.MEDIA_ERROR:
                    console.log('Erreur média, récupération...');
                    hls.recoverMediaError();
                    break;
                default:
                    hls.destroy();
                    break;
            }
        }
    });
} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = videoSrc;
}
```

#### Notes pour la version `^0.7.6`
- Cette version date de 2017, elle manque donc de fonctionnalités plus récentes comme les améliorations de la commutation de débit adaptatif ou le support HLS à faible latence ajoutés dans les versions ultérieures.
- L'API de base (`loadSource`, `attachMedia`, les événements comme `MANIFEST_PARSED`) devrait fonctionner comme indiqué ci-dessus.
- Consultez les [versions officielles de `hls.js` sur GitHub](https://github.com/video-dev/hls.js/releases/tag/v0.7.6) pour le journal des modifications exact si vous avez besoin de détails précis.

#### 6. **Test**
- Utilisez un flux HLS publiquement disponible pour tester, comme :
  ```
  https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8
  ```
- Ouvrez les outils de développement de votre navigateur (F12) pour déboguer tout problème.

Si vous avez un cas d'utilisation spécifique ou un problème (par exemple, l'intégration avec un framework, la gestion des sous-titres, etc.), faites-le-moi savoir et j'adapterai la réponse en conséquence !