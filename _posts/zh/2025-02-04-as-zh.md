---
audio: false
lang: zh
layout: post
title: macOS汇编：你好，世界
translated: true
---

这段代码创建了一个“Hello, World!”程序。它使用系统调用将消息写入控制台，然后退出。`.text`段保存可执行指令，从`_start`开始。它首先设置`sys_write`调用（打印到标准输出），然后设置`sys_exit`调用（干净退出）。`.data`段存储消息本身并计算其长度。

```bash
.global _start
.text

_start:
    // 将“Hello, World!”写入标准输出
    mov x8, #64             // write系统调用号 (sys_write)
    mov x0, #1              // 文件描述符 1 (stdout)
    ldr x1, =msg            // 消息的地址
    mov x2, #14             // 消息的长度
    svc #0                  // 调用系统调用

    // 退出程序
    mov x8, #93             // exit系统调用号 (sys_exit)
    mov x0, #0              // 退出码 0
    svc #0                  // 调用系统调用

.data
msg:
    .asciz "Hello, World!\n"
```

```bash
as -o hello.o hello.s

% clang -o hello hello.o -nostdlib -e _start -Wl,-platform_version,macos,15.0,15.0 -arch arm64

% ./hello
zsh: invalid system call  ./hello
```
