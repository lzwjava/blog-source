---
audio: false
generated: true
lang: zh
layout: post
title: 网络层
translated: true
type: note
---

好的，让我们深入探讨网络层的详细教程，这是专门为中国自学考试（自考）体系中计算机网络技术课程编写的。本章对于理解数据如何在网络中传输至关重要。

## 网络层教程

网络层是 OSI 模型和 TCP/IP 模型中的第三层。它的主要职责是促进数据包跨一个或多个网络从源主机传输到目的主机。可以将其视为互联网的邮政服务——它负责找出最佳路线并确保您的"包裹"（数据包）到达正确的地址。

以下是本章关键知识点的分解：

### 1. 网络层的功能

网络层执行三个主要功能：

#### a) 逻辑寻址

*   **目的：** 唯一标识网络上的每个主机。这与物理地址（MAC 地址）不同，后者用于在本地网络内标识设备。逻辑地址是分层的，允许高效路由。
*   **关键概念：** IP 地址（互联网协议地址）是网络层中使用的主要逻辑寻址形式。
*   **类比：** 想象一下您的家庭住址。它是一个逻辑地址，帮助邮政服务在一个城市和国家内找到您特定的房子，而不管邮局的物理位置在哪里。

#### b) 路由

*   **目的：** 确定数据包从源到目的地的最佳传输路径。这涉及到选择数据包将经过的一系列网络设备（路由器）。
*   **关键概念：** 路由器使用路由算法来构建和维护路由表，其中包含通往不同网络的最佳路径信息。
*   **类比：** 想象计划一次公路旅行。您查看地图或使用 GPS 来确定到达目的地的最佳路线，考虑距离和交通等因素。路由器为数据包做类似的事情。

#### c) 转发

*   **目的：** 根据路由决策，将数据包从路由器的输入端口实际移动到适当输出端口的过程。
*   **关键概念：** 当路由器收到一个数据包时，它会检查目的 IP 地址并查询其路由表，以确定下一跳（另一个路由器或目的主机）。
*   **类比：** 一旦您规划好了路线，转发就像实际驾驶汽车沿着该路线行驶，从一个点移动到下一个点。

### 2. IP 寻址

IP 地址是网络层的基础。主要有两个版本：IPv4 和 IPv6。

#### a) IPv4 结构

*   **格式：** 一个 32 位的数字地址，以点分十进制表示法书写（例如，192.168.1.10）。它分为四个 8 位的八位组。
*   **地址类别（历史沿革）：** 尽管由于无类别域间路由（CIDR）的出现，这些类别现在基本上已过时，但了解历史类别（A、B、C、D、E）有助于奠定基础知识。
    *   **A 类：** 大型网络（第一个八位组 1-126）。
    *   **B 类：** 中型网络（第一个八位组 128-191）。
    *   **C 类：** 小型网络（第一个八位组 192-223）。
    *   **D 类：** 多播地址（第一个八位组 224-239）。
    *   **E 类：** 保留用于实验（第一个八位组 240-255）。
*   **网络 ID 和主机 ID：** 一个 IPv4 地址由一个网络 ID（标识网络）和一个主机 ID（标识该网络内的特定设备）组成。这些 ID 之间的划分取决于地址类别（或 CIDR 中的子网掩码）。
*   **特殊 IPv4 地址：**
    *   **0.0.0.0：** 代表当前网络。
    *   **127.0.0.1（环回地址）：** 用于测试本地机器的网络协议栈。
    *   **私有 IP 地址：** 保留供私有网络内部使用的地址范围（例如，10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16）。这些地址在公共互联网上不可路由。
    *   **公共 IP 地址：** 可在公共互联网上路由的地址。

#### b) IPv6 结构

*   **格式：** 一个 128 位的数字地址，以十六进制格式书写，分为八个 16 位的段，用冒号分隔（例如，2001:0db8:85a3:0000:0000:8a2e:0370:7334）。
*   **相对于 IPv4 的优势：** 更大的地址空间（解决 IPv4 地址耗尽问题）、改进的安全性（通常集成了 IPsec）、简化的报头格式、对移动设备更好的支持。
*   **地址表示：**
    *   **前导零：** 段内的前导零可以省略（例如，0000 可以写成 0）。
    *   **双冒号：** 单个双冒号（::）可用于表示一个或多个连续的全零段。这在每个地址中只能使用一次。
*   **IPv6 地址类型：**
    *   **单播：** 标识单个接口。
    *   **多播：** 标识一组接口。
    *   **任播：** 标识一组接口，数据包被发送到该组中最近的接口。
*   **链路本地地址（fe80::/10）：** 用于单个网络链路内的通信。
*   **全局单播地址：** 在互联网上全局可路由的地址。

#### c) 子网划分

*   **目的：** 将较大的网络划分为更小、更易于管理的子网络（子网）。这有助于组织网络、提高安全性和优化网络性能。
*   **机制：** 通过从 IP 地址的主机部分借用比特位并用它们创建子网 ID 来实现子网划分。这是使用**子网掩码**来完成的。
*   **子网掩码：** 一个 32 位的数字（对于 IPv4），用于标识 IP 地址的网络和子网部分。它由一串连续的 1（代表网络和子网位）后跟一串连续的 0（代表主机位）组成。
*   **CIDR 表示法（无类别域间路由）：** 一种更灵活的表示网络前缀的方法，使用斜杠后跟网络位数（例如，192.168.1.0/24 表示前 24 位代表网络）。这是当今使用的标准方法。
*   **子网划分计算（IPv4）：**
    1.  确定所需的子网数量。
    2.  确定每个子网所需的主机数量。
    3.  计算子网和主机所需的比特位数。
    4.  确定子网掩码。
    5.  识别每个子网的有效子网地址、广播地址和可用主机范围。
*   **IPv6 中的子网划分：** 虽然子网划分的概念在 IPv6 中存在，但其庞大的地址空间使得它主要不是为了节省地址，而是为了网络组织。IPv6 子网通常是固定大小（/64）。

### 3. 路由算法

路由算法被路由器用来确定数据包的最佳路径。它们可以大致分为：

#### a) 静态路由 vs. 动态路由

*   **静态路由：**
    *   路由表由网络管理员手动配置。
    *   对于小型、稳定的网络易于实现。
    *   无法适应网络变化或故障。
    *   适用于特定场景，如连接到单个远程网络。
*   **动态路由：**
    *   路由器通过与其他路由器交换信息，自动学习网络拓扑并更新其路由表。
    *   初始配置更复杂，但能高度适应网络变化和故障。
    *   适用于更大、更复杂的网络，可扩展性强。

#### b) 距离矢量路由

*   **原理：** 每个路由器维护一个路由表，其中列出了到每个目的网络的已知最佳距离（例如，跳数）和方向（下一跳路由器）。
*   **信息交换：** 路由器周期性地与其直接连接的邻居交换整个路由表。
*   **算法示例：** **Bellman-Ford 算法**是距离矢量路由协议中常用的算法。
*   **协议：** RIP（路由信息协议）是距离矢量路由协议的一个著名例子。
*   **局限性：** 可能收敛缓慢（网络适应变化需要时间）并存在"计数到无穷大"问题（可能发生路由环路）。

#### c) 链路状态路由

*   **原理：** 每个路由器维护一个完整的网络拓扑图。它知道所有的路由器以及它们之间的链路，以及每条链路的成本。
*   **信息交换：** 路由器将其直接连接的链路状态信息与网络中的所有其他路由器交换。此信息称为链路状态通告（LSA）。
*   **算法示例：** 每个路由器使用 **Dijkstra 算法**（最短路径优先 - SPF）根据收集到的链路状态信息计算到所有其他目的地的最短路径。
*   **协议：** OSPF（开放最短路径优先）和 IS-IS（中间系统到中间系统）是流行的链路状态路由协议。
*   **优势：** 收敛更快，与距离矢量路由相比更不易形成路由环路。

### 4. 协议

有几个关键协议在网络层运行：

#### a) IP（互联网协议）

*   **核心协议：** 负责跨网络寻址和路由数据包的基本协议。
*   **无连接和不可靠：** IP 提供无连接服务（无需预先建立连接）并且是不可靠的（不保证交付）。它执行错误检测，但错误恢复是更高层协议（如 TCP）的责任。
*   **数据包格式：** IP 定义了 IP 数据包（数据报）的结构，包括源和目的 IP 地址、报头信息（例如，生存时间 - TTL）和有效载荷（来自更高层的数据）。

#### b) ICMP（互联网控制消息协议）

*   **目的：** 用于在网络设备之间发送错误消息和控制/信息消息。
*   **功能：** ICMP 消息用于报告错误（例如，目的不可达、超时）、请求信息（例如，`ping` 命令使用的回显请求/回复）以及执行其他网络诊断。
*   **示例：** `ping` 实用程序使用 ICMP 回显请求和回复来测试网络连通性。`traceroute`（或在 Windows 上是 `tracert`）使用 ICMP 超时消息来跟踪数据包的路径。

#### c) ARP（地址解析协议）

*   **目的：** 用于在同一本地网段内将逻辑地址（IP 地址）解析为物理地址（MAC 地址）。
*   **过程：** 当一台主机需要向同一网络上的另一台主机发送数据包时，它知道目的 IP 地址，但需要在数据链路层为数据包组帧时使用目的 MAC 地址。发送主机广播一个包含目的 IP 地址的 ARP 请求。拥有该 IP 地址的主机用一个包含其 MAC 地址的 ARP 回复来响应。
*   **ARP 缓存：** 主机维护一个 ARP 缓存，用于存储最近解析的 IP 到 MAC 地址的映射，以避免每次通信都发送 ARP 请求。

### 5. 网络设备

网络层主要涉及两种关键类型的网络设备：

#### a) 路由器

*   **主要功能：** 根据目的 IP 地址在不同网络之间转发数据包。
*   **关键特性：**
    *   维护路由表以确定数据包的最佳路径。
    *   连接不同的网段（可以是不同的网络技术）。
    *   根据路由决策执行数据包转发。
    *   可以实现安全功能，如防火墙和访问控制列表（ACL）。

#### b) 网关

*   **广义术语：** 网关是充当进入另一个网络的入口点的设备。它可以是路由器、防火墙或其他类型的设备。
*   **默认网关：** 在 IP 网络环境中，默认网关是本地网络上的一个路由器，主机使用它来发送流量到其自身网络之外的目的地。
*   **协议转换：** 网关也可以在不同网络架构或协议之间执行协议转换，尽管这对于简单的 IP 路由来说不太常见。

## 自学考试关键要点

*   **理解核心功能：** 逻辑寻址（IP 地址）、路由（路径选择）和转发（数据包移动）。
*   **掌握 IP 寻址：** 能够解释 IPv4 和 IPv6 地址的结构，理解子网划分的概念和计算（特别是 IPv4），并了解不同类型的 IP 地址。
*   **区分路由算法：** 理解静态路由和动态路由之间的区别，并能够解释距离矢量和链路状态路由算法的基本原理。了解与每种算法相关的常见协议。
*   **了解关键的网络层协议：** 理解 IP、ICMP 和 ARP 的目的和基本操作。
*   **识别网络设备的作用：** 清楚地理解路由器和网关在网络层中的功能。

## 练习与复习

*   **完成示例：** 练习 IPv4 的子网划分计算。
*   **比较和对比：** 创建表格来比较不同的路由算法和 IP 地址版本。
*   **联系实际场景：** 思考这些概念如何应用于您自己的互联网使用和网络设置。
*   **复习历年考题：** 了解中国自学考试中此主题通常考查的题型。

通过透彻理解这些概念，您将为网络层打下坚实的基础，这对于计算机网络的进一步学习至关重要。祝您学习顺利！