---
audio: false
generated: true
image: false
lang: zh
layout: post
model: x-ai/grok-4-fast
title: 面向熟练程序员的编译器优化技术
translated: true
type: note
---

### 编译器优化

在 Kent Dybvig 的编译器课程中，他曾告诉我们，很多编译器课程都过度强调"优化"，但这类优化大多是为粗心的程序员准备的。比如公共子表达式消除（CSE）——提取重复的昂贵计算表达式。训练有素的程序员本应通过定义变量复用结果来避免冗余计算。然而编译器却大费周章地处理这类问题，仿佛这是什么了不起的功能。其实并非如此。

真正重要的是编译器自身的速度。许多编译器堆砌这类无意义的"优化"，试图将糟糕的代码转化为优质代码，结果反而拖慢了编译速度。项目构建耗时漫长，从代码修改到看到结果的周期被拉长，严重拖累开发效率。

这就是为什么 Chez Scheme 跳过了大多数基础优化——它假定程序员具备基本素养，能自行避免冗余的昂贵表达式。Chez 的优化主要聚焦于编译器自身生成的代码，例如闭包优化，尽可能压缩闭包的内存占用。这些是程序员无法直接控制的领域，编译器理应在此追求最佳效果。但即便这些优化也存在限度：如果追求优化会导致编译器速度急剧下降，而最终程序速度却提升有限，那便得不偿失。Chez Scheme 在编译速度与生成代码性能之间取得了精妙平衡。

在后续的工程实践中，我多次深切体会到这一洞见的重要性。