---
audio: false
generated: true
lang: zh
layout: post
title: 解决DBeaver无法加载数据库架构问题
translated: true
type: note
---

如果你能在 Windows 上使用 Squirrel SQL 查看 IBM DB2 数据库中的模式，但 DBeaver 却卡在"正在加载项目 0%"，问题很可能源于 DBeaver 与 Squirrel SQL 在元数据获取方式上的差异。以下是排查和解决此问题的分步指南：

---

#### 1. 验证 DBeaver 中的 DB2 驱动程序
DBeaver 需要正确的驱动程序才能连接到 IBM DB2 数据库。使用错误的驱动程序（例如 "Db2 for LUW" 与 "Db2 for z/OS"）可能导致模式加载问题。

- **操作步骤**：
  1. 打开 DBeaver，在数据库导航器中右键单击你的 DB2 连接。
  2. 选择 **编辑连接**。
  3. 在"驱动程序"部分，确认所选驱动程序与你的 DB2 环境匹配（例如，Linux/Unix/Windows 使用 "Db2 for LUW"，大型机使用 "Db2 for z/OS"）。
  4. 如果不确定，请咨询数据库管理员或查阅文档以确保选择了正确的驱动程序。
  5. 单击 **测试连接** 以验证其是否正常工作。

---

#### 2. 调整"元数据源"属性
DBeaver 使用名为"元数据源"的属性来控制其获取模式和表信息的方式。对于 DB2，调整此设置可以解决模式加载问题。

- **操作步骤**：
  1. 在 DBeaver 中打开你的 DB2 连接设置（右键单击连接 > **编辑连接**）。
  2. 转到 **驱动程序属性** 选项卡。
  3. 找到"metadata source"属性（如果未列出，则添加它）。
  4. 将其值设置为 `0`。
  5. 单击 **确定** 保存更改。
  6. 重新连接到数据库并检查模式是否加载。

- **为何有效**：将"metadata source"设置为 `0` 可以简化 DBeaver 获取元数据的方式，从而绕过 DB2 模式检索中的特定问题。

---

#### 3. 检查用户权限
尽管 Squirrel SQL 可以显示模式，但 DBeaver 可能以不同的方式查询数据库，需要特定权限才能访问元数据。

- **操作步骤**：
  1. 与数据库管理员确认，你的用户帐户有权查看 DB2 中的模式和元数据（例如，对系统目录表（如 `SYSCAT.SCHEMATA`）具有 `SELECT` 权限）。
  2. 如果权限不足，请请求 DBA 授予必要的权限。
  3. 在 DBeaver 中再次测试连接。

---

#### 4. 排除网络或防火墙问题
网络限制或防火墙可能阻止 DBeaver 完全检索模式数据，即使 Squirrel SQL 可以正常工作。

- **操作步骤**：
  1. 确保从你的 Windows 机器可以访问 DB2 服务器（例如，ping 服务器或测试端口）。
  2. 与网络团队确认没有防火墙规则阻止 DBeaver 的连接。
  3. 如果可能，从另一台机器测试 DBeaver 以隔离问题。

---

#### 5. 更新 DBeaver 到最新版本
旧版本的 DBeaver 可能存在影响 DB2 模式加载的错误。

- **操作步骤**：
  1. 在 DBeaver 中，转到 **帮助** > **检查更新**。
  2. 安装所有可用的更新。
  3. 重新启动 DBeaver 并重新连接到数据库。

- **替代方案**：如果无法通过内置更新获取，请从 [DBeaver 官网](https://dbeaver.io/) 下载最新版本并重新安装。

---

#### 6. 启用调试日志以进一步排查
如果上述步骤未能解决问题，启用调试日志以识别模式加载过程中的具体错误。

- **操作步骤**：
  1. 转到 **窗口** > **首选项** > **DBeaver** > **日志记录**。
  2. 启用详细日志记录并保存设置。
  3. 重新连接到数据库并尝试加载模式。
  4. 检查日志文件（通常在 DBeaver 工作区文件夹中）中与 DB2 模式检索相关的错误消息。
  5. 如果需要，将日志分享给 DBeaver 支持或论坛以获取进一步帮助。

---

### 问题原因
- **DBeaver 与 Squirrel SQL 的差异**：DBeaver 是一个功能更丰富的工具，与 Squirrel SQL 的简单方法相比，它检索了更多的元数据。如果设置未优化，这可能导致与 DB2 的兼容性问题。
- **常见修复方法**：将"metadata source"调整为 `0` 是解决 DBeaver 中 DB2 模式加载问题的已知变通方案。

---

### 后续步骤
首先尝试步骤 1 和 2（驱动程序验证和元数据源调整），因为它们是最有可能的修复方法。如果问题仍然存在，请继续执行其余步骤。如果所有步骤均无效，考虑将调试日志发布到 [DBeaver 社区](https://github.com/dbeaver/dbeaver/issues) 以获取更多帮助。

这应该能解决"正在加载项目 0%"的问题，让你能够像在 Squirrel SQL 中一样在 DBeaver 中查看模式！