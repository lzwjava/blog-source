---
audio: false
generated: true
lang: zh
layout: post
title: 构建与测试JK触发器
translated: true
type: note
---

在之前的视频中，我们探讨了JK触发器的运作原理，注意到它与SR触发器相似，但增加了反馈机制。这种反馈使得当两个输入在时钟上升沿同时为高电平时，输出会发生翻转，而非进入未定义状态。在本视频中，我将实际搭建电路并观察其功能。

我按照提供的电路图搭建了一个JK触发器。在搭建过程中，我发现图中存在标注错误：这里实际上是K输入，而这里是J输入。J对应置位功能，当其为高电平时，Q输出也应变为高电平。相反，K对应复位功能，当其为高电平时，Q输出应变为低电平。除了这个细微的标注修正外，电路其余部分都是准确的。

对于或非门，我使用的是74LS02芯片，具体是其顶部的两个或非门。另一个芯片74LS11是三重3输入与门。我使用了其中两个三输入与门来构建电路。

通电后，电路进入稳定状态，Q输出显示为"开启"状态。随后我连接了时钟电路。您看到的两个开关通过下拉电阻保持低电平；按下按钮会使输入变为高电平。这些开关通过绿色导线连接到两个与门，作为K和J输入。

时钟信号也输入到与门。它经过一个RC电路，该电路由0.0001微法电容和1000欧姆电阻组成。这个RC电路的输出通过两条白色导线传输到两个与门的另一个输入端。与门的输出由蓝色导线表示，它们连接到或非门的两个输入端。或非门的其他输入端通过黄色导线接收来自自身输出的反馈。这些黄色导线还环路返回到与门。最后，或非门的输出驱动两个LED：一个用于Q输出，另一个用于Q反相输出。

当K输入被驱动为高电平时，锁存器应复位，Q输出应关闭，实际表现符合预期。同样地，将J输入驱动为高电平应设置锁存器，使Q输出开启，这也得到了验证。重要的是要注意，变化并非在按下按钮时立即发生，而是在下一个时钟信号到来时变化，因为这个操作是由时钟上升沿门控的。

作为JK触发器，当J和K输入同时设置为高电平时，我们期望输出随每个时钟脉冲翻转。但实际表现并不稳定。有时会翻转，特别是在我轻微调整电路时，但非常不稳定。为了确保同时按下两个按钮，我将插入跳线跨接它们， effectively为J和K提供持续的高电平输入。这*应该*会导致它在每个时钟上升沿都翻转。虽然现在表现有所改善，但仍然不稳定。

这种不稳定行为有明确的解释，最好的理解方式是通过示波器观察信号。

首先，我们观察时钟输入作为参考。示波器显示时钟信号以每秒约两次的频率开关。示波器上每格代表100毫秒，因此在10格范围内，每秒脉冲两次。

接下来我想观察输出，因为这是我们期望随每个时钟脉冲翻转的信号。时钟确实以约每秒两次的频率脉冲。当前输出没有翻转，但经过轻微调整后确实会翻转，只是不稳定。当它*确实*翻转时，是在时钟上升沿进行的，符合预期。

当我们放大时钟上升沿时，有趣的现象出现了。我们看到那里有些活动。进一步放大后变得非常清晰：当时钟变为高电平时，输出*确实*翻转，但在最终稳定之前会来回翻转多次。这正是行为如此不稳定的原因。输出在时钟上升沿按预期翻转，但随后在短时间内又快速翻转。这些快速翻转的周期约为82纳秒。

这种被称为"竞态"的现象，在我们重新检查电路图时就说得通了。时钟脉冲即使我们只想使用其前沿，也会保持高电平相当长时间（本例中为250毫秒）。如果输出在脉冲回零*之前*切换，反馈环路会导致它再次切换，如此反复，形成多次翻转。因此当时钟脉冲变为高电平时，输出开启，但随后立即反复关闭和开启。最终能偶尔稳定在预期状态纯属巧合。

产生这种竞态条件的根本原因在于用于检测上升沿的RC电路。我提到过电容是0.0001微法，电阻是1000欧姆。将这些值相乘得到RC电路的时间常数，它决定了脉冲宽度。这个时间常数约为100纳秒。

让我们测量电路的脉冲输入。初始缩放观察时看起来很好——在时钟上升沿有一个快速脉冲，符合预期。问题在于这个脉冲不够*快*。这是一个1微秒的脉冲，在这1微秒期间，输出会反复切换，直到脉冲降为逻辑零时才最终稳定。

如何解决这个问题？一个选择是缩短脉冲。考虑到翻转周期约为80纳秒，我们需要一个明显短于1微秒的脉冲。可以尝试将1000欧姆电阻换成100欧姆电阻，这应该能将时间常数降低到100纳秒。

更换电阻后，我们观察到更小的脉冲。但仍然无法稳定工作。此时我们遇到了面包板的局限性。数十纳秒范围的高速信号在面包板上处理具有挑战性，因为存在杂散电容、电感和其他寄生效应。这解释了为什么我只是在电路附近挥手就会改变其行为，因为我的手作为接地物体会改变电容。

您可以看到输出现在变高，然后变低并保持低电平。但同样地，如果我调整手的位置，它可能开始翻转。我并没有改变任何连接，只是移动手部就影响了电容。

即使我们时钟的上升沿在这个时间尺度上也不够锐利，这同样是受面包板限制的影响。我们生成的脉冲不如使用大电阻时那么干净。归根结底，这些都表明我们正在逼近面包板可行性的边界。由于竞态条件，这种使用RC电路检测上升沿的方法在JK触发器中本质上是存在问题的。如果脉冲不够窄（理想情况下仅几纳秒），输出就会反馈并在每个时钟上升沿多次翻转。

那么解决方案是什么？在下一个视频中，我将演示一种更优秀的JK触发器构建方法，能完全消除这个竞态问题：主从JK触发器。这是一个更稳健的设计，应该能在面包板上无故障工作。