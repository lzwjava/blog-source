---
audio: false
generated: true
lang: zh
layout: post
title: HTTPS工作原理
translated: true
type: note
---

让我来逐步解释HTTPS的工作原理，包括SSL、证书、加密流程以及TLS 1.2与TLS 1.3的区别。

---

### **什么是HTTPS？**
HTTPS代表**超文本传输安全协议**。它是HTTP协议的安全版本，用于在浏览器和网站之间传输数据。"安全"一词源于增加了加密和认证层，这由**SSL（安全套接层）** 或其现代替代品**TLS（传输层安全）** 提供。因此，HTTPS本质上就是运行在TLS（或历史上的SSL）之上的HTTP协议，用以保障数据安全。

---

### **HTTPS工作原理：TLS握手过程**
当你访问使用HTTPS的网站时（例如`https://example.com`），浏览器与网站服务器会在交换任何数据前建立安全连接。这个过程被称为**TLS握手**。简单步骤如下：

1. **客户端问候**：
   - 浏览器向服务器发送消息："您好！这是我支持的TLS版本（如TLS 1.3）、可用的加密算法（密码套件），以及一个随机字节串（客户端随机数）"

2. **服务端问候**：
   - 服务器回复："您好！我将使用您列表中的这个TLS版本和密码套件。这是我的随机字节串（服务端随机数）"

3. **证书传输**：
   - 服务器发送其**SSL证书**，其中包含**公钥**并由可信**证书颁发机构（CA）** 签名。该证书用于验证服务器身份

4. **客户端密钥交换**：
   - 浏览器验证证书是否有效且由可信CA签发。验证通过后，浏览器生成**预主密钥**，用服务器公钥加密后发送给服务器

5. **会话密钥生成**：
   - 浏览器和服务器使用客户端随机数、服务端随机数和预主密钥，独立生成相同的**会话密钥**。该密钥将用于整个会话期间的数据加解密

6. **握手完成**：
   - 双方发送用会话密钥加密的"完成"消息，确认安全连接已就绪

握手完成后，所有数据（如网页内容、表单或文件）都会使用会话密钥加密，即使被拦截也无法读取。

---

### **SSL证书及其工作原理**
**SSL证书**是用于验证网站身份并启用加密的数字文件。需要了解的是：

- **内容组成**：证书包含网站域名、公钥以及**证书颁发机构（CA）** 的数字签名
- **核心作用**：确保服务器真实性（例如确认连接的是真实网站而非仿冒站点），并提供加密所需的公钥
- **验证流程**：浏览器会检查：
  1. 证书是否有效（未过期或未被撤销）？
  2. 是否由可信CA签发？（浏览器内置可信CA列表，如DigiCert、Let's Encrypt）
- 验证通过后，浏览器信任该服务器并继续握手流程

CA就像为网站背书的可信第三方。没有这种机制，攻击者就能冒充任何网站窃取数据。

---

### **加密算法解析**
HTTPS的加密机制结合了**非对称加密**与**对称加密**：

1. **非对称加密**（握手阶段）：
   - 使用**公钥**（公开共享）和**私钥**（服务器保密）
   - 浏览器用服务器公钥加密预主密钥。只有持有私钥的服务器才能解密
   - 示例算法：RSA或椭圆曲线密码学（ECC）

2. **对称加密**（会话阶段）：
   - 生成会话密钥后，双方使用该密钥进行数据加解密
   - 比非对称加密更高效，适合大数据量传输
   - 示例算法：AES（高级加密标准）

握手阶段使用非对称加密安全传递会话密钥，后续则采用效率更高的对称加密。

---

### **TLS 1.2与TLS 1.3差异对比**
**TLS 1.2**和**TLS 1.3**是TLS协议的两个版本，TLS 1.3是更先进的新版本。主要区别如下：

| **特性**               | **TLS 1.2**                              | **TLS 1.3**                              |
|------------------------|------------------------------------------|------------------------------------------|
| **握手速度**           | 需多次客户端-服务端往返，增加延迟        | 减少往返次数，通常只需一次，连接更快。重连时可立即发送数据（"0-RTT"） |
| **密码套件**           | 支持较旧的低安全性加密算法（如SHA-1）    | 淘汰过时密码套件，仅使用现代安全算法（如AES-GCM） |
| **隐私保护**           | 部分握手数据（如证书）以明文传输         | 几乎整个握手过程加密，有效防止窃听        |
| **0-RTT恢复**          | 不支持                                   | 允许重连时即时发送数据，但若未安全配置可能存在重放攻击风险 |
| **安全性**             | 因保留旧特性易受某些攻击                 | 通过移除薄弱环节实现更强大的安全设计      |

简言之，TLS 1.3相比TLS 1.2具备**更快速**、**更安全**、**更私密**的优势，已成为现代HTTPS的标准协议。

---

### **整体运作机制**
HTTPS通过以下机制保障网络通信安全：
1. 通过**TLS握手**建立加密连接
2. 依赖可信CA签发的**SSL证书**验证服务器身份
3. 结合**非对称加密**（用于握手）和**对称加密**（用于数据传输）保护数据
4. 持续演进如**TLS 1.3**协议，在TLS 1.2基础上实现更优的速度、安全性和隐私保护

这就是HTTPS保护浏览安全的核心原理！如果您想深入了解任何细节，请随时告诉我。