---
audio: false
generated: false
lang: zh
layout: post
title: HTTPS 的工作原理
translated: true
---

让我用清晰、分步的方式解释一下 HTTPS 的工作原理，包括 SSL、证书、加密过程以及 TLS 1.2 和 TLS 1.3 之间的区别。

---

### **什么是 HTTPS？**
HTTPS 代表 **超文本传输协议安全**。它是 HTTP 的安全版本，用于在浏览器和网站之间传输数据。“安全”部分来自于添加了一层加密和认证，由 **SSL（安全套接字层）** 或其现代替代品 **TLS（传输层安全性）** 提供。因此，HTTPS 本质上是 HTTP 在 TLS（或历史上是 SSL）之上运行，以保护您的数据。

---

### **HTTPS 是如何工作的？TLS 握手**
当您使用 HTTPS 访问网站（例如 `https://example.com`）时，您的浏览器和网站的服务器在交换任何数据之前建立一个安全连接。这个过程称为 **TLS 握手**。以下是它的简单步骤：

1. **客户端问候**：
   - 您的浏览器向服务器发送一条消息，说：“你好！这是我支持的 TLS 版本（例如 TLS 1.3），我可以使用的加密算法（密码套件）以及一个随机字节串（客户端随机数）。”

2. **服务器问候**：
   - 服务器回复：“你好！我将使用你列表中的这个 TLS 版本和这个密码套件。这是我的随机字符串（服务器随机数）。”

3. **证书**：
   - 服务器发送其 **SSL 证书**，其中包括其 **公钥**，并由受信任的 **证书颁发机构（CA）** 签名。这个证书证明了服务器的身份。

4. **客户端密钥交换**：
   - 您的浏览器检查证书以确保它有效且由受信任的 CA 签名。如果通过，浏览器生成一个 **预主密钥**，用服务器的公钥加密，并将其发送给服务器。

5. **会话密钥**：
   - 浏览器和服务器都使用客户端随机数、服务器随机数和预主密钥独立生成相同的 **会话密钥**。这个密钥用于在会话期间加密和解密所有数据。

6. **完成**：
   - 双方发送一条用会话密钥加密的“完成”消息，以确认安全连接已准备就绪。

握手完成后，所有数据（如网页、表单或文件）都用会话密钥加密，使其对任何可能拦截它的人都不可读。

---

### **什么是 SSL 证书以及它们是如何工作的？**
**SSL 证书** 是一个数字文档，证明网站的身份并启用加密。以下是您需要了解的内容：

- **内容**：证书包括网站的域名、其公钥和来自 **证书颁发机构（CA）** 的数字签名。
- **目的**：它确保服务器是合法的（例如，您确实连接到 `example.com`，而不是一个假网站），并提供用于加密的公钥。
- **验证**：您的浏览器检查：
  1. 证书是否有效（未过期或未吊销）？
  2. 它是否由受信任的 CA 签名？（浏览器内置受信任的 CA 列表，如 DigiCert 或 Let’s Encrypt。）
- 如果检查通过，浏览器信任服务器并继续握手。

CA 就像一个受信任的第三方为网站背书。没有这个，攻击者可以冒充任何网站并窃取您的数据。

---

### **加密算法**
HTTPS 中的加密依赖于 **非对称** 和 **对称** 加密的组合：

1. **非对称加密**（在握手过程中）：
   - 使用一个 **公钥**（公开共享）和一个 **私钥**（由服务器保密）。
   - 浏览器用服务器的公钥加密预主密钥。只有服务器，用其私钥，才能解密它。
   - 示例算法：RSA 或椭圆曲线密码学（ECC）。

2. **对称加密**（用于会话）：
   - 一旦创建了会话密钥，双方都使用它来加密和解密数据。
   - 这比非对称加密快，适合大数据传输。
   - 示例算法：AES（高级加密标准）。

握手使用非对称加密来安全地共享会话密钥，然后对称加密接管以提高效率。

---

### **TLS 1.2 和 TLS 1.3 的区别**
**TLS 1.2** 和 **TLS 1.3** 是 TLS 协议的版本，TLS 1.3 是更新、改进的版本。以下是关键区别：

| **特性**              | **TLS 1.2**                              | **TLS 1.3**                              |
|---------------------------|------------------------------------------|------------------------------------------|
| **握手速度**       | 客户端和服务器之间有多个往返，增加延迟。 | 减少往返，通常只有一个，连接更快。可以在重新连接时立即发送数据（“0-RTT”）。 |
| **密码套件**         | 支持较旧、较不安全的加密算法（例如 SHA-1）。 | 移除过时的密码套件，只使用现代、安全的密码套件（例如 AES-GCM）。 |
| **隐私**               | 一些握手数据（如证书）以明文发送。 | 几乎整个握手过程都是加密的，隐藏更多细节以防止窃听者。 |
| **0-RTT 重新连接**      | 不可用。                           | 允许在重新连接时立即发送数据，但如果未正确保护，可能会面临重放攻击。 |
| **安全性**              | 由于较旧的功能，容易受到某些攻击。 | 设计上更强大，移除了弱选项。 |

总之，TLS 1.3 比 TLS 1.2 **更快**、**更安全** 和 **更隐私**，使其成为现代 HTTPS 的标准。

---

### **将所有内容整合在一起**
HTTPS 通过以下方式保护网络通信：
1. 使用 **TLS 握手** 设置加密连接。
2. 依赖于来自受信任 CA 的 **SSL 证书** 以验证服务器的身份。
3. 结合 **非对称加密**（用于握手）和 **对称加密**（用于数据传输）来保护您的数据。
4. 通过协议如 **TLS 1.3** 进行演变，TLS 1.3 在速度、安全性和隐私方面改进了 TLS 1.2。

这就是 HTTPS 保护您的浏览安全的核心！如果您想让我深入探讨任何部分，请告诉我。