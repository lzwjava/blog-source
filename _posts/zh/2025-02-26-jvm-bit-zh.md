---
audio: false
generated: true
lang: zh
layout: post
title: 判断JVM是32位还是64位
translated: true
type: note
---

要解决“无法在32位JVM上加载64位SWT库”的错误，需要确保Java虚拟机（JVM）架构与Eclipse安装架构匹配。该错误出现的原因是Eclipse试图使用64位SWT库，而JVM是32位的，导致不兼容。以下是检查Java架构并解决问题的步骤。

---

### 步骤1：检查Java是32位还是64位

可通过以下任一方法确定JVM架构：

#### **方法1：使用 `java -version`**
1. 打开命令提示符：
   - **Windows**：按 `Win + R`，输入 `cmd`，按回车。
   - **Linux/Mac**：打开终端。
2. 输入以下命令并按回车：
   ```
   java -version
   ```
3. 检查输出：
   - **64位JVM**：输出会包含“64-Bit”，例如：
     ```
     java version "1.8.0_311"
     Java(TM) SE Runtime Environment (build 1.8.0_311-b11)
     Java HotSpot(TM) 64-Bit Server VM (build 25.311-b11, mixed mode)
     ```
   - **32位JVM**：输出不会提及“64-Bit”，例如：
     ```
     java version "1.8.0_311"
     Java(TM) SE Runtime Environment (build 1.8.0_311-b11)
     Java HotSpot(TM) Client VM (build 25.311-b11, mixed mode)
     ```

#### **方法2：使用 `java -d64 -version`**
1. 在命令提示符中输入：
   ```
   java -d64 -version
   ```
2. 解读结果：
   - **64位JVM**：会显示版本信息（如上所示）。
   - **32位JVM**：会出现错误，例如：
     ```
     Unrecognized option: -d64
     Error: Could not create the Java Virtual Machine.
     Error: A fatal exception has occurred. Program will exit.
     ```

如果JVM是32位（如错误提示所示），请继续执行步骤2来解决不匹配问题。

---

### 步骤2：解决架构不匹配问题

有两种解决方案：

#### **选项1：安装64位JVM（推荐）**
- **原因**：64位JVM性能更优，支持更大的内存分配，尤其当系统是64位时。
- **步骤**：
  1. 从可信来源下载64位JDK或JRE，例如：
     - [Oracle JDK](https://www.oracle.com/java/technologies/javase-jdk11-downloads.html)
     - [OpenJDK](https://adoptopenjdk.net/)
  2. 安装并记下安装路径（例如 `C:\Program Files\Java\jdk1.8.0_XXX\bin\javaw.exe`）。
  3. 配置Eclipse使用64位JVM：
     - 打开Eclipse安装文件夹中的 `eclipse.ini` 文件（例如 `C:\eclipse\eclipse.ini`）。
     - 在 `-vmargs` 部分**之前**添加以下行：
       ```
       -vm
       C:/Program Files/Java/jdk1.8.0_XXX/bin/javaw.exe
       ```
     - 使用正斜杠（`/`）并确保路径与安装路径匹配。
  4. 保存文件并重启Eclipse。

#### **选项2：切换到32位Eclipse**
- **原因**：如果想保留32位JVM，可以使用32位Eclipse及兼容的SWT库。
- **步骤**：
  1. 从[Eclipse下载页面](https://www.eclipse.org/downloads/packages/)下载32位版本的Eclipse。
  2. 安装并使用现有的32位JVM启动。

---

### 关键注意事项
- **架构匹配**：JVM和Eclipse必须架构一致：
  - 64位Eclipse需要64位JVM。
  - 32位Eclipse需要32位JVM。
- **仔细检查路径**：如果编辑 `eclipse.ini`，请确保 `javaw.exe` 的路径正确。
- **系统兼容性**：如果操作系统是64位，升级到64位JVM是更好的长期解决方案。

按照以上步骤操作，即可解决错误并让Eclipse顺利运行！