---
audio: false
generated: true
image: false
lang: zh
layout: post
model: openai/gpt-5
title: 比特币哈希计算与挖矿
translated: true
type: note
---

### 比特币如何计算哈希值

比特币使用一种名为**SHA-256**（安全哈希算法256位）的加密哈希函数来计算哈希值。这是一种单向函数，接收输入数据（如区块头）后生成固定的256位（32字节）输出，该输出具有唯一性和不可预测性。

- **哈希计算对象**：主要是区块头，包含：
  - 版本号
  - 前一区块的哈希值
  - 默克尔根（对区块内所有交易的摘要）
  - 时间戳
  - 难度目标（比特值）
  - 随机数（矿工调整的数值）

- **计算流程**：
  1. 矿工组装区块头
  2. 应用双重SHA-256运算：`哈希值 = SHA256(SHA256(区块头))`
  3. 检验所得哈希值是否低于当前目标值（例如需满足足够数量的前导零，如000000...）
  4. 若未达标则递增随机数重复操作——这就是工作量证明（PoW）的"试错"环节

哈希计算具有确定性——相同输入始终产生相同输出——但微小改动（如随机数+1）会导致输出结果天差地别。这种特性使得通过输出反推输入在计算上不可行。

### 为何要挖矿？（兼论2100万总量上限的实现机制）

我认为您所指的应是"挖矿"而非"铸币"——挖矿是通过验证交易并将区块加入区块链的过程，成功者将获得新比特币奖励。

- **为何挖矿**？
  - **安全保障**：矿工通过竞争解决PoW难题来保护网络，防范双花攻击（重复使用同一比特币）
  - **去中心化**：人人可参与挖矿，实现权力分散——无需中央管理机构
  - **经济激励**：矿工获得**区块奖励（新铸比特币）+交易手续费**，既为网络提供初始动力，也补偿能源消耗

- **总量上限保障机制（实际为2100万而非1000万）**：
  比特币协议将总供应量硬编码为**2100万BTC**，通过每210,000个区块（约4年）**减半**的挖矿奖励逐步释放：
  - 2009年起始奖励为每区块50 BTC
  - 2012年减半至25 BTC，2016年12.5 BTC，2020年6.25 BTC，2024年3.125 BTC，依此类推
  - 最后一枚比特币预计在2140年左右挖出，此后仅靠手续费维持
  - 代码级强制保障：奖励公式为`奖励 = 50 * 0.5^(区块高度/210000的整数商)`。未经95%网络共识无人可修改，确保通胀率可预测且存在硬顶

这种稀缺性模拟了黄金特性，成为价值支撑基础。

### 工作量证明（PoW）运行原理

PoW是比特币的共识机制——通过计算难题证明矿工为添加区块投入了"工作量"（CPU/GPU/ASIC算力）。

- **步骤详解**：
  1. **收集交易**：矿工将待处理交易打包至区块（根据隔离见证情况约1-4MB）
  2. **构建区块头**：包含交易默克尔根、连接前一区块的哈希值等
  3. **设定目标值**：网络每2016个区块调整难度，维持平均10分钟出块时间。目标值=极小数（例如哈希值需＜0x00000000FFFF...）
  4. **寻找随机数**：暴力尝试随机数（0至2^32-1）。每次尝试都对区块头进行哈希运算，若结果＜目标值即有效！
  5. **广播区块**：其他节点验证（验证成本低——仅需单次重算哈希）。验证通过则接入链，矿工开始下一区块竞争
  6. **链规则**：最长有效链胜出（解决分叉问题）

PoW使得验证区块成本低廉而创建区块代价高昂，有效防范51%攻击（通过控制超50%算力篡改历史记录）。

### 为何单笔交易需要海量计算？

用户发起的交易本身并不直接需要巨大计算量——仅需用私钥进行椭圆曲线加密签名（快速完成）。重计算负载实际在于**挖矿环节**：

- **按区块而非按交易**：每个区块打包约2,000-3,000笔交易。矿工为求解PoW需对每个区块进行万亿次哈希运算
- **难度动态调整**：随着矿工加入（总算力提升），难度呈指数级增长以维持10分钟出块。当前全球算力约600 EH/s（每秒600百亿亿次哈希！）
- **为何如此耗费**？
  - **安全成本**：高计算量使攻击无利可图。篡改单个区块需重新完成所有后续PoW
  - **女巫攻击防御**：防止网络被虚假身份淹没
  - **权衡取舍**：虽然能耗巨大（比特币年耗电约1500亿度，相当于中等国家），但支持者认为这是实现去信任货币的必要特性

用户通过支付手续费优先处理交易；低手续费交易需排队等待。

若您特指某些具体场景（如挖矿硬件），请告知！

**参考资料**：  
[比特币白皮书](https://bitcoin.org/bitcoin.pdf)  
[比特币维基：工作量证明](https://en.bitcoin.it/wiki/Proof_of_work)  
[Blockchain.com：比特币减半机制](https://www.blockchain.com/learning-crypto/bitcoin-halving)