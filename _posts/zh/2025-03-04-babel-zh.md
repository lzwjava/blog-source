---
audio: false
generated: true
lang: zh
layout: post
title: 浏览器兼容性的Babel包
translated: true
---

### 关键点
- 这些 Babel 包似乎用于将现代 JavaScript（ES2015）编译为较旧的版本，以确保浏览器兼容性，特别是在基于 webpack 的前端项目中。
- 研究表明，设置涉及安装特定版本、创建一个 `.babelrc` 文件，并配置 webpack 使用 `babel-loader`。
- 证据表明，这些较旧版本的兼容性问题可能很小，但请确保所有包都正确安装。

### 安装
首先，使用以下命令安装包：

```bash
npm install --save-dev \
  "babel-core@6.13.0" \
  "babel-loader@6.2.5" \
  "babel-plugin-transform-runtime@6.12.0" \
  "babel-preset-es2015@6.13.2" \
  "babel-runtime@6.11.6"
```

### 配置
在项目根目录中创建一个 `.babelrc` 文件，内容如下：

```json
{
  "presets": ["es2015"],
  "plugins": ["transform-runtime"]
}
```

然后，设置 `webpack.config.js` 如下：

```javascript
module.exports = {
  entry: './index.js',
  output: {
    filename: 'bundle.js'
  },
  module: {
    rules: [
      {
        test: /\.js$/,
        loader: 'babel-loader',
        options: {
          configFile: './.babelrc'
        }
      }
    ]
  }
};
```

### 使用
在 `index.js` 等文件中编写 ES2015 JavaScript 代码，然后运行 `npx webpack` 将其编译为 `bundle.js`，以便较旧的浏览器能够理解。

### 意外细节
一个意外的方面是这些是较旧的版本（Babel 6），现在已被 Babel 7 取代，这可能会影响长期维护，但对于遗留项目来说是可以的。

---

### 调查笔记：详细设置和使用 Babel 包

本节提供了关于在 JavaScript 项目中使用指定 Babel 包的全面指南——`babel-core@6.13.0`、`babel-loader@6.2.5`、`babel-plugin-transform-runtime@6.12.0`、`babel-preset-es2015@6.13.2` 和 `babel-runtime@6.11.6`，特别是用于基于 webpack 的前端开发。鉴于这些版本，它们是 Babel 6 的一部分，这是一个较旧但仍然功能齐全的转译现代 JavaScript（ES2015）到 ES5 的套件，以实现更广泛的浏览器兼容性。以下详细说明涵盖了安装、配置、使用和考虑因素，确保开发人员在处理遗留项目或特定项目时能够全面理解。

#### 背景和目的
Babel 是一个 JavaScript 编译器，将现代语法转换为更旧、更广泛支持的版本。列出的包来自 Babel 6，这是在 Babel 7 之前的主要更新之前的版本。`babel-core@6.13.0` 提供核心编译功能，而 `babel-loader@6.2.5` 与 webpack 集成用于前端构建。`babel-preset-es2015@6.13.2` 启用了 ES2015（ECMAScript 2015）到 ES5 的转换，而 `babel-plugin-transform-runtime@6.12.0` 与 `babel-runtime@6.11.6` 通过外部化辅助函数优化代码，减少重复。

鉴于当前日期 2025 年 3 月 3 日，这些版本显然过时，Babel 7 及以上版本是标准。然而，对于遗留项目或特定需求，它们仍然相关。用户的查询暗示在 webpack 环境中需要设置，鉴于 `babel-loader` 的包含，虽然也考虑了 Babel CLI 等替代方案。

#### 安装过程
首先，使用 npm 安装包作为开发依赖项。命令确保指定的版本：

```bash
npm install --save-dev \
  "babel-core@6.13.0" \
  "babel-loader@6.2.5" \
  "babel-plugin-transform-runtime@6.12.0" \
  "babel-preset-es2015@6.13.2" \
  "babel-runtime@6.11.6"
```

此步骤将它们放在 `package.json` 下的 `devDependencies` 中，确保它们在构建过程中可用，但在生产中不打包。请注意，`babel-runtime` 通常是某些设置中的运行时依赖项，但在这里，鉴于插件，它被视为开发依赖项，以与转换保持一致。

#### 配置详情
配置涉及两个主要文件：`.babelrc` 用于 Babel 设置，`webpack.config.js` 用于 webpack 集成。

##### `.babelrc` 文件
在项目根目录中创建或编辑 `.babelrc`，内容如下：

```json
{
  "presets": ["es2015"],
  "plugins": ["transform-runtime"]
}
```

- **预设**：`"es2015"` 对应 `babel-preset-es2015@6.13.2`，启用所有 ES2015 转换到 ES5，例如箭头函数、let/const 和类。
- **插件**：`"transform-runtime"` 使用 `babel-plugin-transform-runtime@6.12.0` 将 Babel 辅助程序外部化，引用 `babel-runtime@6.11.6`，这减少了编译代码的大小，避免了文件之间的辅助程序重复。

此配置确保 ES2015 代码被转译并优化以提高运行时效率。

##### Webpack 配置
对于 webpack，创建或更新 `webpack.config.js` 如下：

```javascript
module.exports = {
  entry: './index.js',
  output: {
    filename: 'bundle.js'
  },
  module: {
    rules: [
      {
        test: /\.js$/,
        loader: 'babel-loader',
        options: {
          configFile: './.babelrc'
        }
      }
    ]
  }
};
```

- **入口和输出**：指定 `index.js` 作为入口点，输出 `bundle.js`。
- **模块规则**：对于 `.js` 文件使用 `babel-loader@6.2.5`，指向 `.babelrc` 以获取选项，确保 Babel 在打包之前处理文件。

此设置利用 webpack 的模块系统处理 JavaScript 文件，通过 Babel 编译它们。

#### 使用和工作流程
完成设置后，在 `index.js` 等文件中编写 ES2015 代码。例如：

```javascript
const arr = [1, 2, 3];
const sum = arr.reduce((a, b) => a + b, 0);
console.log(sum);
```

运行构建命令：

```bash
npx webpack
```

这将代码编译为 `bundle.js`，可以在 HTML 中包含以供浏览器执行，确保与较旧环境兼容。`transform-runtime` 插件确保辅助程序共享，减少了捆绑包大小，这对于大型项目特别有用。

#### 替代使用：Babel CLI
虽然查询建议使用 webpack 设置，但为了完整性，考虑使用 Babel CLI 进行手动编译而不使用 webpack。首先，安装 `babel-cli@6.13.0`：

```bash
npm install --save-dev "babel-cli@6.13.0"
```

然后，使用以下命令编译文件：

```bash
./node_modules/.bin/babel src/index.js -o lib/index.js
```

或者，将其添加到 `package.json` 脚本中：

```json
"scripts": {
  "build": "babel src --out-dir lib"
}
```

使用 `npm run build` 运行，输出编译后的文件到 `lib/`，这对于 Node.js 项目或服务器端代码很有用。

#### 兼容性和考虑因素
鉴于这些版本（所有都是 Babel 6，发布多年），通常在同一主版本内确保兼容性。但是，请注意：

- `babel-loader@6.2.5` 与 webpack 1 和 2 兼容，因此请确保您的 webpack 版本（例如 `webpack@1.14.0`）兼容。
- 这些包已被 Babel 7 取代，使用范围包（例如 `@babel/core`）。对于长期项目，考虑升级，但对于遗留项目，这些仍然可以正常工作。
- 确保没有命名冲突；用户的列表中有空格（例如，“babel loader”），可能是拼写错误，更正为连字符（例如 `babel-loader`）。

#### 可能的陷阱
- 确保 `.babelrc` 在项目根目录中，或者在 webpack 选项中指定路径。
- 验证 `babel-runtime` 是否已安装，因为 `transform-runtime` 依赖它提供辅助程序。
- 检查安装期间的弃用警告，鉴于这些版本的年龄，但它们应该按预期工作。

#### 表：包的角色和版本

| 包名称                  | 版本   | 角色                                                                 |
|-------------------------------|---------|----------------------------------------------------------------------|
| `babel-core`                  | 6.13.0  | Babel 的核心编译功能。                            |
| `babel-loader`                | 6.2.5   | Webpack 加载器，编译 JavaScript 文件。                  |
| `babel-plugin-transform-runtime` | 6.12.0 | 插件将辅助程序外部化，减少代码重复。             |
| `babel-preset-es2015`         | 6.13.2  | 预设用于 ES2015 到 ES5 的转换，启用现代语法。      |
| `babel-runtime`               | 6.11.6  | 提供辅助程序的运行时库，用于 `transform-runtime` 插件。     |

此表总结了每个包的角色，有助于理解它们在设置中的目的。

#### 意外细节：遗留背景
一个有趣的方面是这些是 Babel 6 版本，现在已被 Babel 7 取代，Babel 7 引入了范围包（例如 `@babel/core`）。这种设置对于遗留项目是典型的，虽然功能齐全，但可能缺乏 Babel 7 中的现代功能，例如更好的 TypeScript 支持或性能优化，这对于习惯于当前标准的开发人员来说可能是意外的。

#### 结论
本指南涵盖了在基于 webpack 的前端项目中设置指定 Babel 包，并提供了 Babel CLI 的替代方案。鉴于这些版本，请确保与 webpack 1 或 2 兼容，并注意弃用，但对于预期用途，它应该无缝工作。有关更多详细信息，请参考提供的文档链接。

#### 关键引用
- [babel-loader webpack 文档](https://webpack.js.org/loaders/babel-loader/)
- [babel preset-es2015 npm 包](https://www.npmjs.com/package/babel-preset-es2015)
- [babel plugin-transform-runtime npm 包](https://www.npmjs.com/package/babel-plugin-transform-runtime)
- [babel runtime npm 包](https://www.npmjs.com/package/babel-runtime)
- [Webpack 官方文档](https://webpack.js.org/)